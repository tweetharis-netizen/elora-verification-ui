"use strict";exports.id=2414,exports.ids=[2414],exports.modules={2414:(e,r,t)=>{t.d(r,{Oe:()=>clearTeacherCookie,nS:()=>isTeacherFromReq});var l=t(6113),n=t.n(l);let a="elora_teacher";function isTeacherFromReq(e){let r=process.env.ELORA_TEACHER_COOKIE_SECRET||process.env.SESSION_SECRET;if(!r)return!1;let t=function(e){let r=e?.headers?.cookie||"",t={};return r.split(";").forEach(e=>{let[r,...l]=e.trim().split("=");r&&(t[r]=decodeURIComponent(l.join("=")||""))}),t}(e),l=t[a],o=function(e,r){try{var t;if(!e||!r)return null;let[l,a]=String(e).split(".");if(!l||!a)return null;let o=(t=n().createHmac("sha256",r).update(l).digest(),Buffer.from(t).toString("base64").replaceAll("+","-").replaceAll("/","_").replaceAll("=",""));if(o!==a)return null;let c=JSON.parse(function(e){let r=e.length%4==0?"":"=".repeat(4-e.length%4),t=(e+r).replaceAll("-","+").replaceAll("_","/");return Buffer.from(t,"base64").toString("utf8")}(l)),i=Math.floor(Date.now()/1e3);if(!c?.exp||c.exp<i)return null;return c}catch{return null}}(l,r);return!!o?.teacher}function clearTeacherCookie(){let e=[`${a}=`,"Path=/","HttpOnly","SameSite=Lax","Max-Age=0"];return e.push("Secure"),e.join("; ")}}};