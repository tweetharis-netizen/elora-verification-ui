"use strict";exports.id=4946,exports.ids=[4946],exports.modules={4946:(e,t,o)=>{o.d(t,{Eo:()=>fetchBackendStatus,Rf:()=>clearSessionCookie,Ug:()=>requireVerified,cQ:()=>getBackendBaseUrl,mp:()=>makeSessionCookie,pX:()=>getSessionTokenFromReq});let r="elora_session";function makeCookie(e,t,{maxAgeSeconds:o=2592e3}={}){let r=[`${e}=${encodeURIComponent(t)}`,"Path=/","HttpOnly","SameSite=Lax",`Max-Age=${o}`];return r.push("Secure"),r.join("; ")}function getSessionTokenFromReq(e){let t=function(e){let t=e?.headers?.cookie||"",o={};return t.split(";").forEach(e=>{let[t,...r]=e.trim().split("=");t&&(o[t]=decodeURIComponent(r.join("=")||""))}),o}(e);return t[r]||""}function makeSessionCookie(e,{maxAgeSeconds:t=2592e3}={}){return makeCookie(r,e,{maxAgeSeconds:t})}function clearSessionCookie(){return makeCookie(r,"",{maxAgeSeconds:0})}function getBackendBaseUrl(){return(process.env.NEXT_PUBLIC_ELORA_BACKEND_URL||process.env.ELORA_BACKEND_URL||"https://elora-website.vercel.app").replace(/\/$/,"")}async function fetchBackendStatus(e){let t=getBackendBaseUrl();if(!e)return{ok:!0,verified:!1,role:"guest",email:""};try{let o=await fetch(`${t}/api/verification/status`,{method:"GET",headers:{Authorization:`Bearer ${e}`},cache:"no-store"}),r=await o.json().catch(()=>null);if(!o.ok||!r?.ok)return{ok:!0,verified:!1,role:"guest",email:""};return{ok:!0,verified:!!r?.verified,email:String(r?.email||""),role:String(r?.role||(r?.verified?"regular":"guest"))}}catch{return{ok:!0,verified:!1,role:"guest",email:""}}}async function requireVerified(e,t){let o=getSessionTokenFromReq(e),r=await fetchBackendStatus(o);return r.verified?r:(t.status(403).json({ok:!1,error:"not_verified"}),null)}}};