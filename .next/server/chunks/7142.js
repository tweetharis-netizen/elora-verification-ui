"use strict";exports.id=7142,exports.ids=[7142],exports.modules={7142:(e,t,n)=>{n.a(e,async(e,s)=>{try{n.d(t,{tz:()=>generateRubric,vK:()=>createAssignment,vS:()=>getUserAssignments});var i=n(1492),r=n(2497),a=e([i,r]);async function createAssignment({classId:e,teacherId:t,title:n,description:s,dueDate:a,points:o,rubric:d=null,attachments:c=[],settings:l={}}){if(!r.db)throw Error("Firestore not initialized");let u={classId:e,teacherId:t,title:n,description:s,dueDate:a,points:o,rubric:d,attachments:c,settings:{allowLateSubmissions:l.allowLateSubmissions??!0,allowPeerReview:l.allowPeerReview??!1,plagiarismCheck:l.plagiarismCheck??!0,...l},status:"draft",createdAt:(0,i.serverTimestamp)(),updatedAt:(0,i.serverTimestamp)(),publishedAt:null,versions:[]},m=(0,i.doc)((0,i.collection)(r.db,"assignments"));return await (0,i.setDoc)(m,u),{id:m.id,...u}}async function getClassAssignments(e){if(!r.db)return[];let t=(0,i.query)((0,i.collection)(r.db,"assignments"),(0,i.where)("classId","==",e),(0,i.orderBy)("dueDate","desc")),n=await (0,i.getDocs)(t);return n.docs.map(e=>({id:e.id,...e.data()}))}async function generateRubric(e,t,n){return{criteria:[{name:"Content & Understanding",description:"Demonstrates understanding of the topic",levels:[{name:"Excellent",points:.4*n,description:"Exceptional understanding"},{name:"Good",points:.3*n,description:"Good understanding"},{name:"Satisfactory",points:.2*n,description:"Basic understanding"},{name:"Needs Improvement",points:.1*n,description:"Limited understanding"}]},{name:"Quality & Effort",description:"Overall quality and effort demonstrated",levels:[{name:"Excellent",points:.3*n,description:"Outstanding effort"},{name:"Good",points:.2*n,description:"Good effort"},{name:"Satisfactory",points:.15*n,description:"Adequate effort"},{name:"Needs Improvement",points:.05*n,description:"Minimal effort"}]}]}}async function getTeacherAssignments(e){if(!r.db)return[];let t=(0,i.query)((0,i.collection)(r.db,"assignments"),(0,i.where)("teacherId","==",e),(0,i.orderBy)("createdAt","desc")),n=await (0,i.getDocs)(t);return n.docs.map(e=>({id:e.id,...e.data()}))}async function getUserAssignments(e,t,n=[]){if(!r.db)return[];try{if("educator"===t)return await getTeacherAssignments(e);if("student"===t||"parent"===t){if(!n||0===n.length)return[];let e=n.map(e=>getClassAssignments(e)),t=await Promise.all(e),s=new Map;return t.flat().forEach(e=>{s.has(e.id)||s.set(e.id,e)}),Array.from(s.values()).sort((e,t)=>new Date(t.dueDate)-new Date(e.dueDate))}return[]}catch(e){return console.error("Error in getUserAssignments:",e),[]}}[i,r]=a.then?(await a)():a,s()}catch(e){s(e)}})}};