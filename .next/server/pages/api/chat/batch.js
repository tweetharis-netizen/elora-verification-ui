"use strict";(()=>{var e={};e.id=4337,e.ids=[4337],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},2079:e=>{e.exports=import("openai")},1121:(e,r,t)=>{t.a(e,async(e,a)=>{try{t.r(r),t.d(r,{config:()=>l,default:()=>u,routeModule:()=>d});var s=t(1802),o=t(7153),n=t(6249),i=t(6450),c=e([i]);i=(c.then?(await c)():c)[0];let u=(0,n.l)(i,"default"),l=(0,n.l)(i,"config"),d=new s.PagesAPIRouteModule({definition:{kind:o.x.PAGES_API,page:"/api/chat/batch",pathname:"/api/chat/batch",bundlePath:"",filename:""},userland:i});a()}catch(e){a(e)}})},6450:(e,r,t)=>{t.a(e,async(e,a)=>{try{t.r(r),t.d(r,{default:()=>handler});var s=t(2079),o=e([s]);s=(o.then?(await o)():o)[0];let n=new s.OpenAI({apiKey:process.env.OPENROUTER_API_KEY,baseURL:"https://openrouter.ai/api/v1",defaultHeaders:{"HTTP-Referer":process.env.NEXT_PUBLIC_SITE_URL||"https://elora.app"}});async function handler(e,r){if("POST"!==e.method)return r.status(405).json({error:"Method not allowed"});let{questions:t,context:a={}}=e.body;if(!t||!Array.isArray(t)||0===t.length)return r.status(400).json({error:"Questions array is required"});if(t.length>10)return r.status(400).json({error:"Maximum 10 questions per batch"});try{let e=await Promise.all(t.map(async(e,r)=>{try{let t;let s=(t="You are Elora, an educational AI assistant.","student"===a.role?t+=" You are helping a student learn. Be encouraging and guide them to discover answers rather than just giving them.":"educator"===a.role?t+=" You are assisting a teacher. Provide professional, curriculum-aligned responses.":"parent"===a.role&&(t+=" You are helping a parent understand educational concepts. Explain clearly without jargon."),a.level&&(t+=` The student is in grade ${a.level}.`),a.subject&&(t+=` Focus on ${a.subject}.`),"strict"===a.personality?t+=" Be direct and academically rigorous. Focus on accuracy and proper methodology.":"encouraging"===a.personality?t+=" Be warm, supportive, and celebrate progress. Build confidence.":"socratic"===a.personality&&(t+=" Use the Socratic method: ask guiding questions to help the student discover answers themselves."),t),o=await n.chat.completions.create({model:"gpt-4o-mini",messages:[{role:"system",content:s},{role:"user",content:e}],temperature:.7,max_tokens:500});return{question:e,answer:o.choices[0].message.content,index:r,success:!0}}catch(t){return console.error(`Error processing question ${r}:`,t),{question:e,answer:null,error:"Failed to process this question",index:r,success:!1}}}));r.status(200).json({responses:e})}catch(e){console.error("Batch processing error:",e),r.status(500).json({error:"Failed to process batch"})}}a()}catch(e){a(e)}})}};var r=require("../../../webpack-api-runtime.js");r.C(e);var __webpack_exec__=e=>r(r.s=e),t=r.X(0,[4222],()=>__webpack_exec__(1121));module.exports=t})();