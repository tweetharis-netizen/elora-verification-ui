"use strict";(()=>{var e={};e.id=443,e.ids=[443],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},3808:e=>{e.exports=import("docx")},4119:(e,t,r)=>{r.a(e,async(e,n)=>{try{r.r(t),r.d(t,{config:()=>d,default:()=>s,routeModule:()=>p});var a=r(1802),i=r(7153),o=r(6249),l=r(7021),c=e([l]);l=(c.then?(await c)():c)[0];let s=(0,o.l)(l,"default"),d=(0,o.l)(l,"config"),p=new a.PagesAPIRouteModule({definition:{kind:i.x.PAGES_API,page:"/api/export-docx",pathname:"/api/export-docx",bundlePath:"",filename:""},userland:l});n()}catch(e){n(e)}})},7021:(e,t,r)=>{r.a(e,async(e,n)=>{try{r.r(t),r.d(t,{default:()=>handler});var a=r(3808),i=e([a]);function clampStr(e,t=2e5){if("string"!=typeof e)return"";let r=e.trim();return r.length<=t?r:r.slice(0,t)}async function handler(e,t){if("POST"!==e.method)return t.setHeader("Allow","POST"),t.status(405).json({error:"Method not allowed"});try{let r=clampStr(e.body?.title||"Elora Export",120),n=clampStr(e.body?.content||"",2e5),i=new a.Document({sections:[{children:[new a.Paragraph({children:[new a.TextRun({text:r,bold:!0,size:34})],spacing:{after:250}}),...function(e){let t=(e||"").split("\n"),r=[];for(let e of t){let t=e.replace(/\r/g,"").trimEnd();if(!t.trim()){r.push(new a.Paragraph({children:[new a.TextRun(" ")]}));continue}if(/^[-*]\s+/.test(t)){r.push(new a.Paragraph({children:[new a.TextRun(t.replace(/^[-*]\s+/,""))],bullet:{level:0}}));continue}if(/^\d+\.\s+/.test(t)){r.push(new a.Paragraph({children:[new a.TextRun(t.replace(/^\d+\.\s+/,""))],numbering:{reference:"num",level:0}}));continue}if(/^#{1,6}\s+/.test(t)){let e=t.replace(/^#{1,6}\s+/,"").trim();r.push(new a.Paragraph({children:[new a.TextRun({text:e,bold:!0,size:30})],spacing:{after:200}}));continue}r.push(new a.Paragraph({children:[new a.TextRun(t)]}))}return r}(n)]}]}),o=await a.Packer.toBuffer(i);return t.setHeader("Content-Type","application/vnd.openxmlformats-officedocument.wordprocessingml.document"),t.setHeader("Content-Disposition",`attachment; filename="${r.replace(/[^a-z0-9 _-]/gi,"").replace(/\s+/g,"-").slice(0,60)||"Elora-Export"}.docx"`),t.status(200).send(o)}catch(e){return console.error(e),t.status(500).json({error:"Failed to generate DOCX."})}}a=(i.then?(await i)():i)[0],n()}catch(e){n(e)}})}};var t=require("../../webpack-api-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[4222],()=>__webpack_exec__(4119));module.exports=r})();