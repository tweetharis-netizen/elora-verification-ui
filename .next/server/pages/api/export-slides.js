"use strict";(()=>{var e={};e.id=414,e.ids=[414],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},3120:(e,t,r)=>{r.r(t),r.d(t,{config:()=>c,default:()=>p,routeModule:()=>u});var a={};r.r(a),r.d(a,{default:()=>handler});var n=r(1802),o=r(7153),l=r(6249);let i=require("pptxgenjs");var s=r.n(i),d=r(4946);function clampStr(e,t=2e5){if("string"!=typeof e)return"";let r=e.trim();return r.length<=t?r:r.slice(0,t)}async function handler(e,t){let r=await (0,d.Ug)(e,t);if(r){if("POST"!==e.method)return t.setHeader("Allow","POST"),t.status(405).json({error:"Method not allowed"});try{let r=clampStr(e.body?.title||"Elora Slides",120),a=clampStr(e.body?.content||"",2e5),n=new(s());n.layout="LAYOUT_WIDE",n.author="Elora";let o=a.split(/\n\s*\n/g).map(e=>e.trim()).filter(Boolean);0===o.length&&o.push(a||" "),o.slice(0,25).forEach((e,t)=>{let a=n.addSlide();a.addText(0===t?r:`Slide ${t+1}`,{x:.6,y:.4,w:12.2,h:.6,fontFace:"Aptos Display",fontSize:26,bold:!0}),a.addText(e,{x:.7,y:1.3,w:12,h:5.2,fontFace:"Aptos",fontSize:16,color:"1f2937"})});let l=await n.write("nodebuffer");return t.setHeader("Content-Disposition",`attachment; filename="${r.replace(/[^a-z0-9 _-]/gi,"").replace(/\s+/g,"-").slice(0,60)||"Elora-Slides"}.pptx"`),t.setHeader("Content-Type","application/vnd.openxmlformats-officedocument.presentationml.presentation"),t.status(200).send(l)}catch(e){return console.error(e),t.status(500).json({error:"Failed to generate slides."})}}}let p=(0,l.l)(a,"default"),c=(0,l.l)(a,"config"),u=new n.PagesAPIRouteModule({definition:{kind:o.x.PAGES_API,page:"/api/export-slides",pathname:"/api/export-slides",bundlePath:"",filename:""},userland:a})}};var t=require("../../webpack-api-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[4222,4946],()=>__webpack_exec__(3120));module.exports=r})();