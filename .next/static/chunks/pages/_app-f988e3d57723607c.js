(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[888],{9711:function(e,r,h){"use strict";h.d(r,{BH:function(){return Deferred},LL:function(){return ErrorFactory},ZR:function(){return FirebaseError},tV:function(){return base64Decode},L:function(){return base64urlEncodeWithoutPadding},Sg:function(){return createMockUserToken},ne:function(){return createSubscribe},vZ:function(){return function deepEqual(e,r){if(e===r)return!0;let h=Object.keys(e),d=Object.keys(r);for(let f of h){if(!d.includes(f))return!1;let h=e[f],g=r[f];if(isObject(h)&&isObject(g)){if(!deepEqual(h,g))return!1}else if(h!==g)return!1}for(let e of d)if(!h.includes(e))return!1;return!0}},pd:function(){return extractQuerystring},aH:function(){return getDefaultAppConfig},q4:function(){return getDefaultEmulatorHost},P0:function(){return getDefaultEmulatorHostnameAndPort},Pz:function(){return getExperimentalSetting},m9:function(){return getModularInstance},z$:function(){return getUA},ru:function(){return isBrowserExtension},Xx:function(){return isCloudWorkstation},L_:function(){return isCloudflareWorker},xb:function(){return isEmpty},w1:function(){return isIE},hl:function(){return isIndexedDBAvailable},uI:function(){return isMobileCordova},b$:function(){return isReactNative},G6:function(){return isSafari},Uo:function(){return pingServer},xO:function(){return querystring},zd:function(){return querystringDecode},dp:function(){return updateEmulatorBanner},eu:function(){return validateIndexedDBOpenable}});let getDefaultsFromPostinstall=()=>void 0;var d=h(3454);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let stringToByteArray$1=function(e){let r=[],h=0;for(let d=0;d<e.length;d++){let f=e.charCodeAt(d);f<128?r[h++]=f:(f<2048?r[h++]=f>>6|192:((64512&f)==55296&&d+1<e.length&&(64512&e.charCodeAt(d+1))==56320?(f=65536+((1023&f)<<10)+(1023&e.charCodeAt(++d)),r[h++]=f>>18|240,r[h++]=f>>12&63|128):r[h++]=f>>12|224,r[h++]=f>>6&63|128),r[h++]=63&f|128)}return r},byteArrayToString=function(e){let r=[],h=0,d=0;for(;h<e.length;){let f=e[h++];if(f<128)r[d++]=String.fromCharCode(f);else if(f>191&&f<224){let g=e[h++];r[d++]=String.fromCharCode((31&f)<<6|63&g)}else if(f>239&&f<365){let g=e[h++],b=e[h++],A=e[h++],k=((7&f)<<18|(63&g)<<12|(63&b)<<6|63&A)-65536;r[d++]=String.fromCharCode(55296+(k>>10)),r[d++]=String.fromCharCode(56320+(1023&k))}else{let g=e[h++],b=e[h++];r[d++]=String.fromCharCode((15&f)<<12|(63&g)<<6|63&b)}}return r.join("")},f={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,r){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();let h=r?this.byteToCharMapWebSafe_:this.byteToCharMap_,d=[];for(let r=0;r<e.length;r+=3){let f=e[r],g=r+1<e.length,b=g?e[r+1]:0,A=r+2<e.length,k=A?e[r+2]:0,M=f>>2,j=(3&f)<<4|b>>4,q=(15&b)<<2|k>>6,ee=63&k;A||(ee=64,g||(q=64)),d.push(h[M],h[j],h[q],h[ee])}return d.join("")},encodeString(e,r){return this.HAS_NATIVE_SUPPORT&&!r?btoa(e):this.encodeByteArray(stringToByteArray$1(e),r)},decodeString(e,r){return this.HAS_NATIVE_SUPPORT&&!r?atob(e):byteArrayToString(this.decodeStringToByteArray(e,r))},decodeStringToByteArray(e,r){this.init_();let h=r?this.charToByteMapWebSafe_:this.charToByteMap_,d=[];for(let r=0;r<e.length;){let f=h[e.charAt(r++)],g=r<e.length,b=g?h[e.charAt(r)]:0;++r;let A=r<e.length,k=A?h[e.charAt(r)]:64;++r;let M=r<e.length,j=M?h[e.charAt(r)]:64;if(++r,null==f||null==b||null==k||null==j)throw new DecodeBase64StringError;let q=f<<2|b>>4;if(d.push(q),64!==k){let e=b<<4&240|k>>2;if(d.push(e),64!==j){let e=k<<6&192|j;d.push(e)}}}return d},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};let DecodeBase64StringError=class DecodeBase64StringError extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}};let base64Encode=function(e){let r=stringToByteArray$1(e);return f.encodeByteArray(r,!0)},base64urlEncodeWithoutPadding=function(e){return base64Encode(e).replace(/\./g,"")},base64Decode=function(e){try{return f.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null},getDefaultsFromGlobal=()=>/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==h.g)return h.g;throw Error("Unable to locate global object.")})().__FIREBASE_DEFAULTS__,getDefaultsFromEnvVariable=()=>{if(void 0===d||void 0===d.env)return;let e=d.env.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},getDefaultsFromCookie=()=>{let e;if("undefined"==typeof document)return;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}let r=e&&base64Decode(e[1]);return r&&JSON.parse(r)},getDefaults=()=>{try{return getDefaultsFromPostinstall()||getDefaultsFromGlobal()||getDefaultsFromEnvVariable()||getDefaultsFromCookie()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},getDefaultEmulatorHost=e=>getDefaults()?.emulatorHosts?.[e],getDefaultEmulatorHostnameAndPort=e=>{let r=getDefaultEmulatorHost(e);if(!r)return;let h=r.lastIndexOf(":");if(h<=0||h+1===r.length)throw Error(`Invalid host ${r} with no separate hostname and port!`);let d=parseInt(r.substring(h+1),10);return"["===r[0]?[r.substring(1,h-1),d]:[r.substring(0,h),d]},getDefaultAppConfig=()=>getDefaults()?.config,getExperimentalSetting=e=>getDefaults()?.[`_${e}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Deferred=class Deferred{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,h)=>{r?this.reject(r):this.resolve(h),"function"==typeof e&&(this.promise.catch(()=>{}),1===e.length?e(r):e(r,h))}}};/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function isCloudWorkstation(e){try{let r=e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e;return r.endsWith(".cloudworkstations.dev")}catch{return!1}}async function pingServer(e){let r=await fetch(e,{credentials:"include"});return r.ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function createMockUserToken(e,r){if(e.uid)throw Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let h=r||"demo-project",d=e.iat||0,f=e.sub||e.user_id;if(!f)throw Error("mockUserToken must contain 'sub' or 'user_id' field!");let g={iss:`https://securetoken.google.com/${h}`,aud:h,iat:d,exp:d+3600,auth_time:d,sub:f,user_id:f,firebase:{sign_in_provider:"custom",identities:{}},...e};return[base64urlEncodeWithoutPadding(JSON.stringify({alg:"none",type:"JWT"})),base64urlEncodeWithoutPadding(JSON.stringify(g)),""].join(".")}let g={},b=!1;function updateEmulatorBanner(e,r){if("undefined"==typeof window||"undefined"==typeof document||!isCloudWorkstation(window.location.host)||g[e]===r||g[e]||b)return;function prefixedId(e){return`__firebase__banner__${e}`}g[e]=r;let h="__firebase__banner",d=function(){let e={prod:[],emulator:[]};for(let r of Object.keys(g))g[r]?e.emulator.push(r):e.prod.push(r);return e}(),f=d.prod.length>0;function setupDom(){let e,r;let d=(e=document.getElementById(h),r=!1,e||((e=document.createElement("div")).setAttribute("id",h),r=!0),{created:r,element:e}),g=prefixedId("text"),A=document.getElementById(g)||document.createElement("span"),k=prefixedId("learnmore"),M=document.getElementById(k)||document.createElement("a"),j=prefixedId("preprendIcon"),q=document.getElementById(j)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(d.created){let e=d.element;e.style.display="flex",e.style.background="#7faaf0",e.style.position="fixed",e.style.bottom="5px",e.style.left="5px",e.style.padding=".5em",e.style.borderRadius="5px",e.style.alignItems="center",M.setAttribute("id",k),M.innerText="Learn more",M.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",M.setAttribute("target","__blank"),M.style.paddingLeft="5px",M.style.textDecoration="underline";let r=function(){let e=document.createElement("span");return e.style.cursor="pointer",e.style.marginLeft="16px",e.style.fontSize="24px",e.innerHTML=" &times;",e.onclick=()=>{b=!0,function(){let e=document.getElementById(h);e&&e.remove()}()},e}();q.setAttribute("width","24"),q.setAttribute("id",j),q.setAttribute("height","24"),q.setAttribute("viewBox","0 0 24 24"),q.setAttribute("fill","none"),q.style.marginLeft="-6px",e.append(q,A,M,r),document.body.appendChild(e)}f?(A.innerText="Preview backend disconnected.",q.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(q.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,A.innerText="Preview backend running in this workspace."),A.setAttribute("id",g)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",setupDom):setupDom()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getUA(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function isMobileCordova(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(getUA())}function isCloudflareWorker(){return"undefined"!=typeof navigator&&"Cloudflare-Workers"===navigator.userAgent}function isBrowserExtension(){let e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function isReactNative(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function isIE(){let e=getUA();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function isSafari(){return!function(){let e=getDefaults()?.forceEnvironment;if("node"===e)return!0;if("browser"===e)return!1;try{return"[object process]"===Object.prototype.toString.call(h.g.process)}catch(e){return!1}}()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function isIndexedDBAvailable(){try{return"object"==typeof indexedDB}catch(e){return!1}}function validateIndexedDBOpenable(){return new Promise((e,r)=>{try{let h=!0,d="validate-browser-context-for-indexeddb-analytics-module",f=self.indexedDB.open(d);f.onsuccess=()=>{f.result.close(),h||self.indexedDB.deleteDatabase(d),e(!0)},f.onupgradeneeded=()=>{h=!1},f.onerror=()=>{r(f.error?.message||"")}}catch(e){r(e)}})}let FirebaseError=class FirebaseError extends Error{constructor(e,r,h){super(r),this.code=e,this.customData=h,this.name="FirebaseError",Object.setPrototypeOf(this,FirebaseError.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ErrorFactory.prototype.create)}};let ErrorFactory=class ErrorFactory{constructor(e,r,h){this.service=e,this.serviceName=r,this.errors=h}create(e,...r){let h=r[0]||{},d=`${this.service}/${e}`,f=this.errors[e],g=f?f.replace(A,(e,r)=>{let d=h[r];return null!=d?String(d):`<${r}?>`}):"Error",b=`${this.serviceName}: ${g} (${d}).`,k=new FirebaseError(d,b,h);return k}};let A=/\{\$([^}]+)}/g;function isEmpty(e){for(let r in e)if(Object.prototype.hasOwnProperty.call(e,r))return!1;return!0}function isObject(e){return null!==e&&"object"==typeof e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function querystring(e){let r=[];for(let[h,d]of Object.entries(e))Array.isArray(d)?d.forEach(e=>{r.push(encodeURIComponent(h)+"="+encodeURIComponent(e))}):r.push(encodeURIComponent(h)+"="+encodeURIComponent(d));return r.length?"&"+r.join("&"):""}function querystringDecode(e){let r={},h=e.replace(/^\?/,"").split("&");return h.forEach(e=>{if(e){let[h,d]=e.split("=");r[decodeURIComponent(h)]=decodeURIComponent(d)}}),r}function extractQuerystring(e){let r=e.indexOf("?");if(!r)return"";let h=e.indexOf("#",r);return e.substring(r,h>0?h:void 0)}function createSubscribe(e,r){let h=new ObserverProxy(e,r);return h.subscribe.bind(h)}let ObserverProxy=class ObserverProxy{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,h){let d;if(void 0===e&&void 0===r&&void 0===h)throw Error("Missing Observer.");void 0===(d=!function(e,r){if("object"!=typeof e||null===e)return!1;for(let h of r)if(h in e&&"function"==typeof e[h])return!0;return!1}(e,["next","error","complete"])?{next:e,error:r,complete:h}:e).next&&(d.next=noop),void 0===d.error&&(d.error=noop),void 0===d.complete&&(d.complete=noop);let f=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?d.error(this.finalError):d.complete()}catch(e){}}),this.observers.push(d),f}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{r(this.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function noop(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getModularInstance(e){return e&&e._delegate?e._delegate:e}},3454:function(e,r,h){"use strict";var d,f;e.exports=(null==(d=h.g.process)?void 0:d.env)&&"object"==typeof(null==(f=h.g.process)?void 0:f.env)?h.g.process:h(7663)},1118:function(e,r,h){(window.__NEXT_P=window.__NEXT_P||[]).push(["/_app",function(){return h(4702)}])},6600:function(e,r,h){"use strict";h.d(r,{Z:function(){return Navigation}});var d=h(5893),f=h(7294),g=h(1664),b=h.n(g),A=h(1163),k=h(3495),M=h(1526),j=h(7290);function ThemeToggle(){let[e,r]=(0,f.useState)("light"),[h,g]=(0,f.useState)(!1);return((0,f.useEffect)(()=>{g(!0);let e=localStorage.getItem("elora-theme"),h=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",d=e||h;r(d),document.documentElement.classList.toggle("dark","dark"===d)},[]),h)?(0,d.jsx)(k.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>{let h="light"===e?"dark":"light";r(h),localStorage.setItem("elora-theme",h),document.documentElement.classList.toggle("dark","dark"===h)},className:"relative w-14 h-7 rounded-full bg-gray-200 dark:bg-gray-700 transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2","aria-label":"Switch to ".concat("light"===e?"dark":"light"," mode"),children:(0,d.jsx)(k.E.div,{className:"absolute top-0.5 left-0.5 w-6 h-6 rounded-full bg-white dark:bg-gray-900 shadow-md flex items-center justify-center",animate:{x:"dark"===e?28:0},transition:{type:"spring",stiffness:500,damping:30},children:"light"===e?(0,d.jsx)("svg",{className:"w-4 h-4 text-yellow-500",fill:"currentColor",viewBox:"0 0 20 20",children:(0,d.jsx)("path",{fillRule:"evenodd",d:"M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z",clipRule:"evenodd"})}):(0,d.jsx)("svg",{className:"w-4 h-4 text-indigo-500",fill:"currentColor",viewBox:"0 0 20 20",children:(0,d.jsx)("path",{d:"M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"})})})}):(0,d.jsx)("div",{className:"w-14 h-7"})}function Navigation(){var e;let r=(0,A.useRouter)(),{session:h,user:g}=(0,j.q)(),[q,ee]=(0,f.useState)(!1),[et,er]=(0,f.useState)(!1),en=[{name:"Dashboard",href:"/dashboard",icon:DashboardIcon},{name:"Assistant",href:"/assistant",icon:AssistantIcon},{name:"Classes",href:"/classes",icon:ClassesIcon},{name:"Assignments",href:"/assignments",icon:AssignmentsIcon},{name:"Analytics",href:"/analytics",icon:AnalyticsIcon}],isActive=e=>r.pathname.startsWith(e);return(0,d.jsx)(d.Fragment,{children:(0,d.jsxs)("nav",{className:"sticky top-0 z-50 bg-white/80 dark:bg-neutral-900/80 backdrop-blur-xl border-b border-neutral-200 dark:border-neutral-800",children:[(0,d.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,d.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,d.jsxs)(b(),{href:"/dashboard",className:"flex items-center gap-3 group",children:[(0,d.jsx)("div",{className:"w-9 h-9 rounded-xl bg-gradient-to-br from-primary-500 to-secondary-500 flex items-center justify-center shadow-lg shadow-primary-500/25 group-hover:shadow-primary-500/40 transition-shadow",children:(0,d.jsx)("svg",{className:"w-5 h-5 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),(0,d.jsx)("span",{className:"text-xl font-bold bg-gradient-to-r from-neutral-900 to-neutral-600 dark:from-white dark:to-neutral-300 bg-clip-text text-transparent",children:"Elora"})]}),(0,d.jsx)("div",{className:"hidden md:flex items-center gap-1",children:en.map(e=>{let r=e.icon,h=isActive(e.href);return(0,d.jsxs)(b(),{href:e.href,className:"relative px-4 py-2 rounded-lg text-sm font-medium transition-colors ".concat(h?"text-primary-600 dark:text-primary-400":"text-neutral-600 dark:text-neutral-400 hover:text-neutral-900 dark:hover:text-neutral-100"),children:[(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)(r,{className:"w-4 h-4"}),(0,d.jsx)("span",{children:e.name})]}),h&&(0,d.jsx)(k.E.div,{layoutId:"activeTab",className:"absolute inset-0 bg-primary-50 dark:bg-primary-900/20 rounded-lg -z-10",transition:{type:"spring",bounce:.2,duration:.6}})]},e.name)})}),(0,d.jsxs)("div",{className:"flex items-center gap-3",children:[(0,d.jsx)(ThemeToggle,{}),(0,d.jsx)("button",{className:"hidden md:flex items-center justify-center w-9 h-9 rounded-lg hover:bg-neutral-100 dark:hover:bg-neutral-800 transition-colors",children:(0,d.jsx)("svg",{className:"w-5 h-5 text-neutral-600 dark:text-neutral-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})})}),(0,d.jsxs)("div",{className:"relative",children:[(0,d.jsxs)("button",{onClick:()=>er(!et),className:"flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-neutral-100 dark:hover:bg-neutral-800 transition-colors",children:[(0,d.jsx)("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-primary-400 to-secondary-400 flex items-center justify-center text-white font-semibold text-sm",children:(null==h?void 0:null===(e=h.name)||void 0===e?void 0:e.charAt(0))||"U"}),(0,d.jsxs)("div",{className:"hidden lg:block text-left",children:[(0,d.jsx)("div",{className:"text-sm font-medium text-neutral-900 dark:text-white",children:(null==h?void 0:h.name)||"User"}),(0,d.jsx)("div",{className:"text-xs text-neutral-500 dark:text-neutral-400 capitalize",children:(null==h?void 0:h.role)||"Student"})]}),(0,d.jsx)("svg",{className:"w-4 h-4 text-neutral-400 transition-transform ".concat(et?"rotate-180":""),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),(0,d.jsx)(M.M,{children:et&&(0,d.jsxs)(k.E.div,{initial:{opacity:0,scale:.95,y:-10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-10},className:"absolute right-0 mt-2 w-56 bg-white dark:bg-neutral-800 rounded-xl shadow-xl border border-neutral-200 dark:border-neutral-700 py-2 z-50",children:[(0,d.jsxs)(b(),{href:"/settings",className:"flex items-center gap-3 px-4 py-2 text-sm text-neutral-700 dark:text-neutral-300 hover:bg-neutral-100 dark:hover:bg-neutral-700",children:[(0,d.jsxs)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),"Settings"]}),(0,d.jsxs)(b(),{href:"/help",className:"flex items-center gap-3 px-4 py-2 text-sm text-neutral-700 dark:text-neutral-300 hover:bg-neutral-100 dark:hover:bg-neutral-700",children:[(0,d.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Help"]}),(0,d.jsx)("div",{className:"border-t border-neutral-200 dark:border-neutral-700 my-2"}),(0,d.jsxs)("button",{className:"flex items-center gap-3 px-4 py-2 text-sm text-error hover:bg-red-50 dark:hover:bg-red-900/20 w-full",children:[(0,d.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Sign Out"]})]})})]}),(0,d.jsx)("button",{onClick:()=>ee(!q),className:"md:hidden flex items-center justify-center w-9 h-9 rounded-lg hover:bg-neutral-100 dark:hover:bg-neutral-800 transition-colors",children:(0,d.jsx)("svg",{className:"w-5 h-5 text-neutral-600 dark:text-neutral-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:q?(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"}):(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})]})]})}),(0,d.jsx)(M.M,{children:q&&(0,d.jsx)(k.E.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"md:hidden border-t border-neutral-200 dark:border-neutral-800",children:(0,d.jsx)("div",{className:"px-4 py-4 space-y-1",children:en.map(e=>{let r=e.icon,h=isActive(e.href);return(0,d.jsxs)(b(),{href:e.href,onClick:()=>ee(!1),className:"flex items-center gap-3 px-4 py-3 rounded-lg text-sm font-medium transition-colors ".concat(h?"bg-primary-50 dark:bg-primary-900/20 text-primary-600 dark:text-primary-400":"text-neutral-600 dark:text-neutral-400 hover:bg-neutral-100 dark:hover:bg-neutral-800"),children:[(0,d.jsx)(r,{className:"w-5 h-5"}),(0,d.jsx)("span",{children:e.name})]},e.name)})})})})]})})}function DashboardIcon(e){let{className:r}=e;return(0,d.jsx)("svg",{className:r,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})})}function ClassesIcon(e){let{className:r}=e;return(0,d.jsx)("svg",{className:r,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}function AssignmentsIcon(e){let{className:r}=e;return(0,d.jsx)("svg",{className:r,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}function AnalyticsIcon(e){let{className:r}=e;return(0,d.jsx)("svg",{className:r,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}function AssistantIcon(e){let{className:r}=e;return(0,d.jsx)("svg",{className:r,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}},7290:function(e,r,h){"use strict";h.d(r,{q:function(){return useApp},w:function(){return AppProvider}});var d=h(5893),f=h(7294),g=h(2753),b=h(5266),A=h(3833);let k=(0,f.createContext)(null);function AppProvider(e){let{children:r}=e,[h,M]=(0,f.useState)(null),[j,q]=(0,f.useState)(null),[ee,et]=(0,f.useState)(!0),[er,en]=(0,f.useState)([]);(0,f.useEffect)(()=>{let e=(0,A.Gg)();M(e);let r=(0,g.Aj)(b.I8,e=>{q(e),et(!1)}),handleStorageChange=()=>{let e=(0,A.Gg)();M(e)};return window.addEventListener("elora:session",handleStorageChange),()=>{r(),window.removeEventListener("elora:session",handleStorageChange)}},[]);let ei=(0,f.useCallback)(e=>{let r={...h,...e};(0,A.Aj)(r),M(r)},[h]),es=(0,f.useCallback)(e=>{let r=Date.now().toString();return en(h=>[...h,{id:r,...e}]),setTimeout(()=>{eo(r)},5e3),r},[]),eo=(0,f.useCallback)(e=>{en(r=>r.filter(r=>r.id!==e))},[]);return ee?(0,d.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-gradient-to-br from-primary-50 to-secondary-50 dark:from-neutral-900 dark:to-neutral-800",children:(0,d.jsxs)("div",{className:"text-center",children:[(0,d.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-b-4 border-primary-600 mx-auto mb-4"}),(0,d.jsx)("p",{className:"text-text-secondary text-lg",children:"Loading Elora..."})]})}):(0,d.jsx)(k.Provider,{value:{session:h,user:j,loading:ee,updateSession:ei,notifications:er,addNotification:es,removeNotification:eo},children:r})}function useApp(){let e=(0,f.useContext)(k);if(!e)throw Error("useApp must be used within AppProvider");return e}},7483:function(e,r,h){"use strict";let d,f;h.d(r,{J:function(){return NotificationProvider},z:function(){return useNotifications}});var g,b=h(5893),A=h(7294);let k={data:""},t=e=>{if("object"==typeof window){let r=(e?e.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return r.nonce=window.__nonce__,r.parentNode||(e||document.head).appendChild(r),r.firstChild}return e||k},M=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,j=/\/\*[^]*?\*\/|  +/g,q=/\n+/g,o=(e,r)=>{let h="",d="",f="";for(let g in e){let b=e[g];"@"==g[0]?"i"==g[1]?h=g+" "+b+";":d+="f"==g[1]?o(b,g):g+"{"+o(b,"k"==g[1]?"":r)+"}":"object"==typeof b?d+=o(b,r?r.replace(/([^,])+/g,e=>g.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,r=>/&/.test(r)?r.replace(/&/g,e):e?e+" "+r:r)):g):null!=b&&(g=/^--/.test(g)?g:g.replace(/[A-Z]/g,"-$&").toLowerCase(),f+=o.p?o.p(g,b):g+":"+b+";")}return h+(r&&f?r+"{"+f+"}":f)+d},ee={},s=e=>{if("object"==typeof e){let r="";for(let h in e)r+=h+s(e[h]);return r}return e},i=(e,r,h,d,f)=>{var g;let b=s(e),A=ee[b]||(ee[b]=(e=>{let r=0,h=11;for(;r<e.length;)h=101*h+e.charCodeAt(r++)>>>0;return"go"+h})(b));if(!ee[A]){let r=b!==e?e:(e=>{let r,h,d=[{}];for(;r=M.exec(e.replace(j,""));)r[4]?d.shift():r[3]?(h=r[3].replace(q," ").trim(),d.unshift(d[0][h]=d[0][h]||{})):d[0][r[1]]=r[2].replace(q," ").trim();return d[0]})(e);ee[A]=o(f?{["@keyframes "+A]:r}:r,h?"":"."+A)}let k=h&&ee.g?ee.g:null;return h&&(ee.g=ee[A]),g=ee[A],k?r.data=r.data.replace(k,g):-1===r.data.indexOf(g)&&(r.data=d?g+r.data:r.data+g),A},p=(e,r,h)=>e.reduce((e,d,f)=>{let g=r[f];if(g&&g.call){let e=g(h),r=e&&e.props&&e.props.className||/^go/.test(e)&&e;g=r?"."+r:e&&"object"==typeof e?e.props?"":o(e,""):!1===e?"":e}return e+d+(null==g?"":g)},"");function u(e){let r=this||{},h=e.call?e(r.p):e;return i(h.unshift?h.raw?p(h,[].slice.call(arguments,1),r.p):h.reduce((e,h)=>Object.assign(e,h&&h.call?h(r.p):h),{}):h,t(r.target),r.g,r.o,r.k)}u.bind({g:1});let et,er,en,ei=u.bind({k:1});function w(e,r){let h=this||{};return function(){let d=arguments;function a(f,g){let b=Object.assign({},f),A=b.className||a.className;h.p=Object.assign({theme:er&&er()},b),h.o=/ *go\d+/.test(A),b.className=u.apply(h,d)+(A?" "+A:""),r&&(b.ref=g);let k=e;return e[0]&&(k=b.as||e,delete b.as),en&&k[0]&&en(b),et(k,b)}return r?r(a):a}}var Z=e=>"function"==typeof e,dist_h=(e,r)=>Z(e)?e(r):e,es=(d=0,()=>(++d).toString()),E=()=>{if(void 0===f&&"u">typeof window){let e=matchMedia("(prefers-reduced-motion: reduce)");f=!e||e.matches}return f},eo="default",H=(e,r)=>{let{toastLimit:h}=e.settings;switch(r.type){case 0:return{...e,toasts:[r.toast,...e.toasts].slice(0,h)};case 1:return{...e,toasts:e.toasts.map(e=>e.id===r.toast.id?{...e,...r.toast}:e)};case 2:let{toast:d}=r;return H(e,{type:e.toasts.find(e=>e.id===d.id)?1:0,toast:d});case 3:let{toastId:f}=r;return{...e,toasts:e.toasts.map(e=>e.id===f||void 0===f?{...e,dismissed:!0,visible:!1}:e)};case 4:return void 0===r.toastId?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(e=>e.id!==r.toastId)};case 5:return{...e,pausedAt:r.time};case 6:let g=r.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(e=>({...e,pauseDuration:e.pauseDuration+g}))}}},ea=[],el={toasts:[],pausedAt:void 0,settings:{toastLimit:20}},eu={},Y=(e,r=eo)=>{eu[r]=H(eu[r]||el,e),ea.forEach(([e,h])=>{e===r&&h(eu[r])})},_=e=>Object.keys(eu).forEach(r=>Y(e,r)),Q=e=>Object.keys(eu).find(r=>eu[r].toasts.some(r=>r.id===e)),S=(e=eo)=>r=>{Y(r,e)},eh={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},V=(e={},r=eo)=>{let[h,d]=(0,A.useState)(eu[r]||el),f=(0,A.useRef)(eu[r]);(0,A.useEffect)(()=>(f.current!==eu[r]&&d(eu[r]),ea.push([r,d]),()=>{let e=ea.findIndex(([e])=>e===r);e>-1&&ea.splice(e,1)}),[r]);let g=h.toasts.map(r=>{var h,d,f;return{...e,...e[r.type],...r,removeDelay:r.removeDelay||(null==(h=e[r.type])?void 0:h.removeDelay)||(null==e?void 0:e.removeDelay),duration:r.duration||(null==(d=e[r.type])?void 0:d.duration)||(null==e?void 0:e.duration)||eh[r.type],style:{...e.style,...null==(f=e[r.type])?void 0:f.style,...r.style}}});return{...h,toasts:g}},ie=(e,r="blank",h)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:r,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...h,id:(null==h?void 0:h.id)||es()}),P=e=>(r,h)=>{let d=ie(r,e,h);return S(d.toasterId||Q(d.id))({type:2,toast:d}),d.id},dist_n=(e,r)=>P("blank")(e,r);dist_n.error=P("error"),dist_n.success=P("success"),dist_n.loading=P("loading"),dist_n.custom=P("custom"),dist_n.dismiss=(e,r)=>{let h={type:3,toastId:e};r?S(r)(h):_(h)},dist_n.dismissAll=e=>dist_n.dismiss(void 0,e),dist_n.remove=(e,r)=>{let h={type:4,toastId:e};r?S(r)(h):_(h)},dist_n.removeAll=e=>dist_n.remove(void 0,e),dist_n.promise=(e,r,h)=>{let d=dist_n.loading(r.loading,{...h,...null==h?void 0:h.loading});return"function"==typeof e&&(e=e()),e.then(e=>{let f=r.success?dist_h(r.success,e):void 0;return f?dist_n.success(f,{id:d,...h,...null==h?void 0:h.success}):dist_n.dismiss(d),e}).catch(e=>{let f=r.error?dist_h(r.error,e):void 0;f?dist_n.error(f,{id:d,...h,...null==h?void 0:h.error}):dist_n.dismiss(d)}),e};var ed=1e3,dist_w=(e,r="default")=>{let{toasts:h,pausedAt:d}=V(e,r),f=(0,A.useRef)(new Map).current,g=(0,A.useCallback)((e,r=ed)=>{if(f.has(e))return;let h=setTimeout(()=>{f.delete(e),b({type:4,toastId:e})},r);f.set(e,h)},[]);(0,A.useEffect)(()=>{if(d)return;let e=Date.now(),f=h.map(h=>{if(h.duration===1/0)return;let d=(h.duration||0)+h.pauseDuration-(e-h.createdAt);if(d<0){h.visible&&dist_n.dismiss(h.id);return}return setTimeout(()=>dist_n.dismiss(h.id,r),d)});return()=>{f.forEach(e=>e&&clearTimeout(e))}},[h,d,r]);let b=(0,A.useCallback)(S(r),[r]),k=(0,A.useCallback)(()=>{b({type:5,time:Date.now()})},[b]),M=(0,A.useCallback)((e,r)=>{b({type:1,toast:{id:e,height:r}})},[b]),j=(0,A.useCallback)(()=>{d&&b({type:6,time:Date.now()})},[d,b]),q=(0,A.useCallback)((e,r)=>{let{reverseOrder:d=!1,gutter:f=8,defaultPosition:g}=r||{},b=h.filter(r=>(r.position||g)===(e.position||g)&&r.height),A=b.findIndex(r=>r.id===e.id),k=b.filter((e,r)=>r<A&&e.visible).length;return b.filter(e=>e.visible).slice(...d?[k+1]:[0,k]).reduce((e,r)=>e+(r.height||0)+f,0)},[h]);return(0,A.useEffect)(()=>{h.forEach(e=>{if(e.dismissed)g(e.id,e.removeDelay);else{let r=f.get(e.id);r&&(clearTimeout(r),f.delete(e.id))}})},[h,g]),{toasts:h,handlers:{updateHeight:M,startPause:k,endPause:j,calculateOffset:q}}},em=ei`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,ef=ei`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,ep=ei`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,e_=w("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${em} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${ef} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${ep} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,eg=ei`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,ey=w("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${eg} 1s linear infinite;
`,ev=ei`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,eE=ei`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,eT=w("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${ev} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${eE} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,eI=w("div")`
  position: absolute;
`,eP=w("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,eA=ei`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,eR=w("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${eA} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,$=({toast:e})=>{let{icon:r,type:h,iconTheme:d}=e;return void 0!==r?"string"==typeof r?A.createElement(eR,null,r):r:"blank"===h?null:A.createElement(eP,null,A.createElement(ey,{...d}),"loading"!==h&&A.createElement(eI,null,"error"===h?A.createElement(e_,{...d}):A.createElement(eT,{...d})))},Re=e=>`
0% {transform: translate3d(0,${-200*e}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,Ee=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${-150*e}%,-1px) scale(.6); opacity:0;}
`,ew=w("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,eV=w("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,ke=(e,r)=>{let h=e.includes("top")?1:-1,[d,f]=E()?["0%{opacity:0;} 100%{opacity:1;}","0%{opacity:1;} 100%{opacity:0;}"]:[Re(h),Ee(h)];return{animation:r?`${ei(d)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${ei(f)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},eS=A.memo(({toast:e,position:r,style:h,children:d})=>{let f=e.height?ke(e.position||r||"top-center",e.visible):{opacity:0},g=A.createElement($,{toast:e}),b=A.createElement(eV,{...e.ariaProps},dist_h(e.message,e));return A.createElement(ew,{className:e.className,style:{...f,...h,...e.style}},"function"==typeof d?d({icon:g,message:b}):A.createElement(A.Fragment,null,g,b))});g=A.createElement,o.p=void 0,et=g,er=void 0,en=void 0;var we=({id:e,className:r,style:h,onHeightUpdate:d,children:f})=>{let g=A.useCallback(r=>{if(r){let l=()=>{d(e,r.getBoundingClientRect().height)};l(),new MutationObserver(l).observe(r,{subtree:!0,childList:!0,characterData:!0})}},[e,d]);return A.createElement("div",{ref:g,className:r,style:h},f)},Me=(e,r)=>{let h=e.includes("top"),d=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:E()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${r*(h?1:-1)}px)`,...h?{top:0}:{bottom:0},...d}},eC=u`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Fe=({reverseOrder:e,position:r="top-center",toastOptions:h,gutter:d,children:f,toasterId:g,containerStyle:b,containerClassName:k})=>{let{toasts:M,handlers:j}=dist_w(h,g);return A.createElement("div",{"data-rht-toaster":g||"",style:{position:"fixed",zIndex:9999,top:16,left:16,right:16,bottom:16,pointerEvents:"none",...b},className:k,onMouseEnter:j.startPause,onMouseLeave:j.endPause},M.map(h=>{let g=h.position||r,b=Me(g,j.calculateOffset(h,{reverseOrder:e,gutter:d,defaultPosition:r}));return A.createElement(we,{id:h.id,key:h.id,onHeightUpdate:j.updateHeight,className:h.visible?eC:"",style:b},"custom"===h.type?dist_h(h.message,h):f?f(h):A.createElement(eS,{toast:h,position:g}))}))};let ex=(0,A.createContext)(null);function NotificationProvider(e){let{children:r}=e;return(0,b.jsxs)(ex.Provider,{value:{success:function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return dist_n.success(e,{duration:4e3,style:{background:"var(--color-secondary-600)",color:"#ffffff",borderRadius:"var(--radius-lg)",padding:"var(--spacing-2) var(--spacing-3)",fontSize:"var(--text-base)"},iconTheme:{primary:"#ffffff",secondary:"var(--color-secondary-600)"},...r})},error:function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return dist_n.error(e,{duration:5e3,style:{background:"var(--color-error)",color:"#ffffff",borderRadius:"var(--radius-lg)",padding:"var(--spacing-2) var(--spacing-3)",fontSize:"var(--text-base)"},...r})},info:function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return dist_n(e,{duration:4e3,icon:"ℹ️",style:{background:"var(--color-info)",color:"#ffffff",borderRadius:"var(--radius-lg)",padding:"var(--spacing-2) var(--spacing-3)",fontSize:"var(--text-base)"},...r})},warning:function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return dist_n(e,{duration:4500,icon:"⚠️",style:{background:"var(--color-warning)",color:"#ffffff",borderRadius:"var(--radius-lg)",padding:"var(--spacing-2) var(--spacing-3)",fontSize:"var(--text-base)"},...r})},loading:e=>dist_n.loading(e,{style:{background:"var(--bg-primary)",color:"var(--text-primary)",borderRadius:"var(--radius-lg)",padding:"var(--spacing-2) var(--spacing-3)",fontSize:"var(--text-base)",border:"1px solid var(--border-primary)"}}),promise:(e,r)=>dist_n.promise(e,{loading:r.loading||"Loading...",success:r.success||"Success!",error:r.error||"Error occurred"},{style:{borderRadius:"var(--radius-lg)",padding:"var(--spacing-2) var(--spacing-3)",fontSize:"var(--text-base)"}}),dismiss:e=>{dist_n.dismiss(e)},custom:function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return dist_n.custom(e,r)}},children:[(0,b.jsx)(Fe,{position:"top-right",reverseOrder:!1,gutter:8,toastOptions:{className:"animate-slide-down",style:{maxWidth:"500px"}}}),r]})}function useNotifications(){let e=(0,A.useContext)(ex);if(!e)throw Error("useNotifications must be used within NotificationProvider");return e}},5266:function(e,r,h){"use strict";let d;h.d(r,{I8:function(){return eu},db:function(){return eh}});var f,g,b,A,k=h(6771);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(0,k.KN)("firebase","12.8.0","app");var M=h(2753),j=h(1034),q=h(9711),ee=h(75);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let et="firebasestorage.googleapis.com";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let StorageError=class StorageError extends q.ZR{constructor(e,r,h=0){super(prependCode(e),`Firebase Storage: ${r} (${prependCode(e)})`),this.status_=h,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,StorageError.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return prependCode(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}};function prependCode(e){return"storage/"+e}function invalidArgument(e){return new StorageError(b.INVALID_ARGUMENT,e)}function appDeleted(){return new StorageError(b.APP_DELETED,"The Firebase app was deleted.")}(f=b||(b={})).UNKNOWN="unknown",f.OBJECT_NOT_FOUND="object-not-found",f.BUCKET_NOT_FOUND="bucket-not-found",f.PROJECT_NOT_FOUND="project-not-found",f.QUOTA_EXCEEDED="quota-exceeded",f.UNAUTHENTICATED="unauthenticated",f.UNAUTHORIZED="unauthorized",f.UNAUTHORIZED_APP="unauthorized-app",f.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",f.INVALID_CHECKSUM="invalid-checksum",f.CANCELED="canceled",f.INVALID_EVENT_NAME="invalid-event-name",f.INVALID_URL="invalid-url",f.INVALID_DEFAULT_BUCKET="invalid-default-bucket",f.NO_DEFAULT_BUCKET="no-default-bucket",f.CANNOT_SLICE_BLOB="cannot-slice-blob",f.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",f.NO_DOWNLOAD_URL="no-download-url",f.INVALID_ARGUMENT="invalid-argument",f.INVALID_ARGUMENT_COUNT="invalid-argument-count",f.APP_DELETED="app-deleted",f.INVALID_ROOT_OPERATION="invalid-root-operation",f.INVALID_FORMAT="invalid-format",f.INTERNAL_ERROR="internal-error",f.UNSUPPORTED_ENVIRONMENT="unsupported-environment";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Location=class Location{constructor(e,r){this.bucket=e,this.path_=r}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){let e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){let e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o"}static makeFromBucketSpec(e,r){let h;try{h=Location.makeFromUrl(e,r)}catch(r){return new Location(e,"")}if(""===h.path)return h;throw new StorageError(b.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+e+"'.")}static makeFromUrl(e,r){let h=null,d="([A-Za-z0-9.\\-_]+)",f=RegExp("^gs://"+d+"(/(.*))?$","i");function httpModify(e){e.path_=decodeURIComponent(e.path)}let g=r.replace(/[.]/g,"\\."),A=RegExp(`^https?://${g}/v[A-Za-z0-9_]+/b/${d}/o(/([^?#]*).*)?$`,"i"),k=RegExp(`^https?://${r===et?"(?:storage.googleapis.com|storage.cloud.google.com)":r}/${d}/([^?#]*)`,"i"),M=[{regex:f,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:A,indices:{bucket:1,path:3},postModify:httpModify},{regex:k,indices:{bucket:1,path:2},postModify:httpModify}];for(let r=0;r<M.length;r++){let d=M[r],f=d.regex.exec(e);if(f){let e=f[d.indices.bucket],r=f[d.indices.path];r||(r=""),h=new Location(e,r),d.postModify(h);break}}if(null==h)throw new StorageError(b.INVALID_URL,"Invalid URL '"+e+"'.");return h}};let FailRequest=class FailRequest{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}};function validateNumber(e,r,h,d){if(d<r)throw invalidArgument(`Invalid value for '${e}'. Expected ${r} or greater.`);if(d>h)throw invalidArgument(`Invalid value for '${e}'. Expected ${h} or less.`)}(g=A||(A={}))[g.NO_ERROR=0]="NO_ERROR",g[g.NETWORK_ERROR=1]="NETWORK_ERROR",g[g.ABORT=2]="ABORT";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let NetworkRequest=class NetworkRequest{constructor(e,r,h,d,f,g,b,A,k,M,j,q=!0,ee=!1){this.url_=e,this.method_=r,this.headers_=h,this.body_=d,this.successCodes_=f,this.additionalRetryCodes_=g,this.callback_=b,this.errorCallback_=A,this.timeout_=k,this.progressCallback_=M,this.connectionFactory_=j,this.retry=q,this.isUsingEmulator=ee,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((e,r)=>{this.resolve_=e,this.reject_=r,this.start_()})}start_(){let backoffDone=(e,r)=>{let h=this.resolve_,d=this.reject_,f=r.connection;if(r.wasSuccessCode)try{let e=this.callback_(f,f.getResponse());void 0!==e?h(e):h()}catch(e){d(e)}else if(null!==f){let e=new StorageError(b.UNKNOWN,"An unknown error occurred, please check the error payload for server response.");e.serverResponse=f.getErrorText(),d(this.errorCallback_?this.errorCallback_(f,e):e)}else if(r.canceled){let e=this.appDelete_?appDeleted():new StorageError(b.CANCELED,"User canceled the upload/download.");d(e)}else{let e=new StorageError(b.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.");d(e)}};this.canceled_?backoffDone(!1,new RequestEndStatus(!1,null,!0)):this.backoffId_=/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function(e,r,h){let d=1,f=null,g=null,b=!1,A=0,k=!1;function triggerCallback(...e){k||(k=!0,r.apply(null,e))}function callWithDelay(r){f=setTimeout(()=>{f=null,e(responseHandler,2===A)},r)}function clearGlobalTimeout(){g&&clearTimeout(g)}function responseHandler(e,...r){let h;if(k){clearGlobalTimeout();return}if(e){clearGlobalTimeout(),triggerCallback.call(null,e,...r);return}let f=2===A||b;if(f){clearGlobalTimeout(),triggerCallback.call(null,e,...r);return}d<64&&(d*=2),1===A?(A=2,h=0):h=(d+Math.random())*1e3,callWithDelay(h)}let M=!1;function stop(e){!M&&(M=!0,clearGlobalTimeout(),!k&&(null!==f?(e||(A=2),clearTimeout(f),callWithDelay(0)):e||(A=1)))}return callWithDelay(0),g=setTimeout(()=>{b=!0,stop(!0)},h),stop}((e,r)=>{if(r){e(!1,new RequestEndStatus(!1,null,!0));return}let h=this.connectionFactory_();this.pendingConnection_=h;let progressListener=e=>{let r=e.loaded,h=e.lengthComputable?e.total:-1;null!==this.progressCallback_&&this.progressCallback_(r,h)};null!==this.progressCallback_&&h.addUploadProgressListener(progressListener),h.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&h.removeUploadProgressListener(progressListener),this.pendingConnection_=null;let r=h.getErrorCode()===A.NO_ERROR,d=h.getStatus();if(!r||/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function(e,r){let h=e>=500&&e<600,d=-1!==[408,429].indexOf(e),f=-1!==r.indexOf(e);return h||d||f}(d,this.additionalRetryCodes_)&&this.retry){let r=h.getErrorCode()===A.ABORT;e(!1,new RequestEndStatus(!1,null,r));return}let f=-1!==this.successCodes_.indexOf(d);e(!0,new RequestEndStatus(f,h))})},backoffDone,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&(0,this.backoffId_)(!1),null!==this.pendingConnection_&&this.pendingConnection_.abort()}};let RequestEndStatus=class RequestEndStatus{constructor(e,r,h){this.wasSuccessCode=e,this.connection=r,this.canceled=!!h}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Reference=class Reference{constructor(e,r){this._service=e,r instanceof Location?this._location=r:this._location=Location.makeFromUrl(r,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,r){return new Reference(e,r)}get root(){let e=new Location(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return function(e){let r=e.lastIndexOf("/",e.length-2);return -1===r?e:e.slice(r+1)}(this._location.path)}get storage(){return this._service}get parent(){let e=/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function(e){if(0===e.length)return null;let r=e.lastIndexOf("/");if(-1===r)return"";let h=e.slice(0,r);return h}(this._location.path);if(null===e)return null;let r=new Location(this._location.bucket,e);return new Reference(this._service,r)}_throwIfRoot(e){if(""===this._location.path)throw new StorageError(b.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}};function extractBucket(e,r){let h=r?.storageBucket;return null==h?null:Location.makeFromBucketSpec(h,e)}let FirebaseStorageImpl=class FirebaseStorageImpl{constructor(e,r,h,d,f,g=!1){this.app=e,this._authProvider=r,this._appCheckProvider=h,this._url=d,this._firebaseVersion=f,this._isUsingEmulator=g,this._bucket=null,this._host=et,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,null!=d?this._bucket=Location.makeFromBucketSpec(d,this._host):this._bucket=extractBucket(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,null!=this._url?this._bucket=Location.makeFromBucketSpec(this._url,e):this._bucket=extractBucket(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){validateNumber("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){validateNumber("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;let e=this._authProvider.getImmediate({optional:!0});if(e){let r=await e.getToken();if(null!==r)return r.accessToken}return null}async _getAppCheckToken(){if((0,k.rh)(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let e=this._appCheckProvider.getImmediate({optional:!0});if(e){let r=await e.getToken();return r.token}return null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Reference(this,e)}_makeRequest(e,r,h,d,f=!0){if(this._deleted)return new FailRequest(appDeleted());{let g=function(e,r,h,d,f,g,b=!0,A=!1){let k=function(e){let r=encodeURIComponent,h="?";for(let d in e)if(e.hasOwnProperty(d)){let f=r(d)+"="+r(e[d]);h=h+f+"&"}return h.slice(0,-1)}(e.urlParams),M=e.url+k,j=Object.assign({},e.headers);return r&&(j["X-Firebase-GMPID"]=r),null!==h&&h.length>0&&(j.Authorization="Firebase "+h),j["X-Firebase-Storage-Version"]="webjs/"+(g??"AppManager"),null!==d&&(j["X-Firebase-AppCheck"]=d),new NetworkRequest(M,e.method,j,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,f,b,A)}(e,this._appId,h,d,r,this._firebaseVersion,f,this._isUsingEmulator);return this._requests.add(g),g.getPromise().then(()=>this._requests.delete(g),()=>this._requests.delete(g)),g}}async makeRequestWithTokens(e,r){let[h,d]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,r,h,d).getPromise()}};let er="@firebase/storage",en="0.14.0",ei="storage";(0,k.Xd)(new ee.wA(ei,function(e,{instanceIdentifier:r}){let h=e.getProvider("app").getImmediate(),d=e.getProvider("auth-internal"),f=e.getProvider("app-check-internal");return new FirebaseStorageImpl(h,d,f,r,k.Jn)},"PUBLIC").setMultipleInstances(!0)),(0,k.KN)(er,en,""),(0,k.KN)(er,en,"esm2020");var es=h(3454);let eo={apiKey:es.env.NEXT_PUBLIC_FIREBASE_API_KEY||"preview-key",authDomain:es.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN||"preview.firebaseapp.com",projectId:es.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID||"preview-project",storageBucket:es.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET||"preview.appspot.com",messagingSenderId:es.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID||"123456",appId:es.env.NEXT_PUBLIC_FIREBASE_APP_ID||"1:123456:web:abc123"};if((0,k.C6)().length)d=(0,k.Mq)();else try{d=(0,k.ZF)(eo)}catch(e){console.warn("Firebase init failed",e)}let ea=!es.env.NEXT_PUBLIC_FIREBASE_API_KEY||"mock-api-key-for-ui-preview"===es.env.NEXT_PUBLIC_FIREBASE_API_KEY||"preview-key"===es.env.NEXT_PUBLIC_FIREBASE_API_KEY,el={onAuthStateChanged:e=>(setTimeout(()=>e(null),0),()=>{}),onIdTokenChanged:()=>()=>{},signOut:async()=>{}},eu=ea?el:(()=>{try{return d?(0,M.v0)(d):el}catch(e){return el}})(),eh=ea?null:(()=>{try{return d?(0,j.ad)(d):null}catch(e){return null}})();ea||(()=>{try{return d?function(e=(0,k.Mq)(),r){e=(0,q.m9)(e);let h=(0,k.qX)(e,ei),d=h.getImmediate({identifier:void 0}),f=(0,q.P0)("storage");return f&&function(e,r,h,d={}){!function(e,r,h,d={}){e.host=`${r}:${h}`;let f=(0,q.Xx)(r);f&&((0,q.Uo)(`https://${e.host}/b`),(0,q.dp)("Storage",!0)),e._isUsingEmulator=!0,e._protocol=f?"https":"http";let{mockUserToken:g}=d;g&&(e._overrideAuthToken="string"==typeof g?g:(0,q.Sg)(g,e.app.options.projectId))}(e,r,h,d)}(d,...f),d}(d):null}catch(e){return null}})()},3833:function(e,r,h){"use strict";h.d(r,{Aj:function(){return saveSession},Dc:function(){return setTheme},Gg:function(){return getSession},Hk:function(){return hasSession},IR:function(){return isTeacher},P3:function(){return clearTeacher},S0:function(){return refreshVerifiedFromServer},WN:function(){return setGuest},e6:function(){return activateTeacher},gD:function(){return setRole},k4:function(){return setFontScale},kS:function(){return logout},rE:function(){return setTeacherCode}});let d="elora_session_v1",f="elora_session",g=new BroadcastChannel("elora_session_sync"),b={verified:!1,email:"",teacher:!1,hasSession:!1,guest:!1,role:"student",theme:"system",fontScale:1,country:"Singapore",level:"Primary 1",subject:"math",topicMode:"fixed",topicFixed:"Fractions",topicCustom:"",task:"tutor",style:"clear",messages:[],teacherCode:"",usage:{messagesSent:0,activeMinutes:0,streak:0,lastActive:null,subjects:[]},studentCode:null,linkedStudentId:null,linkedStudents:[],classroom:{name:"My Classroom",totalEngagement:0,classes:[],assignments:[],submissions:[],teacherRules:"",resources:[],quizzes:[]},joinedClasses:[]};function safeParseJSON(e){try{return JSON.parse(e)}catch(e){return null}}function emit(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];window.dispatchEvent(new Event("elora:session")),e&&g&&g.postMessage("sync")}function getSession(){let e=window.localStorage.getItem(d),r=window.localStorage.getItem(f),h=safeParseJSON(e)||safeParseJSON(r)||null;return{...b,...h||{},usage:{...b.usage,...(null==h?void 0:h.usage)||{}},classroom:{...b.classroom,...(null==h?void 0:h.classroom)||{}},linkedStudents:Array.isArray(null==h?void 0:h.linkedStudents)?h.linkedStudents:b.linkedStudents,joinedClasses:Array.isArray(null==h?void 0:h.joinedClasses)?h.joinedClasses:b.joinedClasses}}function saveSession(e){try{window.localStorage.setItem(d,JSON.stringify(e)),window.localStorage.setItem(f,JSON.stringify(e))}catch(e){}applyTheme(e.theme),applyFontScale(e.fontScale),function(e,r){try{e&&window.localStorage.setItem("elora_theme",e),"number"==typeof r&&window.localStorage.setItem("elora_fontScale",String(r))}catch(e){}}(e.theme,e.fontScale),function(e){try{window.localStorage.setItem("elora_guest",e.guest?"true":"false"),window.localStorage.setItem("elora_role",String(e.role||"student")),window.localStorage.setItem("elora_verified",e.verified?"true":"false")}catch(e){}}(e),emit(!0)}function hasSession(){let e=getSession();return!!((null==e?void 0:e.hasSession)||(null==e?void 0:e.verified)||(null==e?void 0:e.teacher))}function setRole(e){let r=getSession();r.role=String(e||"student"),saveSession(r)}function setGuest(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],r=getSession();r.guest=!!e,r.guest&&(!r.role||"educator"===r.role)&&(r.role="student"),saveSession(r)}function setTheme(e){let r=getSession();r.theme=String(e||"system"),saveSession(r)}function setFontScale(e){let r=Math.max(.85,Math.min(1.4,Number(e)||1)),h=getSession();h.fontScale=r,saveSession(h)}function setTeacher(e){let r=getSession();r.teacher=!!e,r.hasSession=!!(r.hasSession||r.teacher||r.verified),saveSession(r)}function setTeacherCode(e){let r=getSession();r.teacherCode=String(e||""),saveSession(r)}function isTeacher(){return!!getSession().teacher}function applyFontScale(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if("undefined"==typeof document)return;let r=Math.max(.85,Math.min(1.4,Number(e)||1));document.documentElement.style.setProperty("--elora-font-scale",String(r))}function applyTheme(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"system";if("undefined"!=typeof document){document.documentElement.dataset.theme=e;{let r=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,h="system"===e?r?"dark":"light":e;document.documentElement.classList.toggle("dark","dark"===h)}}}async function refreshVerifiedFromServer(){try{let e=await fetch("/api/session/status",{cache:"no-store"}),r=await e.json().catch(()=>null),h=!!(null==r?void 0:r.verified),d=String((null==r?void 0:r.email)||""),f=!!(null==r?void 0:r.teacher),g=!!((null==r?void 0:r.hasSession)||h||f),b=getSession();return b.verified=h,b.email=d,b.teacher=f,b.hasSession=g,saveSession(b),{verified:h,email:d,teacher:f,hasSession:g}}catch(e){return{verified:!1,email:"",teacher:!1,hasSession:!1}}}async function activateTeacher(e){let r=String(e||"").split(",").map(e=>e.trim()).filter(Boolean);if(!r.length)return{ok:!1,error:"missing_code"};for(let e of r)try{let r=await fetch("/api/teacher/activate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:e})}),h=await r.json().catch(()=>null);if(r.ok&&(null==h?void 0:h.ok))return setTeacher(!0),setTeacherCode(e),{ok:!0}}catch(e){}return{ok:!1,error:"invalid_invite"}}async function clearTeacher(){try{await fetch("/api/teacher/clear",{method:"POST"})}catch(e){}setTeacher(!1),setTeacherCode("")}async function logout(){try{await fetch("/api/session/clear",{method:"POST"})}catch(e){}try{await fetch("/api/teacher/clear",{method:"POST"})}catch(e){}try{window.localStorage.removeItem(d),window.localStorage.removeItem(f)}catch(e){}!function(){let e=getSession();applyTheme(e.theme),applyFontScale(e.fontScale)}(),emit(!0)}g&&(g.onmessage=e=>{"sync"===e.data&&emit(!1)})},7498:function(e,r){"use strict";var h,d;Object.defineProperty(r,"__esModule",{value:!0}),function(e,r){for(var h in r)Object.defineProperty(e,h,{enumerable:!0,get:r[h]})}(r,{PrefetchKind:function(){return h},ACTION_REFRESH:function(){return f},ACTION_NAVIGATE:function(){return g},ACTION_RESTORE:function(){return b},ACTION_SERVER_PATCH:function(){return A},ACTION_PREFETCH:function(){return k},ACTION_FAST_REFRESH:function(){return M},ACTION_SERVER_ACTION:function(){return j}});let f="refresh",g="navigate",b="restore",A="server-patch",k="prefetch",M="fast-refresh",j="server-action";(d=h||(h={})).AUTO="auto",d.FULL="full",d.TEMPORARY="temporary",("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),e.exports=r.default)},30:function(e,r,h){"use strict";function getDomainLocale(e,r,h,d){return!1}Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"getDomainLocale",{enumerable:!0,get:function(){return getDomainLocale}}),h(2866),("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),e.exports=r.default)},5170:function(e,r,h){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"default",{enumerable:!0,get:function(){return eo}});let d=h(8754),f=d._(h(7294)),g=h(4450),b=h(2227),A=h(4364),k=h(109),M=h(3607),j=h(1823),q=h(9031),ee=h(920),et=h(30),er=h(7192),en=h(7498),ei=new Set;function prefetch(e,r,h,d,f,g){if(!g&&!(0,b.isLocalURL)(r))return;if(!d.bypassPrefetchedCheck){let f=void 0!==d.locale?d.locale:"locale"in e?e.locale:void 0,g=r+"%"+h+"%"+f;if(ei.has(g))return;ei.add(g)}let A=g?e.prefetch(r,f):e.prefetch(r,h,d);Promise.resolve(A).catch(e=>{})}function formatStringOrUrl(e){return"string"==typeof e?e:(0,A.formatUrl)(e)}let es=f.default.forwardRef(function(e,r){let h,d;let{href:A,as:ei,children:es,prefetch:eo=null,passHref:ea,replace:el,shallow:eu,scroll:eh,locale:ed,onClick:em,onMouseEnter:ef,onTouchStart:ep,legacyBehavior:e_=!1,...eg}=e;h=es,e_&&("string"==typeof h||"number"==typeof h)&&(h=f.default.createElement("a",null,h));let ey=f.default.useContext(j.RouterContext),ev=f.default.useContext(q.AppRouterContext),eE=null!=ey?ey:ev,eT=!ey,eI=!1!==eo,eP=null===eo?en.PrefetchKind.AUTO:en.PrefetchKind.FULL,{href:eA,as:eR}=f.default.useMemo(()=>{if(!ey){let e=formatStringOrUrl(A);return{href:e,as:ei?formatStringOrUrl(ei):e}}let[e,r]=(0,g.resolveHref)(ey,A,!0);return{href:e,as:ei?(0,g.resolveHref)(ey,ei):r||e}},[ey,A,ei]),ew=f.default.useRef(eA),eV=f.default.useRef(eR);e_&&(d=f.default.Children.only(h));let eS=e_?d&&"object"==typeof d&&d.ref:r,[eC,ex,ek]=(0,ee.useIntersection)({rootMargin:"200px"}),eD=f.default.useCallback(e=>{(eV.current!==eR||ew.current!==eA)&&(ek(),eV.current=eR,ew.current=eA),eC(e),eS&&("function"==typeof eS?eS(e):"object"==typeof eS&&(eS.current=e))},[eR,eS,eA,ek,eC]);f.default.useEffect(()=>{eE&&ex&&eI&&prefetch(eE,eA,eR,{locale:ed},{kind:eP},eT)},[eR,eA,ex,ed,eI,null==ey?void 0:ey.locale,eE,eT,eP]);let eN={ref:eD,onClick(e){e_||"function"!=typeof em||em(e),e_&&d.props&&"function"==typeof d.props.onClick&&d.props.onClick(e),eE&&!e.defaultPrevented&&function(e,r,h,d,g,A,k,M,j,q){let{nodeName:ee}=e.currentTarget,et="A"===ee.toUpperCase();if(et&&(function(e){let r=e.currentTarget,h=r.getAttribute("target");return h&&"_self"!==h||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey||e.nativeEvent&&2===e.nativeEvent.which}(e)||!j&&!(0,b.isLocalURL)(h)))return;e.preventDefault();let navigate=()=>{let e=null==k||k;"beforePopState"in r?r[g?"replace":"push"](h,d,{shallow:A,locale:M,scroll:e}):r[g?"replace":"push"](d||h,{forceOptimisticNavigation:!q,scroll:e})};j?f.default.startTransition(navigate):navigate()}(e,eE,eA,eR,el,eu,eh,ed,eT,eI)},onMouseEnter(e){e_||"function"!=typeof ef||ef(e),e_&&d.props&&"function"==typeof d.props.onMouseEnter&&d.props.onMouseEnter(e),eE&&(eI||!eT)&&prefetch(eE,eA,eR,{locale:ed,priority:!0,bypassPrefetchedCheck:!0},{kind:eP},eT)},onTouchStart(e){e_||"function"!=typeof ep||ep(e),e_&&d.props&&"function"==typeof d.props.onTouchStart&&d.props.onTouchStart(e),eE&&(eI||!eT)&&prefetch(eE,eA,eR,{locale:ed,priority:!0,bypassPrefetchedCheck:!0},{kind:eP},eT)}};if((0,k.isAbsoluteUrl)(eR))eN.href=eR;else if(!e_||ea||"a"===d.type&&!("href"in d.props)){let e=void 0!==ed?ed:null==ey?void 0:ey.locale,r=(null==ey?void 0:ey.isLocaleDomain)&&(0,et.getDomainLocale)(eR,e,null==ey?void 0:ey.locales,null==ey?void 0:ey.domainLocales);eN.href=r||(0,er.addBasePath)((0,M.addLocale)(eR,e,null==ey?void 0:ey.defaultLocale))}return e_?f.default.cloneElement(d,eN):f.default.createElement("a",{...eg,...eN},h)}),eo=es;("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),e.exports=r.default)},920:function(e,r,h){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"useIntersection",{enumerable:!0,get:function(){return useIntersection}});let d=h(7294),f=h(3436),g="function"==typeof IntersectionObserver,b=new Map,A=[];function useIntersection(e){let{rootRef:r,rootMargin:h,disabled:k}=e,M=k||!g,[j,q]=(0,d.useState)(!1),ee=(0,d.useRef)(null),et=(0,d.useCallback)(e=>{ee.current=e},[]);(0,d.useEffect)(()=>{if(g){if(M||j)return;let e=ee.current;if(e&&e.tagName){let d=function(e,r,h){let{id:d,observer:f,elements:g}=function(e){let r;let h={root:e.root||null,margin:e.rootMargin||""},d=A.find(e=>e.root===h.root&&e.margin===h.margin);if(d&&(r=b.get(d)))return r;let f=new Map,g=new IntersectionObserver(e=>{e.forEach(e=>{let r=f.get(e.target),h=e.isIntersecting||e.intersectionRatio>0;r&&h&&r(h)})},e);return r={id:h,observer:g,elements:f},A.push(h),b.set(h,r),r}(h);return g.set(e,r),f.observe(e),function(){if(g.delete(e),f.unobserve(e),0===g.size){f.disconnect(),b.delete(d);let e=A.findIndex(e=>e.root===d.root&&e.margin===d.margin);e>-1&&A.splice(e,1)}}}(e,e=>e&&q(e),{root:null==r?void 0:r.current,rootMargin:h});return d}}else if(!j){let e=(0,f.requestIdleCallback)(()=>q(!0));return()=>(0,f.cancelIdleCallback)(e)}},[M,h,r,j,ee.current]);let er=(0,d.useCallback)(()=>{q(!1)},[]);return[et,j,er]}("function"==typeof r.default||"object"==typeof r.default&&null!==r.default)&&void 0===r.default.__esModule&&(Object.defineProperty(r.default,"__esModule",{value:!0}),Object.assign(r.default,r),e.exports=r.default)},4702:function(e,r,h){"use strict";h.r(r),h.d(r,{default:function(){return _app}});var d=h(5893);h(415);var f=h(9008),g=h.n(f),b=h(1163),A=h(7290),k=h(7483),M=h(7294);let j=(0,M.createContext)(null),q={didCatch:!1,error:null};let m=class m extends M.Component{constructor(e){super(e),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=q}static getDerivedStateFromError(e){return{didCatch:!0,error:e}}resetErrorBoundary(...e){let{error:r}=this.state;null!==r&&(this.props.onReset?.({args:e,reason:"imperative-api"}),this.setState(q))}componentDidCatch(e,r){this.props.onError?.(e,r)}componentDidUpdate(e,r){let{didCatch:h}=this.state,{resetKeys:d}=this.props;h&&null!==r.error&&function(e=[],r=[]){return e.length!==r.length||e.some((e,h)=>!Object.is(e,r[h]))}(e.resetKeys,d)&&(this.props.onReset?.({next:d,prev:e.resetKeys,reason:"keys"}),this.setState(q))}render(){let{children:e,fallbackRender:r,FallbackComponent:h,fallback:d}=this.props,{didCatch:f,error:g}=this.state,b=e;if(f){let e={error:g,resetErrorBoundary:this.resetErrorBoundary};if("function"==typeof r)b=r(e);else if(h)b=(0,M.createElement)(h,e);else if(void 0!==d)b=d;else throw g}return(0,M.createElement)(j.Provider,{value:{didCatch:f,error:g,resetErrorBoundary:this.resetErrorBoundary}},b)}};function ErrorFallback(e){let{error:r,resetErrorBoundary:h}=e,f=function(e){let r={NetworkError:{title:"Connection Issue",message:"Unable to connect to the server. Please check your internet connection.",recovery:["Check your internet connection","Try refreshing the page","Try again in a moment"]},"fetch failed":{title:"Connection Issue",message:"Unable to reach the server. Please check your internet connection.",recovery:["Check your internet connection","Try refreshing the page"]},"auth/user-not-found":{title:"Account Not Found",message:"We couldn't find an account with that email.",recovery:["Check your email address","Create a new account"]},"auth/wrong-password":{title:"Incorrect Password",message:"The password you entered is incorrect.",recovery:["Try again","Reset your password"]},"auth/email-already-in-use":{title:"Email Already Registered",message:"An account with this email already exists.",recovery:["Sign in instead","Use a different email","Reset password if you forgot it"]},"permission-denied":{title:"Permission Denied",message:"You don't have permission to perform this action.",recovery:["Make sure you're signed in","Contact your teacher or administrator"]},"not-found":{title:"Not Found",message:"The requested item could not be found.",recovery:["Check if the item still exists","Try refreshing the page"]},"invalid-email":{title:"Invalid Email",message:"Please enter a valid email address.",recovery:["Check your email format"]},"required-field":{title:"Required Field",message:"Please fill in all required fields.",recovery:["Fill in the missing information"]},default:{title:"Something Went Wrong",message:"An unexpected error occurred. Please try again.",recovery:["Try again","Refresh the page","Contact support if the problem persists"]}},h="string"==typeof e?e:(null==e?void 0:e.message)||(null==e?void 0:e.code)||"default";for(let[e,d]of Object.entries(r))if(h.includes(e)||e===h)return d;return r.default}(r);return(0,d.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-gradient-to-br from-red-50 to-orange-50 dark:from-neutral-900 dark:to-neutral-800 p-6",children:(0,d.jsxs)("div",{className:"max-w-lg w-full bg-white dark:bg-neutral-800 rounded-2xl shadow-xl p-8 space-y-6",children:[(0,d.jsx)("div",{className:"w-20 h-20 rounded-full bg-red-100 dark:bg-red-900/30 flex items-center justify-center mx-auto",children:(0,d.jsx)("svg",{className:"w-10 h-10 text-red-600 dark:text-red-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),(0,d.jsxs)("div",{className:"text-center",children:[(0,d.jsx)("h1",{className:"text-2xl font-bold text-text-primary mb-2",children:f.title}),(0,d.jsx)("p",{className:"text-text-secondary mb-6",children:f.message}),f.recovery&&(0,d.jsxs)("div",{className:"bg-neutral-50 dark:bg-neutral-700/50 rounded-lg p-4 mb-6 text-left",children:[(0,d.jsx)("h4",{className:"font-semibold text-sm text-text-secondary mb-2",children:"What you can do:"}),(0,d.jsx)("ul",{className:"space-y-1 text-sm text-text-secondary",children:f.recovery.map((e,r)=>(0,d.jsxs)("li",{className:"flex items-start gap-2",children:[(0,d.jsx)("span",{className:"text-primary-600 dark:text-primary-400 mt-0.5",children:"•"}),(0,d.jsx)("span",{children:e})]},r))})]})]}),(0,d.jsxs)("div",{className:"flex gap-3",children:[(0,d.jsx)("button",{onClick:h,className:"btn btn-primary flex-1",children:"Try Again"}),(0,d.jsx)("button",{onClick:()=>window.location.href="/",className:"btn btn-outline flex-1",children:"Go Home"})]}),!1]})})}var ee=h(6600),_app=function(e){let{Component:r,pageProps:h}=e,f=(0,b.useRouter)(),M="/"===f.pathname,j=!M&&"/demo"!==f.pathname;return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(g(),{children:(0,d.jsx)("script",{dangerouslySetInnerHTML:{__html:"\n              (function() {\n                const theme = localStorage.getItem('elora-theme') || \n                  (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');\n                document.documentElement.classList.toggle('dark', theme === 'dark');\n              })();\n            "}})}),(0,d.jsx)(m,{FallbackComponent:ErrorFallback,onReset:()=>window.location.reload(),children:(0,d.jsx)(k.J,{children:(0,d.jsxs)(A.w,{children:[j&&(0,d.jsx)(ee.Z,{}),(0,d.jsx)("div",{className:j?"pt-16":"",children:(0,d.jsx)(r,{...h})})]})})})]})}},1876:function(e){!function(){var r={675:function(e,r){"use strict";r.byteLength=function(e){var r=getLens(e),h=r[0],d=r[1];return(h+d)*3/4-d},r.toByteArray=function(e){var r,h,g=getLens(e),b=g[0],A=g[1],k=new f((b+A)*3/4-A),M=0,j=A>0?b-4:b;for(h=0;h<j;h+=4)r=d[e.charCodeAt(h)]<<18|d[e.charCodeAt(h+1)]<<12|d[e.charCodeAt(h+2)]<<6|d[e.charCodeAt(h+3)],k[M++]=r>>16&255,k[M++]=r>>8&255,k[M++]=255&r;return 2===A&&(r=d[e.charCodeAt(h)]<<2|d[e.charCodeAt(h+1)]>>4,k[M++]=255&r),1===A&&(r=d[e.charCodeAt(h)]<<10|d[e.charCodeAt(h+1)]<<4|d[e.charCodeAt(h+2)]>>2,k[M++]=r>>8&255,k[M++]=255&r),k},r.fromByteArray=function(e){for(var r,d=e.length,f=d%3,g=[],b=0,A=d-f;b<A;b+=16383)g.push(function(e,r,d){for(var f,g=[],b=r;b<d;b+=3)g.push(h[(f=(e[b]<<16&16711680)+(e[b+1]<<8&65280)+(255&e[b+2]))>>18&63]+h[f>>12&63]+h[f>>6&63]+h[63&f]);return g.join("")}(e,b,b+16383>A?A:b+16383));return 1===f?g.push(h[(r=e[d-1])>>2]+h[r<<4&63]+"=="):2===f&&g.push(h[(r=(e[d-2]<<8)+e[d-1])>>10]+h[r>>4&63]+h[r<<2&63]+"="),g.join("")};for(var h=[],d=[],f="undefined"!=typeof Uint8Array?Uint8Array:Array,g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",b=0,A=g.length;b<A;++b)h[b]=g[b],d[g.charCodeAt(b)]=b;function getLens(e){var r=e.length;if(r%4>0)throw Error("Invalid string. Length must be a multiple of 4");var h=e.indexOf("=");-1===h&&(h=r);var d=h===r?0:4-h%4;return[h,d]}d["-".charCodeAt(0)]=62,d["_".charCodeAt(0)]=63},72:function(e,r,h){"use strict";/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var d=h(675),f=h(783),g="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;function createBuffer(e){if(e>2147483647)throw RangeError('The value "'+e+'" is invalid for option "size"');var r=new Uint8Array(e);return Object.setPrototypeOf(r,Buffer.prototype),r}function Buffer(e,r,h){if("number"==typeof e){if("string"==typeof r)throw TypeError('The "string" argument must be of type string. Received type number');return allocUnsafe(e)}return from(e,r,h)}function from(e,r,h){if("string"==typeof e)return function(e,r){if(("string"!=typeof r||""===r)&&(r="utf8"),!Buffer.isEncoding(r))throw TypeError("Unknown encoding: "+r);var h=0|byteLength(e,r),d=createBuffer(h),f=d.write(e,r);return f!==h&&(d=d.slice(0,f)),d}(e,r);if(ArrayBuffer.isView(e))return fromArrayLike(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(isInstance(e,ArrayBuffer)||e&&isInstance(e.buffer,ArrayBuffer)||"undefined"!=typeof SharedArrayBuffer&&(isInstance(e,SharedArrayBuffer)||e&&isInstance(e.buffer,SharedArrayBuffer)))return function(e,r,h){var d;if(r<0||e.byteLength<r)throw RangeError('"offset" is outside of buffer bounds');if(e.byteLength<r+(h||0))throw RangeError('"length" is outside of buffer bounds');return Object.setPrototypeOf(d=void 0===r&&void 0===h?new Uint8Array(e):void 0===h?new Uint8Array(e,r):new Uint8Array(e,r,h),Buffer.prototype),d}(e,r,h);if("number"==typeof e)throw TypeError('The "value" argument must not be of type number. Received type number');var d=e.valueOf&&e.valueOf();if(null!=d&&d!==e)return Buffer.from(d,r,h);var f=function(e){if(Buffer.isBuffer(e)){var r,h=0|checked(e.length),d=createBuffer(h);return 0===d.length||e.copy(d,0,0,h),d}return void 0!==e.length?"number"!=typeof e.length||(r=e.length)!=r?createBuffer(0):fromArrayLike(e):"Buffer"===e.type&&Array.isArray(e.data)?fromArrayLike(e.data):void 0}(e);if(f)return f;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return Buffer.from(e[Symbol.toPrimitive]("string"),r,h);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function assertSize(e){if("number"!=typeof e)throw TypeError('"size" argument must be of type number');if(e<0)throw RangeError('The value "'+e+'" is invalid for option "size"')}function allocUnsafe(e){return assertSize(e),createBuffer(e<0?0:0|checked(e))}function fromArrayLike(e){for(var r=e.length<0?0:0|checked(e.length),h=createBuffer(r),d=0;d<r;d+=1)h[d]=255&e[d];return h}function checked(e){if(e>=2147483647)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|e}function byteLength(e,r){if(Buffer.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||isInstance(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var h=e.length,d=arguments.length>2&&!0===arguments[2];if(!d&&0===h)return 0;for(var f=!1;;)switch(r){case"ascii":case"latin1":case"binary":return h;case"utf8":case"utf-8":return utf8ToBytes(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*h;case"hex":return h>>>1;case"base64":return base64ToBytes(e).length;default:if(f)return d?-1:utf8ToBytes(e).length;r=(""+r).toLowerCase(),f=!0}}function slowToString(e,r,h){var f,g,b=!1;if((void 0===r||r<0)&&(r=0),r>this.length||((void 0===h||h>this.length)&&(h=this.length),h<=0||(h>>>=0)<=(r>>>=0)))return"";for(e||(e="utf8");;)switch(e){case"hex":return function(e,r,h){var d=e.length;(!r||r<0)&&(r=0),(!h||h<0||h>d)&&(h=d);for(var f="",g=r;g<h;++g)f+=A[e[g]];return f}(this,r,h);case"utf8":case"utf-8":return utf8Slice(this,r,h);case"ascii":return function(e,r,h){var d="";h=Math.min(e.length,h);for(var f=r;f<h;++f)d+=String.fromCharCode(127&e[f]);return d}(this,r,h);case"latin1":case"binary":return function(e,r,h){var d="";h=Math.min(e.length,h);for(var f=r;f<h;++f)d+=String.fromCharCode(e[f]);return d}(this,r,h);case"base64":return f=r,g=h,0===f&&g===this.length?d.fromByteArray(this):d.fromByteArray(this.slice(f,g));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(e,r,h){for(var d=e.slice(r,h),f="",g=0;g<d.length;g+=2)f+=String.fromCharCode(d[g]+256*d[g+1]);return f}(this,r,h);default:if(b)throw TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),b=!0}}function swap(e,r,h){var d=e[r];e[r]=e[h],e[h]=d}function bidirectionalIndexOf(e,r,h,d,f){var g;if(0===e.length)return -1;if("string"==typeof h?(d=h,h=0):h>2147483647?h=2147483647:h<-2147483648&&(h=-2147483648),(g=h=+h)!=g&&(h=f?0:e.length-1),h<0&&(h=e.length+h),h>=e.length){if(f)return -1;h=e.length-1}else if(h<0){if(!f)return -1;h=0}if("string"==typeof r&&(r=Buffer.from(r,d)),Buffer.isBuffer(r))return 0===r.length?-1:arrayIndexOf(e,r,h,d,f);if("number"==typeof r)return(r&=255,"function"==typeof Uint8Array.prototype.indexOf)?f?Uint8Array.prototype.indexOf.call(e,r,h):Uint8Array.prototype.lastIndexOf.call(e,r,h):arrayIndexOf(e,[r],h,d,f);throw TypeError("val must be string, number or Buffer")}function arrayIndexOf(e,r,h,d,f){var g,b=1,A=e.length,k=r.length;if(void 0!==d&&("ucs2"===(d=String(d).toLowerCase())||"ucs-2"===d||"utf16le"===d||"utf-16le"===d)){if(e.length<2||r.length<2)return -1;b=2,A/=2,k/=2,h/=2}function read(e,r){return 1===b?e[r]:e.readUInt16BE(r*b)}if(f){var M=-1;for(g=h;g<A;g++)if(read(e,g)===read(r,-1===M?0:g-M)){if(-1===M&&(M=g),g-M+1===k)return M*b}else -1!==M&&(g-=g-M),M=-1}else for(h+k>A&&(h=A-k),g=h;g>=0;g--){for(var j=!0,q=0;q<k;q++)if(read(e,g+q)!==read(r,q)){j=!1;break}if(j)return g}return -1}function utf8Slice(e,r,h){h=Math.min(e.length,h);for(var d=[],f=r;f<h;){var g,b,A,k,M=e[f],j=null,q=M>239?4:M>223?3:M>191?2:1;if(f+q<=h)switch(q){case 1:M<128&&(j=M);break;case 2:(192&(g=e[f+1]))==128&&(k=(31&M)<<6|63&g)>127&&(j=k);break;case 3:g=e[f+1],b=e[f+2],(192&g)==128&&(192&b)==128&&(k=(15&M)<<12|(63&g)<<6|63&b)>2047&&(k<55296||k>57343)&&(j=k);break;case 4:g=e[f+1],b=e[f+2],A=e[f+3],(192&g)==128&&(192&b)==128&&(192&A)==128&&(k=(15&M)<<18|(63&g)<<12|(63&b)<<6|63&A)>65535&&k<1114112&&(j=k)}null===j?(j=65533,q=1):j>65535&&(j-=65536,d.push(j>>>10&1023|55296),j=56320|1023&j),d.push(j),f+=q}return function(e){var r=e.length;if(r<=4096)return String.fromCharCode.apply(String,e);for(var h="",d=0;d<r;)h+=String.fromCharCode.apply(String,e.slice(d,d+=4096));return h}(d)}function checkOffset(e,r,h){if(e%1!=0||e<0)throw RangeError("offset is not uint");if(e+r>h)throw RangeError("Trying to access beyond buffer length")}function checkInt(e,r,h,d,f,g){if(!Buffer.isBuffer(e))throw TypeError('"buffer" argument must be a Buffer instance');if(r>f||r<g)throw RangeError('"value" argument is out of bounds');if(h+d>e.length)throw RangeError("Index out of range")}function checkIEEE754(e,r,h,d,f,g){if(h+d>e.length||h<0)throw RangeError("Index out of range")}function writeFloat(e,r,h,d,g){return r=+r,h>>>=0,g||checkIEEE754(e,r,h,4,34028234663852886e22,-34028234663852886e22),f.write(e,r,h,d,23,4),h+4}function writeDouble(e,r,h,d,g){return r=+r,h>>>=0,g||checkIEEE754(e,r,h,8,17976931348623157e292,-17976931348623157e292),f.write(e,r,h,d,52,8),h+8}r.Buffer=Buffer,r.SlowBuffer=function(e){return+e!=e&&(e=0),Buffer.alloc(+e)},r.INSPECT_MAX_BYTES=50,r.kMaxLength=2147483647,Buffer.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),r={foo:function(){return 42}};return Object.setPrototypeOf(r,Uint8Array.prototype),Object.setPrototypeOf(e,r),42===e.foo()}catch(e){return!1}}(),Buffer.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(Buffer.prototype,"parent",{enumerable:!0,get:function(){if(Buffer.isBuffer(this))return this.buffer}}),Object.defineProperty(Buffer.prototype,"offset",{enumerable:!0,get:function(){if(Buffer.isBuffer(this))return this.byteOffset}}),Buffer.poolSize=8192,Buffer.from=function(e,r,h){return from(e,r,h)},Object.setPrototypeOf(Buffer.prototype,Uint8Array.prototype),Object.setPrototypeOf(Buffer,Uint8Array),Buffer.alloc=function(e,r,h){return(assertSize(e),e<=0)?createBuffer(e):void 0!==r?"string"==typeof h?createBuffer(e).fill(r,h):createBuffer(e).fill(r):createBuffer(e)},Buffer.allocUnsafe=function(e){return allocUnsafe(e)},Buffer.allocUnsafeSlow=function(e){return allocUnsafe(e)},Buffer.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==Buffer.prototype},Buffer.compare=function(e,r){if(isInstance(e,Uint8Array)&&(e=Buffer.from(e,e.offset,e.byteLength)),isInstance(r,Uint8Array)&&(r=Buffer.from(r,r.offset,r.byteLength)),!Buffer.isBuffer(e)||!Buffer.isBuffer(r))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===r)return 0;for(var h=e.length,d=r.length,f=0,g=Math.min(h,d);f<g;++f)if(e[f]!==r[f]){h=e[f],d=r[f];break}return h<d?-1:d<h?1:0},Buffer.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function(e,r){if(!Array.isArray(e))throw TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return Buffer.alloc(0);if(void 0===r)for(h=0,r=0;h<e.length;++h)r+=e[h].length;var h,d=Buffer.allocUnsafe(r),f=0;for(h=0;h<e.length;++h){var g=e[h];if(isInstance(g,Uint8Array)&&(g=Buffer.from(g)),!Buffer.isBuffer(g))throw TypeError('"list" argument must be an Array of Buffers');g.copy(d,f),f+=g.length}return d},Buffer.byteLength=byteLength,Buffer.prototype._isBuffer=!0,Buffer.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(var r=0;r<e;r+=2)swap(this,r,r+1);return this},Buffer.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(var r=0;r<e;r+=4)swap(this,r,r+3),swap(this,r+1,r+2);return this},Buffer.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(var r=0;r<e;r+=8)swap(this,r,r+7),swap(this,r+1,r+6),swap(this,r+2,r+5),swap(this,r+3,r+4);return this},Buffer.prototype.toString=function(){var e=this.length;return 0===e?"":0==arguments.length?utf8Slice(this,0,e):slowToString.apply(this,arguments)},Buffer.prototype.toLocaleString=Buffer.prototype.toString,Buffer.prototype.equals=function(e){if(!Buffer.isBuffer(e))throw TypeError("Argument must be a Buffer");return this===e||0===Buffer.compare(this,e)},Buffer.prototype.inspect=function(){var e="",h=r.INSPECT_MAX_BYTES;return e=this.toString("hex",0,h).replace(/(.{2})/g,"$1 ").trim(),this.length>h&&(e+=" ... "),"<Buffer "+e+">"},g&&(Buffer.prototype[g]=Buffer.prototype.inspect),Buffer.prototype.compare=function(e,r,h,d,f){if(isInstance(e,Uint8Array)&&(e=Buffer.from(e,e.offset,e.byteLength)),!Buffer.isBuffer(e))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===r&&(r=0),void 0===h&&(h=e?e.length:0),void 0===d&&(d=0),void 0===f&&(f=this.length),r<0||h>e.length||d<0||f>this.length)throw RangeError("out of range index");if(d>=f&&r>=h)return 0;if(d>=f)return -1;if(r>=h)return 1;if(r>>>=0,h>>>=0,d>>>=0,f>>>=0,this===e)return 0;for(var g=f-d,b=h-r,A=Math.min(g,b),k=this.slice(d,f),M=e.slice(r,h),j=0;j<A;++j)if(k[j]!==M[j]){g=k[j],b=M[j];break}return g<b?-1:b<g?1:0},Buffer.prototype.includes=function(e,r,h){return -1!==this.indexOf(e,r,h)},Buffer.prototype.indexOf=function(e,r,h){return bidirectionalIndexOf(this,e,r,h,!0)},Buffer.prototype.lastIndexOf=function(e,r,h){return bidirectionalIndexOf(this,e,r,h,!1)},Buffer.prototype.write=function(e,r,h,d){if(void 0===r)d="utf8",h=this.length,r=0;else if(void 0===h&&"string"==typeof r)d=r,h=this.length,r=0;else if(isFinite(r))r>>>=0,isFinite(h)?(h>>>=0,void 0===d&&(d="utf8")):(d=h,h=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var f,g,b,A,k,M,j,q,ee,et,er,en,ei=this.length-r;if((void 0===h||h>ei)&&(h=ei),e.length>0&&(h<0||r<0)||r>this.length)throw RangeError("Attempt to write outside buffer bounds");d||(d="utf8");for(var es=!1;;)switch(d){case"hex":return function(e,r,h,d){h=Number(h)||0;var f=e.length-h;d?(d=Number(d))>f&&(d=f):d=f;var g=r.length;d>g/2&&(d=g/2);for(var b=0;b<d;++b){var A=parseInt(r.substr(2*b,2),16);if(A!=A)break;e[h+b]=A}return b}(this,e,r,h);case"utf8":case"utf-8":return k=r,M=h,blitBuffer(utf8ToBytes(e,this.length-k),this,k,M);case"ascii":return j=r,q=h,blitBuffer(asciiToBytes(e),this,j,q);case"latin1":case"binary":return f=this,g=e,b=r,A=h,blitBuffer(asciiToBytes(g),f,b,A);case"base64":return ee=r,et=h,blitBuffer(base64ToBytes(e),this,ee,et);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return er=r,en=h,blitBuffer(function(e,r){for(var h,d,f=[],g=0;g<e.length&&!((r-=2)<0);++g)d=(h=e.charCodeAt(g))>>8,f.push(h%256),f.push(d);return f}(e,this.length-er),this,er,en);default:if(es)throw TypeError("Unknown encoding: "+d);d=(""+d).toLowerCase(),es=!0}},Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},Buffer.prototype.slice=function(e,r){var h=this.length;e=~~e,r=void 0===r?h:~~r,e<0?(e+=h)<0&&(e=0):e>h&&(e=h),r<0?(r+=h)<0&&(r=0):r>h&&(r=h),r<e&&(r=e);var d=this.subarray(e,r);return Object.setPrototypeOf(d,Buffer.prototype),d},Buffer.prototype.readUIntLE=function(e,r,h){e>>>=0,r>>>=0,h||checkOffset(e,r,this.length);for(var d=this[e],f=1,g=0;++g<r&&(f*=256);)d+=this[e+g]*f;return d},Buffer.prototype.readUIntBE=function(e,r,h){e>>>=0,r>>>=0,h||checkOffset(e,r,this.length);for(var d=this[e+--r],f=1;r>0&&(f*=256);)d+=this[e+--r]*f;return d},Buffer.prototype.readUInt8=function(e,r){return e>>>=0,r||checkOffset(e,1,this.length),this[e]},Buffer.prototype.readUInt16LE=function(e,r){return e>>>=0,r||checkOffset(e,2,this.length),this[e]|this[e+1]<<8},Buffer.prototype.readUInt16BE=function(e,r){return e>>>=0,r||checkOffset(e,2,this.length),this[e]<<8|this[e+1]},Buffer.prototype.readUInt32LE=function(e,r){return e>>>=0,r||checkOffset(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},Buffer.prototype.readUInt32BE=function(e,r){return e>>>=0,r||checkOffset(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},Buffer.prototype.readIntLE=function(e,r,h){e>>>=0,r>>>=0,h||checkOffset(e,r,this.length);for(var d=this[e],f=1,g=0;++g<r&&(f*=256);)d+=this[e+g]*f;return d>=(f*=128)&&(d-=Math.pow(2,8*r)),d},Buffer.prototype.readIntBE=function(e,r,h){e>>>=0,r>>>=0,h||checkOffset(e,r,this.length);for(var d=r,f=1,g=this[e+--d];d>0&&(f*=256);)g+=this[e+--d]*f;return g>=(f*=128)&&(g-=Math.pow(2,8*r)),g},Buffer.prototype.readInt8=function(e,r){return(e>>>=0,r||checkOffset(e,1,this.length),128&this[e])?-((255-this[e]+1)*1):this[e]},Buffer.prototype.readInt16LE=function(e,r){e>>>=0,r||checkOffset(e,2,this.length);var h=this[e]|this[e+1]<<8;return 32768&h?4294901760|h:h},Buffer.prototype.readInt16BE=function(e,r){e>>>=0,r||checkOffset(e,2,this.length);var h=this[e+1]|this[e]<<8;return 32768&h?4294901760|h:h},Buffer.prototype.readInt32LE=function(e,r){return e>>>=0,r||checkOffset(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},Buffer.prototype.readInt32BE=function(e,r){return e>>>=0,r||checkOffset(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},Buffer.prototype.readFloatLE=function(e,r){return e>>>=0,r||checkOffset(e,4,this.length),f.read(this,e,!0,23,4)},Buffer.prototype.readFloatBE=function(e,r){return e>>>=0,r||checkOffset(e,4,this.length),f.read(this,e,!1,23,4)},Buffer.prototype.readDoubleLE=function(e,r){return e>>>=0,r||checkOffset(e,8,this.length),f.read(this,e,!0,52,8)},Buffer.prototype.readDoubleBE=function(e,r){return e>>>=0,r||checkOffset(e,8,this.length),f.read(this,e,!1,52,8)},Buffer.prototype.writeUIntLE=function(e,r,h,d){if(e=+e,r>>>=0,h>>>=0,!d){var f=Math.pow(2,8*h)-1;checkInt(this,e,r,h,f,0)}var g=1,b=0;for(this[r]=255&e;++b<h&&(g*=256);)this[r+b]=e/g&255;return r+h},Buffer.prototype.writeUIntBE=function(e,r,h,d){if(e=+e,r>>>=0,h>>>=0,!d){var f=Math.pow(2,8*h)-1;checkInt(this,e,r,h,f,0)}var g=h-1,b=1;for(this[r+g]=255&e;--g>=0&&(b*=256);)this[r+g]=e/b&255;return r+h},Buffer.prototype.writeUInt8=function(e,r,h){return e=+e,r>>>=0,h||checkInt(this,e,r,1,255,0),this[r]=255&e,r+1},Buffer.prototype.writeUInt16LE=function(e,r,h){return e=+e,r>>>=0,h||checkInt(this,e,r,2,65535,0),this[r]=255&e,this[r+1]=e>>>8,r+2},Buffer.prototype.writeUInt16BE=function(e,r,h){return e=+e,r>>>=0,h||checkInt(this,e,r,2,65535,0),this[r]=e>>>8,this[r+1]=255&e,r+2},Buffer.prototype.writeUInt32LE=function(e,r,h){return e=+e,r>>>=0,h||checkInt(this,e,r,4,4294967295,0),this[r+3]=e>>>24,this[r+2]=e>>>16,this[r+1]=e>>>8,this[r]=255&e,r+4},Buffer.prototype.writeUInt32BE=function(e,r,h){return e=+e,r>>>=0,h||checkInt(this,e,r,4,4294967295,0),this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=255&e,r+4},Buffer.prototype.writeIntLE=function(e,r,h,d){if(e=+e,r>>>=0,!d){var f=Math.pow(2,8*h-1);checkInt(this,e,r,h,f-1,-f)}var g=0,b=1,A=0;for(this[r]=255&e;++g<h&&(b*=256);)e<0&&0===A&&0!==this[r+g-1]&&(A=1),this[r+g]=(e/b>>0)-A&255;return r+h},Buffer.prototype.writeIntBE=function(e,r,h,d){if(e=+e,r>>>=0,!d){var f=Math.pow(2,8*h-1);checkInt(this,e,r,h,f-1,-f)}var g=h-1,b=1,A=0;for(this[r+g]=255&e;--g>=0&&(b*=256);)e<0&&0===A&&0!==this[r+g+1]&&(A=1),this[r+g]=(e/b>>0)-A&255;return r+h},Buffer.prototype.writeInt8=function(e,r,h){return e=+e,r>>>=0,h||checkInt(this,e,r,1,127,-128),e<0&&(e=255+e+1),this[r]=255&e,r+1},Buffer.prototype.writeInt16LE=function(e,r,h){return e=+e,r>>>=0,h||checkInt(this,e,r,2,32767,-32768),this[r]=255&e,this[r+1]=e>>>8,r+2},Buffer.prototype.writeInt16BE=function(e,r,h){return e=+e,r>>>=0,h||checkInt(this,e,r,2,32767,-32768),this[r]=e>>>8,this[r+1]=255&e,r+2},Buffer.prototype.writeInt32LE=function(e,r,h){return e=+e,r>>>=0,h||checkInt(this,e,r,4,2147483647,-2147483648),this[r]=255&e,this[r+1]=e>>>8,this[r+2]=e>>>16,this[r+3]=e>>>24,r+4},Buffer.prototype.writeInt32BE=function(e,r,h){return e=+e,r>>>=0,h||checkInt(this,e,r,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=255&e,r+4},Buffer.prototype.writeFloatLE=function(e,r,h){return writeFloat(this,e,r,!0,h)},Buffer.prototype.writeFloatBE=function(e,r,h){return writeFloat(this,e,r,!1,h)},Buffer.prototype.writeDoubleLE=function(e,r,h){return writeDouble(this,e,r,!0,h)},Buffer.prototype.writeDoubleBE=function(e,r,h){return writeDouble(this,e,r,!1,h)},Buffer.prototype.copy=function(e,r,h,d){if(!Buffer.isBuffer(e))throw TypeError("argument should be a Buffer");if(h||(h=0),d||0===d||(d=this.length),r>=e.length&&(r=e.length),r||(r=0),d>0&&d<h&&(d=h),d===h||0===e.length||0===this.length)return 0;if(r<0)throw RangeError("targetStart out of bounds");if(h<0||h>=this.length)throw RangeError("Index out of range");if(d<0)throw RangeError("sourceEnd out of bounds");d>this.length&&(d=this.length),e.length-r<d-h&&(d=e.length-r+h);var f=d-h;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(r,h,d);else if(this===e&&h<r&&r<d)for(var g=f-1;g>=0;--g)e[g+r]=this[g+h];else Uint8Array.prototype.set.call(e,this.subarray(h,d),r);return f},Buffer.prototype.fill=function(e,r,h,d){if("string"==typeof e){if("string"==typeof r?(d=r,r=0,h=this.length):"string"==typeof h&&(d=h,h=this.length),void 0!==d&&"string"!=typeof d)throw TypeError("encoding must be a string");if("string"==typeof d&&!Buffer.isEncoding(d))throw TypeError("Unknown encoding: "+d);if(1===e.length){var f,g=e.charCodeAt(0);("utf8"===d&&g<128||"latin1"===d)&&(e=g)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(r<0||this.length<r||this.length<h)throw RangeError("Out of range index");if(h<=r)return this;if(r>>>=0,h=void 0===h?this.length:h>>>0,e||(e=0),"number"==typeof e)for(f=r;f<h;++f)this[f]=e;else{var b=Buffer.isBuffer(e)?e:Buffer.from(e,d),A=b.length;if(0===A)throw TypeError('The value "'+e+'" is invalid for argument "value"');for(f=0;f<h-r;++f)this[f+r]=b[f%A]}return this};var b=/[^+/0-9A-Za-z-_]/g;function utf8ToBytes(e,r){r=r||1/0;for(var h,d=e.length,f=null,g=[],b=0;b<d;++b){if((h=e.charCodeAt(b))>55295&&h<57344){if(!f){if(h>56319||b+1===d){(r-=3)>-1&&g.push(239,191,189);continue}f=h;continue}if(h<56320){(r-=3)>-1&&g.push(239,191,189),f=h;continue}h=(f-55296<<10|h-56320)+65536}else f&&(r-=3)>-1&&g.push(239,191,189);if(f=null,h<128){if((r-=1)<0)break;g.push(h)}else if(h<2048){if((r-=2)<0)break;g.push(h>>6|192,63&h|128)}else if(h<65536){if((r-=3)<0)break;g.push(h>>12|224,h>>6&63|128,63&h|128)}else if(h<1114112){if((r-=4)<0)break;g.push(h>>18|240,h>>12&63|128,h>>6&63|128,63&h|128)}else throw Error("Invalid code point")}return g}function asciiToBytes(e){for(var r=[],h=0;h<e.length;++h)r.push(255&e.charCodeAt(h));return r}function base64ToBytes(e){return d.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(b,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function blitBuffer(e,r,h,d){for(var f=0;f<d&&!(f+h>=r.length)&&!(f>=e.length);++f)r[f+h]=e[f];return f}function isInstance(e,r){return e instanceof r||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===r.name}var A=function(){for(var e="0123456789abcdef",r=Array(256),h=0;h<16;++h)for(var d=16*h,f=0;f<16;++f)r[d+f]=e[h]+e[f];return r}()},783:function(e,r){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */r.read=function(e,r,h,d,f){var g,b,A=8*f-d-1,k=(1<<A)-1,M=k>>1,j=-7,q=h?f-1:0,ee=h?-1:1,et=e[r+q];for(q+=ee,g=et&(1<<-j)-1,et>>=-j,j+=A;j>0;g=256*g+e[r+q],q+=ee,j-=8);for(b=g&(1<<-j)-1,g>>=-j,j+=d;j>0;b=256*b+e[r+q],q+=ee,j-=8);if(0===g)g=1-M;else{if(g===k)return b?NaN:(et?-1:1)*(1/0);b+=Math.pow(2,d),g-=M}return(et?-1:1)*b*Math.pow(2,g-d)},r.write=function(e,r,h,d,f,g){var b,A,k,M=8*g-f-1,j=(1<<M)-1,q=j>>1,ee=23===f?5960464477539062e-23:0,et=d?0:g-1,er=d?1:-1,en=r<0||0===r&&1/r<0?1:0;for(isNaN(r=Math.abs(r))||r===1/0?(A=isNaN(r)?1:0,b=j):(b=Math.floor(Math.log(r)/Math.LN2),r*(k=Math.pow(2,-b))<1&&(b--,k*=2),b+q>=1?r+=ee/k:r+=ee*Math.pow(2,1-q),r*k>=2&&(b++,k/=2),b+q>=j?(A=0,b=j):b+q>=1?(A=(r*k-1)*Math.pow(2,f),b+=q):(A=r*Math.pow(2,q-1)*Math.pow(2,f),b=0));f>=8;e[h+et]=255&A,et+=er,A/=256,f-=8);for(b=b<<f|A,M+=f;M>0;e[h+et]=255&b,et+=er,b/=256,M-=8);e[h+et-er]|=128*en}}},h={};function __nccwpck_require__(e){var d=h[e];if(void 0!==d)return d.exports;var f=h[e]={exports:{}},g=!0;try{r[e](f,f.exports,__nccwpck_require__),g=!1}finally{g&&delete h[e]}return f.exports}__nccwpck_require__.ab="//";var d=__nccwpck_require__(72);e.exports=d}()},415:function(){},7663:function(e){!function(){var r={229:function(e){var r,h,d,f=e.exports={};function defaultSetTimout(){throw Error("setTimeout has not been defined")}function defaultClearTimeout(){throw Error("clearTimeout has not been defined")}function runTimeout(e){if(r===setTimeout)return setTimeout(e,0);if((r===defaultSetTimout||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(h){try{return r.call(null,e,0)}catch(h){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){r=defaultSetTimout}try{h="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){h=defaultClearTimeout}}();var g=[],b=!1,A=-1;function cleanUpNextTick(){b&&d&&(b=!1,d.length?g=d.concat(g):A=-1,g.length&&drainQueue())}function drainQueue(){if(!b){var e=runTimeout(cleanUpNextTick);b=!0;for(var r=g.length;r;){for(d=g,g=[];++A<r;)d&&d[A].run();A=-1,r=g.length}d=null,b=!1,function(e){if(h===clearTimeout)return clearTimeout(e);if((h===defaultClearTimeout||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(e);try{h(e)}catch(r){try{return h.call(null,e)}catch(r){return h.call(this,e)}}}(e)}}function Item(e,r){this.fun=e,this.array=r}function noop(){}f.nextTick=function(e){var r=Array(arguments.length-1);if(arguments.length>1)for(var h=1;h<arguments.length;h++)r[h-1]=arguments[h];g.push(new Item(e,r)),1!==g.length||b||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=noop,f.addListener=noop,f.once=noop,f.off=noop,f.removeListener=noop,f.removeAllListeners=noop,f.emit=noop,f.prependListener=noop,f.prependOnceListener=noop,f.listeners=function(e){return[]},f.binding=function(e){throw Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(e){throw Error("process.chdir is not supported")},f.umask=function(){return 0}}},h={};function __nccwpck_require__(e){var d=h[e];if(void 0!==d)return d.exports;var f=h[e]={exports:{}},g=!0;try{r[e](f,f.exports,__nccwpck_require__),g=!1}finally{g&&delete h[e]}return f.exports}__nccwpck_require__.ab="//";var d=__nccwpck_require__(229);e.exports=d}()},9008:function(e,r,h){e.exports=h(9201)},1664:function(e,r,h){e.exports=h(5170)},1163:function(e,r,h){e.exports=h(9974)},6771:function(e,r,h){"use strict";let d,f;h.d(r,{Jn:function(){return e_},qX:function(){return _getProvider},rh:function(){return _isFirebaseServerApp},Xd:function(){return _registerComponent},Mq:function(){return getApp},C6:function(){return getApps},ZF:function(){return initializeApp},KN:function(){return registerVersion}});var g,b=h(75),A=h(4645),k=h(9711);let instanceOfAny=(e,r)=>r.some(r=>e instanceof r),M=new WeakMap,j=new WeakMap,q=new WeakMap,ee=new WeakMap,et=new WeakMap,er={get(e,r,h){if(e instanceof IDBTransaction){if("done"===r)return j.get(e);if("objectStoreNames"===r)return e.objectStoreNames||q.get(e);if("store"===r)return h.objectStoreNames[1]?void 0:h.objectStore(h.objectStoreNames[0])}return wrap_idb_value_wrap(e[r])},set:(e,r,h)=>(e[r]=h,!0),has:(e,r)=>e instanceof IDBTransaction&&("done"===r||"store"===r)||r in e};function wrap_idb_value_wrap(e){var r;if(e instanceof IDBRequest)return function(e){let r=new Promise((r,h)=>{let unlisten=()=>{e.removeEventListener("success",success),e.removeEventListener("error",error)},success=()=>{r(wrap_idb_value_wrap(e.result)),unlisten()},error=()=>{h(e.error),unlisten()};e.addEventListener("success",success),e.addEventListener("error",error)});return r.then(r=>{r instanceof IDBCursor&&M.set(r,e)}).catch(()=>{}),et.set(r,e),r}(e);if(ee.has(e))return ee.get(e);let h="function"==typeof(r=e)?r!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(f||(f=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(r)?function(...e){return r.apply(unwrap(this),e),wrap_idb_value_wrap(M.get(this))}:function(...e){return wrap_idb_value_wrap(r.apply(unwrap(this),e))}:function(e,...h){let d=r.call(unwrap(this),e,...h);return q.set(d,e.sort?e.sort():[e]),wrap_idb_value_wrap(d)}:(r instanceof IDBTransaction&&function(e){if(j.has(e))return;let r=new Promise((r,h)=>{let unlisten=()=>{e.removeEventListener("complete",complete),e.removeEventListener("error",error),e.removeEventListener("abort",error)},complete=()=>{r(),unlisten()},error=()=>{h(e.error||new DOMException("AbortError","AbortError")),unlisten()};e.addEventListener("complete",complete),e.addEventListener("error",error),e.addEventListener("abort",error)});j.set(e,r)}(r),instanceOfAny(r,d||(d=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])))?new Proxy(r,er):r;return h!==e&&(ee.set(e,h),et.set(h,e)),h}let unwrap=e=>et.get(e),en=["get","getKey","getAll","getAllKeys","count"],ei=["put","add","delete","clear"],es=new Map;function getMethod(e,r){if(!(e instanceof IDBDatabase&&!(r in e)&&"string"==typeof r))return;if(es.get(r))return es.get(r);let h=r.replace(/FromIndex$/,""),d=r!==h,f=ei.includes(h);if(!(h in(d?IDBIndex:IDBObjectStore).prototype)||!(f||en.includes(h)))return;let method=async function(e,...r){let g=this.transaction(e,f?"readwrite":"readonly"),b=g.store;return d&&(b=b.index(r.shift())),(await Promise.all([b[h](...r),f&&g.done]))[0]};return es.set(r,method),method}er={...g=er,get:(e,r,h)=>getMethod(e,r)||g.get(e,r,h),has:(e,r)=>!!getMethod(e,r)||g.has(e,r)};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let PlatformLoggerServiceImpl=class PlatformLoggerServiceImpl{constructor(e){this.container=e}getPlatformInfoString(){let e=this.container.getProviders();return e.map(e=>{if(!function(e){let r=e.getComponent();return r?.type==="VERSION"}(e))return null;{let r=e.getImmediate();return`${r.library}/${r.version}`}}).filter(e=>e).join(" ")}};let eo="@firebase/app",ea="0.14.7",el=new A.Yd("@firebase/app"),eu="[DEFAULT]",eh={[eo]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/data-connect":"fire-data-connect","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","@firebase/ai":"fire-vertex","fire-js":"fire-js",firebase:"fire-js-all"},ed=new Map,em=new Map,ef=new Map;function _addComponent(e,r){try{e.container.addComponent(r)}catch(h){el.debug(`Component ${r.name} failed to register with FirebaseApp ${e.name}`,h)}}function _registerComponent(e){let r=e.name;if(ef.has(r))return el.debug(`There were multiple attempts to register component ${r}.`),!1;for(let h of(ef.set(r,e),ed.values()))_addComponent(h,e);for(let r of em.values())_addComponent(r,e);return!0}function _getProvider(e,r){let h=e.container.getProvider("heartbeat").getImmediate({optional:!0});return h&&h.triggerHeartbeat(),e.container.getProvider(r)}function _isFirebaseServerApp(e){return null!=e&&void 0!==e.settings}let ep=new k.LL("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let FirebaseAppImpl=class FirebaseAppImpl{constructor(e,r,h){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=h,this.container.addComponent(new b.wA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ep.create("app-deleted",{appName:this._name})}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let e_="12.8.0";function initializeApp(e,r={}){let h=e;if("object"!=typeof r){let e=r;r={name:e}}let d={name:eu,automaticDataCollectionEnabled:!0,...r},f=d.name;if("string"!=typeof f||!f)throw ep.create("bad-app-name",{appName:String(f)});if(h||(h=(0,k.aH)()),!h)throw ep.create("no-options");let g=ed.get(f);if(g){if((0,k.vZ)(h,g.options)&&(0,k.vZ)(d,g.config))return g;throw ep.create("duplicate-app",{appName:f})}let A=new b.H0(f);for(let e of ef.values())A.addComponent(e);let M=new FirebaseAppImpl(h,d,A);return ed.set(f,M),M}function getApp(e=eu){let r=ed.get(e);if(!r&&e===eu&&(0,k.aH)())return initializeApp();if(!r)throw ep.create("no-app",{appName:e});return r}function getApps(){return Array.from(ed.values())}function registerVersion(e,r,h){let d=eh[e]??e;h&&(d+=`-${h}`);let f=d.match(/\s|\//),g=r.match(/\s|\//);if(f||g){let e=[`Unable to register library "${d}" with version "${r}":`];f&&e.push(`library name "${d}" contains illegal characters (whitespace or "/")`),f&&g&&e.push("and"),g&&e.push(`version name "${r}" contains illegal characters (whitespace or "/")`),el.warn(e.join(" "));return}_registerComponent(new b.wA(`${d}-version`,()=>({library:d,version:r}),"VERSION"))}let eg="firebase-heartbeat-store",ey=null;function getDbPromise(){return ey||(ey=(function(e,r,{blocked:h,upgrade:d,blocking:f,terminated:g}={}){let b=indexedDB.open(e,1),A=wrap_idb_value_wrap(b);return d&&b.addEventListener("upgradeneeded",e=>{d(wrap_idb_value_wrap(b.result),e.oldVersion,e.newVersion,wrap_idb_value_wrap(b.transaction),e)}),h&&b.addEventListener("blocked",e=>h(e.oldVersion,e.newVersion,e)),A.then(e=>{g&&e.addEventListener("close",()=>g()),f&&e.addEventListener("versionchange",e=>f(e.oldVersion,e.newVersion,e))}).catch(()=>{}),A})("firebase-heartbeat-database",0,{upgrade:(e,r)=>{if(0===r)try{e.createObjectStore(eg)}catch(e){console.warn(e)}}}).catch(e=>{throw ep.create("idb-open",{originalErrorMessage:e.message})})),ey}async function readHeartbeatsFromIndexedDB(e){try{let r=await getDbPromise(),h=r.transaction(eg),d=await h.objectStore(eg).get(computeKey(e));return await h.done,d}catch(e){if(e instanceof k.ZR)el.warn(e.message);else{let r=ep.create("idb-get",{originalErrorMessage:e?.message});el.warn(r.message)}}}async function writeHeartbeatsToIndexedDB(e,r){try{let h=await getDbPromise(),d=h.transaction(eg,"readwrite"),f=d.objectStore(eg);await f.put(r,computeKey(e)),await d.done}catch(e){if(e instanceof k.ZR)el.warn(e.message);else{let r=ep.create("idb-set",{originalErrorMessage:e?.message});el.warn(r.message)}}}function computeKey(e){return`${e.name}!${e.options.appId}`}let HeartbeatServiceImpl=class HeartbeatServiceImpl{constructor(e){this.container=e,this._heartbeatsCache=null;let r=this.container.getProvider("app").getImmediate();this._storage=new HeartbeatStorageImpl(r),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){try{let e=this.container.getProvider("platform-logger").getImmediate(),r=e.getPlatformInfoString(),h=getUTCDateString();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===h||this._heartbeatsCache.heartbeats.some(e=>e.date===h))return;if(this._heartbeatsCache.heartbeats.push({date:h,agent:r}),this._heartbeatsCache.heartbeats.length>30){let e=function(e){if(0===e.length)return -1;let r=0,h=e[0].date;for(let d=1;d<e.length;d++)e[d].date<h&&(h=e[d].date,r=d);return r}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){el.warn(e)}}async getHeartbeatsHeader(){try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||0===this._heartbeatsCache.heartbeats.length)return"";let e=getUTCDateString(),{heartbeatsToSend:r,unsentEntries:h}=function(e,r=1024){let h=[],d=e.slice();for(let f of e){let e=h.find(e=>e.agent===f.agent);if(e){if(e.dates.push(f.date),countBytes(h)>r){e.dates.pop();break}}else if(h.push({agent:f.agent,dates:[f.date]}),countBytes(h)>r){h.pop();break}d=d.slice(1)}return{heartbeatsToSend:h,unsentEntries:d}}(this._heartbeatsCache.heartbeats),d=(0,k.L)(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=e,h.length>0?(this._heartbeatsCache.heartbeats=h,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),d}catch(e){return el.warn(e),""}}};function getUTCDateString(){let e=new Date;return e.toISOString().substring(0,10)}let HeartbeatStorageImpl=class HeartbeatStorageImpl{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!(0,k.hl)()&&(0,k.eu)().then(()=>!0).catch(()=>!1)}async read(){let e=await this._canUseIndexedDBPromise;if(!e)return{heartbeats:[]};{let e=await readHeartbeatsFromIndexedDB(this.app);return e?.heartbeats?e:{heartbeats:[]}}}async overwrite(e){let r=await this._canUseIndexedDBPromise;if(r){let r=await this.read();return writeHeartbeatsToIndexedDB(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){let r=await this._canUseIndexedDBPromise;if(r){let r=await this.read();return writeHeartbeatsToIndexedDB(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}}};function countBytes(e){return(0,k.L)(JSON.stringify({version:2,heartbeats:e})).length}_registerComponent(new b.wA("platform-logger",e=>new PlatformLoggerServiceImpl(e),"PRIVATE")),_registerComponent(new b.wA("heartbeat",e=>new HeartbeatServiceImpl(e),"PRIVATE")),registerVersion(eo,ea,""),registerVersion(eo,ea,"esm2020"),registerVersion("fire-js","")},75:function(e,r,h){"use strict";h.d(r,{H0:function(){return ComponentContainer},wA:function(){return Component}});var d=h(9711);let Component=class Component{constructor(e,r,h){this.name=e,this.instanceFactory=r,this.type=h,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let f="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Provider=class Provider{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){let e=new d.BH;if(this.instancesDeferred.set(r,e),this.isInitialized(r)||this.shouldAutoInitialize())try{let h=this.getOrInitializeService({instanceIdentifier:r});h&&e.resolve(h)}catch(e){}}return this.instancesDeferred.get(r).promise}getImmediate(e){let r=this.normalizeInstanceIdentifier(e?.identifier),h=e?.optional??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(e){if(h)return null;throw e}else{if(h)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if("EAGER"===e.instantiationMode)try{this.getOrInitializeService({instanceIdentifier:f})}catch(e){}for(let[e,r]of this.instancesDeferred.entries()){let h=this.normalizeInstanceIdentifier(e);try{let e=this.getOrInitializeService({instanceIdentifier:h});r.resolve(e)}catch(e){}}}}clearInstance(e=f){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(e=f){return this.instances.has(e)}getOptions(e=f){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:r={}}=e,h=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(h))throw Error(`${this.name}(${h}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let d=this.getOrInitializeService({instanceIdentifier:h,options:r});for(let[e,r]of this.instancesDeferred.entries()){let f=this.normalizeInstanceIdentifier(e);h===f&&r.resolve(d)}return d}onInit(e,r){let h=this.normalizeInstanceIdentifier(r),d=this.onInitCallbacks.get(h)??new Set;d.add(e),this.onInitCallbacks.set(h,d);let f=this.instances.get(h);return f&&e(f,h),()=>{d.delete(e)}}invokeOnInitCallbacks(e,r){let h=this.onInitCallbacks.get(r);if(h)for(let d of h)try{d(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let h=this.instances.get(e);if(!h&&this.component&&(h=this.component.instanceFactory(this.container,{instanceIdentifier:e===f?void 0:e,options:r}),this.instances.set(e,h),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(h,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,h)}catch{}return h||null}normalizeInstanceIdentifier(e=f){return this.component?this.component.multipleInstances?e:f:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ComponentContainer=class ComponentContainer{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let r=this.getProvider(e.name);if(r.isComponentSet())throw Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){let r=this.getProvider(e.name);r.isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let r=new Provider(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}},4645:function(e,r,h){"use strict";var d,f;h.d(r,{Yd:function(){return Logger},in:function(){return d}});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let g=[];(f=d||(d={}))[f.DEBUG=0]="DEBUG",f[f.VERBOSE=1]="VERBOSE",f[f.INFO=2]="INFO",f[f.WARN=3]="WARN",f[f.ERROR=4]="ERROR",f[f.SILENT=5]="SILENT";let b={debug:d.DEBUG,verbose:d.VERBOSE,info:d.INFO,warn:d.WARN,error:d.ERROR,silent:d.SILENT},A=d.INFO,k={[d.DEBUG]:"log",[d.VERBOSE]:"log",[d.INFO]:"info",[d.WARN]:"warn",[d.ERROR]:"error"},defaultLogHandler=(e,r,...h)=>{if(r<e.logLevel)return;let d=new Date().toISOString(),f=k[r];if(f)console[f](`[${d}]  ${e.name}:`,...h);else throw Error(`Attempted to log a message with an invalid logType (value: ${r})`)};let Logger=class Logger{constructor(e){this.name=e,this._logLevel=A,this._logHandler=defaultLogHandler,this._userLogHandler=null,g.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in d))throw TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?b[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,d.DEBUG,...e),this._logHandler(this,d.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,d.VERBOSE,...e),this._logHandler(this,d.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,d.INFO,...e),this._logHandler(this,d.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,d.WARN,...e),this._logHandler(this,d.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,d.ERROR,...e),this._logHandler(this,d.ERROR,...e)}}},2753:function(e,r,h){"use strict";h.d(r,{v0:function(){return getAuth},Aj:function(){return onAuthStateChanged}});var d,f=h(6771),g=h(9711),b=h(4645),A=h(75);function _prodErrorMap(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}let k=new g.LL("auth","Firebase",_prodErrorMap()),M=new b.Yd("@firebase/auth");function _logError(e,...r){M.logLevel<=b.in.ERROR&&M.error(`Auth (${f.Jn}): ${e}`,...r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _fail(e,...r){throw createErrorInternal(e,...r)}function _createError(e,...r){return createErrorInternal(e,...r)}function _errorWithCustomMessage(e,r,h){let d={..._prodErrorMap(),[r]:h},f=new g.LL("auth","Firebase",d);return f.create(r,{appName:e.name})}function _serverAppCurrentUserOperationNotSupportedError(e){return _errorWithCustomMessage(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function createErrorInternal(e,...r){if("string"!=typeof e){let h=r[0],d=[...r.slice(1)];return d[0]&&(d[0].appName=e.name),e._errorFactory.create(h,...d)}return k.create(e,...r)}function _assert(e,r,...h){if(!e)throw createErrorInternal(r,...h)}function debugFail(e){let r="INTERNAL ASSERTION FAILED: "+e;throw _logError(r),Error(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _getCurrentUrl(){return"undefined"!=typeof self&&self.location?.href||""}function _getCurrentScheme(){return"undefined"!=typeof self&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Delay=class Delay{constructor(e,r){this.shortDelay=e,this.longDelay=r,r>e||debugFail("Short delay should be less than long delay!"),this.isMobile=(0,g.uI)()||(0,g.b$)()}get(){return!("undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===_getCurrentScheme()||"https:"===_getCurrentScheme()||(0,g.ru)()||"connection"in navigator))||navigator.onLine?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _emulatorUrl(e,r){e.emulator||debugFail("Emulator should always be set here");let{url:h}=e.emulator;return r?`${h}${r.startsWith("/")?r.slice(1):r}`:h}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let FetchProvider=class FetchProvider{static initialize(e,r,h){this.fetchImpl=e,r&&(this.headersImpl=r),h&&(this.responseImpl=h)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:"undefined"!=typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!=typeof fetch?fetch:void debugFail("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:"undefined"!=typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!=typeof Headers?Headers:void debugFail("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:"undefined"!=typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!=typeof Response?Response:void debugFail("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let j={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},q=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],ee=new Delay(3e4,6e4);function _addTidIfNecessary(e,r){return e.tenantId&&!r.tenantId?{...r,tenantId:e.tenantId}:r}async function _performApiRequest(e,r,h,d,f={}){return _performFetchWithErrorHandling(e,f,async()=>{let f={},b={};d&&("GET"===r?b=d:f={body:JSON.stringify(d)});let A=(0,g.xO)({key:e.config.apiKey,...b}).slice(1),k=await e._getAdditionalHeaders();k["Content-Type"]="application/json",e.languageCode&&(k["X-Firebase-Locale"]=e.languageCode);let M={method:r,headers:k,...f};return(0,g.L_)()||(M.referrerPolicy="no-referrer"),e.emulatorConfig&&(0,g.Xx)(e.emulatorConfig.host)&&(M.credentials="include"),FetchProvider.fetch()(await _getFinalTarget(e,e.config.apiHost,h,A),M)})}async function _performFetchWithErrorHandling(e,r,h){e._canInitEmulator=!1;let d={...j,...r};try{let r=new NetworkTimeout(e),f=await Promise.race([h(),r.promise]);r.clearNetworkTimeout();let g=await f.json();if("needConfirmation"in g)throw _makeTaggedError(e,"account-exists-with-different-credential",g);if(f.ok&&!("errorMessage"in g))return g;{let r=f.ok?g.errorMessage:g.error.message,[h,b]=r.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===h)throw _makeTaggedError(e,"credential-already-in-use",g);if("EMAIL_EXISTS"===h)throw _makeTaggedError(e,"email-already-in-use",g);if("USER_DISABLED"===h)throw _makeTaggedError(e,"user-disabled",g);let A=d[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(b)throw _errorWithCustomMessage(e,A,b);_fail(e,A)}}catch(r){if(r instanceof g.ZR)throw r;_fail(e,"network-request-failed",{message:String(r)})}}async function _performSignInRequest(e,r,h,d,f={}){let g=await _performApiRequest(e,r,h,d,f);return"mfaPendingCredential"in g&&_fail(e,"multi-factor-auth-required",{_serverResponse:g}),g}async function _getFinalTarget(e,r,h,d){let f=`${r}${h}?${d}`,g=e.config.emulator?_emulatorUrl(e.config,f):`${e.config.apiScheme}://${f}`;if(q.includes(h)&&(await e._persistenceManagerAvailable,"COOKIE"===e._getPersistenceType())){let r=e._getPersistence();return r._getFinalTarget(g).toString()}return g}let NetworkTimeout=class NetworkTimeout{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,r)=>{this.timer=setTimeout(()=>r(_createError(this.auth,"network-request-failed")),ee.get())})}};function _makeTaggedError(e,r,h){let d={appName:e.name};h.email&&(d.email=h.email),h.phoneNumber&&(d.phoneNumber=h.phoneNumber);let f=_createError(e,r,d);return f.customData._tokenResponse=h,f}function isEnterprise(e){return void 0!==e&&void 0!==e.enterprise}let RecaptchaConfig=class RecaptchaConfig{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(let r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return function(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}(r.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}};async function getRecaptchaConfig(e,r){return _performApiRequest(e,"GET","/v2/recaptchaConfig",_addTidIfNecessary(e,r))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function deleteAccount(e,r){return _performApiRequest(e,"POST","/v1/accounts:delete",r)}async function getAccountInfo(e,r){return _performApiRequest(e,"POST","/v1/accounts:lookup",r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function utcTimestampToDateString(e){if(e)try{let r=new Date(Number(e));if(!isNaN(r.getTime()))return r.toUTCString()}catch(e){}}async function getIdTokenResult(e,r=!1){let h=(0,g.m9)(e),d=await h.getIdToken(r),f=_parseToken(d);_assert(f&&f.exp&&f.auth_time&&f.iat,h.auth,"internal-error");let b="object"==typeof f.firebase?f.firebase:void 0,A=b?.sign_in_provider;return{claims:f,token:d,authTime:utcTimestampToDateString(secondsStringToMilliseconds(f.auth_time)),issuedAtTime:utcTimestampToDateString(secondsStringToMilliseconds(f.iat)),expirationTime:utcTimestampToDateString(secondsStringToMilliseconds(f.exp)),signInProvider:A||null,signInSecondFactor:b?.sign_in_second_factor||null}}function secondsStringToMilliseconds(e){return 1e3*Number(e)}function _parseToken(e){let[r,h,d]=e.split(".");if(void 0===r||void 0===h||void 0===d)return _logError("JWT malformed, contained fewer than 3 sections"),null;try{let e=(0,g.tV)(h);if(!e)return _logError("Failed to decode base64 JWT payload"),null;return JSON.parse(e)}catch(e){return _logError("Caught error parsing JWT payload as JSON",e?.toString()),null}}function _tokenExpiresIn(e){let r=_parseToken(e);return _assert(r,"internal-error"),_assert(void 0!==r.exp,"internal-error"),_assert(void 0!==r.iat,"internal-error"),Number(r.exp)-Number(r.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _logoutIfInvalidated(e,r,h=!1){if(h)return r;try{return await r}catch(r){throw r instanceof g.ZR&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}(r)&&e.auth.currentUser===e&&await e.auth.signOut(),r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ProactiveRefresh=class ProactiveRefresh{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){if(e){let e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;let e=this.user.stsTokenManager.expirationTime??0,r=e-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;let r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let UserMetadata=class UserMetadata{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=utcTimestampToDateString(this.lastLoginAt),this.creationTime=utcTimestampToDateString(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _reloadWithoutSaving(e){let r=e.auth,h=await e.getIdToken(),d=await _logoutIfInvalidated(e,getAccountInfo(r,{idToken:h}));_assert(d?.users.length,r,"internal-error");let f=d.users[0];e._notifyReloadListener(f);let g=f.providerUserInfo?.length?extractProviderData(f.providerUserInfo):[],b=function(e,r){let h=e.filter(e=>!r.some(r=>r.providerId===e.providerId));return[...h,...r]}(e.providerData,g),A=e.isAnonymous,k=!(e.email&&f.passwordHash)&&!b?.length,M={uid:f.localId,displayName:f.displayName||null,photoURL:f.photoUrl||null,email:f.email||null,emailVerified:f.emailVerified||!1,phoneNumber:f.phoneNumber||null,tenantId:f.tenantId||null,providerData:b,metadata:new UserMetadata(f.createdAt,f.lastLoginAt),isAnonymous:!!A&&k};Object.assign(e,M)}async function reload(e){let r=(0,g.m9)(e);await _reloadWithoutSaving(r),await r.auth._persistUserIfCurrent(r),r.auth._notifyListenersIfCurrent(r)}function extractProviderData(e){return e.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function requestStsToken(e,r){let h=await _performFetchWithErrorHandling(e,{},async()=>{let h=(0,g.xO)({grant_type:"refresh_token",refresh_token:r}).slice(1),{tokenApiHost:d,apiKey:f}=e.config,b=await _getFinalTarget(e,d,"/v1/token",`key=${f}`),A=await e._getAdditionalHeaders();A["Content-Type"]="application/x-www-form-urlencoded";let k={method:"POST",headers:A,body:h};return e.emulatorConfig&&(0,g.Xx)(e.emulatorConfig.host)&&(k.credentials="include"),FetchProvider.fetch()(b,k)});return{accessToken:h.access_token,expiresIn:h.expires_in,refreshToken:h.refresh_token}}async function revokeToken(e,r){return _performApiRequest(e,"POST","/v2/accounts:revokeToken",_addTidIfNecessary(e,r))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let StsTokenManager=class StsTokenManager{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){_assert(e.idToken,"internal-error"),_assert(void 0!==e.idToken,"internal-error"),_assert(void 0!==e.refreshToken,"internal-error");let r="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):_tokenExpiresIn(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){_assert(0!==e.length,"internal-error");let r=_tokenExpiresIn(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return r||!this.accessToken||this.isExpired?(_assert(this.refreshToken,e,"user-token-expired"),this.refreshToken)?(await this.refresh(e,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){let{accessToken:h,refreshToken:d,expiresIn:f}=await requestStsToken(e,r);this.updateTokensAndExpiration(h,d,Number(f))}updateTokensAndExpiration(e,r,h){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*h}static fromJSON(e,r){let{refreshToken:h,accessToken:d,expirationTime:f}=r,g=new StsTokenManager;return h&&(_assert("string"==typeof h,"internal-error",{appName:e}),g.refreshToken=h),d&&(_assert("string"==typeof d,"internal-error",{appName:e}),g.accessToken=d),f&&(_assert("number"==typeof f,"internal-error",{appName:e}),g.expirationTime=f),g}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new StsTokenManager,this.toJSON())}_performRefresh(){return debugFail("not implemented")}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function assertStringOrUndefined(e,r){_assert("string"==typeof e||void 0===e,"internal-error",{appName:r})}let UserImpl=class UserImpl{constructor({uid:e,auth:r,stsTokenManager:h,...d}){this.providerId="firebase",this.proactiveRefresh=new ProactiveRefresh(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=h,this.accessToken=h.accessToken,this.displayName=d.displayName||null,this.email=d.email||null,this.emailVerified=d.emailVerified||!1,this.phoneNumber=d.phoneNumber||null,this.photoURL=d.photoURL||null,this.isAnonymous=d.isAnonymous||!1,this.tenantId=d.tenantId||null,this.providerData=d.providerData?[...d.providerData]:[],this.metadata=new UserMetadata(d.createdAt||void 0,d.lastLoginAt||void 0)}async getIdToken(e){let r=await _logoutIfInvalidated(this,this.stsTokenManager.getToken(this.auth,e));return _assert(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return getIdTokenResult(this,e)}reload(){return reload(this)}_assign(e){this!==e&&(_assert(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>({...e})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let r=new UserImpl({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){_assert(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let h=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),h=!0),r&&await _reloadWithoutSaving(this),await this.auth._persistUserIfCurrent(this),h&&this.auth._notifyListenersIfCurrent(this)}async delete(){if((0,f.rh)(this.auth.app))return Promise.reject(_serverAppCurrentUserOperationNotSupportedError(this.auth));let e=await this.getIdToken();return await _logoutIfInvalidated(this,deleteAccount(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){let h=r.displayName??void 0,d=r.email??void 0,f=r.phoneNumber??void 0,g=r.photoURL??void 0,b=r.tenantId??void 0,A=r._redirectEventId??void 0,k=r.createdAt??void 0,M=r.lastLoginAt??void 0,{uid:j,emailVerified:q,isAnonymous:ee,providerData:et,stsTokenManager:er}=r;_assert(j&&er,e,"internal-error");let en=StsTokenManager.fromJSON(this.name,er);_assert("string"==typeof j,e,"internal-error"),assertStringOrUndefined(h,e.name),assertStringOrUndefined(d,e.name),_assert("boolean"==typeof q,e,"internal-error"),_assert("boolean"==typeof ee,e,"internal-error"),assertStringOrUndefined(f,e.name),assertStringOrUndefined(g,e.name),assertStringOrUndefined(b,e.name),assertStringOrUndefined(A,e.name),assertStringOrUndefined(k,e.name),assertStringOrUndefined(M,e.name);let ei=new UserImpl({uid:j,auth:e,email:d,emailVerified:q,displayName:h,isAnonymous:ee,photoURL:g,phoneNumber:f,tenantId:b,stsTokenManager:en,createdAt:k,lastLoginAt:M});return et&&Array.isArray(et)&&(ei.providerData=et.map(e=>({...e}))),A&&(ei._redirectEventId=A),ei}static async _fromIdTokenResponse(e,r,h=!1){let d=new StsTokenManager;d.updateFromServerResponse(r);let f=new UserImpl({uid:r.localId,auth:e,stsTokenManager:d,isAnonymous:h});return await _reloadWithoutSaving(f),f}static async _fromGetAccountInfoResponse(e,r,h){let d=r.users[0];_assert(void 0!==d.localId,"internal-error");let f=void 0!==d.providerUserInfo?extractProviderData(d.providerUserInfo):[],g=!(d.email&&d.passwordHash)&&!f?.length,b=new StsTokenManager;b.updateFromIdToken(h);let A=new UserImpl({uid:d.localId,auth:e,stsTokenManager:b,isAnonymous:g}),k={uid:d.localId,displayName:d.displayName||null,photoURL:d.photoUrl||null,email:d.email||null,emailVerified:d.emailVerified||!1,phoneNumber:d.phoneNumber||null,tenantId:d.tenantId||null,providerData:f,metadata:new UserMetadata(d.createdAt,d.lastLoginAt),isAnonymous:!(d.email&&d.passwordHash)&&!f?.length};return Object.assign(A,k),A}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let et=new Map;function _getInstance(e){e instanceof Function||debugFail("Expected a class definition");let r=et.get(e);return r?r instanceof e||debugFail("Instance stored in cache mismatched with class"):(r=new e,et.set(e,r)),r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let InMemoryPersistence=class InMemoryPersistence{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){let r=this.storage[e];return void 0===r?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _persistenceKeyName(e,r,h){return`firebase:${e}:${r}:${h}`}InMemoryPersistence.type="NONE";let PersistenceUserManager=class PersistenceUserManager{constructor(e,r,h){this.persistence=e,this.auth=r,this.userKey=h;let{config:d,name:f}=this.auth;this.fullUserKey=_persistenceKeyName(this.userKey,d.apiKey,f),this.fullPersistenceKey=_persistenceKeyName("persistence",d.apiKey,f),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){let e=await this.persistence._get(this.fullUserKey);if(!e)return null;if("string"==typeof e){let r=await getAccountInfo(this.auth,{idToken:e}).catch(()=>void 0);return r?UserImpl._fromGetAccountInfoResponse(this.auth,r,e):null}return UserImpl._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;let r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,h="authUser"){if(!r.length)return new PersistenceUserManager(_getInstance(InMemoryPersistence),e,h);let d=(await Promise.all(r.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e),f=d[0]||_getInstance(InMemoryPersistence),g=_persistenceKeyName(h,e.config.apiKey,e.name),b=null;for(let h of r)try{let r=await h._get(g);if(r){let d;if("string"==typeof r){let h=await getAccountInfo(e,{idToken:r}).catch(()=>void 0);if(!h)break;d=await UserImpl._fromGetAccountInfoResponse(e,h,r)}else d=UserImpl._fromJSON(e,r);h!==f&&(b=d),f=h;break}}catch{}let A=d.filter(e=>e._shouldAllowMigration);return f._shouldAllowMigration&&A.length&&(f=A[0],b&&await f._set(g,b.toJSON()),await Promise.all(r.map(async e=>{if(e!==f)try{await e._remove(g)}catch{}}))),new PersistenceUserManager(f,e,h)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _getBrowserName(e){let r=e.toLowerCase();if(r.includes("opera/")||r.includes("opr/")||r.includes("opios/"))return"Opera";if(_isIEMobile(r))return"IEMobile";if(r.includes("msie")||r.includes("trident/"))return"IE";{if(r.includes("edge/"))return"Edge";if(_isFirefox(r))return"Firefox";if(r.includes("silk/"))return"Silk";if(_isBlackBerry(r))return"Blackberry";if(_isWebOS(r))return"Webos";if(_isSafari(r))return"Safari";if((r.includes("chrome/")||_isChromeIOS(r))&&!r.includes("edge/"))return"Chrome";if(_isAndroid(r))return"Android";let h=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(h?.length===2)return h[1]}return"Other"}function _isFirefox(e=(0,g.z$)()){return/firefox\//i.test(e)}function _isSafari(e=(0,g.z$)()){let r=e.toLowerCase();return r.includes("safari/")&&!r.includes("chrome/")&&!r.includes("crios/")&&!r.includes("android")}function _isChromeIOS(e=(0,g.z$)()){return/crios\//i.test(e)}function _isIEMobile(e=(0,g.z$)()){return/iemobile/i.test(e)}function _isAndroid(e=(0,g.z$)()){return/android/i.test(e)}function _isBlackBerry(e=(0,g.z$)()){return/blackberry/i.test(e)}function _isWebOS(e=(0,g.z$)()){return/webos/i.test(e)}function _isIOS(e=(0,g.z$)()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function _isMobileBrowser(e=(0,g.z$)()){return _isIOS(e)||_isAndroid(e)||_isWebOS(e)||_isBlackBerry(e)||/windows phone/i.test(e)||_isIEMobile(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _getClientVersion(e,r=[]){let h;switch(e){case"Browser":h=_getBrowserName((0,g.z$)());break;case"Worker":h=`${_getBrowserName((0,g.z$)())}-${e}`;break;default:h=e}let d=r.length?r.join(","):"FirebaseCore-web";return`${h}/JsCore/${f.Jn}/${d}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let AuthMiddlewareQueue=class AuthMiddlewareQueue{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){let wrappedCallback=r=>new Promise((h,d)=>{try{let d=e(r);h(d)}catch(e){d(e)}});wrappedCallback.onAbort=r,this.queue.push(wrappedCallback);let h=this.queue.length-1;return()=>{this.queue[h]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;let r=[];try{for(let h of this.queue)await h(e),h.onAbort&&r.push(h.onAbort)}catch(e){for(let e of(r.reverse(),r))try{e()}catch(e){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:e?.message})}}};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _getPasswordPolicy(e,r={}){return _performApiRequest(e,"GET","/v2/passwordPolicy",_addTidIfNecessary(e,r))}let PasswordPolicyImpl=class PasswordPolicyImpl{constructor(e){let r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??6,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),void 0!==r.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),void 0!==r.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),void 0!==r.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),void 0!==r.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){let r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){let h=this.customStrengthOptions.minPasswordLength,d=this.customStrengthOptions.maxPasswordLength;h&&(r.meetsMinPasswordLength=e.length>=h),d&&(r.meetsMaxPasswordLength=e.length<=d)}validatePasswordCharacterOptions(e,r){let h;this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);for(let d=0;d<e.length;d++)h=e.charAt(d),this.updatePasswordCharacterOptionsStatuses(r,h>="a"&&h<="z",h>="A"&&h<="Z",h>="0"&&h<="9",this.allowedNonAlphanumericCharacters.includes(h))}updatePasswordCharacterOptionsStatuses(e,r,h,d,f){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=h)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=d)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=f))}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let AuthImpl=class AuthImpl{constructor(e,r,h,d){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=h,this.config=d,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Subscription(this),this.idTokenSubscription=new Subscription(this),this.beforeStateQueue=new AuthMiddlewareQueue(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=k,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=d.sdkClientVersion,this._persistenceManagerAvailable=new Promise(e=>this._resolvePersistenceManagerAvailable=e)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=_getInstance(r)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await PersistenceUserManager.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(e){}await this.initializeCurrentUser(r),this.lastNotifiedUid=this.currentUser?.uid||null,this._deleted||(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;let e=await this.assertedPersistence.getCurrentUser();if(this.currentUser||e){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{let r=await getAccountInfo(this,{idToken:e}),h=await UserImpl._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(h)}catch(e){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",e),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if((0,f.rh)(this.app)){let e=this.app.settings.authIdToken;return e?new Promise(r=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(e).then(r,r))}):this.directlySetCurrentUser(null)}let r=await this.assertedPersistence.getCurrentUser(),h=r,d=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();let r=this.redirectUser?._redirectEventId,f=h?._redirectEventId,g=await this.tryRedirectSignIn(e);(!r||r===f)&&g?.user&&(h=g.user,d=!0)}if(!h)return this.directlySetCurrentUser(null);if(!h._redirectEventId){if(d)try{await this.beforeStateQueue.runMiddleware(h)}catch(e){h=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(e))}return h?this.reloadAndSetCurrentUserOrClear(h):this.directlySetCurrentUser(null)}return(_assert(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===h._redirectEventId)?this.directlySetCurrentUser(h):this.reloadAndSetCurrentUserOrClear(h)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(e){await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await _reloadWithoutSaving(e)}catch(e){if(e?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;let e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if((0,f.rh)(this.app))return Promise.reject(_serverAppCurrentUserOperationNotSupportedError(this));let r=e?(0,g.m9)(e):null;return r&&_assert(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&_assert(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return(0,f.rh)(this.app)?Promise.reject(_serverAppCurrentUserOperationNotSupportedError(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return(0,f.rh)(this.app)?Promise.reject(_serverAppCurrentUserOperationNotSupportedError(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(_getInstance(e))})}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();let r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){let e=await _getPasswordPolicy(this),r=new PasswordPolicyImpl(e);null===this.tenantId?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new g.LL("auth","Firebase",e())}onAuthStateChanged(e,r,h){return this.registerStateListener(this.authStateSubscription,e,r,h)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,h){return this.registerStateListener(this.idTokenSubscription,e,r,h)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{let h=this.onAuthStateChanged(()=>{h(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){let r=await this.currentUser.getIdToken(),h={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};null!=this.tenantId&&(h.tenantId=this.tenantId),await revokeToken(this,h)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,r){let h=await this.getOrInitRedirectPersistenceManager(r);return null===e?h.removeCurrentUser():h.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){let r=e&&_getInstance(e)||this._popupRedirectResolver;_assert(r,this,"argument-error"),this.redirectPersistenceManager=await PersistenceUserManager.create(this,[_getInstance(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return(this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e)?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,h,d){if(this._deleted)return()=>{};let f="function"==typeof r?r:r.next.bind(r),g=!1,b=this._isInitialized?Promise.resolve():this._initializationPromise;if(_assert(b,this,"internal-error"),b.then(()=>{g||f(this.currentUser)}),"function"==typeof r){let f=e.addObserver(r,h,d);return()=>{g=!0,f()}}{let h=e.addObserver(r);return()=>{g=!0,h()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return _assert(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=_getClientVersion(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){let e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);let r=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();r&&(e["X-Firebase-Client"]=r);let h=await this._getAppCheckToken();return h&&(e["X-Firebase-AppCheck"]=h),e}async _getAppCheckToken(){if((0,f.rh)(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&function(e,...r){M.logLevel<=b.in.WARN&&M.warn(`Auth (${f.Jn}): ${e}`,...r)}(`Error while retrieving App Check token: ${e.error}`),e?.token}};function _castAuth(e){return(0,g.m9)(e)}let Subscription=class Subscription{constructor(e){this.auth=e,this.observer=null,this.addObserver=(0,g.ne)(e=>this.observer=e)}get next(){return _assert(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let er={async loadJS(){throw Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function _generateCallbackName(e){return`__${e}${Math.floor(1e6*Math.random())}`}let MockGreCAPTCHATopLevel=class MockGreCAPTCHATopLevel{constructor(){this.enterprise=new MockGreCAPTCHA}ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}};let MockGreCAPTCHA=class MockGreCAPTCHA{ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}};let en="NO_RECAPTCHA";let RecaptchaEnterpriseVerifier=class RecaptchaEnterpriseVerifier{constructor(e){this.type="recaptcha-enterprise",this.auth=_castAuth(e)}async verify(e="verify",r=!1){async function retrieveSiteKey(e){if(!r){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise(async(r,h)=>{getRecaptchaConfig(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(d=>{if(void 0===d.recaptchaKey)h(Error("recaptcha Enterprise site key undefined"));else{let h=new RecaptchaConfig(d);return null==e.tenantId?e._agentRecaptchaConfig=h:e._tenantRecaptchaConfigs[e.tenantId]=h,r(h.siteKey)}}).catch(e=>{h(e)})})}function retrieveRecaptchaToken(r,h,d){let f=window.grecaptcha;isEnterprise(f)?f.enterprise.ready(()=>{f.enterprise.execute(r,{action:e}).then(e=>{h(e)}).catch(()=>{h(en)})}):d(Error("No reCAPTCHA enterprise script loaded."))}if(this.auth.settings.appVerificationDisabledForTesting){let e=new MockGreCAPTCHATopLevel;return e.execute("siteKey",{action:"verify"})}return new Promise((e,h)=>{retrieveSiteKey(this.auth).then(d=>{if(!r&&isEnterprise(window.grecaptcha))retrieveRecaptchaToken(d,e,h);else{var f;if("undefined"==typeof window){h(Error("RecaptchaVerifier is only supported in browser"));return}let r=er.recaptchaEnterpriseScript;0!==r.length&&(r+=d),(f=r,er.loadJS(f)).then(()=>{retrieveRecaptchaToken(d,e,h)}).catch(e=>{h(e)})}}).catch(e=>{h(e)})})}};async function injectRecaptchaFields(e,r,h,d=!1,f=!1){let g;let b=new RecaptchaEnterpriseVerifier(e);if(f)g=en;else try{g=await b.verify(h)}catch(e){g=await b.verify(h,!0)}let A={...r};if("mfaSmsEnrollment"===h||"mfaSmsSignIn"===h){if("phoneEnrollmentInfo"in A){let e=A.phoneEnrollmentInfo.phoneNumber,r=A.phoneEnrollmentInfo.recaptchaToken;Object.assign(A,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:r,captchaResponse:g,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in A){let e=A.phoneSignInInfo.recaptchaToken;Object.assign(A,{phoneSignInInfo:{recaptchaToken:e,captchaResponse:g,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return A}return d?Object.assign(A,{captchaResp:g}):Object.assign(A,{captchaResponse:g}),Object.assign(A,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(A,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),A}async function handleRecaptchaFlow(e,r,h,d,f){if("EMAIL_PASSWORD_PROVIDER"===f){if(!e._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER"))return d(e,r).catch(async f=>{if("auth/missing-recaptcha-token"!==f.code)return Promise.reject(f);{console.log(`${h} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let f=await injectRecaptchaFields(e,r,h,"getOobCode"===h);return d(e,f)}});{let f=await injectRecaptchaFields(e,r,h,"getOobCode"===h);return d(e,f)}}if("PHONE_PROVIDER"!==f)return Promise.reject(f+" provider is not supported.");if(e._getRecaptchaConfig()?.isProviderEnabled("PHONE_PROVIDER")){let f=await injectRecaptchaFields(e,r,h);return d(e,f).catch(async f=>{if(e._getRecaptchaConfig()?.getProviderEnforcementState("PHONE_PROVIDER")==="AUDIT"&&("auth/missing-recaptcha-token"===f.code||"auth/invalid-app-credential"===f.code)){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${h} flow.`);let f=await injectRecaptchaFields(e,r,h,!1,!0);return d(e,f)}return Promise.reject(f)})}{let f=await injectRecaptchaFields(e,r,h,!1,!0);return d(e,f)}}async function _initializeRecaptchaConfig(e){let r=_castAuth(e),h=await getRecaptchaConfig(r,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),d=new RecaptchaConfig(h);if(null==r.tenantId?r._agentRecaptchaConfig=d:r._tenantRecaptchaConfigs[r.tenantId]=d,d.isAnyProviderEnabled()){let e=new RecaptchaEnterpriseVerifier(r);e.verify()}}function extractProtocol(e){let r=e.indexOf(":");return r<0?"":e.substr(0,r+1)}function parsePort(e){if(!e)return null;let r=Number(e);return isNaN(r)?null:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let AuthCredential=class AuthCredential{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return debugFail("not implemented")}_getIdTokenResponse(e){return debugFail("not implemented")}_linkToIdToken(e,r){return debugFail("not implemented")}_getReauthenticationResolver(e){return debugFail("not implemented")}};async function linkEmailPassword(e,r){return _performApiRequest(e,"POST","/v1/accounts:signUp",r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function signInWithPassword(e,r){return _performSignInRequest(e,"POST","/v1/accounts:signInWithPassword",_addTidIfNecessary(e,r))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function signInWithEmailLink$1(e,r){return _performSignInRequest(e,"POST","/v1/accounts:signInWithEmailLink",_addTidIfNecessary(e,r))}async function signInWithEmailLinkForLinking(e,r){return _performSignInRequest(e,"POST","/v1/accounts:signInWithEmailLink",_addTidIfNecessary(e,r))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let EmailAuthCredential=class EmailAuthCredential extends AuthCredential{constructor(e,r,h,d=null){super("password",h),this._email=e,this._password=r,this._tenantId=d}static _fromEmailAndPassword(e,r){return new EmailAuthCredential(e,r,"password")}static _fromEmailAndCode(e,r,h=null){return new EmailAuthCredential(e,r,"emailLink",h)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let r="string"==typeof e?JSON.parse(e):e;if(r?.email&&r?.password){if("password"===r.signInMethod)return this._fromEmailAndPassword(r.email,r.password);if("emailLink"===r.signInMethod)return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":let r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return handleRecaptchaFlow(e,r,"signInWithPassword",signInWithPassword,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return signInWithEmailLink$1(e,{email:this._email,oobCode:this._password});default:_fail(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":let h={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return handleRecaptchaFlow(e,h,"signUpPassword",linkEmailPassword,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return signInWithEmailLinkForLinking(e,{idToken:r,email:this._email,oobCode:this._password});default:_fail(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function signInWithIdp(e,r){return _performSignInRequest(e,"POST","/v1/accounts:signInWithIdp",_addTidIfNecessary(e,r))}let OAuthCredential=class OAuthCredential extends AuthCredential{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){let r=new OAuthCredential(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):_fail("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){let r="string"==typeof e?JSON.parse(e):e,{providerId:h,signInMethod:d,...f}=r;if(!h||!d)return null;let g=new OAuthCredential(h,d);return g.idToken=f.idToken||void 0,g.accessToken=f.accessToken||void 0,g.secret=f.secret,g.nonce=f.nonce,g.pendingToken=f.pendingToken||null,g}_getIdTokenResponse(e){let r=this.buildRequest();return signInWithIdp(e,r)}_linkToIdToken(e,r){let h=this.buildRequest();return h.idToken=r,signInWithIdp(e,h)}_getReauthenticationResolver(e){let r=this.buildRequest();return r.autoCreate=!1,signInWithIdp(e,r)}buildRequest(){let e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=(0,g.xO)(r)}return e}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sendPhoneVerificationCode(e,r){return _performApiRequest(e,"POST","/v1/accounts:sendVerificationCode",_addTidIfNecessary(e,r))}async function signInWithPhoneNumber$1(e,r){return _performSignInRequest(e,"POST","/v1/accounts:signInWithPhoneNumber",_addTidIfNecessary(e,r))}async function linkWithPhoneNumber$1(e,r){let h=await _performSignInRequest(e,"POST","/v1/accounts:signInWithPhoneNumber",_addTidIfNecessary(e,r));if(h.temporaryProof)throw _makeTaggedError(e,"account-exists-with-different-credential",h);return h}let ei={USER_NOT_FOUND:"user-not-found"};async function verifyPhoneNumberForExisting(e,r){let h={...r,operation:"REAUTH"};return _performSignInRequest(e,"POST","/v1/accounts:signInWithPhoneNumber",_addTidIfNecessary(e,h),ei)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let PhoneAuthCredential=class PhoneAuthCredential extends AuthCredential{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,r){return new PhoneAuthCredential({verificationId:e,verificationCode:r})}static _fromTokenResponse(e,r){return new PhoneAuthCredential({phoneNumber:e,temporaryProof:r})}_getIdTokenResponse(e){return signInWithPhoneNumber$1(e,this._makeVerificationRequest())}_linkToIdToken(e,r){return linkWithPhoneNumber$1(e,{idToken:r,...this._makeVerificationRequest()})}_getReauthenticationResolver(e){return verifyPhoneNumberForExisting(e,this._makeVerificationRequest())}_makeVerificationRequest(){let{temporaryProof:e,phoneNumber:r,verificationId:h,verificationCode:d}=this.params;return e&&r?{temporaryProof:e,phoneNumber:r}:{sessionInfo:h,code:d}}toJSON(){let e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"==typeof e&&(e=JSON.parse(e));let{verificationId:r,verificationCode:h,phoneNumber:d,temporaryProof:f}=e;return h||r||d||f?new PhoneAuthCredential({verificationId:r,verificationCode:h,phoneNumber:d,temporaryProof:f}):null}};let ActionCodeURL=class ActionCodeURL{constructor(e){let r=(0,g.zd)((0,g.pd)(e)),h=r.apiKey??null,d=r.oobCode??null,f=/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(r.mode??null);_assert(h&&d&&f,"argument-error"),this.apiKey=h,this.operation=f,this.code=d,this.continueUrl=r.continueUrl??null,this.languageCode=r.lang??null,this.tenantId=r.tenantId??null}static parseLink(e){let r=function(e){let r=(0,g.zd)((0,g.pd)(e)).link,h=r?(0,g.zd)((0,g.pd)(r)).deep_link_id:null,d=(0,g.zd)((0,g.pd)(e)).deep_link_id,f=d?(0,g.zd)((0,g.pd)(d)).link:null;return f||d||h||r||e}(e);try{return new ActionCodeURL(r)}catch{return null}}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let EmailAuthProvider=class EmailAuthProvider{constructor(){this.providerId=EmailAuthProvider.PROVIDER_ID}static credential(e,r){return EmailAuthCredential._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){let h=ActionCodeURL.parseLink(r);return _assert(h,"argument-error"),EmailAuthCredential._fromEmailAndCode(e,h.code,h.tenantId)}};EmailAuthProvider.PROVIDER_ID="password",EmailAuthProvider.EMAIL_PASSWORD_SIGN_IN_METHOD="password",EmailAuthProvider.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let FederatedAuthProvider=class FederatedAuthProvider{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let BaseOAuthProvider=class BaseOAuthProvider extends FederatedAuthProvider{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let FacebookAuthProvider=class FacebookAuthProvider extends BaseOAuthProvider{constructor(){super("facebook.com")}static credential(e){return OAuthCredential._fromParams({providerId:FacebookAuthProvider.PROVIDER_ID,signInMethod:FacebookAuthProvider.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return FacebookAuthProvider.credentialFromTaggedObject(e)}static credentialFromError(e){return FacebookAuthProvider.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return FacebookAuthProvider.credential(e.oauthAccessToken)}catch{return null}}};FacebookAuthProvider.FACEBOOK_SIGN_IN_METHOD="facebook.com",FacebookAuthProvider.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let GoogleAuthProvider=class GoogleAuthProvider extends BaseOAuthProvider{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return OAuthCredential._fromParams({providerId:GoogleAuthProvider.PROVIDER_ID,signInMethod:GoogleAuthProvider.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return GoogleAuthProvider.credentialFromTaggedObject(e)}static credentialFromError(e){return GoogleAuthProvider.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthIdToken:r,oauthAccessToken:h}=e;if(!r&&!h)return null;try{return GoogleAuthProvider.credential(r,h)}catch{return null}}};GoogleAuthProvider.GOOGLE_SIGN_IN_METHOD="google.com",GoogleAuthProvider.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let GithubAuthProvider=class GithubAuthProvider extends BaseOAuthProvider{constructor(){super("github.com")}static credential(e){return OAuthCredential._fromParams({providerId:GithubAuthProvider.PROVIDER_ID,signInMethod:GithubAuthProvider.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return GithubAuthProvider.credentialFromTaggedObject(e)}static credentialFromError(e){return GithubAuthProvider.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return GithubAuthProvider.credential(e.oauthAccessToken)}catch{return null}}};GithubAuthProvider.GITHUB_SIGN_IN_METHOD="github.com",GithubAuthProvider.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let TwitterAuthProvider=class TwitterAuthProvider extends BaseOAuthProvider{constructor(){super("twitter.com")}static credential(e,r){return OAuthCredential._fromParams({providerId:TwitterAuthProvider.PROVIDER_ID,signInMethod:TwitterAuthProvider.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return TwitterAuthProvider.credentialFromTaggedObject(e)}static credentialFromError(e){return TwitterAuthProvider.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthAccessToken:r,oauthTokenSecret:h}=e;if(!r||!h)return null;try{return TwitterAuthProvider.credential(r,h)}catch{return null}}};TwitterAuthProvider.TWITTER_SIGN_IN_METHOD="twitter.com",TwitterAuthProvider.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let UserCredentialImpl=class UserCredentialImpl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,h,d=!1){let f=await UserImpl._fromIdTokenResponse(e,h,d),g=providerIdForResponse(h),b=new UserCredentialImpl({user:f,providerId:g,_tokenResponse:h,operationType:r});return b}static async _forOperation(e,r,h){await e._updateTokensIfNecessary(h,!0);let d=providerIdForResponse(h);return new UserCredentialImpl({user:e,providerId:d,_tokenResponse:h,operationType:r})}};function providerIdForResponse(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let MultiFactorError=class MultiFactorError extends g.ZR{constructor(e,r,h,d){super(r.code,r.message),this.operationType=h,this.user=d,Object.setPrototypeOf(this,MultiFactorError.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:h}}static _fromErrorAndOperation(e,r,h,d){return new MultiFactorError(e,r,h,d)}};function _processCredentialSavingMfaContextIfNecessary(e,r,h,d){let f="reauthenticate"===r?h._getReauthenticationResolver(e):h._getIdTokenResponse(e);return f.catch(h=>{if("auth/multi-factor-auth-required"===h.code)throw MultiFactorError._fromErrorAndOperation(e,h,r,d);throw h})}async function _link$1(e,r,h=!1){let d=await _logoutIfInvalidated(e,r._linkToIdToken(e.auth,await e.getIdToken()),h);return UserCredentialImpl._forOperation(e,"link",d)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _reauthenticate(e,r,h=!1){let{auth:d}=e;if((0,f.rh)(d.app))return Promise.reject(_serverAppCurrentUserOperationNotSupportedError(d));let g="reauthenticate";try{let f=await _logoutIfInvalidated(e,_processCredentialSavingMfaContextIfNecessary(d,g,r,e),h);_assert(f.idToken,d,"internal-error");let b=_parseToken(f.idToken);_assert(b,d,"internal-error");let{sub:A}=b;return _assert(e.uid===A,d,"user-mismatch"),UserCredentialImpl._forOperation(e,g,f)}catch(e){throw e?.code==="auth/user-not-found"&&_fail(d,"user-mismatch"),e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _signInWithCredential(e,r,h=!1){if((0,f.rh)(e.app))return Promise.reject(_serverAppCurrentUserOperationNotSupportedError(e));let d="signIn",g=await _processCredentialSavingMfaContextIfNecessary(e,d,r),b=await UserCredentialImpl._fromIdTokenResponse(e,d,g);return h||await e._updateCurrentUser(b.user),b}function onAuthStateChanged(e,r,h,d){return(0,g.m9)(e).onAuthStateChanged(r,h,d)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function startEnrollPhoneMfa(e,r){return _performApiRequest(e,"POST","/v2/accounts/mfaEnrollment:start",_addTidIfNecessary(e,r))}new WeakMap;let es="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let BrowserPersistenceClass=class BrowserPersistenceClass{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{if(!this.storage)return Promise.resolve(!1);return this.storage.setItem(es,"1"),this.storage.removeItem(es),Promise.resolve(!0)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){let r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};let BrowserLocalPersistence=class BrowserLocalPersistence extends BrowserPersistenceClass{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=_isMobileBrowser(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(let r of Object.keys(this.listeners)){let h=this.storage.getItem(r),d=this.localCache[r];h!==d&&e(r,d,h)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((e,r,h)=>{this.notifyListeners(e,h)});return}let h=e.key;r?this.detachListener():this.stopPolling();let triggerListeners=()=>{let e=this.storage.getItem(h);(r||this.localCache[h]!==e)&&this.notifyListeners(h,e)},d=this.storage.getItem(h);(0,g.w1)()&&10===document.documentMode&&d!==e.newValue&&e.newValue!==e.oldValue?setTimeout(triggerListeners,10):triggerListeners()}notifyListeners(e,r){this.localCache[e]=r;let h=this.listeners[e];if(h)for(let e of Array.from(h))e(r?JSON.parse(r):r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,h)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:h}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){let r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}};BrowserLocalPersistence.type="LOCAL";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let BrowserSessionPersistence=class BrowserSessionPersistence extends BrowserPersistenceClass{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}};BrowserSessionPersistence.type="SESSION";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Receiver=class Receiver{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){let r=this.receivers.find(r=>r.isListeningto(e));if(r)return r;let h=new Receiver(e);return this.receivers.push(h),h}isListeningto(e){return this.eventTarget===e}async handleEvent(e){let{eventId:r,eventType:h,data:d}=e.data,f=this.handlersMap[h];if(!f?.size)return;e.ports[0].postMessage({status:"ack",eventId:r,eventType:h});let g=Array.from(f).map(async r=>r(e.origin,d)),b=await Promise.all(g.map(async e=>{try{let r=await e;return{fulfilled:!0,value:r}}catch(e){return{fulfilled:!1,reason:e}}}));e.ports[0].postMessage({status:"done",eventId:r,eventType:h,response:b})}_subscribe(e,r){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),r&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _generateEventId(e="",r=10){let h="";for(let e=0;e<r;e++)h+=Math.floor(10*Math.random());return e+h}Receiver.receivers=[];/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Sender=class Sender{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,h=50){let d,f;let g="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!g)throw Error("connection_unavailable");return new Promise((b,A)=>{let k=_generateEventId("",20);g.port1.start();let M=setTimeout(()=>{A(Error("unsupported_event"))},h);f={messageChannel:g,onMessage(e){if(e.data.eventId===k)switch(e.data.status){case"ack":clearTimeout(M),d=setTimeout(()=>{A(Error("timeout"))},3e3);break;case"done":clearTimeout(d),b(e.data.response);break;default:clearTimeout(M),clearTimeout(d),A(Error("invalid_response"))}}},this.handlers.add(f),g.port1.addEventListener("message",f.onMessage),this.target.postMessage({eventType:e,eventId:k,data:r},[g.port2])}).finally(()=>{f&&this.removeMessageHandler(f)})}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _window(){return window}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _isWorker(){return void 0!==_window().WorkerGlobalScope&&"function"==typeof _window().importScripts}async function _getActiveServiceWorker(){if(!navigator?.serviceWorker)return null;try{let e=await navigator.serviceWorker.ready;return e.active}catch{return null}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eo="firebaseLocalStorageDb",ea="firebaseLocalStorage",el="fbase_key";let DBPromise=class DBPromise{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}};function getObjectStore(e,r){return e.transaction([ea],r?"readwrite":"readonly").objectStore(ea)}function _openDatabase(){let e=indexedDB.open(eo,1);return new Promise((r,h)=>{e.addEventListener("error",()=>{h(e.error)}),e.addEventListener("upgradeneeded",()=>{let r=e.result;try{r.createObjectStore(ea,{keyPath:el})}catch(e){h(e)}}),e.addEventListener("success",async()=>{let h=e.result;h.objectStoreNames.contains(ea)?r(h):(h.close(),await function(){let e=indexedDB.deleteDatabase(eo);return new DBPromise(e).toPromise()}(),r(await _openDatabase()))})})}async function _putObject(e,r,h){let d=getObjectStore(e,!0).put({[el]:r,value:h});return new DBPromise(d).toPromise()}async function getObject(e,r){let h=getObjectStore(e,!1).get(r),d=await new DBPromise(h).toPromise();return void 0===d?null:d.value}function _deleteObject(e,r){let h=getObjectStore(e,!0).delete(r);return new DBPromise(h).toPromise()}let IndexedDBLocalPersistence=class IndexedDBLocalPersistence{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db||(this.db=await _openDatabase()),this.db}async _withRetries(e){let r=0;for(;;)try{let r=await this._openDb();return await e(r)}catch(e){if(r++>3)throw e;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return _isWorker()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Receiver._getInstance(_isWorker()?self:null),this.receiver._subscribe("keyChanged",async(e,r)=>{let h=await this._poll();return{keyProcessed:h.includes(r.key)}}),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await _getActiveServiceWorker(),!this.activeServiceWorker)return;this.sender=new Sender(this.activeServiceWorker);let e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&(navigator?.serviceWorker?.controller||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;let e=await _openDatabase();return await _putObject(e,es,"1"),await _deleteObject(e,es),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(h=>_putObject(h,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){let r=await this._withRetries(r=>getObject(r,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>_deleteObject(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){let e=await this._withRetries(e=>{let r=getObjectStore(e,!1).getAll();return new DBPromise(r).toPromise()});if(!e||0!==this.pendingWrites)return[];let r=[],h=new Set;if(0!==e.length)for(let{fbase_key:d,value:f}of e)h.add(d),JSON.stringify(this.localCache[d])!==JSON.stringify(f)&&(this.notifyListeners(d,f),r.push(d));for(let e of Object.keys(this.localCache))this.localCache[e]&&!h.has(e)&&(this.notifyListeners(e,null),r.push(e));return r}notifyListeners(e,r){this.localCache[e]=r;let h=this.listeners[e];if(h)for(let e of Array.from(h))e(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function startSignInPhoneMfa(e,r){return _performApiRequest(e,"POST","/v2/accounts/mfaSignIn:start",_addTidIfNecessary(e,r))}IndexedDBLocalPersistence.type="LOCAL",_generateCallbackName("rcb"),new Delay(3e4,6e4);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eu="recaptcha";async function _verifyPhoneNumber(e,r,h){if(!e._getRecaptchaConfig())try{await _initializeRecaptchaConfig(e)}catch(e){console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let d;if(d="string"==typeof r?{phoneNumber:r}:r,"session"in d){let r=d.session;if("phoneNumber"in d){_assert("enroll"===r.type,e,"internal-error");let f={idToken:r.credential,phoneEnrollmentInfo:{phoneNumber:d.phoneNumber,clientType:"CLIENT_TYPE_WEB"}},startEnrollPhoneMfaActionCallback=async(e,r)=>{if(r.phoneEnrollmentInfo.captchaResponse===en){_assert(h?.type===eu,e,"argument-error");let d=await injectRecaptchaV2Token(e,r,h);return startEnrollPhoneMfa(e,d)}return startEnrollPhoneMfa(e,r)},g=handleRecaptchaFlow(e,f,"mfaSmsEnrollment",startEnrollPhoneMfaActionCallback,"PHONE_PROVIDER"),b=await g.catch(e=>Promise.reject(e));return b.phoneSessionInfo.sessionInfo}{_assert("signin"===r.type,e,"internal-error");let f=d.multiFactorHint?.uid||d.multiFactorUid;_assert(f,e,"missing-multi-factor-info");let g={mfaPendingCredential:r.credential,mfaEnrollmentId:f,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}},startSignInPhoneMfaActionCallback=async(e,r)=>{if(r.phoneSignInInfo.captchaResponse===en){_assert(h?.type===eu,e,"argument-error");let d=await injectRecaptchaV2Token(e,r,h);return startSignInPhoneMfa(e,d)}return startSignInPhoneMfa(e,r)},b=handleRecaptchaFlow(e,g,"mfaSmsSignIn",startSignInPhoneMfaActionCallback,"PHONE_PROVIDER"),A=await b.catch(e=>Promise.reject(e));return A.phoneResponseInfo.sessionInfo}}{let r={phoneNumber:d.phoneNumber,clientType:"CLIENT_TYPE_WEB"},sendPhoneVerificationCodeActionCallback=async(e,r)=>{if(r.captchaResponse===en){_assert(h?.type===eu,e,"argument-error");let d=await injectRecaptchaV2Token(e,r,h);return sendPhoneVerificationCode(e,d)}return sendPhoneVerificationCode(e,r)},f=handleRecaptchaFlow(e,r,"sendVerificationCode",sendPhoneVerificationCodeActionCallback,"PHONE_PROVIDER"),g=await f.catch(e=>Promise.reject(e));return g.sessionInfo}}finally{h?._reset()}}async function injectRecaptchaV2Token(e,r,h){_assert(h.type===eu,e,"argument-error");let d=await h.verify();_assert("string"==typeof d,e,"argument-error");let f={...r};if("phoneEnrollmentInfo"in f){let e=f.phoneEnrollmentInfo.phoneNumber,r=f.phoneEnrollmentInfo.captchaResponse,h=f.phoneEnrollmentInfo.clientType,g=f.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(f,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:d,captchaResponse:r,clientType:h,recaptchaVersion:g}}),f}if(!("phoneSignInInfo"in f))return Object.assign(f,{recaptchaToken:d}),f;{let e=f.phoneSignInInfo.captchaResponse,r=f.phoneSignInInfo.clientType,h=f.phoneSignInInfo.recaptchaVersion;return Object.assign(f,{phoneSignInInfo:{recaptchaToken:d,captchaResponse:e,clientType:r,recaptchaVersion:h}}),f}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let PhoneAuthProvider=class PhoneAuthProvider{constructor(e){this.providerId=PhoneAuthProvider.PROVIDER_ID,this.auth=_castAuth(e)}verifyPhoneNumber(e,r){return _verifyPhoneNumber(this.auth,e,(0,g.m9)(r))}static credential(e,r){return PhoneAuthCredential._fromVerification(e,r)}static credentialFromResult(e){return PhoneAuthProvider.credentialFromTaggedObject(e)}static credentialFromError(e){return PhoneAuthProvider.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{phoneNumber:r,temporaryProof:h}=e;return r&&h?PhoneAuthCredential._fromTokenResponse(r,h):null}};PhoneAuthProvider.PROVIDER_ID="phone",PhoneAuthProvider.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let IdpCredential=class IdpCredential extends AuthCredential{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return signInWithIdp(e,this._buildIdpRequest())}_linkToIdToken(e,r){return signInWithIdp(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return signInWithIdp(e,this._buildIdpRequest())}_buildIdpRequest(e){let r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}};function _signIn(e){return _signInWithCredential(e.auth,new IdpCredential(e),e.bypassAuthState)}function _reauth(e){let{auth:r,user:h}=e;return _assert(h,r,"internal-error"),_reauthenticate(h,new IdpCredential(e),e.bypassAuthState)}async function _link(e){let{auth:r,user:h}=e;return _assert(h,r,"internal-error"),_link$1(h,new IdpCredential(e),e.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let AbstractPopupRedirectOperation=class AbstractPopupRedirectOperation{constructor(e,r,h,d,f=!1){this.auth=e,this.resolver=h,this.user=d,this.bypassAuthState=f,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(e){this.reject(e)}})}async onAuthEvent(e){let{urlResponse:r,sessionId:h,postBody:d,tenantId:f,error:g,type:b}=e;if(g){this.reject(g);return}let A={auth:this.auth,requestUri:r,sessionId:h,tenantId:f||void 0,postBody:d||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(b)(A))}catch(e){this.reject(e)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return _signIn;case"linkViaPopup":case"linkViaRedirect":return _link;case"reauthViaPopup":case"reauthViaRedirect":return _reauth;default:_fail(this.auth,"internal-error")}}resolve(e){this.pendingPromise||debugFail("Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){this.pendingPromise||debugFail("Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eh=new Delay(2e3,1e4);let PopupOperation=class PopupOperation extends AbstractPopupRedirectOperation{constructor(e,r,h,d,f){super(e,r,d,f),this.provider=h,this.authWindow=null,this.pollId=null,PopupOperation.currentPopupAction&&PopupOperation.currentPopupAction.cancel(),PopupOperation.currentPopupAction=this}async executeNotNull(){let e=await this.execute();return _assert(e,this.auth,"internal-error"),e}async onExecution(){1===this.filter.length||debugFail("Popup operations only handle one event");let e=_generateEventId();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(_createError(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(_createError(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,PopupOperation.currentPopupAction=null}pollUserCancellation(){let poll=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(_createError(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(poll,eh.get())};poll()}};PopupOperation.currentPopupAction=null;let ed=new Map;let RedirectAction=class RedirectAction extends AbstractPopupRedirectOperation{constructor(e,r,h=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,h),this.eventId=null}async execute(){let e=ed.get(this.auth._key());if(!e){try{let r=await _getAndClearPendingRedirectStatus(this.resolver,this.auth),h=r?await super.execute():null;e=()=>Promise.resolve(h)}catch(r){e=()=>Promise.reject(r)}ed.set(this.auth._key(),e)}return this.bypassAuthState||ed.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"===e.type){this.resolve(null);return}if(e.eventId){let r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}};async function _getAndClearPendingRedirectStatus(e,r){let h=_persistenceKeyName("pendingRedirect",r.config.apiKey,r.name),d=_getInstance(e._redirectPersistence);if(!await d._isAvailable())return!1;let f=await d._get(h)==="true";return await d._remove(h),f}function _overrideRedirectResult(e,r){ed.set(e._key(),r)}async function _getRedirectResult(e,r,h=!1){if((0,f.rh)(e.app))return Promise.reject(_serverAppCurrentUserOperationNotSupportedError(e));let d=_castAuth(e),g=r?_getInstance(r):(_assert(d._popupRedirectResolver,d,"argument-error"),d._popupRedirectResolver),b=new RedirectAction(d,g,h),A=await b.execute();return A&&!h&&(delete A.user._redirectEventId,await d._persistUserIfCurrent(A.user),await d._setRedirectUser(null,r)),A}let AuthEventManager=class AuthEventManager{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(h=>{this.isEventForConsumer(e,h)&&(r=!0,this.sendToConsumer(e,h),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return isNullRedirectEvent(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){if(e.error&&!isNullRedirectEvent(e)){let h=e.error.code?.split("auth/")[1]||"internal-error";r.onError(_createError(this.auth,h))}else r.onAuthEvent(e)}isEventForConsumer(e,r){let h=null===r.eventId||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&h}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(eventUid(e))}saveEventToCache(e){this.cachedEventUids.add(eventUid(e)),this.lastProcessedEventTime=Date.now()}};function eventUid(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function isNullRedirectEvent({type:e,error:r}){return"unknown"===e&&r?.code==="auth/no-auth-event"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _getProjectConfig(e,r={}){return _performApiRequest(e,"GET","/v1/projects",r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let em=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,ef=/^https?/;async function _validateOrigin(e){if(e.config.emulator)return;let{authorizedDomains:r}=await _getProjectConfig(e);for(let e of r)try{if(function(e){let r=_getCurrentUrl(),{protocol:h,hostname:d}=new URL(r);if(e.startsWith("chrome-extension://")){let f=new URL(e);return""===f.hostname&&""===d?"chrome-extension:"===h&&e.replace("chrome-extension://","")===r.replace("chrome-extension://",""):"chrome-extension:"===h&&f.hostname===d}if(!ef.test(h))return!1;if(em.test(e))return d===e;let f=e.replace(/\./g,"\\."),g=RegExp("^(.+\\."+f+"|"+f+")$","i");return g.test(d)}(e))return}catch{}_fail(e,"unauthorized-domain")}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ep=new Delay(3e4,6e4);function resetUnloadedGapiModules(){let e=_window().___jsl;if(e?.H){for(let r of Object.keys(e.H))if(e.H[r].r=e.H[r].r||[],e.H[r].L=e.H[r].L||[],e.H[r].r=[...e.H[r].L],e.CP)for(let r=0;r<e.CP.length;r++)e.CP[r]=null}}let e_=null,eg=new Delay(5e3,15e3),ey={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},ev=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);async function _openIframe(e){let r=await (e_=e_||new Promise((r,h)=>{function loadGapiIframe(){resetUnloadedGapiModules(),gapi.load("gapi.iframes",{callback:()=>{r(gapi.iframes.getContext())},ontimeout:()=>{resetUnloadedGapiModules(),h(_createError(e,"network-request-failed"))},timeout:ep.get()})}if(_window().gapi?.iframes?.Iframe)r(gapi.iframes.getContext());else if(_window().gapi?.load)loadGapiIframe();else{var d;let r=_generateCallbackName("iframefcb");return _window()[r]=()=>{gapi.load?loadGapiIframe():h(_createError(e,"network-request-failed"))},(d=`${er.gapiScript}?onload=${r}`,er.loadJS(d)).catch(e=>h(e))}}).catch(e=>{throw e_=null,e})),h=_window().gapi;return _assert(h,e,"internal-error"),r.open({where:document.body,url:function(e){let r=e.config;_assert(r.authDomain,e,"auth-domain-config-required");let h=r.emulator?_emulatorUrl(r,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,d={apiKey:r.apiKey,appName:e.name,v:f.Jn},b=ev.get(e.config.apiHost);b&&(d.eid=b);let A=e._getFrameworks();return A.length&&(d.fw=A.join(",")),`${h}?${(0,g.xO)(d).slice(1)}`}(e),messageHandlersFilter:h.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:ey,dontclear:!0},r=>new Promise(async(h,d)=>{await r.restyle({setHideOnLeave:!1});let f=_createError(e,"network-request-failed"),g=_window().setTimeout(()=>{d(f)},eg.get());function clearTimerAndResolve(){_window().clearTimeout(g),h(r)}r.ping(clearTimerAndResolve).then(clearTimerAndResolve,()=>{d(f)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eE={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};let AuthPopup=class AuthPopup{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}};let eT=encodeURIComponent("fac");async function _getRedirectUrl(e,r,h,d,b,A){_assert(e.config.authDomain,e,"auth-domain-config-required"),_assert(e.config.apiKey,e,"invalid-api-key");let k={apiKey:e.config.apiKey,appName:e.name,authType:h,redirectUrl:d,v:f.Jn,eventId:b};if(r instanceof FederatedAuthProvider)for(let[h,d]of(r.setDefaultLanguage(e.languageCode),k.providerId=r.providerId||"",(0,g.xb)(r.getCustomParameters())||(k.customParameters=JSON.stringify(r.getCustomParameters())),Object.entries(A||{})))k[h]=d;if(r instanceof BaseOAuthProvider){let e=r.getScopes().filter(e=>""!==e);e.length>0&&(k.scopes=e.join(","))}for(let r of(e.tenantId&&(k.tid=e.tenantId),Object.keys(k)))void 0===k[r]&&delete k[r];let M=await e._getAppCheckToken(),j=M?`#${eT}=${encodeURIComponent(M)}`:"";return`${function({config:e}){return e.emulator?_emulatorUrl(e,"emulator/auth/handler"):`https://${e.authDomain}/__/auth/handler`}(e)}?${(0,g.xO)(k).slice(1)}${j}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eI="webStorageSupport",eP=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=BrowserSessionPersistence,this._completeRedirectFn=_getRedirectResult,this._overrideRedirectResult=_overrideRedirectResult}async _openPopup(e,r,h,d){this.eventManagers[e._key()]?.manager||debugFail("_initialize() not called before _openPopup()");let f=await _getRedirectUrl(e,r,h,_getCurrentUrl(),d);return function(e,r,h,d=500,f=600){let b=Math.max((window.screen.availHeight-f)/2,0).toString(),A=Math.max((window.screen.availWidth-d)/2,0).toString(),k="",M={...eE,width:d.toString(),height:f.toString(),top:b,left:A},j=(0,g.z$)().toLowerCase();h&&(k=_isChromeIOS(j)?"_blank":h),_isFirefox(j)&&(r=r||"http://localhost",M.scrollbars="yes");let q=Object.entries(M).reduce((e,[r,h])=>`${e}${r}=${h},`,"");if(function(e=(0,g.z$)()){return _isIOS(e)&&!!window.navigator?.standalone}(j)&&"_self"!==k)return function(e,r){let h=document.createElement("a");h.href=e,h.target=r;let d=document.createEvent("MouseEvent");d.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),h.dispatchEvent(d)}(r||"",k),new AuthPopup(null);let ee=window.open(r||"",k,q);_assert(ee,e,"popup-blocked");try{ee.focus()}catch(e){}return new AuthPopup(ee)}(e,f,_generateEventId())}async _openRedirect(e,r,h,d){await this._originValidation(e);let f=await _getRedirectUrl(e,r,h,_getCurrentUrl(),d);return _window().location.href=f,new Promise(()=>{})}_initialize(e){let r=e._key();if(this.eventManagers[r]){let{manager:e,promise:h}=this.eventManagers[r];return e?Promise.resolve(e):(h||debugFail("If manager is not set, promise should be"),h)}let h=this.initAndGetManager(e);return this.eventManagers[r]={promise:h},h.catch(()=>{delete this.eventManagers[r]}),h}async initAndGetManager(e){let r=await _openIframe(e),h=new AuthEventManager(e);return r.register("authEvent",r=>{_assert(r?.authEvent,e,"invalid-auth-event");let d=h.onEvent(r.authEvent);return{status:d?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:h},this.iframes[e._key()]=r,h}_isIframeWebStorageSupported(e,r){let h=this.iframes[e._key()];h.send(eI,{type:eI},h=>{let d=h?.[0]?.[eI];void 0!==d&&r(!!d),_fail(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=_validateOrigin(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return _isMobileBrowser()||_isSafari()||_isIOS()}};let MultiFactorAssertionImpl=class MultiFactorAssertionImpl{constructor(e){this.factorId=e}_process(e,r,h){switch(r.type){case"enroll":return this._finalizeEnroll(e,r.credential,h);case"signin":return this._finalizeSignIn(e,r.credential);default:return debugFail("unexpected MultiFactorSessionType")}}};let PhoneMultiFactorAssertionImpl=class PhoneMultiFactorAssertionImpl extends MultiFactorAssertionImpl{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new PhoneMultiFactorAssertionImpl(e)}_finalizeEnroll(e,r,h){return _performApiRequest(e,"POST","/v2/accounts/mfaEnrollment:finalize",_addTidIfNecessary(e,{idToken:r,displayName:h,phoneVerificationInfo:this.credential._makeVerificationRequest()}))}_finalizeSignIn(e,r){return _performApiRequest(e,"POST","/v2/accounts/mfaSignIn:finalize",_addTidIfNecessary(e,{mfaPendingCredential:r,phoneVerificationInfo:this.credential._makeVerificationRequest()}))}};let TotpMultiFactorAssertionImpl=class TotpMultiFactorAssertionImpl extends MultiFactorAssertionImpl{constructor(e,r,h){super("totp"),this.otp=e,this.enrollmentId=r,this.secret=h}static _fromSecret(e,r){return new TotpMultiFactorAssertionImpl(r,void 0,e)}static _fromEnrollmentId(e,r){return new TotpMultiFactorAssertionImpl(r,e)}async _finalizeEnroll(e,r,h){return _assert(void 0!==this.secret,e,"argument-error"),_performApiRequest(e,"POST","/v2/accounts/mfaEnrollment:finalize",_addTidIfNecessary(e,{idToken:r,displayName:h,totpVerificationInfo:this.secret._makeTotpVerificationInfo(this.otp)}))}async _finalizeSignIn(e,r){_assert(void 0!==this.enrollmentId&&void 0!==this.otp,e,"argument-error");let h={verificationCode:this.otp};return _performApiRequest(e,"POST","/v2/accounts/mfaSignIn:finalize",_addTidIfNecessary(e,{mfaPendingCredential:r,mfaEnrollmentId:this.enrollmentId,totpVerificationInfo:h}))}};let TotpSecret=class TotpSecret{constructor(e,r,h,d,f,g,b){this.sessionInfo=g,this.auth=b,this.secretKey=e,this.hashingAlgorithm=r,this.codeLength=h,this.codeIntervalSeconds=d,this.enrollmentCompletionDeadline=f}static _fromStartTotpMfaEnrollmentResponse(e,r){return new TotpSecret(e.totpSessionInfo.sharedSecretKey,e.totpSessionInfo.hashingAlgorithm,e.totpSessionInfo.verificationCodeLength,e.totpSessionInfo.periodSec,new Date(e.totpSessionInfo.finalizeEnrollmentTime).toUTCString(),e.totpSessionInfo.sessionInfo,r)}_makeTotpVerificationInfo(e){return{sessionInfo:this.sessionInfo,verificationCode:e}}generateQrCodeUrl(e,r){let h=!1;return(_isEmptyString(e)||_isEmptyString(r))&&(h=!0),h&&(_isEmptyString(e)&&(e=this.auth.currentUser?.email||"unknownuser"),_isEmptyString(r)&&(r=this.auth.name)),`otpauth://totp/${r}:${e}?secret=${this.secretKey}&issuer=${r}&algorithm=${this.hashingAlgorithm}&digits=${this.codeLength}`}};function _isEmptyString(e){return void 0===e||e?.length===0}var eA="@firebase/auth",eR="1.12.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let AuthInterop=class AuthInterop{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;let r=await this.auth.currentUser.getIdToken(e);return{accessToken:r}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let r=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){_assert(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};let ew=(0,g.Pz)("authIdTokenMaxAge")||300,eV=null,mintCookieFactory=e=>async r=>{let h=r&&await r.getIdTokenResult(),d=h&&(new Date().getTime()-Date.parse(h.issuedAtTime))/1e3;if(d&&d>ew)return;let f=h?.token;eV!==f&&(eV=f,await fetch(e,{method:f?"POST":"DELETE",headers:f?{Authorization:`Bearer ${f}`}:{}}))};function getAuth(e=(0,f.Mq)()){let r=(0,f.qX)(e,"auth");if(r.isInitialized())return r.getImmediate();let h=/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function(e,r){let h=(0,f.qX)(e,"auth");if(h.isInitialized()){let e=h.getImmediate(),d=h.getOptions();if((0,g.vZ)(d,r??{}))return e;_fail(e,"already-initialized")}let d=h.initialize({options:r});return d}(e,{popupRedirectResolver:eP,persistence:[IndexedDBLocalPersistence,BrowserLocalPersistence,BrowserSessionPersistence]}),d=(0,g.Pz)("authTokenSyncURL");if(d&&"boolean"==typeof isSecureContext&&isSecureContext){let e=new URL(d,location.origin);if(location.origin===e.origin){let r=mintCookieFactory(e.toString());(0,g.m9)(h).beforeAuthStateChanged(r,()=>r(h.currentUser)),(0,g.m9)(h).onIdTokenChanged(e=>r(e),void 0,void 0)}}let b=(0,g.q4)("auth");return b&&function(e,r,h){let d=_castAuth(e);_assert(/^https?:\/\//.test(r),d,"invalid-emulator-scheme");let f=extractProtocol(r),{host:b,port:A}=function(e){let r=extractProtocol(e),h=/(\/\/)?([^?#/]+)/.exec(e.substr(r.length));if(!h)return{host:"",port:null};let d=h[2].split("@").pop()||"",f=/^(\[[^\]]+\])(:|$)/.exec(d);if(f){let e=f[1];return{host:e,port:parsePort(d.substr(e.length+1))}}{let[e,r]=d.split(":");return{host:e,port:parsePort(r)}}}(r),k=null===A?"":`:${A}`,M={url:`${f}//${b}${k}/`},j=Object.freeze({host:b,port:A,protocol:f.replace(":",""),options:Object.freeze({disableWarnings:!1})});if(!d._canInitEmulator){_assert(d.config.emulator&&d.emulatorConfig,d,"emulator-config-failed"),_assert((0,g.vZ)(M,d.config.emulator)&&(0,g.vZ)(j,d.emulatorConfig),d,"emulator-config-failed");return}d.config.emulator=M,d.emulatorConfig=j,d.settings.appVerificationDisabledForTesting=!0,(0,g.Xx)(b)?((0,g.Uo)(`${f}//${b}${k}`),(0,g.dp)("Auth",!0)):function(){function attachBanner(){let e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",attachBanner):attachBanner())}()}(h,`http://${b}`),h}er={loadJS:e=>new Promise((r,h)=>{let d=document.createElement("script");d.setAttribute("src",e),d.onload=r,d.onerror=e=>{let r=_createError("internal-error");r.customData=e,h(r)},d.type="text/javascript",d.charset="UTF-8",(document.getElementsByTagName("head")?.[0]??document).appendChild(d)}),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},d="Browser",(0,f.Xd)(new A.wA("auth",(e,{options:r})=>{let h=e.getProvider("app").getImmediate(),f=e.getProvider("heartbeat"),g=e.getProvider("app-check-internal"),{apiKey:b,authDomain:A}=h.options;_assert(b&&!b.includes(":"),"invalid-api-key",{appName:h.name});let k={apiKey:b,authDomain:A,clientPlatform:d,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:_getClientVersion(d)},M=new AuthImpl(h,f,g,k);return function(e,r){let h=r?.persistence||[],d=(Array.isArray(h)?h:[h]).map(_getInstance);r?.errorMap&&e._updateErrorMap(r.errorMap),e._initializeWithPersistence(d,r?.popupRedirectResolver)}(M,r),M},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,h)=>{let d=e.getProvider("auth-internal");d.initialize()})),(0,f.Xd)(new A.wA("auth-internal",e=>{let r=_castAuth(e.getProvider("auth").getImmediate());return new AuthInterop(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,f.KN)(eA,eR,/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(d)),(0,f.KN)(eA,eR,"esm2020")},1034:function(e,r,h){"use strict";h.d(r,{vr:function(){return arrayUnion},hJ:function(){return collection},JU:function(){return common_341bda9b_esm_doc},QT:function(){return getDoc},PL:function(){return getDocs},ad:function(){return getFirestore},Xo:function(){return orderBy},IO:function(){return query},Bt:function(){return serverTimestamp},pl:function(){return setDoc},r7:function(){return updateDoc},ar:function(){return where}});var d,f,g,b,A,k,M,j,q,ee,et,er,en,ei,es=h(6771),eo=h(75),ea=h(9711),el="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},eu={};(function(){function m(){this.blockSize=-1,this.blockSize=64,this.g=[,,,,],this.C=Array(this.blockSize),this.o=this.h=0,this.u()}function n(e,r,h){h||(h=0);let d=Array(16);if("string"==typeof r)for(var f=0;f<16;++f)d[f]=r.charCodeAt(h++)|r.charCodeAt(h++)<<8|r.charCodeAt(h++)<<16|r.charCodeAt(h++)<<24;else for(f=0;f<16;++f)d[f]=r[h++]|r[h++]<<8|r[h++]<<16|r[h++]<<24;r=e.g[0],h=e.g[1],f=e.g[2];let g=e.g[3],b;b=r+(g^h&(f^g))+d[0]+3614090360&4294967295,b=g+(f^(r=h+(b<<7&4294967295|b>>>25))&(h^f))+d[1]+3905402710&4294967295,b=f+(h^(g=r+(b<<12&4294967295|b>>>20))&(r^h))+d[2]+606105819&4294967295,b=h+(r^(f=g+(b<<17&4294967295|b>>>15))&(g^r))+d[3]+3250441966&4294967295,b=r+(g^(h=f+(b<<22&4294967295|b>>>10))&(f^g))+d[4]+4118548399&4294967295,b=g+(f^(r=h+(b<<7&4294967295|b>>>25))&(h^f))+d[5]+1200080426&4294967295,b=f+(h^(g=r+(b<<12&4294967295|b>>>20))&(r^h))+d[6]+2821735955&4294967295,b=h+(r^(f=g+(b<<17&4294967295|b>>>15))&(g^r))+d[7]+4249261313&4294967295,b=r+(g^(h=f+(b<<22&4294967295|b>>>10))&(f^g))+d[8]+1770035416&4294967295,b=g+(f^(r=h+(b<<7&4294967295|b>>>25))&(h^f))+d[9]+2336552879&4294967295,b=f+(h^(g=r+(b<<12&4294967295|b>>>20))&(r^h))+d[10]+4294925233&4294967295,b=h+(r^(f=g+(b<<17&4294967295|b>>>15))&(g^r))+d[11]+2304563134&4294967295,b=r+(g^(h=f+(b<<22&4294967295|b>>>10))&(f^g))+d[12]+1804603682&4294967295,b=g+(f^(r=h+(b<<7&4294967295|b>>>25))&(h^f))+d[13]+4254626195&4294967295,b=f+(h^(g=r+(b<<12&4294967295|b>>>20))&(r^h))+d[14]+2792965006&4294967295,b=h+(r^(f=g+(b<<17&4294967295|b>>>15))&(g^r))+d[15]+1236535329&4294967295,h=f+(b<<22&4294967295|b>>>10),b=r+(f^g&(h^f))+d[1]+4129170786&4294967295,r=h+(b<<5&4294967295|b>>>27),b=g+(h^f&(r^h))+d[6]+3225465664&4294967295,g=r+(b<<9&4294967295|b>>>23),b=f+(r^h&(g^r))+d[11]+643717713&4294967295,f=g+(b<<14&4294967295|b>>>18),b=h+(g^r&(f^g))+d[0]+3921069994&4294967295,h=f+(b<<20&4294967295|b>>>12),b=r+(f^g&(h^f))+d[5]+3593408605&4294967295,r=h+(b<<5&4294967295|b>>>27),b=g+(h^f&(r^h))+d[10]+38016083&4294967295,g=r+(b<<9&4294967295|b>>>23),b=f+(r^h&(g^r))+d[15]+3634488961&4294967295,f=g+(b<<14&4294967295|b>>>18),b=h+(g^r&(f^g))+d[4]+3889429448&4294967295,h=f+(b<<20&4294967295|b>>>12),b=r+(f^g&(h^f))+d[9]+568446438&4294967295,r=h+(b<<5&4294967295|b>>>27),b=g+(h^f&(r^h))+d[14]+3275163606&4294967295,g=r+(b<<9&4294967295|b>>>23),b=f+(r^h&(g^r))+d[3]+4107603335&4294967295,f=g+(b<<14&4294967295|b>>>18),b=h+(g^r&(f^g))+d[8]+1163531501&4294967295,h=f+(b<<20&4294967295|b>>>12),b=r+(f^g&(h^f))+d[13]+2850285829&4294967295,r=h+(b<<5&4294967295|b>>>27),b=g+(h^f&(r^h))+d[2]+4243563512&4294967295,g=r+(b<<9&4294967295|b>>>23),b=f+(r^h&(g^r))+d[7]+1735328473&4294967295,f=g+(b<<14&4294967295|b>>>18),b=h+(g^r&(f^g))+d[12]+2368359562&4294967295,b=r+((h=f+(b<<20&4294967295|b>>>12))^f^g)+d[5]+4294588738&4294967295,b=g+((r=h+(b<<4&4294967295|b>>>28))^h^f)+d[8]+2272392833&4294967295,b=f+((g=r+(b<<11&4294967295|b>>>21))^r^h)+d[11]+1839030562&4294967295,b=h+((f=g+(b<<16&4294967295|b>>>16))^g^r)+d[14]+4259657740&4294967295,b=r+((h=f+(b<<23&4294967295|b>>>9))^f^g)+d[1]+2763975236&4294967295,b=g+((r=h+(b<<4&4294967295|b>>>28))^h^f)+d[4]+1272893353&4294967295,b=f+((g=r+(b<<11&4294967295|b>>>21))^r^h)+d[7]+4139469664&4294967295,b=h+((f=g+(b<<16&4294967295|b>>>16))^g^r)+d[10]+3200236656&4294967295,b=r+((h=f+(b<<23&4294967295|b>>>9))^f^g)+d[13]+681279174&4294967295,b=g+((r=h+(b<<4&4294967295|b>>>28))^h^f)+d[0]+3936430074&4294967295,b=f+((g=r+(b<<11&4294967295|b>>>21))^r^h)+d[3]+3572445317&4294967295,b=h+((f=g+(b<<16&4294967295|b>>>16))^g^r)+d[6]+76029189&4294967295,b=r+((h=f+(b<<23&4294967295|b>>>9))^f^g)+d[9]+3654602809&4294967295,b=g+((r=h+(b<<4&4294967295|b>>>28))^h^f)+d[12]+3873151461&4294967295,b=f+((g=r+(b<<11&4294967295|b>>>21))^r^h)+d[15]+530742520&4294967295,b=h+((f=g+(b<<16&4294967295|b>>>16))^g^r)+d[2]+3299628645&4294967295,h=f+(b<<23&4294967295|b>>>9),b=r+(f^(h|~g))+d[0]+4096336452&4294967295,r=h+(b<<6&4294967295|b>>>26),b=g+(h^(r|~f))+d[7]+1126891415&4294967295,g=r+(b<<10&4294967295|b>>>22),b=f+(r^(g|~h))+d[14]+2878612391&4294967295,f=g+(b<<15&4294967295|b>>>17),b=h+(g^(f|~r))+d[5]+4237533241&4294967295,h=f+(b<<21&4294967295|b>>>11),b=r+(f^(h|~g))+d[12]+1700485571&4294967295,r=h+(b<<6&4294967295|b>>>26),b=g+(h^(r|~f))+d[3]+2399980690&4294967295,g=r+(b<<10&4294967295|b>>>22),b=f+(r^(g|~h))+d[10]+4293915773&4294967295,f=g+(b<<15&4294967295|b>>>17),b=h+(g^(f|~r))+d[1]+2240044497&4294967295,h=f+(b<<21&4294967295|b>>>11),b=r+(f^(h|~g))+d[8]+1873313359&4294967295,r=h+(b<<6&4294967295|b>>>26),b=g+(h^(r|~f))+d[15]+4264355552&4294967295,g=r+(b<<10&4294967295|b>>>22),b=f+(r^(g|~h))+d[6]+2734768916&4294967295,f=g+(b<<15&4294967295|b>>>17),b=h+(g^(f|~r))+d[13]+1309151649&4294967295,h=f+(b<<21&4294967295|b>>>11),b=r+(f^(h|~g))+d[4]+4149444226&4294967295,r=h+(b<<6&4294967295|b>>>26),b=g+(h^(r|~f))+d[11]+3174756917&4294967295,g=r+(b<<10&4294967295|b>>>22),b=f+(r^(g|~h))+d[2]+718787259&4294967295,f=g+(b<<15&4294967295|b>>>17),b=h+(g^(f|~r))+d[9]+3951481745&4294967295,e.g[0]=e.g[0]+r&4294967295,e.g[1]=e.g[1]+(f+(b<<21&4294967295|b>>>11))&4294967295,e.g[2]=e.g[2]+f&4294967295,e.g[3]=e.g[3]+g&4294967295}function t(e,r){this.h=r;let h=[],d=!0;for(let f=e.length-1;f>=0;f--){let g=0|e[f];d&&g==r||(h[f]=g,d=!1)}this.g=h}!function(e,r){function c(){}c.prototype=r.prototype,e.F=r.prototype,e.prototype=new c,e.prototype.constructor=e,e.D=function(e,h,d){for(var f=Array(arguments.length-2),g=2;g<arguments.length;g++)f[g-2]=arguments[g];return r.prototype[h].apply(e,f)}}(m,function(){this.blockSize=-1}),m.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},m.prototype.v=function(e,r){void 0===r&&(r=e.length);let h=r-this.blockSize,d=this.C,f=this.h,g=0;for(;g<r;){if(0==f)for(;g<=h;)n(this,e,g),g+=this.blockSize;if("string"==typeof e){for(;g<r;)if(d[f++]=e.charCodeAt(g++),f==this.blockSize){n(this,d),f=0;break}}else for(;g<r;)if(d[f++]=e[g++],f==this.blockSize){n(this,d),f=0;break}}this.h=f,this.o+=r},m.prototype.A=function(){var e=Array((this.h<56?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var r=1;r<e.length-8;++r)e[r]=0;r=8*this.o;for(var h=e.length-8;h<e.length;++h)e[h]=255&r,r/=256;for(this.v(e),e=Array(16),r=0,h=0;h<4;++h)for(let d=0;d<32;d+=8)e[r++]=this.g[h]>>>d&255;return e};var e,r={};function u(e){return -128<=e&&e<128?Object.prototype.hasOwnProperty.call(r,e)?r[e]:r[e]=new t([0|e],e<0?-1:0):new t([0|e],e<0?-1:0)}function v(e){if(isNaN(e)||!isFinite(e))return h;if(e<0)return x(v(-e));let r=[],d=1;for(let h=0;e>=d;h++)r[h]=e/d|0,d*=4294967296;return new t(r,0)}var h=u(0),g=u(1),b=u(16777216);function C(e){if(0!=e.h)return!1;for(let r=0;r<e.g.length;r++)if(0!=e.g[r])return!1;return!0}function B(e){return -1==e.h}function x(e){let r=e.g.length,h=[];for(let d=0;d<r;d++)h[d]=~e.g[d];return new t(h,~e.h).add(g)}function F(e,r){return e.add(x(r))}function G(e,r){for(;(65535&e[r])!=e[r];)e[r+1]+=e[r]>>>16,e[r]&=65535,r++}function H(e,r){this.g=e,this.h=r}function D(e,r){if(C(r))throw Error("division by zero");if(C(e))return new H(h,h);if(B(e))return r=D(x(e),r),new H(x(r.g),x(r.h));if(B(r))return r=D(e,x(r)),new H(x(r.g),r.h);if(e.g.length>30){if(B(e)||B(r))throw Error("slowDivide_ only works with positive integers.");for(var d=g,f=r;0>=f.l(e);)d=I(d),f=I(f);var b=J(d,1),A=J(f,1);for(f=J(f,2),d=J(d,2);!C(f);){var k=A.add(f);0>=k.l(e)&&(b=b.add(d),A=k),f=J(f,1),d=J(d,1)}return r=F(e,b.j(r)),new H(b,r)}for(b=h;e.l(r)>=0;){for(f=(f=Math.ceil(Math.log(d=Math.max(1,Math.floor(e.m()/r.m())))/Math.LN2))<=48?1:Math.pow(2,f-48),k=(A=v(d)).j(r);B(k)||k.l(e)>0;)d-=f,k=(A=v(d)).j(r);C(A)&&(A=g),b=b.add(A),e=F(e,k)}return new H(b,e)}function I(e){let r=e.g.length+1,h=[];for(let d=0;d<r;d++)h[d]=e.i(d)<<1|e.i(d-1)>>>31;return new t(h,e.h)}function J(e,r){let h=r>>5;r%=32;let d=e.g.length-h,f=[];for(let g=0;g<d;g++)f[g]=r>0?e.i(g+h)>>>r|e.i(g+h+1)<<32-r:e.i(g+h);return new t(f,e.h)}(e=t.prototype).m=function(){if(B(this))return-x(this).m();let e=0,r=1;for(let h=0;h<this.g.length;h++){let d=this.i(h);e+=(d>=0?d:4294967296+d)*r,r*=4294967296}return e},e.toString=function(e){if((e=e||10)<2||36<e)throw Error("radix out of range: "+e);if(C(this))return"0";if(B(this))return"-"+x(this).toString(e);let r=v(Math.pow(e,6));var h=this;let d="";for(;;){let f=D(h,r).g,g=(((h=F(h,f.j(r))).g.length>0?h.g[0]:h.h)>>>0).toString(e);if(C(h=f))return g+d;for(;g.length<6;)g="0"+g;d=g+d}},e.i=function(e){return e<0?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return B(e=F(this,e))?-1:C(e)?0:1},e.abs=function(){return B(this)?x(this):this},e.add=function(e){let r=Math.max(this.g.length,e.g.length),h=[],d=0;for(let f=0;f<=r;f++){let r=d+(65535&this.i(f))+(65535&e.i(f)),g=(r>>>16)+(this.i(f)>>>16)+(e.i(f)>>>16);d=g>>>16,r&=65535,g&=65535,h[f]=g<<16|r}return new t(h,-2147483648&h[h.length-1]?-1:0)},e.j=function(e){if(C(this)||C(e))return h;if(B(this))return B(e)?x(this).j(x(e)):x(x(this).j(e));if(B(e))return x(this.j(x(e)));if(0>this.l(b)&&0>e.l(b))return v(this.m()*e.m());let r=this.g.length+e.g.length,d=[];for(var f=0;f<2*r;f++)d[f]=0;for(f=0;f<this.g.length;f++)for(let r=0;r<e.g.length;r++){let h=this.i(f)>>>16,g=65535&this.i(f),b=e.i(r)>>>16,A=65535&e.i(r);d[2*f+2*r]+=g*A,G(d,2*f+2*r),d[2*f+2*r+1]+=h*A,G(d,2*f+2*r+1),d[2*f+2*r+1]+=g*b,G(d,2*f+2*r+1),d[2*f+2*r+2]+=h*b,G(d,2*f+2*r+2)}for(e=0;e<r;e++)d[e]=d[2*e+1]<<16|d[2*e];for(e=r;e<2*r;e++)d[e]=0;return new t(d,0)},e.B=function(e){return D(this,e).h},e.and=function(e){let r=Math.max(this.g.length,e.g.length),h=[];for(let d=0;d<r;d++)h[d]=this.i(d)&e.i(d);return new t(h,this.h&e.h)},e.or=function(e){let r=Math.max(this.g.length,e.g.length),h=[];for(let d=0;d<r;d++)h[d]=this.i(d)|e.i(d);return new t(h,this.h|e.h)},e.xor=function(e){let r=Math.max(this.g.length,e.g.length),h=[];for(let d=0;d<r;d++)h[d]=this.i(d)^e.i(d);return new t(h,this.h^e.h)},m.prototype.digest=m.prototype.A,m.prototype.reset=m.prototype.u,m.prototype.update=m.prototype.v,f=eu.Md5=m,t.prototype.add=t.prototype.add,t.prototype.multiply=t.prototype.j,t.prototype.modulo=t.prototype.B,t.prototype.compare=t.prototype.l,t.prototype.toNumber=t.prototype.m,t.prototype.toString=t.prototype.toString,t.prototype.getBits=t.prototype.i,t.fromNumber=v,t.fromString=function y(e,r){if(0==e.length)throw Error("number format error: empty string");if((r=r||10)<2||36<r)throw Error("radix out of range: "+r);if("-"==e.charAt(0))return x(y(e.substring(1),r));if(e.indexOf("-")>=0)throw Error('number format error: interior "-" character');let d=v(Math.pow(r,8)),f=h;for(let h=0;h<e.length;h+=8){var g=Math.min(8,e.length-h);let b=parseInt(e.substring(h,h+g),r);g<8?(g=v(Math.pow(r,g)),f=f.j(g).add(v(b))):f=(f=f.j(d)).add(v(b))}return f},d=eu.Integer=t}).apply(void 0!==el?el:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var eh=h(4645),ed="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},em={};(function(){var e,r,h=Object.defineProperty,d=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof ed&&ed];for(var r=0;r<e.length;++r){var h=e[r];if(h&&h.Math==Math)return h}throw Error("Cannot find global object")}(this);function da(e,r){if(r)e:{var f=d;e=e.split(".");for(var g=0;g<e.length-1;g++){var b=e[g];if(!(b in f))break e;f=f[b]}(r=r(g=f[e=e[e.length-1]]))!=g&&null!=r&&h(f,e,{configurable:!0,writable:!0,value:r})}}da("Symbol.dispose",function(e){return e||Symbol("Symbol.dispose")}),da("Array.prototype.values",function(e){return e||function(){return this[Symbol.iterator]()}}),da("Object.entries",function(e){return e||function(e){var r,h=[];for(r in e)Object.prototype.hasOwnProperty.call(e,r)&&h.push([r,e[r]]);return h}});var f=f||{},et=this||self;function n(e){var r=typeof e;return"object"==r&&null!=e||"function"==r}function fa(e,r,h){return e.call.apply(e.bind,arguments)}function p(e,r,h){return(p=fa).apply(null,arguments)}function ha(e,r){var h=Array.prototype.slice.call(arguments,1);return function(){var r=h.slice();return r.push.apply(r,arguments),e.apply(this,r)}}function t(e,r){function c(){}c.prototype=r.prototype,e.Z=r.prototype,e.prototype=new c,e.prototype.constructor=e,e.Ob=function(e,h,d){for(var f=Array(arguments.length-2),g=2;g<arguments.length;g++)f[g-2]=arguments[g];return r.prototype[h].apply(e,f)}}var er="undefined"!=typeof AsyncContext&&"function"==typeof AsyncContext.Snapshot?e=>e&&AsyncContext.Snapshot.wrap(e):e=>e;function ja(e){let r=e.length;if(r>0){let h=Array(r);for(let d=0;d<r;d++)h[d]=e[d];return h}return[]}function ka(e,r){for(let r=1;r<arguments.length;r++){let d=arguments[r];var h=typeof d;if("array"==(h="object"!=h?h:d?Array.isArray(d)?"array":h:"null")||"object"==h&&"number"==typeof d.length){h=e.length||0;let r=d.length||0;e.length=h+r;for(let f=0;f<r;f++)e[h+f]=d[f]}else e.push(d)}}var en=new class{constructor(e,r){this.i=e,this.j=r,this.h=0,this.g=null}get(){let e;return this.h>0?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new ra,e=>e.reset());let ra=class ra{constructor(){this.next=this.g=this.h=null}set(e,r){this.h=e,this.g=r,this.next=null}reset(){this.next=this.g=this.h=null}};let ei,es=!1,eo=new class{constructor(){this.h=this.g=null}add(e,r){let h=en.get();h.set(e,r),this.h?this.h.next=h:this.g=h,this.h=h}},ta=()=>{let e=Promise.resolve(void 0);ei=()=>{e.then(sa)}};function sa(){let e;for(var r;e=null,eo.g&&(e=eo.g,eo.g=eo.g.next,eo.g||(eo.h=null),e.next=null),r=e;){try{r.h.call(r.g)}catch(e){!function(e){et.setTimeout(()=>{throw e},0)}(e)}en.j(r),en.h<100&&(en.h++,r.next=en.g,en.g=r)}es=!1}function w(){this.u=this.u,this.C=this.C}function x(e,r){this.type=e,this.g=this.target=r,this.defaultPrevented=!1}w.prototype.u=!1,w.prototype.dispose=function(){this.u||(this.u=!0,this.N())},w.prototype[Symbol.dispose]=function(){this.dispose()},w.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},x.prototype.h=function(){this.defaultPrevented=!0};var ea=function(){if(!et.addEventListener||!Object.defineProperty)return!1;var e=!1,r=Object.defineProperty({},"passive",{get:function(){e=!0}});try{let c=()=>{};et.addEventListener("test",c,r),et.removeEventListener("test",c,r)}catch(e){}return e}();function y(e){return/^[\s\xa0]*$/.test(e)}function z(e,r){x.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e&&this.init(e,r)}t(z,x),z.prototype.init=function(e,r){let h=this.type=e.type,d=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;this.target=e.target||e.srcElement,this.g=r,(r=e.relatedTarget)||("mouseover"==h?r=e.fromElement:"mouseout"==h&&(r=e.toElement)),this.relatedTarget=r,d?(this.clientX=void 0!==d.clientX?d.clientX:d.pageX,this.clientY=void 0!==d.clientY?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=e.pointerType,this.state=e.state,this.i=e,e.defaultPrevented&&z.Z.h.call(this)},z.prototype.h=function(){z.Z.h.call(this);let e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var el="closure_listenable_"+(1e6*Math.random()|0),eu=0;function wa(e,r,h,d,f){this.listener=e,this.proxy=null,this.src=r,this.type=h,this.capture=!!d,this.ha=f,this.key=++eu,this.da=this.fa=!1}function xa(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function ya(e,r,h){for(let d in e)r.call(h,e[d],d,e)}function Ba(e){let r={};for(let h in e)r[h]=e[h];return r}let eh="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Da(e,r){let h,d;for(let r=1;r<arguments.length;r++){for(h in d=arguments[r])e[h]=d[h];for(let r=0;r<eh.length;r++)h=eh[r],Object.prototype.hasOwnProperty.call(d,h)&&(e[h]=d[h])}}function Ea(e){this.src=e,this.g={},this.h=0}function Ga(e,r){let h=r.type;if(h in e.g){var d,f=e.g[h],g=Array.prototype.indexOf.call(f,r,void 0);(d=g>=0)&&Array.prototype.splice.call(f,g,1),d&&(xa(r),0==e.g[h].length&&(delete e.g[h],e.h--))}}function Fa(e,r,h,d){for(let f=0;f<e.length;++f){let g=e[f];if(!g.da&&g.listener==r&&!!h==g.capture&&g.ha==d)return f}return -1}Ea.prototype.add=function(e,r,h,d,f){let g=e.toString();(e=this.g[g])||(e=this.g[g]=[],this.h++);let b=Fa(e,r,d,f);return b>-1?(r=e[b],h||(r.fa=!1)):((r=new wa(r,this.src,g,!!d,f)).fa=h,e.push(r)),r};var ef="closure_lm_"+(1e6*Math.random()|0),ep={};function Na(e,r,h,d,f,g){if(!r)throw Error("Invalid event type");let b=n(f)?!!f.capture:!!f,A=Oa(e);if(A||(e[ef]=A=new Ea(e)),(h=A.add(r,h,d,b,g)).proxy)return h;if(d=function a(e){return Ra.call(a.src,a.listener,e)},h.proxy=d,d.src=e,d.listener=h,e.addEventListener)ea||(f=b),void 0===f&&(f=!1),e.addEventListener(r.toString(),d,f);else if(e.attachEvent)e.attachEvent(Qa(r.toString()),d);else if(e.addListener&&e.removeListener)e.addListener(d);else throw Error("addEventListener and attachEvent are unavailable.");return h}function Ta(e){if("number"!=typeof e&&e&&!e.da){var r=e.src;if(r&&r[el])Ga(r.i,e);else{var h=e.type,d=e.proxy;r.removeEventListener?r.removeEventListener(h,d,e.capture):r.detachEvent?r.detachEvent(Qa(h),d):r.addListener&&r.removeListener&&r.removeListener(d),(h=Oa(r))?(Ga(h,e),0==h.h&&(h.src=null,r[ef]=null)):xa(e)}}}function Qa(e){return e in ep?ep[e]:ep[e]="on"+e}function Ra(e,r){if(e.da)e=!0;else{r=new z(r,this);let h=e.listener,d=e.ha||e.src;e.fa&&Ta(e),e=h.call(d,r)}return e}function Oa(e){return(e=e[ef])instanceof Ea?e:null}var e_="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ma(e){return"function"==typeof e?e:(e[e_]||(e[e_]=function(r){return e.handleEvent(r)}),e[e_])}function C(){w.call(this),this.i=new Ea(this),this.M=this,this.G=null}function D(e,r){let h,d;var f,g=e.G;if(g)for(f=[];g;g=g.G)f.push(g);if(e=e.M,g=r.type||r,"string"==typeof r)r=new x(r,e);else if(r instanceof x)r.target=r.target||e;else{var b=r;Da(r=new x(g,e),b)}if(b=!0,f)for(d=f.length-1;d>=0;d--)b=Va(h=r.g=f[d],g,!0,r)&&b;if(b=Va(h=r.g=e,g,!0,r)&&b,b=Va(h,g,!1,r)&&b,f)for(d=0;d<f.length;d++)b=Va(h=r.g=f[d],g,!1,r)&&b}function Va(e,r,h,d){if(!(r=e.i.g[String(r)]))return!0;r=r.concat();let f=!0;for(let g=0;g<r.length;++g){let b=r[g];if(b&&!b.da&&b.capture==h){let r=b.listener,h=b.ha||b.src;b.fa&&Ga(e.i,b),f=!1!==r.call(h,d)&&f}}return f&&!d.defaultPrevented}t(C,w),C.prototype[el]=!0,C.prototype.removeEventListener=function(e,r,h,d){!function Sa(e,r,h,d,f){if(Array.isArray(r))for(var g=0;g<r.length;g++)Sa(e,r[g],h,d,f);else(d=n(d)?!!d.capture:!!d,h=Ma(h),e&&e[el])?(e=e.i,(g=String(r).toString())in e.g&&(h=Fa(r=e.g[g],h,d,f))>-1&&(xa(r[h]),Array.prototype.splice.call(r,h,1),0==r.length&&(delete e.g[g],e.h--))):e&&(e=Oa(e))&&(r=e.g[r.toString()],e=-1,r&&(e=Fa(r,h,d,f)),(h=e>-1?r[e]:null)&&Ta(h))}(this,e,r,h,d)},C.prototype.N=function(){if(C.Z.N.call(this),this.i){var e=this.i;for(let r in e.g){let h=e.g[r];for(let e=0;e<h.length;e++)xa(h[e]);delete e.g[r],e.h--}}this.G=null},C.prototype.J=function(e,r,h,d){return this.i.add(String(e),r,!1,h,d)},C.prototype.K=function(e,r,h,d){return this.i.add(String(e),r,!0,h,d)};let Ya=class Ya extends w{constructor(e,r){super(),this.m=e,this.l=r,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:function Xa(e){e.g=function(e,r){if("function"!=typeof e){if(e&&"function"==typeof e.handleEvent)e=p(e.handleEvent,e);else throw Error("Invalid listener argument")}return Number(r)>2147483647?-1:et.setTimeout(e,r||0)}(()=>{e.g=null,e.i&&(e.i=!1,Xa(e))},e.l);let r=e.h;e.h=null,e.m.apply(null,r)}(this)}N(){super.N(),this.g&&(et.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}};function E(e){w.call(this),this.h=e,this.g={}}t(E,w);var eg=[];function $a(e){ya(e.g,function(e,r){this.g.hasOwnProperty(r)&&Ta(e)},e),e.g={}}E.prototype.N=function(){E.Z.N.call(this),$a(this)},E.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ey=et.JSON.stringify,ev=et.JSON.parse,eE=class{stringify(e){return et.JSON.stringify(e,void 0)}parse(e){return et.JSON.parse(e,void 0)}};function eb(){}function fb(){}var eT={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function gb(){x.call(this,"d")}function hb(){x.call(this,"c")}t(gb,x),t(hb,x);var eI={},eP=null;function jb(){return eP=eP||new C}function kb(e){x.call(this,eI.Ia,e)}function lb(e){let r=jb();D(r,new kb(r))}function mb(e,r){x.call(this,eI.STAT_EVENT,e),this.stat=r}function J(e){let r=jb();D(r,new mb(r,e))}function nb(e,r){x.call(this,eI.Ja,e),this.size=r}function ob(e,r){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return et.setTimeout(function(){e()},r)}function pb(){this.g=!0}function K(e,r,h,d){e.info(function(){return"XMLHTTP TEXT ("+r+"): "+function(e,r){if(!e.g)return r;if(!r)return null;try{let g=JSON.parse(r);if(g){for(e=0;e<g.length;e++)if(Array.isArray(g[e])){var h=g[e];if(!(h.length<2)){var d=h[1];if(Array.isArray(d)&&!(d.length<1)){var f=d[0];if("noop"!=f&&"stop"!=f&&"close"!=f)for(let e=1;e<d.length;e++)d[e]=""}}}}return ey(g)}catch(e){return r}}(e,h)+(d?" "+d:"")})}eI.Ia="serverreachability",t(kb,x),eI.STAT_EVENT="statevent",t(mb,x),eI.Ja="timingevent",t(nb,x),pb.prototype.ua=function(){this.g=!1},pb.prototype.info=function(){};var eA={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},eR={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"};function xb(){}function L(e){return encodeURIComponent(String(e))}function N(e,r,h,d){this.j=e,this.i=r,this.l=h,this.S=d||1,this.V=new E(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new zb}function zb(){this.i=null,this.g="",this.h=!1}t(xb,eb),xb.prototype.g=function(){return new XMLHttpRequest},e=new xb;var ew={},eV={};function Cb(e,r,h){e.M=1,e.A=Db(O(r)),e.u=h,e.R=!0,Eb(e,null)}function Eb(e,r){e.F=Date.now(),Fb(e),e.B=O(e.A);var h=e.B,d=e.S;Array.isArray(d)||(d=[String(d)]),Gb(h.i,"t",d),e.C=0,h=e.j.L,e.h=new zb,e.g=Hb(e.j,h?r:null,!e.u),e.P>0&&(e.O=new Ya(p(e.Y,e,e.g),e.P)),r=e.V,h=e.g,d=e.ba;var f="readystatechange";Array.isArray(f)||(f&&(eg[0]=f.toString()),f=eg);for(let e=0;e<f.length;e++){let g=function Ka(e,r,h,d,f){if(d&&d.once)return function La(e,r,h,d,f){if(Array.isArray(r)){for(let g=0;g<r.length;g++)La(e,r[g],h,d,f);return null}return h=Ma(h),e&&e[el]?e.K(r,h,n(d)?!!d.capture:!!d,f):Na(e,r,h,!0,d,f)}(e,r,h,d,f);if(Array.isArray(r)){for(let g=0;g<r.length;g++)Ka(e,r[g],h,d,f);return null}return h=Ma(h),e&&e[el]?e.J(r,h,n(d)?!!d.capture:!!d,f):Na(e,r,h,!1,d,f)}(h,f[e],d||r.handleEvent,!1,r.h||r);if(!g)break;r.g[g.key]=g}r=e.J?Ba(e.J):{},e.u?(e.v||(e.v="POST"),r["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.B,e.v,e.u,r)):(e.v="GET",e.g.ea(e.B,e.v,null,r)),lb(),function(e,r,h,d,f,g){e.info(function(){if(e.g){if(g){var b="",A=g.split("&");for(let e=0;e<A.length;e++){var k=A[e].split("=");if(k.length>1){let e=k[0];k=k[1];let r=e.split("_");b=r.length>=2&&"type"==r[1]?b+(e+"=")+k+"&":b+(e+"=redacted&")}}}else b=null}else b=g;return"XMLHTTP REQ ("+d+") [attempt "+f+"]: "+r+"\n"+h+"\n"+b})}(e.i,e.v,e.B,e.l,e.S,e.u)}function Ob(e){return!!e.g&&"GET"==e.v&&2!=e.M&&e.j.Aa}function Fb(e){e.T=Date.now()+e.H,Sb(e,e.H)}function Sb(e,r){if(null!=e.D)throw Error("WatchDog timer not null");e.D=ob(p(e.aa,e),r)}function Jb(e){e.D&&(et.clearTimeout(e.D),e.D=null)}function Mb(e){0==e.j.I||e.K||Qb(e.j,e)}function Q(e){Jb(e);var r=e.O;r&&"function"==typeof r.dispose&&r.dispose(),e.O=null,$a(e.V),e.g&&(r=e.g,e.g=null,r.abort(),r.dispose())}function Lb(e,r){try{var h=e.j;if(0!=h.I&&(h.g==e||Tb(h.h,e))){if(!e.L&&Tb(h.h,e)&&3==h.I){try{var d=h.Ba.g.parse(r)}catch(e){d=null}if(Array.isArray(d)&&3==d.length){var f=d;if(0==f[0]){e:if(!h.v){if(h.g){if(h.g.F+3e3<e.F)Ub(h),Vb(h);else break e}Wb(h),J(18)}}else h.xa=f[1],0<h.xa-h.K&&f[2]<37500&&h.F&&0==h.A&&!h.C&&(h.C=ob(p(h.Va,h),6e3));1>=Xb(h.h)&&h.ta&&(h.ta=void 0)}else R(h,11)}else if((e.L||h.g==e)&&Ub(h),!y(r))for(f=h.Ba.g.parse(r),r=0;r<f.length;r++){let A=f[r],k=A[0];if(!(k<=h.K)){if(h.K=k,A=A[1],2==h.I){if("c"==A[0]){h.M=A[1],h.ba=A[2];let r=A[3];null!=r&&(h.ka=r,h.j.info("VER="+h.ka));let f=A[4];null!=f&&(h.za=f,h.j.info("SVER="+h.za));let k=A[5];null!=k&&"number"==typeof k&&k>0&&(d=1.5*k,h.O=d,h.j.info("backChannelRequestTimeoutMs_="+d)),d=h;let M=e.g;if(M){let e=M.g?M.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var g=d.h;g.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(g.j=g.l,g.g=new Set,g.h&&(Yb(g,g.h),g.h=null))}if(d.G){let e=M.g?M.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(d.wa=e,S(d.J,d.G,e))}}if(h.I=3,h.l&&h.l.ra(),h.aa&&(h.T=Date.now()-e.F,h.j.info("Handshake RTT: "+h.T+"ms")),(d=h).na=Zb(d,d.L?d.ba:null,d.W),e.L){$b(d.h,e);var b=d.O;b&&(e.H=b),e.D&&(Jb(e),Fb(e)),d.g=e}else ac(d);h.i.length>0&&bc(h)}else"stop"!=A[0]&&"close"!=A[0]||R(h,7)}else 3==h.I&&("stop"==A[0]||"close"==A[0]?"stop"==A[0]?R(h,7):cc(h):"noop"!=A[0]&&h.l&&h.l.qa(A),h.A=0)}}}lb(4)}catch(e){}}N.prototype.ba=function(e){e=e.target;let r=this.O;r&&3==P(e)?r.j():this.Y(e)},N.prototype.Y=function(e){try{if(e==this.g)e:{let A=P(this.g),k=this.g.ya(),M=this.g.ca();if(!(A<3)&&(3!=A||this.g&&(this.h.h||this.g.la()||Ib(this.g)))){this.K||4!=A||7==k||(8==k||M<=0?lb(3):lb(2)),Jb(this);var r=this.g.ca();this.X=r;var h=function(e){if(!Ob(e))return e.g.la();let r=Ib(e.g);if(""===r)return"";let h="",d=r.length,f=4==P(e.g);if(!e.h.i){if("undefined"==typeof TextDecoder)return Q(e),Mb(e),"";e.h.i=new et.TextDecoder}for(let g=0;g<d;g++)e.h.h=!0,h+=e.h.i.decode(r[g],{stream:!(f&&g==d-1)});return r.length=0,e.h.g+=h,e.C=0,e.h.g}(this);if(this.o=200==r,function(e,r,h,d,f,g,b){e.info(function(){return"XMLHTTP RESP ("+d+") [ attempt "+f+"]: "+r+"\n"+h+"\n"+g+" "+b})}(this.i,this.v,this.B,this.l,this.S,A,r),this.o){if(this.U&&!this.L){t:{if(this.g){var d,f=this.g;if((d=f.g?f.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!y(d)){var g=d;break t}}g=null}if(e=g)K(this.i,this.l,e,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Lb(this,e);else{this.o=!1,this.m=3,J(12),Q(this),Mb(this);break e}}if(this.R){let r;for(e=!0;!this.K&&this.C<h.length;)if((r=function(e,r){var h=e.C,d=r.indexOf("\n",h);return -1==d?eV:isNaN(h=Number(r.substring(h,d)))?ew:(d+=1)+h>r.length?eV:(r=r.slice(d,d+h),e.C=d+h,r)}(this,h))==eV){4==A&&(this.m=4,J(14),e=!1),K(this.i,this.l,null,"[Incomplete Response]");break}else if(r==ew){this.m=4,J(15),K(this.i,this.l,h,"[Invalid Chunk]"),e=!1;break}else K(this.i,this.l,r,null),Lb(this,r);if(Ob(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=A||0!=h.length||this.h.h||(this.m=1,J(16),e=!1),this.o=this.o&&e,e){if(h.length>0&&!this.W){this.W=!0;var b=this.j;b.g==this&&b.aa&&!b.P&&(b.j.info("Great, no buffering proxy detected. Bytes received: "+h.length),Pb(b),b.P=!0,J(11))}}else K(this.i,this.l,h,"[Invalid Chunked Response]"),Q(this),Mb(this)}else K(this.i,this.l,h,null),Lb(this,h);4==A&&Q(this),this.o&&!this.K&&(4==A?Qb(this.j,this):(this.o=!1,Fb(this)))}else(function(e){let r={};e=(e.g&&P(e)>=2&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let d=0;d<e.length;d++){if(y(e[d]))continue;var h=function(e){var r=1;e=e.split(":");let h=[];for(;r>0&&e.length;)h.push(e.shift()),r--;return e.length&&h.push(e.join(":")),h}(e[d]);let f=h[0];if("string"!=typeof(h=h[1]))continue;h=h.trim();let g=r[f]||[];r[f]=g,g.push(h)}!function(e,r){for(let h in e)r.call(void 0,e[h],h,e)}(r,function(e){return e.join(", ")})})(this.g),400==r&&h.indexOf("Unknown SID")>0?(this.m=3,J(12)):(this.m=0,J(13)),Q(this),Mb(this)}}}catch(e){}finally{}},N.prototype.cancel=function(){this.K=!0,Q(this)},N.prototype.aa=function(){this.D=null;let e=Date.now();e-this.T>=0?(function(e,r){e.info(function(){return"TIMEOUT: "+r})}(this.i,this.B),2!=this.M&&(lb(),J(17)),Q(this),this.m=2,Mb(this)):Sb(this,this.T-e)};var eS=class{constructor(e,r){this.g=e,this.map=r}};function ec(e){this.l=e||10,e=et.PerformanceNavigationTiming?(e=et.performance.getEntriesByType("navigation")).length>0&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(et.chrome&&et.chrome.loadTimes&&et.chrome.loadTimes()&&et.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function fc(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Xb(e){return e.h?1:e.g?e.g.size:0}function Tb(e,r){return e.h?e.h==r:!!e.g&&e.g.has(r)}function Yb(e,r){e.g?e.g.add(r):e.h=r}function $b(e,r){e.h&&e.h==r?e.h=null:e.g&&e.g.has(r)&&e.g.delete(r)}function hc(e){if(null!=e.h)return e.i.concat(e.h.G);if(null!=e.g&&0!==e.g.size){let r=e.i;for(let h of e.g.values())r=r.concat(h.G);return r}return ja(e.i)}ec.prototype.cancel=function(){if(this.i=hc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(let e of this.g.values())e.cancel();this.g.clear()}};var eC=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function T(e){let r;this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1,e instanceof T?(this.l=e.l,kc(this,e.j),this.o=e.o,this.g=e.g,lc(this,e.u),this.h=e.h,mc(this,nc(e.i)),this.m=e.m):e&&(r=String(e).match(eC))?(this.l=!1,kc(this,r[1]||"",!0),this.o=oc(r[2]||""),this.g=oc(r[3]||"",!0),lc(this,r[4]),this.h=oc(r[5]||"",!0),mc(this,r[6]||"",!0),this.m=oc(r[7]||"")):(this.l=!1,this.i=new pc(null,this.l))}function O(e){return new T(e)}function kc(e,r,h){e.j=h?oc(r,!0):r,e.j&&(e.j=e.j.replace(/:$/,""))}function lc(e,r){if(r){if(isNaN(r=Number(r))||r<0)throw Error("Bad port number "+r);e.u=r}else e.u=null}function mc(e,r,h){var d,f;r instanceof pc?(e.i=r,d=e.i,(f=e.l)&&!d.j&&(U(d),d.i=null,d.g.forEach(function(e,r){let h=r.toLowerCase();r!=h&&(yc(this,r),Gb(this,h,e))},d)),d.j=f):(h||(r=qc(r,eN)),e.i=new pc(r,e.l))}function S(e,r,h){e.i.set(r,h)}function Db(e){return S(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function oc(e,r){return e?r?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function qc(e,r,h){return"string"==typeof e?(e=encodeURI(e).replace(r,xc),h&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function xc(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}T.prototype.toString=function(){let e=[];var r=this.j;r&&e.push(qc(r,ex,!0),":");var h=this.g;return(h||"file"==r)&&(e.push("//"),(r=this.o)&&e.push(qc(r,ex,!0),"@"),e.push(L(h).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(h=this.u)&&e.push(":",String(h))),(h=this.h)&&(this.g&&"/"!=h.charAt(0)&&e.push("/"),e.push(qc(h,"/"==h.charAt(0)?eD:ek,!0))),(h=this.i.toString())&&e.push("?",h),(h=this.m)&&e.push("#",qc(h,eO)),e.join("")},T.prototype.resolve=function(e){let r=O(this),h=!!e.j;h?kc(r,e.j):h=!!e.o,h?r.o=e.o:h=!!e.g,h?r.g=e.g:h=null!=e.u;var d=e.h;if(h)lc(r,e.u);else if(h=!!e.h){if("/"!=d.charAt(0)){if(this.g&&!this.h)d="/"+d;else{var f=r.h.lastIndexOf("/");-1!=f&&(d=r.h.slice(0,f+1)+d)}}if(".."==(f=d)||"."==f)d="";else if(-1!=f.indexOf("./")||-1!=f.indexOf("/.")){d=0==f.lastIndexOf("/",0),f=f.split("/");let e=[];for(let r=0;r<f.length;){let h=f[r++];"."==h?d&&r==f.length&&e.push(""):".."==h?((e.length>1||1==e.length&&""!=e[0])&&e.pop(),d&&r==f.length&&e.push("")):(e.push(h),d=!0)}d=e.join("/")}else d=f}return h?r.h=d:h=""!==e.i.toString(),h?mc(r,nc(e.i)):h=!!e.m,h&&(r.m=e.m),r};var ex=/[#\/\?@]/g,ek=/[#\?:]/g,eD=/[#\?]/g,eN=/[#\?@]/g,eO=/#/g;function pc(e,r){this.h=this.g=null,this.i=e||null,this.j=!!r}function U(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,r){if(e){e=e.split("&");for(let h=0;h<e.length;h++){let d=e[h].indexOf("="),f,g=null;d>=0?(f=e[h].substring(0,d),g=e[h].substring(d+1)):f=e[h],r(f,g?decodeURIComponent(g.replace(/\+/g," ")):"")}}}(e.i,function(r,h){e.add(decodeURIComponent(r.replace(/\+/g," ")),h)}))}function yc(e,r){U(e),r=V(e,r),e.g.has(r)&&(e.i=null,e.h-=e.g.get(r).length,e.g.delete(r))}function zc(e,r){return U(e),r=V(e,r),e.g.has(r)}function Ac(e,r){U(e);let h=[];if("string"==typeof r)zc(e,r)&&(h=h.concat(e.g.get(V(e,r))));else for(e=Array.from(e.g.values()),r=0;r<e.length;r++)h=h.concat(e[r]);return h}function Gb(e,r,h){yc(e,r),h.length>0&&(e.i=null,e.g.set(V(e,r),ja(h)),e.h+=h.length)}function nc(e){let r=new pc;return r.i=e.i,e.g&&(r.g=new Map(e.g),r.h=e.h),r}function V(e,r){return r=String(r),e.j&&(r=r.toLowerCase()),r}function W(e,r,h,d,f){try{f&&(f.onload=null,f.onerror=null,f.onabort=null,f.ontimeout=null),d(h)}catch(e){}}function Dc(){this.g=new eE}function Ec(e){this.i=e.Sb||null,this.h=e.ab||!1}function Fc(e,r){C.call(this),this.H=e,this.o=r,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}function Ic(e){e.j.read().then(e.Ma.bind(e)).catch(e.ga.bind(e))}function Hc(e){e.readyState=4,e.l=null,e.j=null,e.B=null,Gc(e)}function Gc(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Jc(e){let r="";return ya(e,function(e,h){r+=h+":"+e+"\r\n"}),r}function Kc(e,r,h){e:{for(d in h){var d=!1;break e}d=!0}d||(h=Jc(h),"string"==typeof e?null!=h&&L(h):S(e,r,h))}function X(e){C.call(this),this.headers=new Map,this.L=e||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}(r=pc.prototype).add=function(e,r){U(this),this.i=null,e=V(this,e);let h=this.g.get(e);return h||this.g.set(e,h=[]),h.push(r),this.h+=1,this},r.forEach=function(e,r){U(this),this.g.forEach(function(h,d){h.forEach(function(h){e.call(r,h,d,this)},this)},this)},r.set=function(e,r){return U(this),this.i=null,zc(this,e=V(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[r]),this.h+=1,this},r.get=function(e,r){return e&&(e=Ac(this,e)).length>0?String(e[0]):r},r.toString=function(){if(this.i)return this.i;if(!this.g)return"";let e=[],r=Array.from(this.g.keys());for(let d=0;d<r.length;d++){var h=r[d];let f=L(h);h=Ac(this,h);for(let r=0;r<h.length;r++){let d=f;""!==h[r]&&(d+="="+L(h[r])),e.push(d)}}return this.i=e.join("&")},t(Ec,eb),Ec.prototype.g=function(){return new Fc(this.i,this.h)},t(Fc,C),(r=Fc.prototype).open=function(e,r){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.F=e,this.D=r,this.readyState=1,Gc(this)},r.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;let r={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};e&&(r.body=e),(this.H||et).fetch(new Request(this.D,r)).then(this.Pa.bind(this),this.ga.bind(this))},r.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&4!=this.readyState&&(this.g=!1,Hc(this)),this.readyState=0},r.Pa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Gc(this)),this.g&&(this.readyState=3,Gc(this),this.g))){if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(void 0!==et.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Ic(this)}else e.text().then(this.Oa.bind(this),this.ga.bind(this))}},r.Ma=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var r=e.value?e.value:new Uint8Array(0);(r=this.B.decode(r,{stream:!e.done}))&&(this.response=this.responseText+=r)}e.done?Hc(this):Gc(this),3==this.readyState&&Ic(this)}},r.Oa=function(e){this.g&&(this.response=this.responseText=e,Hc(this))},r.Na=function(e){this.g&&(this.response=e,Hc(this))},r.ga=function(){this.g&&Hc(this)},r.setRequestHeader=function(e,r){this.A.append(e,r)},r.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},r.getAllResponseHeaders=function(){if(!this.h)return"";let e=[],r=this.h.entries();for(var h=r.next();!h.done;)e.push((h=h.value)[0]+": "+h[1]),h=r.next();return e.join("\r\n")},Object.defineProperty(Fc.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),t(X,C);var eM=/^https?$/i,eL=["POST","PUT"];function Nc(e,r){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=r,e.o=5,Oc(e),Pc(e)}function Oc(e){e.A||(e.A=!0,D(e,"complete"),D(e,"error"))}function Qc(e){if(e.h&&void 0!==f){if(e.v&&4==P(e))setTimeout(e.Ca.bind(e),0);else if(D(e,"readystatechange"),4==P(e)){e.h=!1;try{let f=e.ca();switch(f){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r,h,d=!0;break;default:d=!1}if(!(r=d)){if(h=0===f){let r=String(e.D).match(eC)[1]||null;!r&&et.self&&et.self.location&&(r=et.self.location.protocol.slice(0,-1)),h=!eM.test(r?r.toLowerCase():"")}r=h}if(r)D(e,"complete"),D(e,"success");else{e.o=6;try{var g=P(e)>2?e.g.statusText:""}catch(e){g=""}e.l=g+" ["+e.ca()+"]",Oc(e)}}finally{Pc(e)}}}}function Pc(e,r){if(e.g){e.m&&(clearTimeout(e.m),e.m=null);let h=e.g;e.g=null,r||D(e,"ready");try{h.onreadystatechange=null}catch(e){}}}function P(e){return e.g?e.g.readyState:0}function Ib(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.F){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(e){return null}}function Rc(e,r,h){return h&&h.internalChannelParams&&h.internalChannelParams[e]||r}function Sc(e){this.za=0,this.i=[],this.j=new pb,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Rc("failFast",!1,e),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Rc("baseRetryDelayMs",5e3,e),this.Za=Rc("retryDelaySeedMs",1e4,e),this.Ta=Rc("forwardChannelMaxRetries",2,e),this.va=Rc("forwardChannelRequestTimeoutMs",2e4,e),this.ma=e&&e.xmlHttpFactory||void 0,this.Ua=e&&e.Rb||void 0,this.Aa=e&&e.useFetchStreams||!1,this.O=void 0,this.L=e&&e.supportsCrossDomainXhr||!1,this.M="",this.h=new ec(e&&e.concurrentRequestLimit),this.Ba=new Dc,this.S=e&&e.fastHandshake||!1,this.R=e&&e.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=e&&e.Pb||!1,e&&e.ua&&this.j.ua(),e&&e.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&e&&e.detectBufferingProxy||!1,this.ia=void 0,e&&e.longPollingTimeout&&e.longPollingTimeout>0&&(this.ia=e.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}function cc(e){if(Tc(e),3==e.I){var r=e.V++,h=O(e.J);if(S(h,"SID",e.M),S(h,"RID",r),S(h,"TYPE","terminate"),Uc(e,h),(r=new N(e,e.j,r)).M=2,r.A=Db(O(h)),h=!1,et.navigator&&et.navigator.sendBeacon)try{h=et.navigator.sendBeacon(r.A.toString(),"")}catch(e){}!h&&et.Image&&((new Image).src=r.A,h=!0),h||(r.g=Hb(r.j,null),r.g.ea(r.A)),r.F=Date.now(),Fb(r)}Vc(e)}function Vb(e){e.g&&(Pb(e),e.g.cancel(),e.g=null)}function Tc(e){Vb(e),e.v&&(et.clearTimeout(e.v),e.v=null),Ub(e),e.h.cancel(),e.m&&("number"==typeof e.m&&et.clearTimeout(e.m),e.m=null)}function bc(e){if(!fc(e.h)&&!e.m){e.m=!0;var r=e.Ea;ei||ta(),es||(ei(),es=!0),eo.add(r,e),e.D=0}}function Zc(e,r){var h;h=r?r.l:e.V++;let d=O(e.J);S(d,"SID",e.M),S(d,"RID",h),S(d,"AID",e.K),Uc(e,d),e.u&&e.o&&Kc(d,e.u,e.o),h=new N(e,e.j,h,e.D+1),null===e.u&&(h.J=e.o),r&&(e.i=r.G.concat(e.i)),r=Yc(e,h,1e3),h.H=Math.round(.5*e.va)+Math.round(.5*e.va*Math.random()),Yb(e.h,h),Cb(h,d,r)}function Uc(e,r){e.H&&ya(e.H,function(e,h){S(r,h,e)}),e.l&&ya({},function(e,h){S(r,h,e)})}function Yc(e,r,h){h=Math.min(e.i.length,h);let d=e.l?p(e.l.Ka,e.l,e):null;e:{var f=e.i;let r=-1;for(;;){let e=["count="+h];-1==r?h>0?(r=f[0].g,e.push("ofs="+r)):r=0:e.push("ofs="+r);let A=!0;for(let k=0;k<h;k++){var g=f[k].g;let h=f[k].map;if((g-=r)<0)r=Math.max(0,f[k].g-100),A=!1;else try{g="req"+g+"_";try{var b=h instanceof Map?h:Object.entries(h);for(let[r,h]of b){let d=h;n(h)&&(d=ey(h)),e.push(g+r+"="+encodeURIComponent(d))}}catch(r){throw e.push(g+"type="+encodeURIComponent("_badmap")),r}}catch(e){d&&d(h)}}if(A){b=e.join("&");break e}}b=void 0}return e=e.i.splice(0,h),r.G=e,b}function ac(e){if(!e.g&&!e.v){e.Y=1;var r=e.Da;ei||ta(),es||(ei(),es=!0),eo.add(r,e),e.A=0}}function Wb(e){return!e.g&&!e.v&&!(e.A>=3)&&(e.Y++,e.v=ob(p(e.Da,e),Xc(e,e.A)),e.A++,!0)}function Pb(e){null!=e.B&&(et.clearTimeout(e.B),e.B=null)}function $c(e){e.g=new N(e,e.j,"rpc",e.Y),null===e.u&&(e.g.J=e.o),e.g.P=0;var r=O(e.na);S(r,"RID","rpc"),S(r,"SID",e.M),S(r,"AID",e.K),S(r,"CI",e.F?"0":"1"),!e.F&&e.ia&&S(r,"TO",e.ia),S(r,"TYPE","xmlhttp"),Uc(e,r),e.u&&e.o&&Kc(r,e.u,e.o),e.O&&(e.g.H=e.O);var h=e.g;e=e.ba,h.M=1,h.A=Db(O(r)),h.u=null,h.R=!0,Eb(h,e)}function Ub(e){null!=e.C&&(et.clearTimeout(e.C),e.C=null)}function Qb(e,r){var h=null;if(e.g==r){Ub(e),Pb(e),e.g=null;var d=2}else{if(!Tb(e.h,r))return;h=r.G,$b(e.h,r),d=1}if(0!=e.I){if(r.o){if(1==d){h=r.u?r.u.length:0,r=Date.now()-r.F;var f,g=e.D;D(d=jb(),new nb(d,h)),bc(e)}else ac(e)}else if(3==(g=r.m)||0==g&&r.X>0||!(1==d&&(f=r,!(Xb(e.h)>=e.h.j-(e.m?1:0))&&(e.m?(e.i=f.G.concat(e.i),!0):1!=e.I&&2!=e.I&&!(e.D>=(e.Sa?0:e.Ta))&&(e.m=ob(p(e.Ea,e,f),Xc(e,e.D)),e.D++,!0)))||2==d&&Wb(e)))switch(h&&h.length>0&&((r=e.h).i=r.i.concat(h)),g){case 1:R(e,5);break;case 4:R(e,10);break;case 3:R(e,6);break;default:R(e,2)}}}function Xc(e,r){let h=e.Qa+Math.floor(Math.random()*e.Za);return e.isActive()||(h*=2),h*r}function R(e,r){if(e.j.info("Error code "+r),2==r){var h=p(e.bb,e),d=e.Ua;let r=!d;d=new T(d||"//www.google.com/images/cleardot.gif"),et.location&&"http"==et.location.protocol||kc(d,"https"),Db(d),r?function(e,r){let h=new pb;if(et.Image){let d=new Image;d.onload=ha(W,h,"TestLoadImage: loaded",!0,r,d),d.onerror=ha(W,h,"TestLoadImage: error",!1,r,d),d.onabort=ha(W,h,"TestLoadImage: abort",!1,r,d),d.ontimeout=ha(W,h,"TestLoadImage: timeout",!1,r,d),et.setTimeout(function(){d.ontimeout&&d.ontimeout()},1e4),d.src=e}else r(!1)}(d.toString(),h):function(e,r){let h=new pb,d=new AbortController,f=setTimeout(()=>{d.abort(),W(h,"TestPingServer: timeout",!1,r)},1e4);fetch(e,{signal:d.signal}).then(e=>{clearTimeout(f),e.ok?W(h,"TestPingServer: ok",!0,r):W(h,"TestPingServer: server error",!1,r)}).catch(()=>{clearTimeout(f),W(h,"TestPingServer: error",!1,r)})}(d.toString(),h)}else J(2);e.I=0,e.l&&e.l.pa(r),Vc(e),Tc(e)}function Vc(e){if(e.I=0,e.ja=[],e.l){let r=hc(e.h);(0!=r.length||0!=e.i.length)&&(ka(e.ja,r),ka(e.ja,e.i),e.h.i.length=0,ja(e.i),e.i.length=0),e.l.oa()}}function Zb(e,r,h){var d=h instanceof T?O(h):new T(h);if(""!=d.g)r&&(d.g=r+"."+d.g),lc(d,d.u);else{var f=et.location;d=f.protocol,r=r?r+"."+f.hostname:f.hostname,f=+f.port;let e=new T(null);d&&kc(e,d),r&&(e.g=r),f&&lc(e,f),h&&(e.h=h),d=e}return h=e.G,r=e.wa,h&&r&&S(d,h,r),S(d,"VER",e.ka),Uc(e,d),d}function Hb(e,r,h){if(r&&!e.L)throw Error("Can't create secondary domain capable XhrIo object.");return(r=new X(e.Aa&&!e.ma?new Ec({ab:h}):e.ma)).Fa(e.L),r}function ad(){}function bd(){}function Y(e,r){C.call(this),this.g=new Sc(r),this.l=e,this.h=r&&r.messageUrlParams||null,e=r&&r.messageHeaders||null,r&&r.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=r&&r.initMessageHeaders||null,r&&r.messageContentType&&(e?e["X-WebChannel-Content-Type"]=r.messageContentType:e={"X-WebChannel-Content-Type":r.messageContentType}),r&&r.sa&&(e?e["X-WebChannel-Client-Profile"]=r.sa:e={"X-WebChannel-Client-Profile":r.sa}),this.g.U=e,(e=r&&r.Qb)&&!y(e)&&(this.g.u=e),this.A=r&&r.supportsCrossDomainXhr||!1,this.v=r&&r.sendRawJson||!1,(r=r&&r.httpSessionIdParam)&&!y(r)&&(this.g.G=r,null!==(e=this.h)&&r in e&&r in(e=this.h)&&delete e[r]),this.j=new Z(this)}function cd(e){gb.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var r=e.__sm__;if(r){e:{for(let h in r){e=h;break e}e=void 0}(this.i=e)&&(e=this.i,r=null!==r&&e in r?r[e]:void 0),this.data=r}else this.data=e}function dd(){hb.call(this),this.status=1}function Z(e){this.g=e}(r=X.prototype).Fa=function(e){this.H=e},r.ea=function(r,h,d,f){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+r);h=h?h.toUpperCase():"GET",this.D=r,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():e.g(),this.g.onreadystatechange=er(p(this.Ca,this));try{this.B=!0,this.g.open(h,String(r),!0),this.B=!1}catch(e){Nc(this,e);return}if(r=d||"",d=new Map(this.headers),f){if(Object.getPrototypeOf(f)===Object.prototype)for(var g in f)d.set(g,f[g]);else if("function"==typeof f.keys&&"function"==typeof f.get)for(let e of f.keys())d.set(e,f.get(e));else throw Error("Unknown input type for opt_headers: "+String(f))}for(let[e,b]of(f=Array.from(d.keys()).find(e=>"content-type"==e.toLowerCase()),g=et.FormData&&r instanceof et.FormData,!(Array.prototype.indexOf.call(eL,h,void 0)>=0)||f||g||d.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),d))this.g.setRequestHeader(e,b);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(r),this.v=!1}catch(e){Nc(this,e)}},r.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=e||7,D(this,"complete"),D(this,"abort"),Pc(this))},r.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Pc(this,!0)),X.Z.N.call(this)},r.Ca=function(){this.u||(this.B||this.v||this.j?Qc(this):this.Xa())},r.Xa=function(){Qc(this)},r.isActive=function(){return!!this.g},r.ca=function(){try{return P(this)>2?this.g.status:-1}catch(e){return -1}},r.la=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},r.La=function(e){if(this.g){var r=this.g.responseText;return e&&0==r.indexOf(e)&&(r=r.substring(e.length)),ev(r)}},r.ya=function(){return this.o},r.Ha=function(){return"string"==typeof this.l?this.l:String(this.l)},(r=Sc.prototype).ka=8,r.I=1,r.connect=function(e,r,h,d){J(0),this.W=e,this.H=r||{},h&&void 0!==d&&(this.H.OSID=h,this.H.OAID=d),this.F=this.X,this.J=Zb(this,null,this.W),bc(this)},r.Ea=function(e){if(this.m){if(this.m=null,1==this.I){if(!e){this.V=Math.floor(1e5*Math.random()),e=this.V++;let f=new N(this,this.j,e),g=this.o;if(this.U&&(g?Da(g=Ba(g),this.U):g=this.U),null!==this.u||this.R||(f.J=g,g=null),this.S)e:{for(var r=0,h=0;h<this.i.length;h++){t:{var d=this.i[h];if("__data__"in d.map&&"string"==typeof(d=d.map.__data__)){d=d.length;break t}d=void 0}if(void 0===d)break;if((r+=d)>4096){r=h;break e}if(4096===r||h===this.i.length-1){r=h+1;break e}}r=1e3}else r=1e3;r=Yc(this,f,r),S(h=O(this.J),"RID",e),S(h,"CVER",22),this.G&&S(h,"X-HTTP-Session-Id",this.G),Uc(this,h),g&&(this.R?r="headers="+L(Jc(g))+"&"+r:this.u&&Kc(h,this.u,g)),Yb(this.h,f),this.Ra&&S(h,"TYPE","init"),this.S?(S(h,"$req",r),S(h,"SID","null"),f.U=!0,Cb(f,h,null)):Cb(f,h,r),this.I=2}}else 3==this.I&&(e?Zc(this,e):0==this.i.length||fc(this.h)||Zc(this))}},r.Da=function(){if(this.v=null,$c(this),this.aa&&!(this.P||null==this.g||this.T<=0)){var e=4*this.T;this.j.info("BP detection timer enabled: "+e),this.B=ob(p(this.Wa,this),e)}},r.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,J(10),Vb(this),$c(this))},r.Va=function(){null!=this.C&&(this.C=null,Vb(this),Wb(this),J(19))},r.bb=function(e){e?(this.j.info("Successfully pinged google.com"),J(2)):(this.j.info("Failed to ping google.com"),J(1))},r.isActive=function(){return!!this.l&&this.l.isActive(this)},(r=ad.prototype).ra=function(){},r.qa=function(){},r.pa=function(){},r.oa=function(){},r.isActive=function(){return!0},r.Ka=function(){},bd.prototype.g=function(e,r){return new Y(e,r)},t(Y,C),Y.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Y.prototype.close=function(){cc(this.g)},Y.prototype.o=function(e){var r=this.g;if("string"==typeof e){var h={};h.__data__=e,e=h}else this.v&&((h={}).__data__=ey(e),e=h);r.i.push(new eS(r.Ya++,e)),3==r.I&&bc(r)},Y.prototype.N=function(){this.g.l=null,delete this.j,cc(this.g),delete this.g,Y.Z.N.call(this)},t(cd,gb),t(dd,hb),t(Z,ad),Z.prototype.ra=function(){D(this.g,"a")},Z.prototype.qa=function(e){D(this.g,new cd(e))},Z.prototype.pa=function(e){D(this.g,new dd)},Z.prototype.oa=function(){D(this.g,"b")},bd.prototype.createWebChannel=bd.prototype.g,Y.prototype.send=Y.prototype.o,Y.prototype.open=Y.prototype.m,Y.prototype.close=Y.prototype.close,ee=em.createWebChannelTransport=function(){return new bd},q=em.getStatEventTarget=function(){return jb()},j=em.Event=eI,M=em.Stat={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},eA.NO_ERROR=0,eA.TIMEOUT=8,eA.HTTP_ERROR=6,k=em.ErrorCode=eA,eR.COMPLETE="complete",A=em.EventType=eR,fb.EventType=eT,eT.OPEN="a",eT.CLOSE="b",eT.ERROR="c",eT.MESSAGE="d",C.prototype.listen=C.prototype.J,b=em.WebChannel=fb,em.FetchXmlHttpFactory=Ec,X.prototype.listenOnce=X.prototype.K,X.prototype.getLastError=X.prototype.Ha,X.prototype.getLastErrorCode=X.prototype.ya,X.prototype.getStatus=X.prototype.ca,X.prototype.getResponseJson=X.prototype.La,X.prototype.getResponseText=X.prototype.la,X.prototype.send=X.prototype.ea,X.prototype.setWithCredentials=X.prototype.Fa,g=em.XhrIo=X}).apply(void 0!==ed?ed:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{}),h(3454);var ef=h(1876).Buffer;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let User=class User{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};User.UNAUTHENTICATED=new User(null),User.GOOGLE_CREDENTIALS=new User("google-credentials-uid"),User.FIRST_PARTY=new User("first-party-uid"),User.MOCK_USER=new User("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ep="12.8.0",e_=new eh.Yd("@firebase/firestore");function __PRIVATE_getLogLevel(){return e_.logLevel}function common_341bda9b_esm_PRIVATE_logDebug(e,...r){if(e_.logLevel<=eh.in.DEBUG){let h=r.map(__PRIVATE_argToString);e_.debug(`Firestore (${ep}): ${e}`,...h)}}function __PRIVATE_logError(e,...r){if(e_.logLevel<=eh.in.ERROR){let h=r.map(__PRIVATE_argToString);e_.error(`Firestore (${ep}): ${e}`,...h)}}function common_341bda9b_esm_PRIVATE_logWarn(e,...r){if(e_.logLevel<=eh.in.WARN){let h=r.map(__PRIVATE_argToString);e_.warn(`Firestore (${ep}): ${e}`,...h)}}function __PRIVATE_argToString(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(r){return e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function common_341bda9b_esm_fail(e,r,h){let d="Unexpected state";"string"==typeof r?d=r:h=r,__PRIVATE__fail(e,d,h)}function __PRIVATE__fail(e,r,h){let d=`FIRESTORE (${ep}) INTERNAL ASSERTION FAILED: ${r} (ID: ${e.toString(16)})`;if(void 0!==h)try{d+=" CONTEXT: "+JSON.stringify(h)}catch(e){d+=" CONTEXT: "+h}throw __PRIVATE_logError(d),Error(d)}function __PRIVATE_hardAssert(e,r,h,d){let f="Unexpected state";"string"==typeof h?f=h:d=h,e||__PRIVATE__fail(r,f,d)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eg={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};let common_341bda9b_esm_FirestoreError=class common_341bda9b_esm_FirestoreError extends ea.ZR{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_Deferred=class __PRIVATE_Deferred{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_OAuthToken=class __PRIVATE_OAuthToken{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}};let __PRIVATE_EmptyAuthCredentialsProvider=class __PRIVATE_EmptyAuthCredentialsProvider{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(User.UNAUTHENTICATED))}shutdown(){}};let __PRIVATE_EmulatorAuthCredentialsProvider=class __PRIVATE_EmulatorAuthCredentialsProvider{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}};let __PRIVATE_FirebaseAuthCredentialsProvider=class __PRIVATE_FirebaseAuthCredentialsProvider{constructor(e){this.t=e,this.currentUser=User.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){__PRIVATE_hardAssert(void 0===this.o,42304);let h=this.i,__PRIVATE_guardedChangeListener=e=>this.i!==h?(h=this.i,r(e)):Promise.resolve(),d=new __PRIVATE_Deferred;this.o=()=>{this.i++,this.currentUser=this.u(),d.resolve(),d=new __PRIVATE_Deferred,e.enqueueRetryable(()=>__PRIVATE_guardedChangeListener(this.currentUser))};let __PRIVATE_awaitNextToken=()=>{let r=d;e.enqueueRetryable(async()=>{await r.promise,await __PRIVATE_guardedChangeListener(this.currentUser)})},__PRIVATE_registerAuth=e=>{common_341bda9b_esm_PRIVATE_logDebug("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),__PRIVATE_awaitNextToken())};this.t.onInit(e=>__PRIVATE_registerAuth(e)),setTimeout(()=>{if(!this.auth){let e=this.t.getImmediate({optional:!0});e?__PRIVATE_registerAuth(e):(common_341bda9b_esm_PRIVATE_logDebug("FirebaseAuthCredentialsProvider","Auth not yet detected"),d.resolve(),d=new __PRIVATE_Deferred)}},0),__PRIVATE_awaitNextToken()}getToken(){let e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(r=>this.i!==e?(common_341bda9b_esm_PRIVATE_logDebug("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(__PRIVATE_hardAssert("string"==typeof r.accessToken,31837,{l:r}),new __PRIVATE_OAuthToken(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return __PRIVATE_hardAssert(null===e||"string"==typeof e,2055,{h:e}),new User(e)}};let __PRIVATE_FirstPartyToken=class __PRIVATE_FirstPartyToken{constructor(e,r,h){this.P=e,this.T=r,this.I=h,this.type="FirstParty",this.user=User.FIRST_PARTY,this.R=new Map}A(){return this.I?this.I():null}get headers(){this.R.set("X-Goog-AuthUser",this.P);let e=this.A();return e&&this.R.set("Authorization",e),this.T&&this.R.set("X-Goog-Iam-Authorization-Token",this.T),this.R}};let __PRIVATE_FirstPartyAuthCredentialsProvider=class __PRIVATE_FirstPartyAuthCredentialsProvider{constructor(e,r,h){this.P=e,this.T=r,this.I=h}getToken(){return Promise.resolve(new __PRIVATE_FirstPartyToken(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable(()=>r(User.FIRST_PARTY))}shutdown(){}invalidateToken(){}};let AppCheckToken=class AppCheckToken{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}};let __PRIVATE_FirebaseAppCheckTokenProvider=class __PRIVATE_FirebaseAppCheckTokenProvider{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,(0,es.rh)(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){__PRIVATE_hardAssert(void 0===this.o,3512);let onTokenChanged=e=>{null!=e.error&&common_341bda9b_esm_PRIVATE_logDebug("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);let h=e.token!==this.m;return this.m=e.token,common_341bda9b_esm_PRIVATE_logDebug("FirebaseAppCheckTokenProvider",`Received ${h?"new":"existing"} token.`),h?r(e.token):Promise.resolve()};this.o=r=>{e.enqueueRetryable(()=>onTokenChanged(r))};let __PRIVATE_registerAppCheck=e=>{common_341bda9b_esm_PRIVATE_logDebug("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(e=>__PRIVATE_registerAppCheck(e)),setTimeout(()=>{if(!this.appCheck){let e=this.V.getImmediate({optional:!0});e?__PRIVATE_registerAppCheck(e):common_341bda9b_esm_PRIVATE_logDebug("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new AppCheckToken(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(__PRIVATE_hardAssert("string"==typeof e.token,44558,{tokenResult:e}),this.m=e.token,new AppCheckToken(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_AutoId=class __PRIVATE_AutoId{static newId(){let e=62*Math.floor(256/62),r="";for(;r.length<20;){let h=/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function(e){let r="undefined"!=typeof self&&(self.crypto||self.msCrypto),h=new Uint8Array(e);if(r&&"function"==typeof r.getRandomValues)r.getRandomValues(h);else for(let r=0;r<e;r++)h[r]=Math.floor(256*Math.random());return h}(40);for(let d=0;d<h.length;++d)r.length<20&&h[d]<e&&(r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(h[d]%62))}return r}};function __PRIVATE_primitiveComparator(e,r){return e<r?-1:e>r?1:0}function __PRIVATE_compareUtf8Strings(e,r){let h=Math.min(e.length,r.length);for(let d=0;d<h;d++){let h=e.charAt(d),f=r.charAt(d);if(h!==f)return __PRIVATE_isSurrogate(h)===__PRIVATE_isSurrogate(f)?__PRIVATE_primitiveComparator(h,f):__PRIVATE_isSurrogate(h)?1:-1}return __PRIVATE_primitiveComparator(e.length,r.length)}function __PRIVATE_isSurrogate(e){let r=e.charCodeAt(0);return r>=55296&&r<=57343}function __PRIVATE_arrayEquals(e,r,h){return e.length===r.length&&e.every((e,d)=>h(e,r[d]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ey="__name__";let BasePath=class BasePath{constructor(e,r,h){void 0===r?r=0:r>e.length&&common_341bda9b_esm_fail(637,{offset:r,range:e.length}),void 0===h?h=e.length-r:h>e.length-r&&common_341bda9b_esm_fail(1746,{length:h,range:e.length-r}),this.segments=e,this.offset=r,this.len=h}get length(){return this.len}isEqual(e){return 0===BasePath.comparator(this,e)}child(e){let r=this.segments.slice(this.offset,this.limit());return e instanceof BasePath?e.forEach(e=>{r.push(e)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,h=this.limit();r<h;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){let h=Math.min(e.length,r.length);for(let d=0;d<h;d++){let h=BasePath.compareSegments(e.get(d),r.get(d));if(0!==h)return h}return __PRIVATE_primitiveComparator(e.length,r.length)}static compareSegments(e,r){let h=BasePath.isNumericId(e),d=BasePath.isNumericId(r);return h&&!d?-1:!h&&d?1:h&&d?BasePath.extractNumericId(e).compare(BasePath.extractNumericId(r)):__PRIVATE_compareUtf8Strings(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return d.fromString(e.substring(4,e.length-2))}};let common_341bda9b_esm_ResourcePath=class common_341bda9b_esm_ResourcePath extends BasePath{construct(e,r,h){return new common_341bda9b_esm_ResourcePath(e,r,h)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let r=[];for(let h of e){if(h.indexOf("//")>=0)throw new common_341bda9b_esm_FirestoreError(eg.INVALID_ARGUMENT,`Invalid segment (${h}). Paths must not contain // in them.`);r.push(...h.split("/").filter(e=>e.length>0))}return new common_341bda9b_esm_ResourcePath(r)}static emptyPath(){return new common_341bda9b_esm_ResourcePath([])}};let ev=/^[_a-zA-Z][_a-zA-Z0-9]*$/;let FieldPath$1=class FieldPath$1 extends BasePath{construct(e,r,h){return new FieldPath$1(e,r,h)}static isValidIdentifier(e){return ev.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),FieldPath$1.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===ey}static keyField(){return new FieldPath$1([ey])}static fromServerFormat(e){let r=[],h="",d=0,__PRIVATE_addCurrentSegment=()=>{if(0===h.length)throw new common_341bda9b_esm_FirestoreError(eg.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(h),h=""},f=!1;for(;d<e.length;){let r=e[d];if("\\"===r){if(d+1===e.length)throw new common_341bda9b_esm_FirestoreError(eg.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let r=e[d+1];if("\\"!==r&&"."!==r&&"`"!==r)throw new common_341bda9b_esm_FirestoreError(eg.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);h+=r,d+=2}else"`"===r?f=!f:"."!==r||f?h+=r:__PRIVATE_addCurrentSegment(),d++}if(__PRIVATE_addCurrentSegment(),f)throw new common_341bda9b_esm_FirestoreError(eg.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new FieldPath$1(r)}static emptyPath(){return new FieldPath$1([])}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let common_341bda9b_esm_DocumentKey=class common_341bda9b_esm_DocumentKey{constructor(e){this.path=e}static fromPath(e){return new common_341bda9b_esm_DocumentKey(common_341bda9b_esm_ResourcePath.fromString(e))}static fromName(e){return new common_341bda9b_esm_DocumentKey(common_341bda9b_esm_ResourcePath.fromString(e).popFirst(5))}static empty(){return new common_341bda9b_esm_DocumentKey(common_341bda9b_esm_ResourcePath.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===common_341bda9b_esm_ResourcePath.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,r){return common_341bda9b_esm_ResourcePath.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new common_341bda9b_esm_DocumentKey(new common_341bda9b_esm_ResourcePath(e.slice()))}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_validateNonEmptyArgument(e,r,h){if(!h)throw new common_341bda9b_esm_FirestoreError(eg.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${r}.`)}function __PRIVATE_validateDocumentPath(e){if(!common_341bda9b_esm_DocumentKey.isDocumentKey(e))throw new common_341bda9b_esm_FirestoreError(eg.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function __PRIVATE_validateCollectionPath(e){if(common_341bda9b_esm_DocumentKey.isDocumentKey(e))throw new common_341bda9b_esm_FirestoreError(eg.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function __PRIVATE_isPlainObject(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}function __PRIVATE_valueDescription(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{var r;let h=(r=e).constructor?r.constructor.name:null;return h?`a custom ${h} object`:"an object"}}return"function"==typeof e?"a function":common_341bda9b_esm_fail(12329,{type:typeof e})}function common_341bda9b_esm_PRIVATE_cast(e,r){if("_delegate"in e&&(e=e._delegate),!(e instanceof r)){if(r.name===e.constructor.name)throw new common_341bda9b_esm_FirestoreError(eg.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let h=__PRIVATE_valueDescription(e);throw new common_341bda9b_esm_FirestoreError(eg.INVALID_ARGUMENT,`Expected type '${r.name}', but it was: ${h}`)}}return e}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function property(e,r){let h={typeString:e};return r&&(h.value=r),h}function common_341bda9b_esm_PRIVATE_validateJSON(e,r){let h;if(!__PRIVATE_isPlainObject(e))throw new common_341bda9b_esm_FirestoreError(eg.INVALID_ARGUMENT,"JSON must be an object");for(let d in r)if(r[d]){let f=r[d].typeString,g="value"in r[d]?{value:r[d].value}:void 0;if(!(d in e)){h=`JSON missing required field: '${d}'`;break}let b=e[d];if(f&&typeof b!==f){h=`JSON field '${d}' must be a ${f}.`;break}if(void 0!==g&&b!==g.value){h=`Expected '${d}' field to equal '${g.value}'`;break}}if(h)throw new common_341bda9b_esm_FirestoreError(eg.INVALID_ARGUMENT,h);return!0}let Timestamp=class Timestamp{static now(){return Timestamp.fromMillis(Date.now())}static fromDate(e){return Timestamp.fromMillis(e.getTime())}static fromMillis(e){let r=Math.floor(e/1e3),h=Math.floor((e-1e3*r)*1e6);return new Timestamp(r,h)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0||r>=1e9)throw new common_341bda9b_esm_FirestoreError(eg.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800||e>=253402300800)throw new common_341bda9b_esm_FirestoreError(eg.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?__PRIVATE_primitiveComparator(this.nanoseconds,e.nanoseconds):__PRIVATE_primitiveComparator(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Timestamp._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(common_341bda9b_esm_PRIVATE_validateJSON(e,Timestamp._jsonSchema))return new Timestamp(e.seconds,e.nanoseconds)}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};Timestamp._jsonSchemaVersion="firestore/timestamp/1.0",Timestamp._jsonSchema={type:property("string",Timestamp._jsonSchemaVersion),seconds:property("number"),nanoseconds:property("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let SnapshotVersion=class SnapshotVersion{static fromTimestamp(e){return new SnapshotVersion(e)}static min(){return new SnapshotVersion(new Timestamp(0,0))}static max(){return new SnapshotVersion(new Timestamp(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};let IndexOffset=class IndexOffset{constructor(e,r,h){this.readTime=e,this.documentKey=r,this.largestBatchId=h}static min(){return new IndexOffset(SnapshotVersion.min(),common_341bda9b_esm_DocumentKey.empty(),-1)}static max(){return new IndexOffset(SnapshotVersion.max(),common_341bda9b_esm_DocumentKey.empty(),-1)}};let PersistenceTransaction=class PersistenceTransaction{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function __PRIVATE_ignoreIfPrimaryLeaseLoss(e){if(e.code!==eg.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;common_341bda9b_esm_PRIVATE_logDebug("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let PersistencePromise=class PersistencePromise{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&common_341bda9b_esm_fail(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new PersistencePromise((h,d)=>{this.nextCallback=r=>{this.wrapSuccess(e,r).next(h,d)},this.catchCallback=e=>{this.wrapFailure(r,e).next(h,d)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{let r=e();return r instanceof PersistencePromise?r:PersistencePromise.resolve(r)}catch(e){return PersistencePromise.reject(e)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):PersistencePromise.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):PersistencePromise.reject(r)}static resolve(e){return new PersistencePromise((r,h)=>{r(e)})}static reject(e){return new PersistencePromise((r,h)=>{h(e)})}static waitFor(e){return new PersistencePromise((r,h)=>{let d=0,f=0,g=!1;e.forEach(e=>{++d,e.next(()=>{++f,g&&f===d&&r()},e=>h(e))}),g=!0,f===d&&r()})}static or(e){let r=PersistencePromise.resolve(!1);for(let h of e)r=r.next(e=>e?PersistencePromise.resolve(e):h());return r}static forEach(e,r){let h=[];return e.forEach((e,d)=>{h.push(r.call(this,e,d))}),this.waitFor(h)}static mapArray(e,r){return new PersistencePromise((h,d)=>{let f=e.length,g=Array(f),b=0;for(let A=0;A<f;A++){let k=A;r(e[k]).next(e=>{g[k]=e,++b===f&&h(g)},e=>d(e))}})}static doWhile(e,r){return new PersistencePromise((h,d)=>{let process=()=>{!0===e()?r().next(()=>{process()},d):h()};process()})}};function __PRIVATE_isIndexedDbTransactionError(e){return"IndexedDbTransactionError"===e.name}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_ListenSequence=class __PRIVATE_ListenSequence{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=e=>this.ae(e),this.ue=e=>r.writeSequenceNumber(e))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){let e=++this.previousValue;return this.ue&&this.ue(e),e}};function __PRIVATE_isNegativeZero(e){return 0===e&&1/e==-1/0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_objectSize(e){let r=0;for(let h in e)Object.prototype.hasOwnProperty.call(e,h)&&r++;return r}function forEach(e,r){for(let h in e)Object.prototype.hasOwnProperty.call(e,h)&&r(h,e[h])}function isEmpty(e){for(let r in e)if(Object.prototype.hasOwnProperty.call(e,r))return!1;return!0}__PRIVATE_ListenSequence.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let SortedMap=class SortedMap{constructor(e,r){this.comparator=e,this.root=r||LLRBNode.EMPTY}insert(e,r){return new SortedMap(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,LLRBNode.BLACK,null,null))}remove(e){return new SortedMap(this.comparator,this.root.remove(e,this.comparator).copy(null,null,LLRBNode.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){let h=this.comparator(e,r.key);if(0===h)return r.value;h<0?r=r.left:h>0&&(r=r.right)}return null}indexOf(e){let r=0,h=this.root;for(;!h.isEmpty();){let d=this.comparator(e,h.key);if(0===d)return r+h.left.size;d<0?h=h.left:(r+=h.left.size+1,h=h.right)}return -1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,h)=>(e(r,h),!1))}toString(){let e=[];return this.inorderTraversal((r,h)=>(e.push(`${r}:${h}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new SortedMapIterator(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new SortedMapIterator(this.root,e,this.comparator,!1)}getReverseIterator(){return new SortedMapIterator(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new SortedMapIterator(this.root,e,this.comparator,!0)}};let SortedMapIterator=class SortedMapIterator{constructor(e,r,h,d){this.isReverse=d,this.nodeStack=[];let f=1;for(;!e.isEmpty();)if(f=r?h(e.key,r):1,r&&d&&(f*=-1),f<0)e=this.isReverse?e.left:e.right;else{if(0===f){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}};let LLRBNode=class LLRBNode{constructor(e,r,h,d,f){this.key=e,this.value=r,this.color=null!=h?h:LLRBNode.RED,this.left=null!=d?d:LLRBNode.EMPTY,this.right=null!=f?f:LLRBNode.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,h,d,f){return new LLRBNode(null!=e?e:this.key,null!=r?r:this.value,null!=h?h:this.color,null!=d?d:this.left,null!=f?f:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,h){let d=this,f=h(e,d.key);return(d=f<0?d.copy(null,null,null,d.left.insert(e,r,h),null):0===f?d.copy(null,r,null,null,null):d.copy(null,null,null,null,d.right.insert(e,r,h))).fixUp()}removeMin(){if(this.left.isEmpty())return LLRBNode.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()}remove(e,r){let h,d=this;if(0>r(e,d.key))d.left.isEmpty()||d.left.isRed()||d.left.left.isRed()||(d=d.moveRedLeft()),d=d.copy(null,null,null,d.left.remove(e,r),null);else{if(d.left.isRed()&&(d=d.rotateRight()),d.right.isEmpty()||d.right.isRed()||d.right.left.isRed()||(d=d.moveRedRight()),0===r(e,d.key)){if(d.right.isEmpty())return LLRBNode.EMPTY;h=d.right.min(),d=d.copy(h.key,h.value,null,null,d.right.removeMin())}d=d.copy(null,null,null,null,d.right.remove(e,r))}return d.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e}rotateLeft(){let e=this.copy(null,null,LLRBNode.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,LLRBNode.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw common_341bda9b_esm_fail(43730,{key:this.key,value:this.value});if(this.right.isRed())throw common_341bda9b_esm_fail(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw common_341bda9b_esm_fail(27949);return e+(this.isRed()?0:1)}};LLRBNode.EMPTY=null,LLRBNode.RED=!0,LLRBNode.BLACK=!1,LLRBNode.EMPTY=new class{constructor(){this.size=0}get key(){throw common_341bda9b_esm_fail(57766)}get value(){throw common_341bda9b_esm_fail(16141)}get color(){throw common_341bda9b_esm_fail(16727)}get left(){throw common_341bda9b_esm_fail(29726)}get right(){throw common_341bda9b_esm_fail(36894)}copy(e,r,h,d,f){return this}insert(e,r,h){return new LLRBNode(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let SortedSet=class SortedSet{constructor(e){this.comparator=e,this.data=new SortedMap(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,h)=>(e(r),!1))}forEachInRange(e,r){let h=this.data.getIteratorFrom(e[0]);for(;h.hasNext();){let d=h.getNext();if(this.comparator(d.key,e[1])>=0)return;r(d.key)}}forEachWhile(e,r){let h;for(h=void 0!==r?this.data.getIteratorFrom(r):this.data.getIterator();h.hasNext();)if(!e(h.getNext().key))return}firstAfterOrEqual(e){let r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new SortedSetIterator(this.data.getIterator())}getIteratorFrom(e){return new SortedSetIterator(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(e=>{r=r.add(e)}),r}isEqual(e){if(!(e instanceof SortedSet)||this.size!==e.size)return!1;let r=this.data.getIterator(),h=e.data.getIterator();for(;r.hasNext();){let e=r.getNext().key,d=h.getNext().key;if(0!==this.comparator(e,d))return!1}return!0}toArray(){let e=[];return this.forEach(r=>{e.push(r)}),e}toString(){let e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){let r=new SortedSet(this.comparator);return r.data=e,r}};let SortedSetIterator=class SortedSetIterator{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let FieldMask=class FieldMask{constructor(e){this.fields=e,e.sort(FieldPath$1.comparator)}static empty(){return new FieldMask([])}unionWith(e){let r=new SortedSet(FieldPath$1.comparator);for(let e of this.fields)r=r.add(e);for(let h of e)r=r.add(h);return new FieldMask(r.toArray())}covers(e){for(let r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return __PRIVATE_arrayEquals(this.fields,e.fields,(e,r)=>e.isEqual(r))}};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_Base64DecodeError=class __PRIVATE_Base64DecodeError extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ByteString=class ByteString{constructor(e){this.binaryString=e}static fromBase64String(e){let r=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new __PRIVATE_Base64DecodeError("Invalid base64 string: "+e):e}}(e);return new ByteString(r)}static fromUint8Array(e){let r=function(e){let r="";for(let h=0;h<e.length;++h)r+=String.fromCharCode(e[h]);return r}(e);return new ByteString(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(e){let r=new Uint8Array(e.length);for(let h=0;h<e.length;h++)r[h]=e.charCodeAt(h);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return __PRIVATE_primitiveComparator(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};ByteString.EMPTY_BYTE_STRING=new ByteString("");let eE=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function __PRIVATE_normalizeTimestamp(e){if(__PRIVATE_hardAssert(!!e,39018),"string"==typeof e){let r=0,h=eE.exec(e);if(__PRIVATE_hardAssert(!!h,46558,{timestamp:e}),h[1]){let e=h[1];r=Number(e=(e+"000000000").substr(0,9))}let d=new Date(e);return{seconds:Math.floor(d.getTime()/1e3),nanos:r}}return{seconds:__PRIVATE_normalizeNumber(e.seconds),nanos:__PRIVATE_normalizeNumber(e.nanos)}}function __PRIVATE_normalizeNumber(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function __PRIVATE_normalizeByteString(e){return"string"==typeof e?ByteString.fromBase64String(e):ByteString.fromUint8Array(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eT="server_timestamp",eI="__type__",eP="__previous_value__",eA="__local_write_time__";function common_341bda9b_esm_PRIVATE_isServerTimestamp(e){let r=(e?.mapValue?.fields||{})[eI]?.stringValue;return r===eT}function __PRIVATE_getPreviousValue(e){let r=e.mapValue.fields[eP];return common_341bda9b_esm_PRIVATE_isServerTimestamp(r)?__PRIVATE_getPreviousValue(r):r}function __PRIVATE_getLocalWriteTime(e){let r=__PRIVATE_normalizeTimestamp(e.mapValue.fields[eA].timestampValue);return new Timestamp(r.seconds,r.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let DatabaseInfo=class DatabaseInfo{constructor(e,r,h,d,f,g,b,A,k,M,j){this.databaseId=e,this.appId=r,this.persistenceKey=h,this.host=d,this.ssl=f,this.forceLongPolling=g,this.autoDetectLongPolling=b,this.longPollingOptions=A,this.useFetchStreams=k,this.isUsingEmulator=M,this.apiKey=j}};let eR="(default)";let DatabaseId=class DatabaseId{constructor(e,r){this.projectId=e,this.database=r||eR}static empty(){return new DatabaseId("","")}get isDefaultDatabase(){return this.database===eR}isEqual(e){return e instanceof DatabaseId&&e.projectId===this.projectId&&e.database===this.database}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ew="__type__",eV="__max__",eS={mapValue:{fields:{__type__:{stringValue:eV}}}},eC="__vector__",ex="value";function __PRIVATE_typeOrder(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?common_341bda9b_esm_PRIVATE_isServerTimestamp(e)?4:__PRIVATE_isMaxValue(e)?9007199254740991:__PRIVATE_isVectorValue(e)?10:11:common_341bda9b_esm_fail(28295,{value:e})}function __PRIVATE_valueEquals(e,r){if(e===r)return!0;let h=__PRIVATE_typeOrder(e);if(h!==__PRIVATE_typeOrder(r))return!1;switch(h){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===r.booleanValue;case 4:return __PRIVATE_getLocalWriteTime(e).isEqual(__PRIVATE_getLocalWriteTime(r));case 3:return function(e,r){if("string"==typeof e.timestampValue&&"string"==typeof r.timestampValue&&e.timestampValue.length===r.timestampValue.length)return e.timestampValue===r.timestampValue;let h=__PRIVATE_normalizeTimestamp(e.timestampValue),d=__PRIVATE_normalizeTimestamp(r.timestampValue);return h.seconds===d.seconds&&h.nanos===d.nanos}(e,r);case 5:return e.stringValue===r.stringValue;case 6:return __PRIVATE_normalizeByteString(e.bytesValue).isEqual(__PRIVATE_normalizeByteString(r.bytesValue));case 7:return e.referenceValue===r.referenceValue;case 8:return __PRIVATE_normalizeNumber(e.geoPointValue.latitude)===__PRIVATE_normalizeNumber(r.geoPointValue.latitude)&&__PRIVATE_normalizeNumber(e.geoPointValue.longitude)===__PRIVATE_normalizeNumber(r.geoPointValue.longitude);case 2:return function(e,r){if("integerValue"in e&&"integerValue"in r)return __PRIVATE_normalizeNumber(e.integerValue)===__PRIVATE_normalizeNumber(r.integerValue);if("doubleValue"in e&&"doubleValue"in r){let h=__PRIVATE_normalizeNumber(e.doubleValue),d=__PRIVATE_normalizeNumber(r.doubleValue);return h===d?__PRIVATE_isNegativeZero(h)===__PRIVATE_isNegativeZero(d):isNaN(h)&&isNaN(d)}return!1}(e,r);case 9:return __PRIVATE_arrayEquals(e.arrayValue.values||[],r.arrayValue.values||[],__PRIVATE_valueEquals);case 10:case 11:return function(e,r){let h=e.mapValue.fields||{},d=r.mapValue.fields||{};if(__PRIVATE_objectSize(h)!==__PRIVATE_objectSize(d))return!1;for(let e in h)if(h.hasOwnProperty(e)&&(void 0===d[e]||!__PRIVATE_valueEquals(h[e],d[e])))return!1;return!0}(e,r);default:return common_341bda9b_esm_fail(52216,{left:e})}}function __PRIVATE_arrayValueContains(e,r){return void 0!==(e.values||[]).find(e=>__PRIVATE_valueEquals(e,r))}function __PRIVATE_valueCompare(e,r){if(e===r)return 0;let h=__PRIVATE_typeOrder(e),d=__PRIVATE_typeOrder(r);if(h!==d)return __PRIVATE_primitiveComparator(h,d);switch(h){case 0:case 9007199254740991:return 0;case 1:return __PRIVATE_primitiveComparator(e.booleanValue,r.booleanValue);case 2:return function(e,r){let h=__PRIVATE_normalizeNumber(e.integerValue||e.doubleValue),d=__PRIVATE_normalizeNumber(r.integerValue||r.doubleValue);return h<d?-1:h>d?1:h===d?0:isNaN(h)?isNaN(d)?0:-1:1}(e,r);case 3:return __PRIVATE_compareTimestamps(e.timestampValue,r.timestampValue);case 4:return __PRIVATE_compareTimestamps(__PRIVATE_getLocalWriteTime(e),__PRIVATE_getLocalWriteTime(r));case 5:return __PRIVATE_compareUtf8Strings(e.stringValue,r.stringValue);case 6:return function(e,r){let h=__PRIVATE_normalizeByteString(e),d=__PRIVATE_normalizeByteString(r);return h.compareTo(d)}(e.bytesValue,r.bytesValue);case 7:return function(e,r){let h=e.split("/"),d=r.split("/");for(let e=0;e<h.length&&e<d.length;e++){let r=__PRIVATE_primitiveComparator(h[e],d[e]);if(0!==r)return r}return __PRIVATE_primitiveComparator(h.length,d.length)}(e.referenceValue,r.referenceValue);case 8:return function(e,r){let h=__PRIVATE_primitiveComparator(__PRIVATE_normalizeNumber(e.latitude),__PRIVATE_normalizeNumber(r.latitude));return 0!==h?h:__PRIVATE_primitiveComparator(__PRIVATE_normalizeNumber(e.longitude),__PRIVATE_normalizeNumber(r.longitude))}(e.geoPointValue,r.geoPointValue);case 9:return __PRIVATE_compareArrays(e.arrayValue,r.arrayValue);case 10:return function(e,r){let h=e.fields||{},d=r.fields||{},f=h[ex]?.arrayValue,g=d[ex]?.arrayValue,b=__PRIVATE_primitiveComparator(f?.values?.length||0,g?.values?.length||0);return 0!==b?b:__PRIVATE_compareArrays(f,g)}(e.mapValue,r.mapValue);case 11:return function(e,r){if(e===eS.mapValue&&r===eS.mapValue)return 0;if(e===eS.mapValue)return 1;if(r===eS.mapValue)return -1;let h=e.fields||{},d=Object.keys(h),f=r.fields||{},g=Object.keys(f);d.sort(),g.sort();for(let e=0;e<d.length&&e<g.length;++e){let r=__PRIVATE_compareUtf8Strings(d[e],g[e]);if(0!==r)return r;let b=__PRIVATE_valueCompare(h[d[e]],f[g[e]]);if(0!==b)return b}return __PRIVATE_primitiveComparator(d.length,g.length)}(e.mapValue,r.mapValue);default:throw common_341bda9b_esm_fail(23264,{he:h})}}function __PRIVATE_compareTimestamps(e,r){if("string"==typeof e&&"string"==typeof r&&e.length===r.length)return __PRIVATE_primitiveComparator(e,r);let h=__PRIVATE_normalizeTimestamp(e),d=__PRIVATE_normalizeTimestamp(r),f=__PRIVATE_primitiveComparator(h.seconds,d.seconds);return 0!==f?f:__PRIVATE_primitiveComparator(h.nanos,d.nanos)}function __PRIVATE_compareArrays(e,r){let h=e.values||[],d=r.values||[];for(let e=0;e<h.length&&e<d.length;++e){let r=__PRIVATE_valueCompare(h[e],d[e]);if(r)return r}return __PRIVATE_primitiveComparator(h.length,d.length)}function __PRIVATE_canonifyValue(e){var r,h;return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){let r=__PRIVATE_normalizeTimestamp(e);return`time(${r.seconds},${r.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?__PRIVATE_normalizeByteString(e.bytesValue).toBase64():"referenceValue"in e?(r=e.referenceValue,common_341bda9b_esm_DocumentKey.fromName(r).toString()):"geoPointValue"in e?(h=e.geoPointValue,`geo(${h.latitude},${h.longitude})`):"arrayValue"in e?function(e){let r="[",h=!0;for(let d of e.values||[])h?h=!1:r+=",",r+=__PRIVATE_canonifyValue(d);return r+"]"}(e.arrayValue):"mapValue"in e?function(e){let r=Object.keys(e.fields||{}).sort(),h="{",d=!0;for(let f of r)d?d=!1:h+=",",h+=`${f}:${__PRIVATE_canonifyValue(e.fields[f])}`;return h+"}"}(e.mapValue):common_341bda9b_esm_fail(61005,{value:e})}function common_341bda9b_esm_PRIVATE_refValue(e,r){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${r.path.canonicalString()}`}}function isInteger(e){return!!e&&"integerValue"in e}function isArray(e){return!!e&&"arrayValue"in e}function __PRIVATE_isNullValue(e){return!!e&&"nullValue"in e}function __PRIVATE_isNanValue(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function __PRIVATE_isMapValue(e){return!!e&&"mapValue"in e}function __PRIVATE_isVectorValue(e){let r=(e?.mapValue?.fields||{})[ew]?.stringValue;return r===eC}function __PRIVATE_deepClone(e){if(e.geoPointValue)return{geoPointValue:{...e.geoPointValue}};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:{...e.timestampValue}};if(e.mapValue){let r={mapValue:{fields:{}}};return forEach(e.mapValue.fields,(e,h)=>r.mapValue.fields[e]=__PRIVATE_deepClone(h)),r}if(e.arrayValue){let r={arrayValue:{values:[]}};for(let h=0;h<(e.arrayValue.values||[]).length;++h)r.arrayValue.values[h]=__PRIVATE_deepClone(e.arrayValue.values[h]);return r}return{...e}}function __PRIVATE_isMaxValue(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===eV}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let common_341bda9b_esm_ObjectValue=class common_341bda9b_esm_ObjectValue{constructor(e){this.value=e}static empty(){return new common_341bda9b_esm_ObjectValue({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let h=0;h<e.length-1;++h)if(!__PRIVATE_isMapValue(r=(r.mapValue.fields||{})[e.get(h)]))return null;return(r=(r.mapValue.fields||{})[e.lastSegment()])||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=__PRIVATE_deepClone(r)}setAll(e){let r=FieldPath$1.emptyPath(),h={},d=[];e.forEach((e,f)=>{if(!r.isImmediateParentOf(f)){let e=this.getFieldsMap(r);this.applyChanges(e,h,d),h={},d=[],r=f.popLast()}e?h[f.lastSegment()]=__PRIVATE_deepClone(e):d.push(f.lastSegment())});let f=this.getFieldsMap(r);this.applyChanges(f,h,d)}delete(e){let r=this.field(e.popLast());__PRIVATE_isMapValue(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return __PRIVATE_valueEquals(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let h=0;h<e.length;++h){let d=r.mapValue.fields[e.get(h)];__PRIVATE_isMapValue(d)&&d.mapValue.fields||(d={mapValue:{fields:{}}},r.mapValue.fields[e.get(h)]=d),r=d}return r.mapValue.fields}applyChanges(e,r,h){for(let d of(forEach(r,(r,h)=>e[r]=h),h))delete e[d]}clone(){return new common_341bda9b_esm_ObjectValue(__PRIVATE_deepClone(this.value))}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let MutableDocument=class MutableDocument{constructor(e,r,h,d,f,g,b){this.key=e,this.documentType=r,this.version=h,this.readTime=d,this.createTime=f,this.data=g,this.documentState=b}static newInvalidDocument(e){return new MutableDocument(e,0,SnapshotVersion.min(),SnapshotVersion.min(),SnapshotVersion.min(),common_341bda9b_esm_ObjectValue.empty(),0)}static newFoundDocument(e,r,h,d){return new MutableDocument(e,1,r,SnapshotVersion.min(),h,d,0)}static newNoDocument(e,r){return new MutableDocument(e,2,r,SnapshotVersion.min(),SnapshotVersion.min(),common_341bda9b_esm_ObjectValue.empty(),0)}static newUnknownDocument(e,r){return new MutableDocument(e,3,r,SnapshotVersion.min(),SnapshotVersion.min(),common_341bda9b_esm_ObjectValue.empty(),2)}convertToFoundDocument(e,r){return this.createTime.isEqual(SnapshotVersion.min())&&(2===this.documentType||0===this.documentType)&&(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=common_341bda9b_esm_ObjectValue.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=common_341bda9b_esm_ObjectValue.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=SnapshotVersion.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof MutableDocument&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new MutableDocument(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let common_341bda9b_esm_Bound=class common_341bda9b_esm_Bound{constructor(e,r){this.position=e,this.inclusive=r}};function __PRIVATE_boundCompareToDocument(e,r,h){let d=0;for(let f=0;f<e.position.length;f++){let g=r[f],b=e.position[f];if(d=g.field.isKeyField()?common_341bda9b_esm_DocumentKey.comparator(common_341bda9b_esm_DocumentKey.fromName(b.referenceValue),h.key):__PRIVATE_valueCompare(b,h.data.field(g.field)),"desc"===g.dir&&(d*=-1),0!==d)break}return d}function __PRIVATE_boundEquals(e,r){if(null===e)return null===r;if(null===r||e.inclusive!==r.inclusive||e.position.length!==r.position.length)return!1;for(let h=0;h<e.position.length;h++)if(!__PRIVATE_valueEquals(e.position[h],r.position[h]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let OrderBy=class OrderBy{constructor(e,r="asc"){this.field=e,this.dir=r}};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Filter=class Filter{};let FieldFilter=class FieldFilter extends Filter{constructor(e,r,h){super(),this.field=e,this.op=r,this.value=h}static create(e,r,h){return e.isKeyField()?"in"===r||"not-in"===r?this.createKeyFieldInFilter(e,r,h):new __PRIVATE_KeyFieldFilter(e,r,h):"array-contains"===r?new __PRIVATE_ArrayContainsFilter(e,h):"in"===r?new __PRIVATE_InFilter(e,h):"not-in"===r?new __PRIVATE_NotInFilter(e,h):"array-contains-any"===r?new __PRIVATE_ArrayContainsAnyFilter(e,h):new FieldFilter(e,r,h)}static createKeyFieldInFilter(e,r,h){return"in"===r?new __PRIVATE_KeyFieldInFilter(e,h):new __PRIVATE_KeyFieldNotInFilter(e,h)}matches(e){let r=e.data.field(this.field);return"!="===this.op?null!==r&&void 0===r.nullValue&&this.matchesComparison(__PRIVATE_valueCompare(r,this.value)):null!==r&&__PRIVATE_typeOrder(this.value)===__PRIVATE_typeOrder(r)&&this.matchesComparison(__PRIVATE_valueCompare(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return common_341bda9b_esm_fail(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}};let CompositeFilter=class CompositeFilter extends Filter{constructor(e,r){super(),this.filters=e,this.op=r,this.Pe=null}static create(e,r){return new CompositeFilter(e,r)}matches(e){return __PRIVATE_compositeFilterIsConjunction(this)?void 0===this.filters.find(r=>!r.matches(e)):void 0!==this.filters.find(r=>r.matches(e))}getFlattenedFilters(){return null!==this.Pe||(this.Pe=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}};function __PRIVATE_compositeFilterIsConjunction(e){return"and"===e.op}function __PRIVATE_compositeFilterIsFlat(e){for(let r of e.filters)if(r instanceof CompositeFilter)return!1;return!0}let __PRIVATE_KeyFieldFilter=class __PRIVATE_KeyFieldFilter extends FieldFilter{constructor(e,r,h){super(e,r,h),this.key=common_341bda9b_esm_DocumentKey.fromName(h.referenceValue)}matches(e){let r=common_341bda9b_esm_DocumentKey.comparator(e.key,this.key);return this.matchesComparison(r)}};let __PRIVATE_KeyFieldInFilter=class __PRIVATE_KeyFieldInFilter extends FieldFilter{constructor(e,r){super(e,"in",r),this.keys=__PRIVATE_extractDocumentKeysFromArrayValue("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}};let __PRIVATE_KeyFieldNotInFilter=class __PRIVATE_KeyFieldNotInFilter extends FieldFilter{constructor(e,r){super(e,"not-in",r),this.keys=__PRIVATE_extractDocumentKeysFromArrayValue("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}};function __PRIVATE_extractDocumentKeysFromArrayValue(e,r){return(r.arrayValue?.values||[]).map(e=>common_341bda9b_esm_DocumentKey.fromName(e.referenceValue))}let __PRIVATE_ArrayContainsFilter=class __PRIVATE_ArrayContainsFilter extends FieldFilter{constructor(e,r){super(e,"array-contains",r)}matches(e){let r=e.data.field(this.field);return isArray(r)&&__PRIVATE_arrayValueContains(r.arrayValue,this.value)}};let __PRIVATE_InFilter=class __PRIVATE_InFilter extends FieldFilter{constructor(e,r){super(e,"in",r)}matches(e){let r=e.data.field(this.field);return null!==r&&__PRIVATE_arrayValueContains(this.value.arrayValue,r)}};let __PRIVATE_NotInFilter=class __PRIVATE_NotInFilter extends FieldFilter{constructor(e,r){super(e,"not-in",r)}matches(e){if(__PRIVATE_arrayValueContains(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let r=e.data.field(this.field);return null!==r&&void 0===r.nullValue&&!__PRIVATE_arrayValueContains(this.value.arrayValue,r)}};let __PRIVATE_ArrayContainsAnyFilter=class __PRIVATE_ArrayContainsAnyFilter extends FieldFilter{constructor(e,r){super(e,"array-contains-any",r)}matches(e){let r=e.data.field(this.field);return!(!isArray(r)||!r.arrayValue.values)&&r.arrayValue.values.some(e=>__PRIVATE_arrayValueContains(this.value.arrayValue,e))}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_TargetImpl=class __PRIVATE_TargetImpl{constructor(e,r=null,h=[],d=[],f=null,g=null,b=null){this.path=e,this.collectionGroup=r,this.orderBy=h,this.filters=d,this.limit=f,this.startAt=g,this.endAt=b,this.Te=null}};function __PRIVATE_newTarget(e,r=null,h=[],d=[],f=null,g=null,b=null){return new __PRIVATE_TargetImpl(e,r,h,d,f,g,b)}function __PRIVATE_canonifyTarget(e){if(null===e.Te){let r=e.path.canonicalString();null!==e.collectionGroup&&(r+="|cg:"+e.collectionGroup),r+="|f:"+e.filters.map(e=>(function __PRIVATE_canonifyFilter(e){if(e instanceof FieldFilter)return e.field.canonicalString()+e.op.toString()+__PRIVATE_canonifyValue(e.value);if(__PRIVATE_compositeFilterIsFlat(e)&&__PRIVATE_compositeFilterIsConjunction(e))return e.filters.map(e=>__PRIVATE_canonifyFilter(e)).join(",");{let r=e.filters.map(e=>__PRIVATE_canonifyFilter(e)).join(",");return`${e.op}(${r})`}})(e)).join(",")+"|ob:"+e.orderBy.map(e=>e.field.canonicalString()+e.dir).join(","),null==e.limit||(r+="|l:"+e.limit),e.startAt&&(r+="|lb:"+(e.startAt.inclusive?"b:":"a:")+e.startAt.position.map(e=>__PRIVATE_canonifyValue(e)).join(",")),e.endAt&&(r+="|ub:"+(e.endAt.inclusive?"a:":"b:")+e.endAt.position.map(e=>__PRIVATE_canonifyValue(e)).join(",")),e.Te=r}return e.Te}function __PRIVATE_targetEquals(e,r){if(e.limit!==r.limit||e.orderBy.length!==r.orderBy.length)return!1;for(let f=0;f<e.orderBy.length;f++){var h,d;if(h=e.orderBy[f],d=r.orderBy[f],!(h.dir===d.dir&&h.field.isEqual(d.field)))return!1}if(e.filters.length!==r.filters.length)return!1;for(let h=0;h<e.filters.length;h++)if(!function __PRIVATE_filterEquals(e,r){return e instanceof FieldFilter?r instanceof FieldFilter&&e.op===r.op&&e.field.isEqual(r.field)&&__PRIVATE_valueEquals(e.value,r.value):e instanceof CompositeFilter?r instanceof CompositeFilter&&e.op===r.op&&e.filters.length===r.filters.length&&e.filters.reduce((e,h,d)=>e&&__PRIVATE_filterEquals(h,r.filters[d]),!0):void common_341bda9b_esm_fail(19439)}(e.filters[h],r.filters[h]))return!1;return e.collectionGroup===r.collectionGroup&&!!e.path.isEqual(r.path)&&!!__PRIVATE_boundEquals(e.startAt,r.startAt)&&__PRIVATE_boundEquals(e.endAt,r.endAt)}function __PRIVATE_targetIsDocumentTarget(e){return common_341bda9b_esm_DocumentKey.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_QueryImpl=class __PRIVATE_QueryImpl{constructor(e,r=null,h=[],d=[],f=null,g="F",b=null,A=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=h,this.filters=d,this.limit=f,this.limitType=g,this.startAt=b,this.endAt=A,this.Ie=null,this.Ee=null,this.Re=null,this.startAt,this.endAt}};function __PRIVATE_queryMatchesAllDocuments(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function common_341bda9b_esm_PRIVATE_isCollectionGroupQuery(e){return null!==e.collectionGroup}function common_341bda9b_esm_PRIVATE_queryNormalizedOrderBy(e){if(null===e.Ie){let r;e.Ie=[];let h=new Set;for(let r of e.explicitOrderBy)e.Ie.push(r),h.add(r.field.canonicalString());let d=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc",f=(r=new SortedSet(FieldPath$1.comparator),e.filters.forEach(e=>{e.getFlattenedFilters().forEach(e=>{e.isInequality()&&(r=r.add(e.field))})}),r);f.forEach(r=>{h.has(r.canonicalString())||r.isKeyField()||e.Ie.push(new OrderBy(r,d))}),h.has(FieldPath$1.keyField().canonicalString())||e.Ie.push(new OrderBy(FieldPath$1.keyField(),d))}return e.Ie}function __PRIVATE_queryToTarget(e){return e.Ee||(e.Ee=function(e,r){if("F"===e.limitType)return __PRIVATE_newTarget(e.path,e.collectionGroup,r,e.filters,e.limit,e.startAt,e.endAt);{r=r.map(e=>{let r="desc"===e.dir?"asc":"desc";return new OrderBy(e.field,r)});let h=e.endAt?new common_341bda9b_esm_Bound(e.endAt.position,e.endAt.inclusive):null,d=e.startAt?new common_341bda9b_esm_Bound(e.startAt.position,e.startAt.inclusive):null;return __PRIVATE_newTarget(e.path,e.collectionGroup,r,e.filters,e.limit,h,d)}}(e,common_341bda9b_esm_PRIVATE_queryNormalizedOrderBy(e))),e.Ee}function __PRIVATE_queryWithAddedFilter(e,r){let h=e.filters.concat([r]);return new __PRIVATE_QueryImpl(e.path,e.collectionGroup,e.explicitOrderBy.slice(),h,e.limit,e.limitType,e.startAt,e.endAt)}function common_341bda9b_esm_PRIVATE_queryWithLimit(e,r,h){return new __PRIVATE_QueryImpl(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),r,h,e.startAt,e.endAt)}function __PRIVATE_queryEquals(e,r){return __PRIVATE_targetEquals(__PRIVATE_queryToTarget(e),__PRIVATE_queryToTarget(r))&&e.limitType===r.limitType}function __PRIVATE_canonifyQuery(e){return`${__PRIVATE_canonifyTarget(__PRIVATE_queryToTarget(e))}|lt:${e.limitType}`}function __PRIVATE_stringifyQuery(e){var r;let h;return`Query(target=${h=(r=__PRIVATE_queryToTarget(e)).path.canonicalString(),null!==r.collectionGroup&&(h+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(h+=`, filters: [${r.filters.map(e=>(function __PRIVATE_stringifyFilter(e){return e instanceof FieldFilter?`${e.field.canonicalString()} ${e.op} ${__PRIVATE_canonifyValue(e.value)}`:e instanceof CompositeFilter?e.op.toString()+" {"+e.getFilters().map(__PRIVATE_stringifyFilter).join(" ,")+"}":"Filter"})(e)).join(", ")}]`),null==r.limit||(h+=", limit: "+r.limit),r.orderBy.length>0&&(h+=`, orderBy: [${r.orderBy.map(e=>`${e.field.canonicalString()} (${e.dir})`).join(", ")}]`),r.startAt&&(h+=", startAt: "+(r.startAt.inclusive?"b:":"a:")+r.startAt.position.map(e=>__PRIVATE_canonifyValue(e)).join(",")),r.endAt&&(h+=", endAt: "+(r.endAt.inclusive?"a:":"b:")+r.endAt.position.map(e=>__PRIVATE_canonifyValue(e)).join(",")),`Target(${h})`}; limitType=${e.limitType})`}function __PRIVATE_queryMatches(e,r){return r.isFoundDocument()&&function(e,r){let h=r.key.path;return null!==e.collectionGroup?r.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(h):common_341bda9b_esm_DocumentKey.isDocumentKey(e.path)?e.path.isEqual(h):e.path.isImmediateParentOf(h)}(e,r)&&function(e,r){for(let h of common_341bda9b_esm_PRIVATE_queryNormalizedOrderBy(e))if(!h.field.isKeyField()&&null===r.data.field(h.field))return!1;return!0}(e,r)&&function(e,r){for(let h of e.filters)if(!h.matches(r))return!1;return!0}(e,r)&&(!e.startAt||!!function(e,r,h){let d=__PRIVATE_boundCompareToDocument(e,r,h);return e.inclusive?d<=0:d<0}(e.startAt,common_341bda9b_esm_PRIVATE_queryNormalizedOrderBy(e),r))&&(!e.endAt||!!function(e,r,h){let d=__PRIVATE_boundCompareToDocument(e,r,h);return e.inclusive?d>=0:d>0}(e.endAt,common_341bda9b_esm_PRIVATE_queryNormalizedOrderBy(e),r))}function __PRIVATE_newQueryComparator(e){return(r,h)=>{let d=!1;for(let f of common_341bda9b_esm_PRIVATE_queryNormalizedOrderBy(e)){let e=function(e,r,h){let d=e.field.isKeyField()?common_341bda9b_esm_DocumentKey.comparator(r.key,h.key):function(e,r,h){let d=r.data.field(e),f=h.data.field(e);return null!==d&&null!==f?__PRIVATE_valueCompare(d,f):common_341bda9b_esm_fail(42886)}(e.field,r,h);switch(e.dir){case"asc":return d;case"desc":return -1*d;default:return common_341bda9b_esm_fail(19790,{direction:e.dir})}}(f,r,h);if(0!==e)return e;d=d||f.field.isKeyField()}return 0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ObjectMap=class ObjectMap{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){let r=this.mapKeyFn(e),h=this.inner[r];if(void 0!==h){for(let[r,d]of h)if(this.equalsFn(r,e))return d}}has(e){return void 0!==this.get(e)}set(e,r){let h=this.mapKeyFn(e),d=this.inner[h];if(void 0===d)return this.inner[h]=[[e,r]],void this.innerSize++;for(let h=0;h<d.length;h++)if(this.equalsFn(d[h][0],e))return void(d[h]=[e,r]);d.push([e,r]),this.innerSize++}delete(e){let r=this.mapKeyFn(e),h=this.inner[r];if(void 0===h)return!1;for(let d=0;d<h.length;d++)if(this.equalsFn(h[d][0],e))return 1===h.length?delete this.inner[r]:h.splice(d,1),this.innerSize--,!0;return!1}forEach(e){forEach(this.inner,(r,h)=>{for(let[r,d]of h)e(r,d)})}isEmpty(){return isEmpty(this.inner)}size(){return this.innerSize}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ek=new SortedMap(common_341bda9b_esm_DocumentKey.comparator),eD=new SortedMap(common_341bda9b_esm_DocumentKey.comparator);function documentMap(...e){let r=eD;for(let h of e)r=r.insert(h.key,h);return r}function __PRIVATE_convertOverlayedDocumentMapToDocumentMap(e){let r=eD;return e.forEach((e,h)=>r=r.insert(e,h.overlayedDocument)),r}function __PRIVATE_newDocumentKeyMap(){return new ObjectMap(e=>e.toString(),(e,r)=>e.isEqual(r))}let eN=new SortedMap(common_341bda9b_esm_DocumentKey.comparator),eO=new SortedSet(common_341bda9b_esm_DocumentKey.comparator);function common_341bda9b_esm_PRIVATE_documentKeySet(...e){let r=eO;for(let h of e)r=r.add(h);return r}let eM=new SortedSet(__PRIVATE_primitiveComparator);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_toDouble(e,r){if(e.useProto3Json){if(isNaN(r))return{doubleValue:"NaN"};if(r===1/0)return{doubleValue:"Infinity"};if(r===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:__PRIVATE_isNegativeZero(r)?"-0":r}}function __PRIVATE_toInteger(e){return{integerValue:""+e}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let TransformOperation=class TransformOperation{constructor(){this._=void 0}};function __PRIVATE_computeTransformOperationBaseValue(e,r){return e instanceof __PRIVATE_NumericIncrementTransformOperation?isInteger(r)||r&&"doubleValue"in r?r:{integerValue:0}:null}let __PRIVATE_ServerTimestampTransform=class __PRIVATE_ServerTimestampTransform extends TransformOperation{};let __PRIVATE_ArrayUnionTransformOperation=class __PRIVATE_ArrayUnionTransformOperation extends TransformOperation{constructor(e){super(),this.elements=e}};function __PRIVATE_applyArrayUnionTransformOperation(e,r){let h=__PRIVATE_coercedFieldValuesArray(r);for(let r of e.elements)h.some(e=>__PRIVATE_valueEquals(e,r))||h.push(r);return{arrayValue:{values:h}}}let __PRIVATE_ArrayRemoveTransformOperation=class __PRIVATE_ArrayRemoveTransformOperation extends TransformOperation{constructor(e){super(),this.elements=e}};function __PRIVATE_applyArrayRemoveTransformOperation(e,r){let h=__PRIVATE_coercedFieldValuesArray(r);for(let r of e.elements)h=h.filter(e=>!__PRIVATE_valueEquals(e,r));return{arrayValue:{values:h}}}let __PRIVATE_NumericIncrementTransformOperation=class __PRIVATE_NumericIncrementTransformOperation extends TransformOperation{constructor(e,r){super(),this.serializer=e,this.Ae=r}};function asNumber(e){return __PRIVATE_normalizeNumber(e.integerValue||e.doubleValue)}function __PRIVATE_coercedFieldValuesArray(e){return isArray(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let FieldTransform=class FieldTransform{constructor(e,r){this.field=e,this.transform=r}};let MutationResult=class MutationResult{constructor(e,r){this.version=e,this.transformResults=r}};let common_341bda9b_esm_Precondition=class common_341bda9b_esm_Precondition{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new common_341bda9b_esm_Precondition}static exists(e){return new common_341bda9b_esm_Precondition(void 0,e)}static updateTime(e){return new common_341bda9b_esm_Precondition(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function __PRIVATE_preconditionIsValidForDocument(e,r){return void 0!==e.updateTime?r.isFoundDocument()&&r.version.isEqual(e.updateTime):void 0===e.exists||e.exists===r.isFoundDocument()}let Mutation=class Mutation{};function __PRIVATE_calculateOverlayMutation(e,r){if(!e.hasLocalMutations||r&&0===r.fields.length)return null;if(null===r)return e.isNoDocument()?new common_341bda9b_esm_PRIVATE_DeleteMutation(e.key,common_341bda9b_esm_Precondition.none()):new __PRIVATE_SetMutation(e.key,e.data,common_341bda9b_esm_Precondition.none());{let h=e.data,d=common_341bda9b_esm_ObjectValue.empty(),f=new SortedSet(FieldPath$1.comparator);for(let e of r.fields)if(!f.has(e)){let r=h.field(e);null===r&&e.length>1&&(e=e.popLast(),r=h.field(e)),null===r?d.delete(e):d.set(e,r),f=f.add(e)}return new __PRIVATE_PatchMutation(e.key,d,new FieldMask(f.toArray()),common_341bda9b_esm_Precondition.none())}}function __PRIVATE_mutationApplyToLocalView(e,r,h,d){return e instanceof __PRIVATE_SetMutation?function(e,r,h,d){if(!__PRIVATE_preconditionIsValidForDocument(e.precondition,r))return h;let f=e.value.clone(),g=__PRIVATE_localTransformResults(e.fieldTransforms,d,r);return f.setAll(g),r.convertToFoundDocument(r.version,f).setHasLocalMutations(),null}(e,r,h,d):e instanceof __PRIVATE_PatchMutation?function(e,r,h,d){if(!__PRIVATE_preconditionIsValidForDocument(e.precondition,r))return h;let f=__PRIVATE_localTransformResults(e.fieldTransforms,d,r),g=r.data;return(g.setAll(__PRIVATE_getPatch(e)),g.setAll(f),r.convertToFoundDocument(r.version,g).setHasLocalMutations(),null===h)?null:h.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,r,h,d):__PRIVATE_preconditionIsValidForDocument(e.precondition,r)?(r.convertToNoDocument(r.version).setHasLocalMutations(),null):h}function __PRIVATE_mutationEquals(e,r){var h,d;return e.type===r.type&&!!e.key.isEqual(r.key)&&!!e.precondition.isEqual(r.precondition)&&(h=e.fieldTransforms,d=r.fieldTransforms,!!(void 0===h&&void 0===d||!(!h||!d)&&__PRIVATE_arrayEquals(h,d,(e,r)=>{var h,d;return e.field.isEqual(r.field)&&(h=e.transform,d=r.transform,h instanceof __PRIVATE_ArrayUnionTransformOperation&&d instanceof __PRIVATE_ArrayUnionTransformOperation||h instanceof __PRIVATE_ArrayRemoveTransformOperation&&d instanceof __PRIVATE_ArrayRemoveTransformOperation?__PRIVATE_arrayEquals(h.elements,d.elements,__PRIVATE_valueEquals):h instanceof __PRIVATE_NumericIncrementTransformOperation&&d instanceof __PRIVATE_NumericIncrementTransformOperation?__PRIVATE_valueEquals(h.Ae,d.Ae):h instanceof __PRIVATE_ServerTimestampTransform&&d instanceof __PRIVATE_ServerTimestampTransform)})))&&(0===e.type?e.value.isEqual(r.value):1!==e.type||e.data.isEqual(r.data)&&e.fieldMask.isEqual(r.fieldMask))}let __PRIVATE_SetMutation=class __PRIVATE_SetMutation extends Mutation{constructor(e,r,h,d=[]){super(),this.key=e,this.value=r,this.precondition=h,this.fieldTransforms=d,this.type=0}getFieldMask(){return null}};let __PRIVATE_PatchMutation=class __PRIVATE_PatchMutation extends Mutation{constructor(e,r,h,d,f=[]){super(),this.key=e,this.data=r,this.fieldMask=h,this.precondition=d,this.fieldTransforms=f,this.type=1}getFieldMask(){return this.fieldMask}};function __PRIVATE_getPatch(e){let r=new Map;return e.fieldMask.fields.forEach(h=>{if(!h.isEmpty()){let d=e.data.field(h);r.set(h,d)}}),r}function __PRIVATE_serverTransformResults(e,r,h){let d=new Map;__PRIVATE_hardAssert(e.length===h.length,32656,{Ve:h.length,de:e.length});for(let g=0;g<h.length;g++){var f;let b=e[g],A=b.transform,k=r.data.field(b.field);d.set(b.field,(f=h[g],A instanceof __PRIVATE_ArrayUnionTransformOperation?__PRIVATE_applyArrayUnionTransformOperation(A,k):A instanceof __PRIVATE_ArrayRemoveTransformOperation?__PRIVATE_applyArrayRemoveTransformOperation(A,k):f))}return d}function __PRIVATE_localTransformResults(e,r,h){let d=new Map;for(let f of e){let e=f.transform,g=h.data.field(f.field);d.set(f.field,e instanceof __PRIVATE_ServerTimestampTransform?function(e,r){let h={fields:{[eI]:{stringValue:eT},[eA]:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return r&&common_341bda9b_esm_PRIVATE_isServerTimestamp(r)&&(r=__PRIVATE_getPreviousValue(r)),r&&(h.fields[eP]=r),{mapValue:h}}(r,g):e instanceof __PRIVATE_ArrayUnionTransformOperation?__PRIVATE_applyArrayUnionTransformOperation(e,g):e instanceof __PRIVATE_ArrayRemoveTransformOperation?__PRIVATE_applyArrayRemoveTransformOperation(e,g):function(e,r){let h=__PRIVATE_computeTransformOperationBaseValue(e,r),d=asNumber(h)+asNumber(e.Ae);return isInteger(h)&&isInteger(e.Ae)?__PRIVATE_toInteger(d):__PRIVATE_toDouble(e.serializer,d)}(e,g))}return d}let common_341bda9b_esm_PRIVATE_DeleteMutation=class common_341bda9b_esm_PRIVATE_DeleteMutation extends Mutation{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}};let __PRIVATE_VerifyMutation=class __PRIVATE_VerifyMutation extends Mutation{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let MutationBatch=class MutationBatch{constructor(e,r,h,d){this.batchId=e,this.localWriteTime=r,this.baseMutations=h,this.mutations=d}applyToRemoteDocument(e,r){let h=r.mutationResults;for(let r=0;r<this.mutations.length;r++){let f=this.mutations[r];if(f.key.isEqual(e.key)){var d;d=h[r],f instanceof __PRIVATE_SetMutation?function(e,r,h){let d=e.value.clone(),f=__PRIVATE_serverTransformResults(e.fieldTransforms,r,h.transformResults);d.setAll(f),r.convertToFoundDocument(h.version,d).setHasCommittedMutations()}(f,e,d):f instanceof __PRIVATE_PatchMutation?function(e,r,h){if(!__PRIVATE_preconditionIsValidForDocument(e.precondition,r))return void r.convertToUnknownDocument(h.version);let d=__PRIVATE_serverTransformResults(e.fieldTransforms,r,h.transformResults),f=r.data;f.setAll(__PRIVATE_getPatch(e)),f.setAll(d),r.convertToFoundDocument(h.version,f).setHasCommittedMutations()}(f,e,d):function(e,r,h){r.convertToNoDocument(h.version).setHasCommittedMutations()}(0,e,d)}}}applyToLocalView(e,r){for(let h of this.baseMutations)h.key.isEqual(e.key)&&(r=__PRIVATE_mutationApplyToLocalView(h,e,r,this.localWriteTime));for(let h of this.mutations)h.key.isEqual(e.key)&&(r=__PRIVATE_mutationApplyToLocalView(h,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){let h=__PRIVATE_newDocumentKeyMap();return this.mutations.forEach(d=>{let f=e.get(d.key),g=f.overlayedDocument,b=this.applyToLocalView(g,f.mutatedFields);b=r.has(d.key)?null:b;let A=__PRIVATE_calculateOverlayMutation(g,b);null!==A&&h.set(d.key,A),g.isValidDocument()||g.convertToNoDocument(SnapshotVersion.min())}),h}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),common_341bda9b_esm_PRIVATE_documentKeySet())}isEqual(e){return this.batchId===e.batchId&&__PRIVATE_arrayEquals(this.mutations,e.mutations,(e,r)=>__PRIVATE_mutationEquals(e,r))&&__PRIVATE_arrayEquals(this.baseMutations,e.baseMutations,(e,r)=>__PRIVATE_mutationEquals(e,r))}};let MutationBatchResult=class MutationBatchResult{constructor(e,r,h,d){this.batch=e,this.commitVersion=r,this.mutationResults=h,this.docVersions=d}static from(e,r,h){__PRIVATE_hardAssert(e.mutations.length===h.length,58842,{me:e.mutations.length,fe:h.length});let d=eN,f=e.mutations;for(let e=0;e<f.length;e++)d=d.insert(f[e].key,h[e].version);return new MutationBatchResult(e,r,h,d)}};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Overlay=class Overlay{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ExistenceFilter=class ExistenceFilter{constructor(e,r){this.count=e,this.unchangedNames=r}};function __PRIVATE_mapCodeFromRpcCode(e){if(void 0===e)return __PRIVATE_logError("GRPC error has no .code"),eg.UNKNOWN;switch(e){case et.OK:return eg.OK;case et.CANCELLED:return eg.CANCELLED;case et.UNKNOWN:return eg.UNKNOWN;case et.DEADLINE_EXCEEDED:return eg.DEADLINE_EXCEEDED;case et.RESOURCE_EXHAUSTED:return eg.RESOURCE_EXHAUSTED;case et.INTERNAL:return eg.INTERNAL;case et.UNAVAILABLE:return eg.UNAVAILABLE;case et.UNAUTHENTICATED:return eg.UNAUTHENTICATED;case et.INVALID_ARGUMENT:return eg.INVALID_ARGUMENT;case et.NOT_FOUND:return eg.NOT_FOUND;case et.ALREADY_EXISTS:return eg.ALREADY_EXISTS;case et.PERMISSION_DENIED:return eg.PERMISSION_DENIED;case et.FAILED_PRECONDITION:return eg.FAILED_PRECONDITION;case et.ABORTED:return eg.ABORTED;case et.OUT_OF_RANGE:return eg.OUT_OF_RANGE;case et.UNIMPLEMENTED:return eg.UNIMPLEMENTED;case et.DATA_LOSS:return eg.DATA_LOSS;default:return common_341bda9b_esm_fail(39323,{code:e})}}(er=et||(et={}))[er.OK=0]="OK",er[er.CANCELLED=1]="CANCELLED",er[er.UNKNOWN=2]="UNKNOWN",er[er.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",er[er.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",er[er.NOT_FOUND=5]="NOT_FOUND",er[er.ALREADY_EXISTS=6]="ALREADY_EXISTS",er[er.PERMISSION_DENIED=7]="PERMISSION_DENIED",er[er.UNAUTHENTICATED=16]="UNAUTHENTICATED",er[er.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",er[er.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",er[er.ABORTED=10]="ABORTED",er[er.OUT_OF_RANGE=11]="OUT_OF_RANGE",er[er.UNIMPLEMENTED=12]="UNIMPLEMENTED",er[er.INTERNAL=13]="INTERNAL",er[er.UNAVAILABLE=14]="UNAVAILABLE",er[er.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eL=new d([4294967295,4294967295],0);function __PRIVATE_getMd5HashValue(e){let r=(new TextEncoder).encode(e),h=new f;return h.update(r),new Uint8Array(h.digest())}function __PRIVATE_get64BitUints(e){let r=new DataView(e.buffer),h=r.getUint32(0,!0),f=r.getUint32(4,!0),g=r.getUint32(8,!0),b=r.getUint32(12,!0);return[new d([h,f],0),new d([g,b],0)]}let BloomFilter=class BloomFilter{constructor(e,r,h){if(this.bitmap=e,this.padding=r,this.hashCount=h,r<0||r>=8)throw new __PRIVATE_BloomFilterError(`Invalid padding: ${r}`);if(h<0||e.length>0&&0===this.hashCount)throw new __PRIVATE_BloomFilterError(`Invalid hash count: ${h}`);if(0===e.length&&0!==r)throw new __PRIVATE_BloomFilterError(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*e.length-r,this.pe=d.fromNumber(this.ge)}ye(e,r,h){let f=e.add(r.multiply(d.fromNumber(h)));return 1===f.compare(eL)&&(f=new d([f.getBits(0),f.getBits(1)],0)),f.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.ge)return!1;let r=__PRIVATE_getMd5HashValue(e),[h,d]=__PRIVATE_get64BitUints(r);for(let e=0;e<this.hashCount;e++){let r=this.ye(h,d,e);if(!this.we(r))return!1}return!0}static create(e,r,h){let d=new Uint8Array(Math.ceil(e/8)),f=new BloomFilter(d,e%8==0?0:8-e%8,r);return h.forEach(e=>f.insert(e)),f}insert(e){if(0===this.ge)return;let r=__PRIVATE_getMd5HashValue(e),[h,d]=__PRIVATE_get64BitUints(r);for(let e=0;e<this.hashCount;e++){let r=this.ye(h,d,e);this.be(r)}}be(e){this.bitmap[Math.floor(e/8)]|=1<<e%8}};let __PRIVATE_BloomFilterError=class __PRIVATE_BloomFilterError extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let RemoteEvent=class RemoteEvent{constructor(e,r,h,d,f){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=h,this.documentUpdates=d,this.resolvedLimboDocuments=f}static createSynthesizedRemoteEventForCurrentChange(e,r,h){let d=new Map;return d.set(e,TargetChange.createSynthesizedTargetChangeForCurrentChange(e,r,h)),new RemoteEvent(SnapshotVersion.min(),d,new SortedMap(__PRIVATE_primitiveComparator),ek,common_341bda9b_esm_PRIVATE_documentKeySet())}};let TargetChange=class TargetChange{constructor(e,r,h,d,f){this.resumeToken=e,this.current=r,this.addedDocuments=h,this.modifiedDocuments=d,this.removedDocuments=f}static createSynthesizedTargetChangeForCurrentChange(e,r,h){return new TargetChange(h,r,common_341bda9b_esm_PRIVATE_documentKeySet(),common_341bda9b_esm_PRIVATE_documentKeySet(),common_341bda9b_esm_PRIVATE_documentKeySet())}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_DocumentWatchChange=class __PRIVATE_DocumentWatchChange{constructor(e,r,h,d){this.Se=e,this.removedTargetIds=r,this.key=h,this.De=d}};let __PRIVATE_ExistenceFilterChange=class __PRIVATE_ExistenceFilterChange{constructor(e,r){this.targetId=e,this.Ce=r}};let __PRIVATE_WatchTargetChange=class __PRIVATE_WatchTargetChange{constructor(e,r,h=ByteString.EMPTY_BYTE_STRING,d=null){this.state=e,this.targetIds=r,this.resumeToken=h,this.cause=d}};let __PRIVATE_TargetState=class __PRIVATE_TargetState{constructor(){this.ve=0,this.Fe=__PRIVATE_snapshotChangesMap(),this.Me=ByteString.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return 0!==this.ve}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=common_341bda9b_esm_PRIVATE_documentKeySet(),r=common_341bda9b_esm_PRIVATE_documentKeySet(),h=common_341bda9b_esm_PRIVATE_documentKeySet();return this.Fe.forEach((d,f)=>{switch(f){case 0:e=e.add(d);break;case 2:r=r.add(d);break;case 1:h=h.add(d);break;default:common_341bda9b_esm_fail(38017,{changeType:f})}}),new TargetChange(this.Me,this.xe,e,r,h)}Ke(){this.Oe=!1,this.Fe=__PRIVATE_snapshotChangesMap()}qe(e,r){this.Oe=!0,this.Fe=this.Fe.insert(e,r)}Ue(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}$e(){this.ve+=1}We(){this.ve-=1,__PRIVATE_hardAssert(this.ve>=0,3241,{ve:this.ve})}Qe(){this.Oe=!0,this.xe=!0}};let __PRIVATE_WatchChangeAggregator=class __PRIVATE_WatchChangeAggregator{constructor(e){this.Ge=e,this.ze=new Map,this.je=ek,this.He=__PRIVATE_documentTargetMap(),this.Je=__PRIVATE_documentTargetMap(),this.Ze=new SortedMap(__PRIVATE_primitiveComparator)}Xe(e){for(let r of e.Se)e.De&&e.De.isFoundDocument()?this.Ye(r,e.De):this.et(r,e.key,e.De);for(let r of e.removedTargetIds)this.et(r,e.key,e.De)}tt(e){this.forEachTarget(e,r=>{let h=this.nt(r);switch(e.state){case 0:this.rt(r)&&h.Le(e.resumeToken);break;case 1:h.We(),h.Ne||h.Ke(),h.Le(e.resumeToken);break;case 2:h.We(),h.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(h.Qe(),h.Le(e.resumeToken));break;case 4:this.rt(r)&&(this.it(r),h.Le(e.resumeToken));break;default:common_341bda9b_esm_fail(56790,{state:e.state})}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.ze.forEach((e,h)=>{this.rt(h)&&r(h)})}st(e){let r=e.targetId,h=e.Ce.count,d=this.ot(r);if(d){let f=d.target;if(__PRIVATE_targetIsDocumentTarget(f)){if(0===h){let e=new common_341bda9b_esm_DocumentKey(f.path);this.et(r,e,MutableDocument.newNoDocument(e,SnapshotVersion.min()))}else __PRIVATE_hardAssert(1===h,20013,{expectedCount:h})}else{let d=this._t(r);if(d!==h){let h=this.ut(e),f=h?this.ct(h,e,d):1;0!==f&&(this.it(r),this.Ze=this.Ze.insert(r,2===f?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch"))}}}}ut(e){let r,h;let d=e.Ce.unchangedNames;if(!d||!d.bits)return null;let{bits:{bitmap:f="",padding:g=0},hashCount:b=0}=d;try{r=__PRIVATE_normalizeByteString(f).toUint8Array()}catch(e){if(e instanceof __PRIVATE_Base64DecodeError)return common_341bda9b_esm_PRIVATE_logWarn("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{h=new BloomFilter(r,g,b)}catch(e){return common_341bda9b_esm_PRIVATE_logWarn(e instanceof __PRIVATE_BloomFilterError?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===h.ge?null:h}ct(e,r,h){return r.Ce.count===h-this.Pt(e,r.targetId)?0:2}Pt(e,r){let h=this.Ge.getRemoteKeysForTarget(r),d=0;return h.forEach(h=>{let f=this.Ge.ht(),g=`projects/${f.projectId}/databases/${f.database}/documents/${h.path.canonicalString()}`;e.mightContain(g)||(this.et(r,h,null),d++)}),d}Tt(e){let r=new Map;this.ze.forEach((h,d)=>{let f=this.ot(d);if(f){if(h.current&&__PRIVATE_targetIsDocumentTarget(f.target)){let r=new common_341bda9b_esm_DocumentKey(f.target.path);this.It(r).has(d)||this.Et(d,r)||this.et(d,r,MutableDocument.newNoDocument(r,e))}h.Be&&(r.set(d,h.ke()),h.Ke())}});let h=common_341bda9b_esm_PRIVATE_documentKeySet();this.Je.forEach((e,r)=>{let d=!0;r.forEachWhile(e=>{let r=this.ot(e);return!r||"TargetPurposeLimboResolution"===r.purpose||(d=!1,!1)}),d&&(h=h.add(e))}),this.je.forEach((r,h)=>h.setReadTime(e));let d=new RemoteEvent(e,r,this.Ze,this.je,h);return this.je=ek,this.He=__PRIVATE_documentTargetMap(),this.Je=__PRIVATE_documentTargetMap(),this.Ze=new SortedMap(__PRIVATE_primitiveComparator),d}Ye(e,r){if(!this.rt(e))return;let h=this.Et(e,r.key)?2:0;this.nt(e).qe(r.key,h),this.je=this.je.insert(r.key,r),this.He=this.He.insert(r.key,this.It(r.key).add(e)),this.Je=this.Je.insert(r.key,this.Rt(r.key).add(e))}et(e,r,h){if(!this.rt(e))return;let d=this.nt(e);this.Et(e,r)?d.qe(r,1):d.Ue(r),this.Je=this.Je.insert(r,this.Rt(r).delete(e)),this.Je=this.Je.insert(r,this.Rt(r).add(e)),h&&(this.je=this.je.insert(r,h))}removeTarget(e){this.ze.delete(e)}_t(e){let r=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}$e(e){this.nt(e).$e()}nt(e){let r=this.ze.get(e);return r||(r=new __PRIVATE_TargetState,this.ze.set(e,r)),r}Rt(e){let r=this.Je.get(e);return r||(r=new SortedSet(__PRIVATE_primitiveComparator),this.Je=this.Je.insert(e,r)),r}It(e){let r=this.He.get(e);return r||(r=new SortedSet(__PRIVATE_primitiveComparator),this.He=this.He.insert(e,r)),r}rt(e){let r=null!==this.ot(e);return r||common_341bda9b_esm_PRIVATE_logDebug("WatchChangeAggregator","Detected inactive target",e),r}ot(e){let r=this.ze.get(e);return r&&r.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new __PRIVATE_TargetState),this.Ge.getRemoteKeysForTarget(e).forEach(r=>{this.et(e,r,null)})}Et(e,r){return this.Ge.getRemoteKeysForTarget(e).has(r)}};function __PRIVATE_documentTargetMap(){return new SortedMap(common_341bda9b_esm_DocumentKey.comparator)}function __PRIVATE_snapshotChangesMap(){return new SortedMap(common_341bda9b_esm_DocumentKey.comparator)}let eF={asc:"ASCENDING",desc:"DESCENDING"},eB={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},eU={and:"AND",or:"OR"};let JsonProtoSerializer=class JsonProtoSerializer{constructor(e,r){this.databaseId=e,this.useProto3Json=r}};function __PRIVATE_toInt32Proto(e,r){return e.useProto3Json||null==r?r:{value:r}}function toTimestamp(e,r){return e.useProto3Json?`${new Date(1e3*r.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+r.nanoseconds).slice(-9)}Z`:{seconds:""+r.seconds,nanos:r.nanoseconds}}function __PRIVATE_toBytes(e,r){return e.useProto3Json?r.toBase64():r.toUint8Array()}function __PRIVATE_fromVersion(e){return __PRIVATE_hardAssert(!!e,49232),SnapshotVersion.fromTimestamp(function(e){let r=__PRIVATE_normalizeTimestamp(e);return new Timestamp(r.seconds,r.nanos)}(e))}function __PRIVATE_toResourceName(e,r){return __PRIVATE_toResourcePath(e,r).canonicalString()}function __PRIVATE_toResourcePath(e,r){let h=new common_341bda9b_esm_ResourcePath(["projects",e.projectId,"databases",e.database]).child("documents");return void 0===r?h:h.child(r)}function __PRIVATE_fromResourceName(e){let r=common_341bda9b_esm_ResourcePath.fromString(e);return __PRIVATE_hardAssert(__PRIVATE_isValidResourceName(r),10190,{key:r.toString()}),r}function __PRIVATE_toName(e,r){return __PRIVATE_toResourceName(e.databaseId,r.path)}function fromName(e,r){let h=__PRIVATE_fromResourceName(r);if(h.get(1)!==e.databaseId.projectId)throw new common_341bda9b_esm_FirestoreError(eg.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+h.get(1)+" vs "+e.databaseId.projectId);if(h.get(3)!==e.databaseId.database)throw new common_341bda9b_esm_FirestoreError(eg.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+h.get(3)+" vs "+e.databaseId.database);return new common_341bda9b_esm_DocumentKey(__PRIVATE_extractLocalPathFromResourceName(h))}function __PRIVATE_toQueryPath(e,r){return __PRIVATE_toResourceName(e.databaseId,r)}function __PRIVATE_getEncodedDatabaseId(e){return new common_341bda9b_esm_ResourcePath(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function __PRIVATE_extractLocalPathFromResourceName(e){return __PRIVATE_hardAssert(e.length>4&&"documents"===e.get(4),29091,{key:e.toString()}),e.popFirst(5)}function __PRIVATE_toMutationDocument(e,r,h){return{name:__PRIVATE_toName(e,r),fields:h.value.mapValue.fields}}function __PRIVATE_toFieldPathReference(e){return{fieldPath:e.canonicalString()}}function __PRIVATE_fromFieldPathReference(e){return FieldPath$1.fromServerFormat(e.fieldPath)}function __PRIVATE_isValidResourceName(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}function __PRIVATE_isProtoValueSerializable(e){return!!e&&"function"==typeof e._toProto&&"ProtoValue"===e._protoValueType}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let TargetData=class TargetData{constructor(e,r,h,d,f=SnapshotVersion.min(),g=SnapshotVersion.min(),b=ByteString.EMPTY_BYTE_STRING,A=null){this.target=e,this.targetId=r,this.purpose=h,this.sequenceNumber=d,this.snapshotVersion=f,this.lastLimboFreeSnapshotVersion=g,this.resumeToken=b,this.expectedCount=A}withSequenceNumber(e){return new TargetData(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new TargetData(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new TargetData(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new TargetData(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_LocalSerializer=class __PRIVATE_LocalSerializer{constructor(e){this.yt=e}};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_FirestoreIndexValueWriter=class __PRIVATE_FirestoreIndexValueWriter{constructor(){}Dt(e,r){this.Ct(e,r),r.vt()}Ct(e,r){if("nullValue"in e)this.Ft(r,5);else if("booleanValue"in e)this.Ft(r,10),r.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(r,15),r.Mt(__PRIVATE_normalizeNumber(e.integerValue));else if("doubleValue"in e){let h=__PRIVATE_normalizeNumber(e.doubleValue);isNaN(h)?this.Ft(r,13):(this.Ft(r,15),__PRIVATE_isNegativeZero(h)?r.Mt(0):r.Mt(h))}else if("timestampValue"in e){let h=e.timestampValue;this.Ft(r,20),"string"==typeof h&&(h=__PRIVATE_normalizeTimestamp(h)),r.xt(`${h.seconds||""}`),r.Mt(h.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,r),this.Nt(r);else if("bytesValue"in e)this.Ft(r,30),r.Bt(__PRIVATE_normalizeByteString(e.bytesValue)),this.Nt(r);else if("referenceValue"in e)this.Lt(e.referenceValue,r);else if("geoPointValue"in e){let h=e.geoPointValue;this.Ft(r,45),r.Mt(h.latitude||0),r.Mt(h.longitude||0)}else"mapValue"in e?__PRIVATE_isMaxValue(e)?this.Ft(r,Number.MAX_SAFE_INTEGER):__PRIVATE_isVectorValue(e)?this.kt(e.mapValue,r):(this.Kt(e.mapValue,r),this.Nt(r)):"arrayValue"in e?(this.qt(e.arrayValue,r),this.Nt(r)):common_341bda9b_esm_fail(19022,{Ut:e})}Ot(e,r){this.Ft(r,25),this.$t(e,r)}$t(e,r){r.xt(e)}Kt(e,r){let h=e.fields||{};for(let e of(this.Ft(r,55),Object.keys(h)))this.Ot(e,r),this.Ct(h[e],r)}kt(e,r){let h=e.fields||{};this.Ft(r,53);let d=h[ex].arrayValue?.values?.length||0;this.Ft(r,15),r.Mt(__PRIVATE_normalizeNumber(d)),this.Ot(ex,r),this.Ct(h[ex],r)}qt(e,r){let h=e.values||[];for(let e of(this.Ft(r,50),h))this.Ct(e,r)}Lt(e,r){this.Ft(r,37),common_341bda9b_esm_DocumentKey.fromName(e).path.forEach(e=>{this.Ft(r,60),this.$t(e,r)})}Ft(e,r){e.Mt(r)}Nt(e){e.Mt(2)}};__PRIVATE_FirestoreIndexValueWriter.Wt=new __PRIVATE_FirestoreIndexValueWriter;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_MemoryIndexManager=class __PRIVATE_MemoryIndexManager{constructor(){this.Sn=new __PRIVATE_MemoryCollectionParentIndex}addToCollectionParentIndex(e,r){return this.Sn.add(r),PersistencePromise.resolve()}getCollectionParents(e,r){return PersistencePromise.resolve(this.Sn.getEntries(r))}addFieldIndex(e,r){return PersistencePromise.resolve()}deleteFieldIndex(e,r){return PersistencePromise.resolve()}deleteAllFieldIndexes(e){return PersistencePromise.resolve()}createTargetIndexes(e,r){return PersistencePromise.resolve()}getDocumentsMatchingTarget(e,r){return PersistencePromise.resolve(null)}getIndexType(e,r){return PersistencePromise.resolve(0)}getFieldIndexes(e,r){return PersistencePromise.resolve([])}getNextCollectionGroupToUpdate(e){return PersistencePromise.resolve(null)}getMinOffset(e,r){return PersistencePromise.resolve(IndexOffset.min())}getMinOffsetFromCollectionGroup(e,r){return PersistencePromise.resolve(IndexOffset.min())}updateCollectionGroup(e,r,h){return PersistencePromise.resolve()}updateIndexEntries(e,r){return PersistencePromise.resolve()}};let __PRIVATE_MemoryCollectionParentIndex=class __PRIVATE_MemoryCollectionParentIndex{constructor(){this.index={}}add(e){let r=e.lastSegment(),h=e.popLast(),d=this.index[r]||new SortedSet(common_341bda9b_esm_ResourcePath.comparator),f=!d.has(h);return this.index[r]=d.add(h),f}has(e){let r=e.lastSegment(),h=e.popLast(),d=this.index[r];return d&&d.has(h)}getEntries(e){return(this.index[e]||new SortedSet(common_341bda9b_esm_ResourcePath.comparator)).toArray()}};new Uint8Array(0);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ej={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};let LruParams=class LruParams{static withCacheSize(e){return new LruParams(e,LruParams.DEFAULT_COLLECTION_PERCENTILE,LruParams.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,h){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=h}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */LruParams.DEFAULT_COLLECTION_PERCENTILE=10,LruParams.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,LruParams.DEFAULT=new LruParams(41943040,LruParams.DEFAULT_COLLECTION_PERCENTILE,LruParams.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),LruParams.DISABLED=new LruParams(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_TargetIdGenerator=class __PRIVATE_TargetIdGenerator{constructor(e){this.sr=e}next(){return this.sr+=2,this.sr}static _r(){return new __PRIVATE_TargetIdGenerator(0)}static ar(){return new __PRIVATE_TargetIdGenerator(-1)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eq="LruGarbageCollector";function __PRIVATE_bufferEntryComparator([e,r],[h,d]){let f=__PRIVATE_primitiveComparator(e,h);return 0===f?__PRIVATE_primitiveComparator(r,d):f}let __PRIVATE_RollingSequenceNumberBuffer=class __PRIVATE_RollingSequenceNumberBuffer{constructor(e){this.Pr=e,this.buffer=new SortedSet(__PRIVATE_bufferEntryComparator),this.Tr=0}Ir(){return++this.Tr}Er(e){let r=[e,this.Ir()];if(this.buffer.size<this.Pr)this.buffer=this.buffer.add(r);else{let e=this.buffer.last();0>__PRIVATE_bufferEntryComparator(r,e)&&(this.buffer=this.buffer.delete(e).add(r))}}get maxValue(){return this.buffer.last()[0]}};let __PRIVATE_LruScheduler=class __PRIVATE_LruScheduler{constructor(e,r,h){this.garbageCollector=e,this.asyncQueue=r,this.localStore=h,this.Rr=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Ar(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return null!==this.Rr}Ar(e){common_341bda9b_esm_PRIVATE_logDebug(eq,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){__PRIVATE_isIndexedDbTransactionError(e)?common_341bda9b_esm_PRIVATE_logDebug(eq,"Ignoring IndexedDB error during garbage collection: ",e):await __PRIVATE_ignoreIfPrimaryLeaseLoss(e)}await this.Ar(3e5)})}};let __PRIVATE_LruGarbageCollectorImpl=class __PRIVATE_LruGarbageCollectorImpl{constructor(e,r){this.Vr=e,this.params=r}calculateTargetCount(e,r){return this.Vr.dr(e).next(e=>Math.floor(r/100*e))}nthSequenceNumber(e,r){if(0===r)return PersistencePromise.resolve(__PRIVATE_ListenSequence.ce);let h=new __PRIVATE_RollingSequenceNumberBuffer(r);return this.Vr.forEachTarget(e,e=>h.Er(e.sequenceNumber)).next(()=>this.Vr.mr(e,e=>h.Er(e))).next(()=>h.maxValue)}removeTargets(e,r,h){return this.Vr.removeTargets(e,r,h)}removeOrphanedDocuments(e,r){return this.Vr.removeOrphanedDocuments(e,r)}collect(e,r){return -1===this.params.cacheSizeCollectionThreshold?(common_341bda9b_esm_PRIVATE_logDebug("LruGarbageCollector","Garbage collection skipped; disabled"),PersistencePromise.resolve(ej)):this.getCacheSize(e).next(h=>h<this.params.cacheSizeCollectionThreshold?(common_341bda9b_esm_PRIVATE_logDebug("LruGarbageCollector",`Garbage collection skipped; Cache size ${h} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),ej):this.gr(e,r))}getCacheSize(e){return this.Vr.getCacheSize(e)}gr(e,r){let h,d,f,g,b,A,k;let M=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(r=>(r>this.params.maximumSequenceNumbersToCollect?(common_341bda9b_esm_PRIVATE_logDebug("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${r}`),d=this.params.maximumSequenceNumbersToCollect):d=r,g=Date.now(),this.nthSequenceNumber(e,d))).next(d=>(h=d,b=Date.now(),this.removeTargets(e,h,r))).next(r=>(f=r,A=Date.now(),this.removeOrphanedDocuments(e,h))).next(e=>(k=Date.now(),__PRIVATE_getLogLevel()<=eh.in.DEBUG&&common_341bda9b_esm_PRIVATE_logDebug("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${g-M}ms
	Determined least recently used ${d} in `+(b-g)+"ms\n"+`	Removed ${f} targets in `+(A-b)+"ms\n"+`	Removed ${e} documents in `+(k-A)+"ms\n"+`Total Duration: ${k-M}ms`),PersistencePromise.resolve({didRun:!0,sequenceNumbersCollected:d,targetsRemoved:f,documentsRemoved:e})))}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let RemoteDocumentChangeBuffer=class RemoteDocumentChangeBuffer{constructor(){this.changes=new ObjectMap(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,MutableDocument.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();let h=this.changes.get(r);return void 0!==h?PersistencePromise.resolve(h):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let OverlayedDocument=class OverlayedDocument{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let LocalDocumentsView=class LocalDocumentsView{constructor(e,r,h,d){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=h,this.indexManager=d}getDocument(e,r){let h=null;return this.documentOverlayCache.getOverlay(e,r).next(d=>(h=d,this.remoteDocumentCache.getEntry(e,r))).next(e=>(null!==h&&__PRIVATE_mutationApplyToLocalView(h.mutation,e,FieldMask.empty(),Timestamp.now()),e))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(r=>this.getLocalViewOfDocuments(e,r,common_341bda9b_esm_PRIVATE_documentKeySet()).next(()=>r))}getLocalViewOfDocuments(e,r,h=common_341bda9b_esm_PRIVATE_documentKeySet()){let d=__PRIVATE_newDocumentKeyMap();return this.populateOverlays(e,d,r).next(()=>this.computeViews(e,r,d,h).next(e=>{let r=documentMap();return e.forEach((e,h)=>{r=r.insert(e,h.overlayedDocument)}),r}))}getOverlayedDocuments(e,r){let h=__PRIVATE_newDocumentKeyMap();return this.populateOverlays(e,h,r).next(()=>this.computeViews(e,r,h,common_341bda9b_esm_PRIVATE_documentKeySet()))}populateOverlays(e,r,h){let d=[];return h.forEach(e=>{r.has(e)||d.push(e)}),this.documentOverlayCache.getOverlays(e,d).next(e=>{e.forEach((e,h)=>{r.set(e,h)})})}computeViews(e,r,h,d){let f=ek,g=__PRIVATE_newDocumentKeyMap(),b=__PRIVATE_newDocumentKeyMap();return r.forEach((e,r)=>{let b=h.get(r.key);d.has(r.key)&&(void 0===b||b.mutation instanceof __PRIVATE_PatchMutation)?f=f.insert(r.key,r):void 0!==b?(g.set(r.key,b.mutation.getFieldMask()),__PRIVATE_mutationApplyToLocalView(b.mutation,r,b.mutation.getFieldMask(),Timestamp.now())):g.set(r.key,FieldMask.empty())}),this.recalculateAndSaveOverlays(e,f).next(e=>(e.forEach((e,r)=>g.set(e,r)),r.forEach((e,r)=>b.set(e,new OverlayedDocument(r,g.get(e)??null))),b))}recalculateAndSaveOverlays(e,r){let h=__PRIVATE_newDocumentKeyMap(),d=new SortedMap((e,r)=>e-r),f=common_341bda9b_esm_PRIVATE_documentKeySet();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(e=>{for(let f of e)f.keys().forEach(e=>{let g=r.get(e);if(null===g)return;let b=h.get(e)||FieldMask.empty();b=f.applyToLocalView(g,b),h.set(e,b);let A=(d.get(f.batchId)||common_341bda9b_esm_PRIVATE_documentKeySet()).add(e);d=d.insert(f.batchId,A)})}).next(()=>{let g=[],b=d.getReverseIterator();for(;b.hasNext();){let d=b.getNext(),A=d.key,k=d.value,M=__PRIVATE_newDocumentKeyMap();k.forEach(e=>{if(!f.has(e)){let d=__PRIVATE_calculateOverlayMutation(r.get(e),h.get(e));null!==d&&M.set(e,d),f=f.add(e)}}),g.push(this.documentOverlayCache.saveOverlays(e,A,M))}return PersistencePromise.waitFor(g)}).next(()=>h)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,r,h,d){return common_341bda9b_esm_DocumentKey.isDocumentKey(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.getDocumentsMatchingDocumentQuery(e,r.path):common_341bda9b_esm_PRIVATE_isCollectionGroupQuery(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,h,d):this.getDocumentsMatchingCollectionQuery(e,r,h,d)}getNextDocuments(e,r,h,d){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,h,d).next(f=>{let g=d-f.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,h.largestBatchId,d-f.size):PersistencePromise.resolve(__PRIVATE_newDocumentKeyMap()),b=-1,A=f;return g.next(r=>PersistencePromise.forEach(r,(r,h)=>(b<h.largestBatchId&&(b=h.largestBatchId),f.get(r)?PersistencePromise.resolve():this.remoteDocumentCache.getEntry(e,r).next(e=>{A=A.insert(r,e)}))).next(()=>this.populateOverlays(e,r,f)).next(()=>this.computeViews(e,A,r,common_341bda9b_esm_PRIVATE_documentKeySet())).next(e=>({batchId:b,changes:__PRIVATE_convertOverlayedDocumentMapToDocumentMap(e)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new common_341bda9b_esm_DocumentKey(r)).next(e=>{let r=documentMap();return e.isFoundDocument()&&(r=r.insert(e.key,e)),r})}getDocumentsMatchingCollectionGroupQuery(e,r,h,d){let f=r.collectionGroup,g=documentMap();return this.indexManager.getCollectionParents(e,f).next(b=>PersistencePromise.forEach(b,b=>{var A;let k=(A=b.child(f),new __PRIVATE_QueryImpl(A,null,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt));return this.getDocumentsMatchingCollectionQuery(e,k,h,d).next(e=>{e.forEach((e,r)=>{g=g.insert(e,r)})})}).next(()=>g))}getDocumentsMatchingCollectionQuery(e,r,h,d){let f;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,h.largestBatchId).next(g=>(f=g,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,h,f,d))).next(e=>{f.forEach((r,h)=>{let d=h.getKey();null===e.get(d)&&(e=e.insert(d,MutableDocument.newInvalidDocument(d)))});let h=documentMap();return e.forEach((e,d)=>{let g=f.get(e);void 0!==g&&__PRIVATE_mutationApplyToLocalView(g.mutation,d,FieldMask.empty(),Timestamp.now()),__PRIVATE_queryMatches(r,d)&&(h=h.insert(e,d))}),h})}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_MemoryBundleCache=class __PRIVATE_MemoryBundleCache{constructor(e){this.serializer=e,this.Nr=new Map,this.Br=new Map}getBundleMetadata(e,r){return PersistencePromise.resolve(this.Nr.get(r))}saveBundleMetadata(e,r){return this.Nr.set(r.id,{id:r.id,version:r.version,createTime:__PRIVATE_fromVersion(r.createTime)}),PersistencePromise.resolve()}getNamedQuery(e,r){return PersistencePromise.resolve(this.Br.get(r))}saveNamedQuery(e,r){return this.Br.set(r.name,{name:r.name,query:function(e){let r=function(e){var r,h,d,f,g,b,A,k;let M,j=function(e){let r=__PRIVATE_fromResourceName(e);return 4===r.length?common_341bda9b_esm_ResourcePath.emptyPath():__PRIVATE_extractLocalPathFromResourceName(r)}(e.parent),q=e.structuredQuery,ee=q.from?q.from.length:0,et=null;if(ee>0){__PRIVATE_hardAssert(1===ee,65062);let e=q.from[0];e.allDescendants?et=e.collectionId:j=j.child(e.collectionId)}let er=[];q.where&&(er=function(e){var r;let h=function __PRIVATE_fromFilter(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":let r=__PRIVATE_fromFieldPathReference(e.unaryFilter.field);return FieldFilter.create(r,"==",{doubleValue:NaN});case"IS_NULL":let h=__PRIVATE_fromFieldPathReference(e.unaryFilter.field);return FieldFilter.create(h,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let d=__PRIVATE_fromFieldPathReference(e.unaryFilter.field);return FieldFilter.create(d,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let f=__PRIVATE_fromFieldPathReference(e.unaryFilter.field);return FieldFilter.create(f,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return common_341bda9b_esm_fail(61313);default:return common_341bda9b_esm_fail(60726)}}(e):void 0!==e.fieldFilter?FieldFilter.create(__PRIVATE_fromFieldPathReference(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return common_341bda9b_esm_fail(58110);default:return common_341bda9b_esm_fail(50506)}}(e.fieldFilter.op),e.fieldFilter.value):void 0!==e.compositeFilter?CompositeFilter.create(e.compositeFilter.filters.map(e=>__PRIVATE_fromFilter(e)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return common_341bda9b_esm_fail(1026)}}(e.compositeFilter.op)):common_341bda9b_esm_fail(30097,{filter:e})}(e);return h instanceof CompositeFilter&&__PRIVATE_compositeFilterIsFlat(r=h)&&__PRIVATE_compositeFilterIsConjunction(r)?h.getFilters():[h]}(q.where));let en=[];q.orderBy&&(en=q.orderBy.map(e=>new OrderBy(__PRIVATE_fromFieldPathReference(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))));let ei=null;q.limit&&(ei=null==(M="object"==typeof(r=q.limit)?r.value:r)?null:M);let es=null;q.startAt&&(es=function(e){let r=!!e.before,h=e.values||[];return new common_341bda9b_esm_Bound(h,r)}(q.startAt));let eo=null;return q.endAt&&(eo=function(e){let r=!e.before,h=e.values||[];return new common_341bda9b_esm_Bound(h,r)}(q.endAt)),h=j,d=et,f=en,g=er,b=ei,A=es,k=eo,new __PRIVATE_QueryImpl(h,d,f,g,b,"F",A,k)}({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?common_341bda9b_esm_PRIVATE_queryWithLimit(r,r.limit,"L"):r}(r.bundledQuery),readTime:__PRIVATE_fromVersion(r.readTime)}),PersistencePromise.resolve()}};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_MemoryDocumentOverlayCache=class __PRIVATE_MemoryDocumentOverlayCache{constructor(){this.overlays=new SortedMap(common_341bda9b_esm_DocumentKey.comparator),this.Lr=new Map}getOverlay(e,r){return PersistencePromise.resolve(this.overlays.get(r))}getOverlays(e,r){let h=__PRIVATE_newDocumentKeyMap();return PersistencePromise.forEach(r,r=>this.getOverlay(e,r).next(e=>{null!==e&&h.set(r,e)})).next(()=>h)}saveOverlays(e,r,h){return h.forEach((h,d)=>{this.bt(e,r,d)}),PersistencePromise.resolve()}removeOverlaysForBatchId(e,r,h){let d=this.Lr.get(h);return void 0!==d&&(d.forEach(e=>this.overlays=this.overlays.remove(e)),this.Lr.delete(h)),PersistencePromise.resolve()}getOverlaysForCollection(e,r,h){let d=__PRIVATE_newDocumentKeyMap(),f=r.length+1,g=new common_341bda9b_esm_DocumentKey(r.child("")),b=this.overlays.getIteratorFrom(g);for(;b.hasNext();){let e=b.getNext().value,g=e.getKey();if(!r.isPrefixOf(g.path))break;g.path.length===f&&e.largestBatchId>h&&d.set(e.getKey(),e)}return PersistencePromise.resolve(d)}getOverlaysForCollectionGroup(e,r,h,d){let f=new SortedMap((e,r)=>e-r),g=this.overlays.getIterator();for(;g.hasNext();){let e=g.getNext().value;if(e.getKey().getCollectionGroup()===r&&e.largestBatchId>h){let r=f.get(e.largestBatchId);null===r&&(r=__PRIVATE_newDocumentKeyMap(),f=f.insert(e.largestBatchId,r)),r.set(e.getKey(),e)}}let b=__PRIVATE_newDocumentKeyMap(),A=f.getIterator();for(;A.hasNext()&&(A.getNext().value.forEach((e,r)=>b.set(e,r)),!(b.size()>=d)););return PersistencePromise.resolve(b)}bt(e,r,h){let d=this.overlays.get(h.key);if(null!==d){let e=this.Lr.get(d.largestBatchId).delete(h.key);this.Lr.set(d.largestBatchId,e)}this.overlays=this.overlays.insert(h.key,new Overlay(r,h));let f=this.Lr.get(r);void 0===f&&(f=common_341bda9b_esm_PRIVATE_documentKeySet(),this.Lr.set(r,f)),this.Lr.set(r,f.add(h.key))}};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_MemoryGlobalsCache=class __PRIVATE_MemoryGlobalsCache{constructor(){this.sessionToken=ByteString.EMPTY_BYTE_STRING}getSessionToken(e){return PersistencePromise.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,PersistencePromise.resolve()}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_ReferenceSet=class __PRIVATE_ReferenceSet{constructor(){this.kr=new SortedSet(__PRIVATE_DocReference.Kr),this.qr=new SortedSet(__PRIVATE_DocReference.Ur)}isEmpty(){return this.kr.isEmpty()}addReference(e,r){let h=new __PRIVATE_DocReference(e,r);this.kr=this.kr.add(h),this.qr=this.qr.add(h)}$r(e,r){e.forEach(e=>this.addReference(e,r))}removeReference(e,r){this.Wr(new __PRIVATE_DocReference(e,r))}Qr(e,r){e.forEach(e=>this.removeReference(e,r))}Gr(e){let r=new common_341bda9b_esm_DocumentKey(new common_341bda9b_esm_ResourcePath([])),h=new __PRIVATE_DocReference(r,e),d=new __PRIVATE_DocReference(r,e+1),f=[];return this.qr.forEachInRange([h,d],e=>{this.Wr(e),f.push(e.key)}),f}zr(){this.kr.forEach(e=>this.Wr(e))}Wr(e){this.kr=this.kr.delete(e),this.qr=this.qr.delete(e)}jr(e){let r=new common_341bda9b_esm_DocumentKey(new common_341bda9b_esm_ResourcePath([])),h=new __PRIVATE_DocReference(r,e),d=new __PRIVATE_DocReference(r,e+1),f=common_341bda9b_esm_PRIVATE_documentKeySet();return this.qr.forEachInRange([h,d],e=>{f=f.add(e.key)}),f}containsKey(e){let r=new __PRIVATE_DocReference(e,0),h=this.kr.firstAfterOrEqual(r);return null!==h&&e.isEqual(h.key)}};let __PRIVATE_DocReference=class __PRIVATE_DocReference{constructor(e,r){this.key=e,this.Hr=r}static Kr(e,r){return common_341bda9b_esm_DocumentKey.comparator(e.key,r.key)||__PRIVATE_primitiveComparator(e.Hr,r.Hr)}static Ur(e,r){return __PRIVATE_primitiveComparator(e.Hr,r.Hr)||common_341bda9b_esm_DocumentKey.comparator(e.key,r.key)}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_MemoryMutationQueue=class __PRIVATE_MemoryMutationQueue{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.Yn=1,this.Jr=new SortedSet(__PRIVATE_DocReference.Kr)}checkEmpty(e){return PersistencePromise.resolve(0===this.mutationQueue.length)}addMutationBatch(e,r,h,d){let f=this.Yn;this.Yn++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let g=new MutationBatch(f,r,h,d);for(let r of(this.mutationQueue.push(g),d))this.Jr=this.Jr.add(new __PRIVATE_DocReference(r.key,f)),this.indexManager.addToCollectionParentIndex(e,r.key.path.popLast());return PersistencePromise.resolve(g)}lookupMutationBatch(e,r){return PersistencePromise.resolve(this.Zr(r))}getNextMutationBatchAfterBatchId(e,r){let h=this.Xr(r+1),d=h<0?0:h;return PersistencePromise.resolve(this.mutationQueue.length>d?this.mutationQueue[d]:null)}getHighestUnacknowledgedBatchId(){return PersistencePromise.resolve(0===this.mutationQueue.length?-1:this.Yn-1)}getAllMutationBatches(e){return PersistencePromise.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){let h=new __PRIVATE_DocReference(r,0),d=new __PRIVATE_DocReference(r,Number.POSITIVE_INFINITY),f=[];return this.Jr.forEachInRange([h,d],e=>{let r=this.Zr(e.Hr);f.push(r)}),PersistencePromise.resolve(f)}getAllMutationBatchesAffectingDocumentKeys(e,r){let h=new SortedSet(__PRIVATE_primitiveComparator);return r.forEach(e=>{let r=new __PRIVATE_DocReference(e,0),d=new __PRIVATE_DocReference(e,Number.POSITIVE_INFINITY);this.Jr.forEachInRange([r,d],e=>{h=h.add(e.Hr)})}),PersistencePromise.resolve(this.Yr(h))}getAllMutationBatchesAffectingQuery(e,r){let h=r.path,d=h.length+1,f=h;common_341bda9b_esm_DocumentKey.isDocumentKey(f)||(f=f.child(""));let g=new __PRIVATE_DocReference(new common_341bda9b_esm_DocumentKey(f),0),b=new SortedSet(__PRIVATE_primitiveComparator);return this.Jr.forEachWhile(e=>{let r=e.key.path;return!!h.isPrefixOf(r)&&(r.length===d&&(b=b.add(e.Hr)),!0)},g),PersistencePromise.resolve(this.Yr(b))}Yr(e){let r=[];return e.forEach(e=>{let h=this.Zr(e);null!==h&&r.push(h)}),r}removeMutationBatch(e,r){__PRIVATE_hardAssert(0===this.ei(r.batchId,"removed"),55003),this.mutationQueue.shift();let h=this.Jr;return PersistencePromise.forEach(r.mutations,d=>{let f=new __PRIVATE_DocReference(d.key,r.batchId);return h=h.delete(f),this.referenceDelegate.markPotentiallyOrphaned(e,d.key)}).next(()=>{this.Jr=h})}nr(e){}containsKey(e,r){let h=new __PRIVATE_DocReference(r,0),d=this.Jr.firstAfterOrEqual(h);return PersistencePromise.resolve(r.isEqual(d&&d.key))}performConsistencyCheck(e){return this.mutationQueue.length,PersistencePromise.resolve()}ei(e,r){return this.Xr(e)}Xr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Zr(e){let r=this.Xr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_MemoryRemoteDocumentCacheImpl=class __PRIVATE_MemoryRemoteDocumentCacheImpl{constructor(e){this.ti=e,this.docs=new SortedMap(common_341bda9b_esm_DocumentKey.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){let h=r.key,d=this.docs.get(h),f=d?d.size:0,g=this.ti(r);return this.docs=this.docs.insert(h,{document:r.mutableCopy(),size:g}),this.size+=g-f,this.indexManager.addToCollectionParentIndex(e,h.path.popLast())}removeEntry(e){let r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){let h=this.docs.get(r);return PersistencePromise.resolve(h?h.document.mutableCopy():MutableDocument.newInvalidDocument(r))}getEntries(e,r){let h=ek;return r.forEach(e=>{let r=this.docs.get(e);h=h.insert(e,r?r.document.mutableCopy():MutableDocument.newInvalidDocument(e))}),PersistencePromise.resolve(h)}getDocumentsMatchingQuery(e,r,h,d){let f=ek,g=r.path,b=new common_341bda9b_esm_DocumentKey(g.child("__id-9223372036854775808__")),A=this.docs.getIteratorFrom(b);for(;A.hasNext();){let{key:e,value:{document:b}}=A.getNext();if(!g.isPrefixOf(e.path))break;e.path.length>g.length+1||0>=function(e,r){let h=e.readTime.compareTo(r.readTime);return 0!==h?h:0!==(h=common_341bda9b_esm_DocumentKey.comparator(e.documentKey,r.documentKey))?h:__PRIVATE_primitiveComparator(e.largestBatchId,r.largestBatchId)}(new IndexOffset(b.readTime,b.key,-1),h)||(d.has(b.key)||__PRIVATE_queryMatches(r,b))&&(f=f.insert(b.key,b.mutableCopy()))}return PersistencePromise.resolve(f)}getAllFromCollectionGroup(e,r,h,d){common_341bda9b_esm_fail(9500)}ni(e,r){return PersistencePromise.forEach(this.docs,e=>r(e))}newChangeBuffer(e){return new __PRIVATE_MemoryRemoteDocumentChangeBuffer(this)}getSize(e){return PersistencePromise.resolve(this.size)}};let __PRIVATE_MemoryRemoteDocumentChangeBuffer=class __PRIVATE_MemoryRemoteDocumentChangeBuffer extends RemoteDocumentChangeBuffer{constructor(e){super(),this.Mr=e}applyChanges(e){let r=[];return this.changes.forEach((h,d)=>{d.isValidDocument()?r.push(this.Mr.addEntry(e,d)):this.Mr.removeEntry(h)}),PersistencePromise.waitFor(r)}getFromCache(e,r){return this.Mr.getEntry(e,r)}getAllFromCache(e,r){return this.Mr.getEntries(e,r)}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_MemoryTargetCache=class __PRIVATE_MemoryTargetCache{constructor(e){this.persistence=e,this.ri=new ObjectMap(e=>__PRIVATE_canonifyTarget(e),__PRIVATE_targetEquals),this.lastRemoteSnapshotVersion=SnapshotVersion.min(),this.highestTargetId=0,this.ii=0,this.si=new __PRIVATE_ReferenceSet,this.targetCount=0,this.oi=__PRIVATE_TargetIdGenerator._r()}forEachTarget(e,r){return this.ri.forEach((e,h)=>r(h)),PersistencePromise.resolve()}getLastRemoteSnapshotVersion(e){return PersistencePromise.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return PersistencePromise.resolve(this.ii)}allocateTargetId(e){return this.highestTargetId=this.oi.next(),PersistencePromise.resolve(this.highestTargetId)}setTargetsMetadata(e,r,h){return h&&(this.lastRemoteSnapshotVersion=h),r>this.ii&&(this.ii=r),PersistencePromise.resolve()}lr(e){this.ri.set(e.target,e);let r=e.targetId;r>this.highestTargetId&&(this.oi=new __PRIVATE_TargetIdGenerator(r),this.highestTargetId=r),e.sequenceNumber>this.ii&&(this.ii=e.sequenceNumber)}addTargetData(e,r){return this.lr(r),this.targetCount+=1,PersistencePromise.resolve()}updateTargetData(e,r){return this.lr(r),PersistencePromise.resolve()}removeTargetData(e,r){return this.ri.delete(r.target),this.si.Gr(r.targetId),this.targetCount-=1,PersistencePromise.resolve()}removeTargets(e,r,h){let d=0,f=[];return this.ri.forEach((g,b)=>{b.sequenceNumber<=r&&null===h.get(b.targetId)&&(this.ri.delete(g),f.push(this.removeMatchingKeysForTargetId(e,b.targetId)),d++)}),PersistencePromise.waitFor(f).next(()=>d)}getTargetCount(e){return PersistencePromise.resolve(this.targetCount)}getTargetData(e,r){let h=this.ri.get(r)||null;return PersistencePromise.resolve(h)}addMatchingKeys(e,r,h){return this.si.$r(r,h),PersistencePromise.resolve()}removeMatchingKeys(e,r,h){this.si.Qr(r,h);let d=this.persistence.referenceDelegate,f=[];return d&&r.forEach(r=>{f.push(d.markPotentiallyOrphaned(e,r))}),PersistencePromise.waitFor(f)}removeMatchingKeysForTargetId(e,r){return this.si.Gr(r),PersistencePromise.resolve()}getMatchingKeysForTargetId(e,r){let h=this.si.jr(r);return PersistencePromise.resolve(h)}containsKey(e,r){return PersistencePromise.resolve(this.si.containsKey(r))}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_MemoryPersistence=class __PRIVATE_MemoryPersistence{constructor(e,r){this._i={},this.overlays={},this.ai=new __PRIVATE_ListenSequence(0),this.ui=!1,this.ui=!0,this.ci=new __PRIVATE_MemoryGlobalsCache,this.referenceDelegate=e(this),this.li=new __PRIVATE_MemoryTargetCache(this),this.indexManager=new __PRIVATE_MemoryIndexManager,this.remoteDocumentCache=new __PRIVATE_MemoryRemoteDocumentCacheImpl(e=>this.referenceDelegate.hi(e)),this.serializer=new __PRIVATE_LocalSerializer(r),this.Pi=new __PRIVATE_MemoryBundleCache(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ui=!1,Promise.resolve()}get started(){return this.ui}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new __PRIVATE_MemoryDocumentOverlayCache,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let h=this._i[e.toKey()];return h||(h=new __PRIVATE_MemoryMutationQueue(r,this.referenceDelegate),this._i[e.toKey()]=h),h}getGlobalsCache(){return this.ci}getTargetCache(){return this.li}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Pi}runTransaction(e,r,h){common_341bda9b_esm_PRIVATE_logDebug("MemoryPersistence","Starting transaction:",e);let d=new __PRIVATE_MemoryTransaction(this.ai.next());return this.referenceDelegate.Ti(),h(d).next(e=>this.referenceDelegate.Ii(d).next(()=>e)).toPromise().then(e=>(d.raiseOnCommittedEvent(),e))}Ei(e,r){return PersistencePromise.or(Object.values(this._i).map(h=>()=>h.containsKey(e,r)))}};let __PRIVATE_MemoryTransaction=class __PRIVATE_MemoryTransaction extends PersistenceTransaction{constructor(e){super(),this.currentSequenceNumber=e}};let __PRIVATE_MemoryEagerDelegate=class __PRIVATE_MemoryEagerDelegate{constructor(e){this.persistence=e,this.Ri=new __PRIVATE_ReferenceSet,this.Ai=null}static Vi(e){return new __PRIVATE_MemoryEagerDelegate(e)}get di(){if(this.Ai)return this.Ai;throw common_341bda9b_esm_fail(60996)}addReference(e,r,h){return this.Ri.addReference(h,r),this.di.delete(h.toString()),PersistencePromise.resolve()}removeReference(e,r,h){return this.Ri.removeReference(h,r),this.di.add(h.toString()),PersistencePromise.resolve()}markPotentiallyOrphaned(e,r){return this.di.add(r.toString()),PersistencePromise.resolve()}removeTarget(e,r){this.Ri.Gr(r.targetId).forEach(e=>this.di.add(e.toString()));let h=this.persistence.getTargetCache();return h.getMatchingKeysForTargetId(e,r.targetId).next(e=>{e.forEach(e=>this.di.add(e.toString()))}).next(()=>h.removeTargetData(e,r))}Ti(){this.Ai=new Set}Ii(e){let r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return PersistencePromise.forEach(this.di,h=>{let d=common_341bda9b_esm_DocumentKey.fromPath(h);return this.mi(e,d).next(e=>{e||r.removeEntry(d,SnapshotVersion.min())})}).next(()=>(this.Ai=null,r.apply(e)))}updateLimboDocument(e,r){return this.mi(e,r).next(e=>{e?this.di.delete(r.toString()):this.di.add(r.toString())})}hi(e){return 0}mi(e,r){return PersistencePromise.or([()=>PersistencePromise.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ei(e,r)])}};let __PRIVATE_MemoryLruDelegate=class __PRIVATE_MemoryLruDelegate{constructor(e,r){this.persistence=e,this.fi=new ObjectMap(e=>(function(e){var r,h;let d="";for(let r=0;r<e.length;r++)d.length>0&&(d=d+"\x01\x01"),d=function(e,r){let h=r,d=e.length;for(let r=0;r<d;r++){let d=e.charAt(r);switch(d){case"\x00":h+="\x01\x10";break;case"\x01":h+="\x01\x11";break;default:h+=d}}return h}(e.get(r),d);return d+"\x01\x01"})(e.path),(e,r)=>e.isEqual(r)),this.garbageCollector=new __PRIVATE_LruGarbageCollectorImpl(this,r)}static Vi(e,r){return new __PRIVATE_MemoryLruDelegate(e,r)}Ti(){}Ii(e){return PersistencePromise.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}dr(e){let r=this.pr(e);return this.persistence.getTargetCache().getTargetCount(e).next(e=>r.next(r=>e+r))}pr(e){let r=0;return this.mr(e,e=>{r++}).next(()=>r)}mr(e,r){return PersistencePromise.forEach(this.fi,(h,d)=>this.wr(e,h,d).next(e=>e?PersistencePromise.resolve():r(d)))}removeTargets(e,r,h){return this.persistence.getTargetCache().removeTargets(e,r,h)}removeOrphanedDocuments(e,r){let h=0,d=this.persistence.getRemoteDocumentCache(),f=d.newChangeBuffer();return d.ni(e,d=>this.wr(e,d,r).next(e=>{e||(h++,f.removeEntry(d,SnapshotVersion.min()))})).next(()=>f.apply(e)).next(()=>h)}markPotentiallyOrphaned(e,r){return this.fi.set(r,e.currentSequenceNumber),PersistencePromise.resolve()}removeTarget(e,r){let h=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,h)}addReference(e,r,h){return this.fi.set(h,e.currentSequenceNumber),PersistencePromise.resolve()}removeReference(e,r,h){return this.fi.set(h,e.currentSequenceNumber),PersistencePromise.resolve()}updateLimboDocument(e,r){return this.fi.set(r,e.currentSequenceNumber),PersistencePromise.resolve()}hi(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=function __PRIVATE_estimateByteSize(e){switch(__PRIVATE_typeOrder(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let r=__PRIVATE_getPreviousValue(e);return r?16+__PRIVATE_estimateByteSize(r):16;case 5:return 2*e.stringValue.length;case 6:return __PRIVATE_normalizeByteString(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return(e.arrayValue.values||[]).reduce((e,r)=>e+__PRIVATE_estimateByteSize(r),0);case 10:case 11:var h;let d;return h=e.mapValue,d=0,forEach(h.fields,(e,r)=>{d+=e.length+__PRIVATE_estimateByteSize(r)}),d;default:throw common_341bda9b_esm_fail(13486,{value:e})}}(e.data.value)),r}wr(e,r,h){return PersistencePromise.or([()=>this.persistence.Ei(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{let e=this.fi.get(r);return PersistencePromise.resolve(void 0!==e&&e>h)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_LocalViewChanges=class __PRIVATE_LocalViewChanges{constructor(e,r,h,d){this.targetId=e,this.fromCache=r,this.Ts=h,this.Is=d}static Es(e,r){let h=common_341bda9b_esm_PRIVATE_documentKeySet(),d=common_341bda9b_esm_PRIVATE_documentKeySet();for(let e of r.docChanges)switch(e.type){case 0:h=h.add(e.doc.key);break;case 1:d=d.add(e.doc.key)}return new __PRIVATE_LocalViewChanges(e,r.fromCache,h,d)}};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let QueryContext=class QueryContext{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_QueryEngine=class __PRIVATE_QueryEngine{constructor(){this.Rs=!1,this.As=!1,this.Vs=100,this.ds=(0,ea.G6)()?8:function(e){let r=e.match(/Android ([\d.]+)/i),h=r?r[1].split(".").slice(0,2).join("."):"-1";return Number(h)}((0,ea.z$)())>0?6:4}initialize(e,r){this.fs=e,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(e,r,h,d){let f={result:null};return this.gs(e,r).next(e=>{f.result=e}).next(()=>{if(!f.result)return this.ps(e,r,d,h).next(e=>{f.result=e})}).next(()=>{if(f.result)return;let h=new QueryContext;return this.ys(e,r,h).next(d=>{if(f.result=d,this.As)return this.ws(e,r,h,d.size)})}).next(()=>f.result)}ws(e,r,h,d){return h.documentReadCount<this.Vs?(__PRIVATE_getLogLevel()<=eh.in.DEBUG&&common_341bda9b_esm_PRIVATE_logDebug("QueryEngine","SDK will not create cache indexes for query:",__PRIVATE_stringifyQuery(r),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),PersistencePromise.resolve()):(__PRIVATE_getLogLevel()<=eh.in.DEBUG&&common_341bda9b_esm_PRIVATE_logDebug("QueryEngine","Query:",__PRIVATE_stringifyQuery(r),"scans",h.documentReadCount,"local documents and returns",d,"documents as results."),h.documentReadCount>this.ds*d?(__PRIVATE_getLogLevel()<=eh.in.DEBUG&&common_341bda9b_esm_PRIVATE_logDebug("QueryEngine","The SDK decides to create cache indexes for query:",__PRIVATE_stringifyQuery(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,__PRIVATE_queryToTarget(r))):PersistencePromise.resolve())}gs(e,r){if(__PRIVATE_queryMatchesAllDocuments(r))return PersistencePromise.resolve(null);let h=__PRIVATE_queryToTarget(r);return this.indexManager.getIndexType(e,h).next(d=>0===d?null:(null!==r.limit&&1===d&&(h=__PRIVATE_queryToTarget(r=common_341bda9b_esm_PRIVATE_queryWithLimit(r,null,"F"))),this.indexManager.getDocumentsMatchingTarget(e,h).next(d=>{let f=common_341bda9b_esm_PRIVATE_documentKeySet(...d);return this.fs.getDocuments(e,f).next(d=>this.indexManager.getMinOffset(e,h).next(h=>{let g=this.bs(r,d);return this.Ss(r,g,f,h.readTime)?this.gs(e,common_341bda9b_esm_PRIVATE_queryWithLimit(r,null,"F")):this.Ds(e,g,r,h)}))})))}ps(e,r,h,d){return __PRIVATE_queryMatchesAllDocuments(r)||d.isEqual(SnapshotVersion.min())?PersistencePromise.resolve(null):this.fs.getDocuments(e,h).next(f=>{let g=this.bs(r,f);return this.Ss(r,g,h,d)?PersistencePromise.resolve(null):(__PRIVATE_getLogLevel()<=eh.in.DEBUG&&common_341bda9b_esm_PRIVATE_logDebug("QueryEngine","Re-using previous result from %s to execute query: %s",d.toString(),__PRIVATE_stringifyQuery(r)),this.Ds(e,g,r,function(e,r){let h=e.toTimestamp().seconds,d=e.toTimestamp().nanoseconds+1,f=SnapshotVersion.fromTimestamp(1e9===d?new Timestamp(h+1,0):new Timestamp(h,d));return new IndexOffset(f,common_341bda9b_esm_DocumentKey.empty(),-1)}(d,0)).next(e=>e))})}bs(e,r){let h=new SortedSet(__PRIVATE_newQueryComparator(e));return r.forEach((r,d)=>{__PRIVATE_queryMatches(e,d)&&(h=h.add(d))}),h}Ss(e,r,h,d){if(null===e.limit)return!1;if(h.size!==r.size)return!0;let f="F"===e.limitType?r.last():r.first();return!!f&&(f.hasPendingWrites||f.version.compareTo(d)>0)}ys(e,r,h){return __PRIVATE_getLogLevel()<=eh.in.DEBUG&&common_341bda9b_esm_PRIVATE_logDebug("QueryEngine","Using full collection scan to execute query:",__PRIVATE_stringifyQuery(r)),this.fs.getDocumentsMatchingQuery(e,r,IndexOffset.min(),h)}Ds(e,r,h,d){return this.fs.getDocumentsMatchingQuery(e,h,d).next(e=>(r.forEach(r=>{e=e.insert(r.key,r)}),e))}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ez="LocalStore";let __PRIVATE_LocalStoreImpl=class __PRIVATE_LocalStoreImpl{constructor(e,r,h,d){this.persistence=e,this.Cs=r,this.serializer=d,this.vs=new SortedMap(__PRIVATE_primitiveComparator),this.Fs=new ObjectMap(e=>__PRIVATE_canonifyTarget(e),__PRIVATE_targetEquals),this.Ms=new Map,this.xs=e.getRemoteDocumentCache(),this.li=e.getTargetCache(),this.Pi=e.getBundleCache(),this.Os(h)}Os(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new LocalDocumentsView(this.xs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.xs.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.vs))}};async function __PRIVATE_localStoreHandleUserChange(e,r){return await e.persistence.runTransaction("Handle user change","readonly",h=>{let d;return e.mutationQueue.getAllMutationBatches(h).next(f=>(d=f,e.Os(r),e.mutationQueue.getAllMutationBatches(h))).next(r=>{let f=[],g=[],b=common_341bda9b_esm_PRIVATE_documentKeySet();for(let e of d)for(let r of(f.push(e.batchId),e.mutations))b=b.add(r.key);for(let e of r)for(let r of(g.push(e.batchId),e.mutations))b=b.add(r.key);return e.localDocuments.getDocuments(h,b).next(e=>({Ns:e,removedBatchIds:f,addedBatchIds:g}))})})}function __PRIVATE_localStoreGetLastRemoteSnapshotVersion(e){return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.li.getLastRemoteSnapshotVersion(r))}async function __PRIVATE_localStoreReleaseTarget(e,r,h){let d=e.vs.get(r);try{h||await e.persistence.runTransaction("Release target",h?"readwrite":"readwrite-primary",r=>e.persistence.referenceDelegate.removeTarget(r,d))}catch(e){if(!__PRIVATE_isIndexedDbTransactionError(e))throw e;common_341bda9b_esm_PRIVATE_logDebug(ez,`Failed to update sequence numbers for target ${r}: ${e}`)}e.vs=e.vs.remove(r),e.Fs.delete(d.target)}function __PRIVATE_localStoreExecuteQuery(e,r,h){let d=SnapshotVersion.min(),f=common_341bda9b_esm_PRIVATE_documentKeySet();return e.persistence.runTransaction("Execute query","readwrite",g=>(function(e,r,h){let d=e.Fs.get(h);return void 0!==d?PersistencePromise.resolve(e.vs.get(d)):e.li.getTargetData(r,h)})(e,g,__PRIVATE_queryToTarget(r)).next(r=>{if(r)return d=r.lastLimboFreeSnapshotVersion,e.li.getMatchingKeysForTargetId(g,r.targetId).next(e=>{f=e})}).next(()=>e.Cs.getDocumentsMatchingQuery(g,r,h?d:SnapshotVersion.min(),h?f:common_341bda9b_esm_PRIVATE_documentKeySet())).next(h=>{var d;let g;return d=r.collectionGroup||(r.path.length%2==1?r.path.lastSegment():r.path.get(r.path.length-2)),g=e.Ms.get(d)||SnapshotVersion.min(),h.forEach((e,r)=>{r.readTime.compareTo(g)>0&&(g=r.readTime)}),e.Ms.set(d,g),{documents:h,ks:f}}))}let __PRIVATE_LocalClientState=class __PRIVATE_LocalClientState{constructor(){this.activeTargetIds=eM}Qs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};let __PRIVATE_MemorySharedClientState=class __PRIVATE_MemorySharedClientState{constructor(){this.vo=new __PRIVATE_LocalClientState,this.Fo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,h){}addLocalQueryTarget(e,r=!0){return r&&this.vo.Qs(e),this.Fo[e]||"not-current"}updateQueryState(e,r,h){this.Fo[e]=r}removeLocalQueryTarget(e){this.vo.Gs(e)}isLocalQueryTarget(e){return this.vo.activeTargetIds.has(e)}clearQueryState(e){delete this.Fo[e]}getAllActiveQueryTargets(){return this.vo.activeTargetIds}isActiveQueryTarget(e){return this.vo.activeTargetIds.has(e)}start(){return this.vo=new __PRIVATE_LocalClientState,Promise.resolve()}handleUserChange(e,r,h){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_NoopConnectivityMonitor=class __PRIVATE_NoopConnectivityMonitor{Mo(e){}shutdown(){}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eW="ConnectivityMonitor";let __PRIVATE_BrowserConnectivityMonitor=class __PRIVATE_BrowserConnectivityMonitor{constructor(){this.xo=()=>this.Oo(),this.No=()=>this.Bo(),this.Lo=[],this.ko()}Mo(e){this.Lo.push(e)}shutdown(){window.removeEventListener("online",this.xo),window.removeEventListener("offline",this.No)}ko(){window.addEventListener("online",this.xo),window.addEventListener("offline",this.No)}Oo(){for(let e of(common_341bda9b_esm_PRIVATE_logDebug(eW,"Network connectivity changed: AVAILABLE"),this.Lo))e(0)}Bo(){for(let e of(common_341bda9b_esm_PRIVATE_logDebug(eW,"Network connectivity changed: UNAVAILABLE"),this.Lo))e(1)}static v(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let e$=null;function __PRIVATE_generateUniqueDebugId(){return null===e$?e$=268435456+Math.round(2147483648*Math.random()):e$++,"0x"+e$.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eK="RestConnection",eH={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery",ExecutePipeline:"executePipeline"};let __PRIVATE_RestConnection=class __PRIVATE_RestConnection{get Ko(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let r=e.ssl?"https":"http",h=encodeURIComponent(this.databaseId.projectId),d=encodeURIComponent(this.databaseId.database);this.qo=r+"://"+e.host,this.Uo=`projects/${h}/databases/${d}`,this.$o=this.databaseId.database===eR?`project_id=${h}`:`project_id=${h}&database_id=${d}`}Wo(e,r,h,d,f){let g=__PRIVATE_generateUniqueDebugId(),b=this.Qo(e,r.toUriEncodedString());common_341bda9b_esm_PRIVATE_logDebug(eK,`Sending RPC '${e}' ${g}:`,b,h);let A={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.$o};this.Go(A,d,f);let{host:k}=new URL(b),M=(0,ea.Xx)(k);return this.zo(e,b,A,h,M).then(r=>(common_341bda9b_esm_PRIVATE_logDebug(eK,`Received RPC '${e}' ${g}: `,r),r),r=>{throw common_341bda9b_esm_PRIVATE_logWarn(eK,`RPC '${e}' ${g} failed with error: `,r,"url: ",b,"request:",h),r})}jo(e,r,h,d,f,g){return this.Wo(e,r,h,d,f)}Go(e,r,h){e["X-Goog-Api-Client"]="gl-js/ fire/"+ep,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((r,h)=>e[h]=r),h&&h.headers.forEach((r,h)=>e[h]=r)}Qo(e,r){let h=eH[e],d=`${this.qo}/v1/${r}:${h}`;return this.databaseInfo.apiKey&&(d=`${d}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),d}terminate(){}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_StreamBridge=class __PRIVATE_StreamBridge{constructor(e){this.Ho=e.Ho,this.Jo=e.Jo}Zo(e){this.Xo=e}Yo(e){this.e_=e}t_(e){this.n_=e}onMessage(e){this.r_=e}close(){this.Jo()}send(e){this.Ho(e)}i_(){this.Xo()}s_(){this.e_()}o_(e){this.n_(e)}__(e){this.r_(e)}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eG="WebChannelConnection",__PRIVATE_unguardedEventListen=(e,r,h)=>{e.listen(r,e=>{try{h(e)}catch(e){setTimeout(()=>{throw e},0)}})};let __PRIVATE_WebChannelConnection=class __PRIVATE_WebChannelConnection extends __PRIVATE_RestConnection{constructor(e){super(e),this.a_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}static u_(){if(!__PRIVATE_WebChannelConnection.c_){let e=q();__PRIVATE_unguardedEventListen(e,j.STAT_EVENT,e=>{e.stat===M.PROXY?common_341bda9b_esm_PRIVATE_logDebug(eG,"STAT_EVENT: detected buffering proxy"):e.stat===M.NOPROXY&&common_341bda9b_esm_PRIVATE_logDebug(eG,"STAT_EVENT: detected no buffering proxy")}),__PRIVATE_WebChannelConnection.c_=!0}}zo(e,r,h,d,f){let b=__PRIVATE_generateUniqueDebugId();return new Promise((f,M)=>{let j=new g;j.setWithCredentials(!0),j.listenOnce(A.COMPLETE,()=>{try{switch(j.getLastErrorCode()){case k.NO_ERROR:let r=j.getResponseJson();common_341bda9b_esm_PRIVATE_logDebug(eG,`XHR for RPC '${e}' ${b} received:`,JSON.stringify(r)),f(r);break;case k.TIMEOUT:common_341bda9b_esm_PRIVATE_logDebug(eG,`RPC '${e}' ${b} timed out`),M(new common_341bda9b_esm_FirestoreError(eg.DEADLINE_EXCEEDED,"Request time out"));break;case k.HTTP_ERROR:let h=j.getStatus();if(common_341bda9b_esm_PRIVATE_logDebug(eG,`RPC '${e}' ${b} failed with status:`,h,"response text:",j.getResponseText()),h>0){let e=j.getResponseJson();Array.isArray(e)&&(e=e[0]);let r=e?.error;if(r&&r.status&&r.message){let e=function(e){let r=e.toLowerCase().replace(/_/g,"-");return Object.values(eg).indexOf(r)>=0?r:eg.UNKNOWN}(r.status);M(new common_341bda9b_esm_FirestoreError(e,r.message))}else M(new common_341bda9b_esm_FirestoreError(eg.UNKNOWN,"Server responded with status "+j.getStatus()))}else M(new common_341bda9b_esm_FirestoreError(eg.UNAVAILABLE,"Connection failed."));break;default:common_341bda9b_esm_fail(9055,{l_:e,streamId:b,h_:j.getLastErrorCode(),P_:j.getLastError()})}}finally{common_341bda9b_esm_PRIVATE_logDebug(eG,`RPC '${e}' ${b} completed.`)}});let q=JSON.stringify(d);common_341bda9b_esm_PRIVATE_logDebug(eG,`RPC '${e}' ${b} sending request:`,d),j.send(r,"POST",q,h,15)})}T_(e,r,h){let d=__PRIVATE_generateUniqueDebugId(),f=[this.qo,"/","google.firestore.v1.Firestore","/",e,"/channel"],g=this.createWebChannelTransport(),A={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},k=this.longPollingOptions.timeoutSeconds;void 0!==k&&(A.longPollingTimeout=Math.round(1e3*k)),this.useFetchStreams&&(A.useFetchStreams=!0),this.Go(A.initMessageHeaders,r,h),A.encodeInitMessageHeaders=!0;let M=f.join("");common_341bda9b_esm_PRIVATE_logDebug(eG,`Creating RPC '${e}' stream ${d}: ${M}`,A);let j=g.createWebChannel(M,A);this.I_(j);let q=!1,ee=!1,er=new __PRIVATE_StreamBridge({Ho:r=>{ee?common_341bda9b_esm_PRIVATE_logDebug(eG,`Not sending because RPC '${e}' stream ${d} is closed:`,r):(q||(common_341bda9b_esm_PRIVATE_logDebug(eG,`Opening RPC '${e}' stream ${d} transport.`),j.open(),q=!0),common_341bda9b_esm_PRIVATE_logDebug(eG,`RPC '${e}' stream ${d} sending:`,r),j.send(r))},Jo:()=>j.close()});return __PRIVATE_unguardedEventListen(j,b.EventType.OPEN,()=>{ee||(common_341bda9b_esm_PRIVATE_logDebug(eG,`RPC '${e}' stream ${d} transport opened.`),er.i_())}),__PRIVATE_unguardedEventListen(j,b.EventType.CLOSE,()=>{ee||(ee=!0,common_341bda9b_esm_PRIVATE_logDebug(eG,`RPC '${e}' stream ${d} transport closed`),er.o_(),this.E_(j))}),__PRIVATE_unguardedEventListen(j,b.EventType.ERROR,r=>{ee||(ee=!0,common_341bda9b_esm_PRIVATE_logWarn(eG,`RPC '${e}' stream ${d} transport errored. Name:`,r.name,"Message:",r.message),er.o_(new common_341bda9b_esm_FirestoreError(eg.UNAVAILABLE,"The operation could not be completed")))}),__PRIVATE_unguardedEventListen(j,b.EventType.MESSAGE,r=>{if(!ee){let h=r.data[0];__PRIVATE_hardAssert(!!h,16349);let f=h?.error||h[0]?.error;if(f){common_341bda9b_esm_PRIVATE_logDebug(eG,`RPC '${e}' stream ${d} received error:`,f);let r=f.status,h=function(e){let r=et[e];if(void 0!==r)return __PRIVATE_mapCodeFromRpcCode(r)}(r),g=f.message;void 0===h&&(h=eg.INTERNAL,g="Unknown error status: "+r+" with message "+f.message),ee=!0,er.o_(new common_341bda9b_esm_FirestoreError(h,g)),j.close()}else common_341bda9b_esm_PRIVATE_logDebug(eG,`RPC '${e}' stream ${d} received:`,h),er.__(h)}}),__PRIVATE_WebChannelConnection.u_(),setTimeout(()=>{er.s_()},0),er}terminate(){this.a_.forEach(e=>e.close()),this.a_=[]}I_(e){this.a_.push(e)}E_(e){this.a_=this.a_.filter(r=>r===e)}Go(e,r,h){super.Go(e,r,h),this.databaseInfo.apiKey&&(e["x-goog-api-key"]=this.databaseInfo.apiKey)}createWebChannelTransport(){return ee()}};function getDocument(){return"undefined"!=typeof document?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function common_341bda9b_esm_PRIVATE_newSerializer(e){return new JsonProtoSerializer(e,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */__PRIVATE_WebChannelConnection.c_=!1;let __PRIVATE_ExponentialBackoff=class __PRIVATE_ExponentialBackoff{constructor(e,r,h=1e3,d=1.5,f=6e4){this.Ci=e,this.timerId=r,this.R_=h,this.A_=d,this.V_=f,this.d_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.d_=0}g_(){this.d_=this.V_}p_(e){this.cancel();let r=Math.floor(this.d_+this.y_()),h=Math.max(0,Date.now()-this.f_),d=Math.max(0,r-h);d>0&&common_341bda9b_esm_PRIVATE_logDebug("ExponentialBackoff",`Backing off for ${d} ms (base delay: ${this.d_} ms, delay with jitter: ${r} ms, last attempt: ${h} ms ago)`),this.m_=this.Ci.enqueueAfterDelay(this.timerId,d,()=>(this.f_=Date.now(),e())),this.d_*=this.A_,this.d_<this.R_&&(this.d_=this.R_),this.d_>this.V_&&(this.d_=this.V_)}w_(){null!==this.m_&&(this.m_.skipDelay(),this.m_=null)}cancel(){null!==this.m_&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.d_}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eQ="PersistentStream";let __PRIVATE_PersistentStream=class __PRIVATE_PersistentStream{constructor(e,r,h,d,f,g,b,A){this.Ci=e,this.b_=h,this.S_=d,this.connection=f,this.authCredentialsProvider=g,this.appCheckCredentialsProvider=b,this.listener=A,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new __PRIVATE_ExponentialBackoff(e,r)}x_(){return 1===this.state||5===this.state||this.O_()}O_(){return 2===this.state||3===this.state}start(){this.F_=0,4!==this.state?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&null===this.C_&&(this.C_=this.Ci.enqueueAfterDelay(this.b_,6e4,()=>this.k_()))}K_(e){this.q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.q_(),this.U_(),this.M_.cancel(),this.D_++,4!==e?this.M_.reset():r&&r.code===eg.RESOURCE_EXHAUSTED?(__PRIVATE_logError(r.toString()),__PRIVATE_logError("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===eg.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.t_(r)}W_(){}auth(){this.state=1;let e=this.Q_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([e,h])=>{this.D_===r&&this.G_(e,h)},r=>{e(()=>{let e=new common_341bda9b_esm_FirestoreError(eg.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(e)})})}G_(e,r){let h=this.Q_(this.D_);this.stream=this.j_(e,r),this.stream.Zo(()=>{h(()=>this.listener.Zo())}),this.stream.Yo(()=>{h(()=>(this.state=2,this.v_=this.Ci.enqueueAfterDelay(this.S_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.Yo()))}),this.stream.t_(e=>{h(()=>this.z_(e))}),this.stream.onMessage(e=>{h(()=>1==++this.F_?this.H_(e):this.onNext(e))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return common_341bda9b_esm_PRIVATE_logDebug(eQ,`close with error: ${e}`),this.stream=null,this.close(4,e)}Q_(e){return r=>{this.Ci.enqueueAndForget(()=>this.D_===e?r():(common_341bda9b_esm_PRIVATE_logDebug(eQ,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}};let __PRIVATE_PersistentListenStream=class __PRIVATE_PersistentListenStream extends __PRIVATE_PersistentStream{constructor(e,r,h,d,f,g){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,h,d,g),this.serializer=f}j_(e,r){return this.connection.T_("Listen",e,r)}H_(e){return this.onNext(e)}onNext(e){this.M_.reset();let r=function(e,r){let h;if("targetChange"in r){var d,f;r.targetChange;let g="NO_CHANGE"===(d=r.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===d?1:"REMOVE"===d?2:"CURRENT"===d?3:"RESET"===d?4:common_341bda9b_esm_fail(39313,{state:d}),b=r.targetChange.targetIds||[],A=(f=r.targetChange.resumeToken,e.useProto3Json?(__PRIVATE_hardAssert(void 0===f||"string"==typeof f,58123),ByteString.fromBase64String(f||"")):(__PRIVATE_hardAssert(void 0===f||f instanceof ef||f instanceof Uint8Array,16193),ByteString.fromUint8Array(f||new Uint8Array))),k=r.targetChange.cause,M=k&&function(e){let r=void 0===e.code?eg.UNKNOWN:__PRIVATE_mapCodeFromRpcCode(e.code);return new common_341bda9b_esm_FirestoreError(r,e.message||"")}(k);h=new __PRIVATE_WatchTargetChange(g,b,A,M||null)}else if("documentChange"in r){r.documentChange;let d=r.documentChange;d.document,d.document.name,d.document.updateTime;let f=fromName(e,d.document.name),g=__PRIVATE_fromVersion(d.document.updateTime),b=d.document.createTime?__PRIVATE_fromVersion(d.document.createTime):SnapshotVersion.min(),A=new common_341bda9b_esm_ObjectValue({mapValue:{fields:d.document.fields}}),k=MutableDocument.newFoundDocument(f,g,b,A),M=d.targetIds||[],j=d.removedTargetIds||[];h=new __PRIVATE_DocumentWatchChange(M,j,k.key,k)}else if("documentDelete"in r){r.documentDelete;let d=r.documentDelete;d.document;let f=fromName(e,d.document),g=d.readTime?__PRIVATE_fromVersion(d.readTime):SnapshotVersion.min(),b=MutableDocument.newNoDocument(f,g),A=d.removedTargetIds||[];h=new __PRIVATE_DocumentWatchChange([],A,b.key,b)}else if("documentRemove"in r){r.documentRemove;let d=r.documentRemove;d.document;let f=fromName(e,d.document),g=d.removedTargetIds||[];h=new __PRIVATE_DocumentWatchChange([],g,f,null)}else{if(!("filter"in r))return common_341bda9b_esm_fail(11601,{Vt:r});{r.filter;let e=r.filter;e.targetId;let{count:d=0,unchangedNames:f}=e,g=new ExistenceFilter(d,f),b=e.targetId;h=new __PRIVATE_ExistenceFilterChange(b,g)}}return h}(this.serializer,e),h=function(e){if(!("targetChange"in e))return SnapshotVersion.min();let r=e.targetChange;return r.targetIds&&r.targetIds.length?SnapshotVersion.min():r.readTime?__PRIVATE_fromVersion(r.readTime):SnapshotVersion.min()}(e);return this.listener.J_(r,h)}Z_(e){let r={};r.database=__PRIVATE_getEncodedDatabaseId(this.serializer),r.addTarget=function(e,r){let h;let d=r.target;if((h=__PRIVATE_targetIsDocumentTarget(d)?{documents:{documents:[__PRIVATE_toQueryPath(e,d.path)]}}:{query:function(e,r){var h,d;let f;let g={structuredQuery:{}},b=r.path;null!==r.collectionGroup?(f=b,g.structuredQuery.from=[{collectionId:r.collectionGroup,allDescendants:!0}]):(f=b.popLast(),g.structuredQuery.from=[{collectionId:b.lastSegment()}]),g.parent=__PRIVATE_toQueryPath(e,f);let A=function(e){if(0!==e.length)return function __PRIVATE_toFilter(e){return e instanceof FieldFilter?function(e){if("=="===e.op){if(__PRIVATE_isNanValue(e.value))return{unaryFilter:{field:__PRIVATE_toFieldPathReference(e.field),op:"IS_NAN"}};if(__PRIVATE_isNullValue(e.value))return{unaryFilter:{field:__PRIVATE_toFieldPathReference(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(__PRIVATE_isNanValue(e.value))return{unaryFilter:{field:__PRIVATE_toFieldPathReference(e.field),op:"IS_NOT_NAN"}};if(__PRIVATE_isNullValue(e.value))return{unaryFilter:{field:__PRIVATE_toFieldPathReference(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:__PRIVATE_toFieldPathReference(e.field),op:eB[e.op],value:e.value}}}(e):e instanceof CompositeFilter?function(e){let r=e.getFilters().map(e=>__PRIVATE_toFilter(e));return 1===r.length?r[0]:{compositeFilter:{op:eU[e.op],filters:r}}}(e):common_341bda9b_esm_fail(54877,{filter:e})}(CompositeFilter.create(e,"and"))}(r.filters);A&&(g.structuredQuery.where=A);let k=function(e){if(0!==e.length)return e.map(e=>({field:__PRIVATE_toFieldPathReference(e.field),direction:eF[e.dir]}))}(r.orderBy);k&&(g.structuredQuery.orderBy=k);let M=__PRIVATE_toInt32Proto(e,r.limit);return null!==M&&(g.structuredQuery.limit=M),r.startAt&&(g.structuredQuery.startAt={before:(h=r.startAt).inclusive,values:h.position}),r.endAt&&(g.structuredQuery.endAt={before:!(d=r.endAt).inclusive,values:d.position}),{ft:g,parent:f}}(e,d).ft}).targetId=r.targetId,r.resumeToken.approximateByteSize()>0){h.resumeToken=__PRIVATE_toBytes(e,r.resumeToken);let d=__PRIVATE_toInt32Proto(e,r.expectedCount);null!==d&&(h.expectedCount=d)}else if(r.snapshotVersion.compareTo(SnapshotVersion.min())>0){h.readTime=toTimestamp(e,r.snapshotVersion.toTimestamp());let d=__PRIVATE_toInt32Proto(e,r.expectedCount);null!==d&&(h.expectedCount=d)}return h}(this.serializer,e);let h=function(e,r){let h=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return common_341bda9b_esm_fail(28987,{purpose:e})}}(r.purpose);return null==h?null:{"goog-listen-tags":h}}(this.serializer,e);h&&(r.labels=h),this.K_(r)}X_(e){let r={};r.database=__PRIVATE_getEncodedDatabaseId(this.serializer),r.removeTarget=e,this.K_(r)}};let __PRIVATE_PersistentWriteStream=class __PRIVATE_PersistentWriteStream extends __PRIVATE_PersistentStream{constructor(e,r,h,d,f,g){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,h,d,g),this.serializer=f}get Y_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.Y_&&this.ea([])}j_(e,r){return this.connection.T_("Write",e,r)}H_(e){return __PRIVATE_hardAssert(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,__PRIVATE_hardAssert(!e.writeResults||0===e.writeResults.length,55816),this.listener.ta()}onNext(e){var r,h;__PRIVATE_hardAssert(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();let d=(r=e.writeResults,h=e.commitTime,r&&r.length>0?(__PRIVATE_hardAssert(void 0!==h,14353),r.map(e=>{let r;return(r=e.updateTime?__PRIVATE_fromVersion(e.updateTime):__PRIVATE_fromVersion(h)).isEqual(SnapshotVersion.min())&&(r=__PRIVATE_fromVersion(h)),new MutationResult(r,e.transformResults||[])})):[]),f=__PRIVATE_fromVersion(e.commitTime);return this.listener.na(f,d)}ra(){let e={};e.database=__PRIVATE_getEncodedDatabaseId(this.serializer),this.K_(e)}ea(e){let r={streamToken:this.lastStreamToken,writes:e.map(e=>(function(e,r){var h;let d;if(r instanceof __PRIVATE_SetMutation)d={update:__PRIVATE_toMutationDocument(e,r.key,r.value)};else if(r instanceof common_341bda9b_esm_PRIVATE_DeleteMutation)d={delete:__PRIVATE_toName(e,r.key)};else if(r instanceof __PRIVATE_PatchMutation)d={update:__PRIVATE_toMutationDocument(e,r.key,r.data),updateMask:function(e){let r=[];return e.fields.forEach(e=>r.push(e.canonicalString())),{fieldPaths:r}}(r.fieldMask)};else{if(!(r instanceof __PRIVATE_VerifyMutation))return common_341bda9b_esm_fail(16599,{dt:r.type});d={verify:__PRIVATE_toName(e,r.key)}}return r.fieldTransforms.length>0&&(d.updateTransforms=r.fieldTransforms.map(e=>(function(e,r){let h=r.transform;if(h instanceof __PRIVATE_ServerTimestampTransform)return{fieldPath:r.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(h instanceof __PRIVATE_ArrayUnionTransformOperation)return{fieldPath:r.field.canonicalString(),appendMissingElements:{values:h.elements}};if(h instanceof __PRIVATE_ArrayRemoveTransformOperation)return{fieldPath:r.field.canonicalString(),removeAllFromArray:{values:h.elements}};if(h instanceof __PRIVATE_NumericIncrementTransformOperation)return{fieldPath:r.field.canonicalString(),increment:h.Ae};throw common_341bda9b_esm_fail(20930,{transform:r.transform})})(0,e))),r.precondition.isNone||(d.currentDocument=void 0!==(h=r.precondition).updateTime?{updateTime:toTimestamp(e,h.updateTime.toTimestamp())}:void 0!==h.exists?{exists:h.exists}:common_341bda9b_esm_fail(27497)),d})(this.serializer,e))};this.K_(r)}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Datastore=class Datastore{};let __PRIVATE_DatastoreImpl=class __PRIVATE_DatastoreImpl extends Datastore{constructor(e,r,h,d){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=h,this.serializer=d,this.ia=!1}sa(){if(this.ia)throw new common_341bda9b_esm_FirestoreError(eg.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,r,h,d){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([f,g])=>this.connection.Wo(e,__PRIVATE_toResourcePath(r,h),d,f,g)).catch(e=>{throw"FirebaseError"===e.name?(e.code===eg.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new common_341bda9b_esm_FirestoreError(eg.UNKNOWN,e.toString())})}jo(e,r,h,d,f){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([g,b])=>this.connection.jo(e,__PRIVATE_toResourcePath(r,h),d,g,b,f)).catch(e=>{throw"FirebaseError"===e.name?(e.code===eg.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new common_341bda9b_esm_FirestoreError(eg.UNKNOWN,e.toString())})}terminate(){this.ia=!0,this.connection.terminate()}};let __PRIVATE_OnlineStateTracker=class __PRIVATE_OnlineStateTracker{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){0===this.oa&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){"Online"===this.state?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,"Online"===e&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){let r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(__PRIVATE_logError(r),this.aa=!1):common_341bda9b_esm_PRIVATE_logDebug("OnlineStateTracker",r)}Pa(){null!==this._a&&(this._a.cancel(),this._a=null)}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eJ="RemoteStore";let __PRIVATE_RemoteStoreImpl=class __PRIVATE_RemoteStoreImpl{constructor(e,r,h,d,f){this.localStore=e,this.datastore=r,this.asyncQueue=h,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.Ra=[],this.Aa=f,this.Aa.Mo(e=>{h.enqueueAndForget(async()=>{__PRIVATE_canUseNetwork(this)&&(common_341bda9b_esm_PRIVATE_logDebug(eJ,"Restarting streams for network reachability change."),await async function(e){e.Ea.add(4),await __PRIVATE_disableNetworkInternal(e),e.Va.set("Unknown"),e.Ea.delete(4),await __PRIVATE_enableNetworkInternal(e)}(this))})}),this.Va=new __PRIVATE_OnlineStateTracker(h,d)}};async function __PRIVATE_enableNetworkInternal(e){if(__PRIVATE_canUseNetwork(e))for(let r of e.Ra)await r(!0)}async function __PRIVATE_disableNetworkInternal(e){for(let r of e.Ra)await r(!1)}function __PRIVATE_remoteStoreListen(e,r){e.Ia.has(r.targetId)||(e.Ia.set(r.targetId,r),__PRIVATE_shouldStartWatchStream(e)?__PRIVATE_startWatchStream(e):__PRIVATE_ensureWatchStream(e).O_()&&__PRIVATE_sendWatchRequest(e,r))}function __PRIVATE_remoteStoreUnlisten(e,r){let h=__PRIVATE_ensureWatchStream(e);e.Ia.delete(r),h.O_()&&__PRIVATE_sendUnwatchRequest(e,r),0===e.Ia.size&&(h.O_()?h.L_():__PRIVATE_canUseNetwork(e)&&e.Va.set("Unknown"))}function __PRIVATE_sendWatchRequest(e,r){if(e.da.$e(r.targetId),r.resumeToken.approximateByteSize()>0||r.snapshotVersion.compareTo(SnapshotVersion.min())>0){let h=e.remoteSyncer.getRemoteKeysForTarget(r.targetId).size;r=r.withExpectedCount(h)}__PRIVATE_ensureWatchStream(e).Z_(r)}function __PRIVATE_sendUnwatchRequest(e,r){e.da.$e(r),__PRIVATE_ensureWatchStream(e).X_(r)}function __PRIVATE_startWatchStream(e){e.da=new __PRIVATE_WatchChangeAggregator({getRemoteKeysForTarget:r=>e.remoteSyncer.getRemoteKeysForTarget(r),At:r=>e.Ia.get(r)||null,ht:()=>e.datastore.serializer.databaseId}),__PRIVATE_ensureWatchStream(e).start(),e.Va.ua()}function __PRIVATE_shouldStartWatchStream(e){return __PRIVATE_canUseNetwork(e)&&!__PRIVATE_ensureWatchStream(e).x_()&&e.Ia.size>0}function __PRIVATE_canUseNetwork(e){return 0===e.Ea.size}async function __PRIVATE_onWatchStreamConnected(e){e.Va.set("Online")}async function __PRIVATE_onWatchStreamOpen(e){e.Ia.forEach((r,h)=>{__PRIVATE_sendWatchRequest(e,r)})}async function __PRIVATE_onWatchStreamClose(e,r){e.da=void 0,__PRIVATE_shouldStartWatchStream(e)?(e.Va.ha(r),__PRIVATE_startWatchStream(e)):e.Va.set("Unknown")}async function __PRIVATE_onWatchStreamChange(e,r,h){if(e.Va.set("Online"),r instanceof __PRIVATE_WatchTargetChange&&2===r.state&&r.cause)try{await async function(e,r){let h=r.cause;for(let d of r.targetIds)e.Ia.has(d)&&(await e.remoteSyncer.rejectListen(d,h),e.Ia.delete(d),e.da.removeTarget(d))}(e,r)}catch(h){common_341bda9b_esm_PRIVATE_logDebug(eJ,"Failed to remove targets %s: %s ",r.targetIds.join(","),h),await __PRIVATE_disableNetworkUntilRecovery(e,h)}else if(r instanceof __PRIVATE_DocumentWatchChange?e.da.Xe(r):r instanceof __PRIVATE_ExistenceFilterChange?e.da.st(r):e.da.tt(r),!h.isEqual(SnapshotVersion.min()))try{let r=await __PRIVATE_localStoreGetLastRemoteSnapshotVersion(e.localStore);h.compareTo(r)>=0&&await function(e,r){let h=e.da.Tt(r);return h.targetChanges.forEach((h,d)=>{if(h.resumeToken.approximateByteSize()>0){let f=e.Ia.get(d);f&&e.Ia.set(d,f.withResumeToken(h.resumeToken,r))}}),h.targetMismatches.forEach((r,h)=>{let d=e.Ia.get(r);if(!d)return;e.Ia.set(r,d.withResumeToken(ByteString.EMPTY_BYTE_STRING,d.snapshotVersion)),__PRIVATE_sendUnwatchRequest(e,r);let f=new TargetData(d.target,r,h,d.sequenceNumber);__PRIVATE_sendWatchRequest(e,f)}),e.remoteSyncer.applyRemoteEvent(h)}(e,h)}catch(r){common_341bda9b_esm_PRIVATE_logDebug(eJ,"Failed to raise snapshot:",r),await __PRIVATE_disableNetworkUntilRecovery(e,r)}}async function __PRIVATE_disableNetworkUntilRecovery(e,r,h){if(!__PRIVATE_isIndexedDbTransactionError(r))throw r;e.Ea.add(1),await __PRIVATE_disableNetworkInternal(e),e.Va.set("Offline"),h||(h=()=>__PRIVATE_localStoreGetLastRemoteSnapshotVersion(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{common_341bda9b_esm_PRIVATE_logDebug(eJ,"Retrying IndexedDB access"),await h(),e.Ea.delete(1),await __PRIVATE_enableNetworkInternal(e)})}function __PRIVATE_executeWithRecovery(e,r){return r().catch(h=>__PRIVATE_disableNetworkUntilRecovery(e,h,r))}async function __PRIVATE_fillWritePipeline(e){let r=__PRIVATE_ensureWriteStream(e),h=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:-1;for(;__PRIVATE_canUseNetwork(e)&&e.Ta.length<10;)try{let d=await function(e,r){return e.persistence.runTransaction("Get next mutation batch","readonly",h=>(void 0===r&&(r=-1),e.mutationQueue.getNextMutationBatchAfterBatchId(h,r)))}(e.localStore,h);if(null===d){0===e.Ta.length&&r.L_();break}h=d.batchId,function(e,r){e.Ta.push(r);let h=__PRIVATE_ensureWriteStream(e);h.O_()&&h.Y_&&h.ea(r.mutations)}(e,d)}catch(r){await __PRIVATE_disableNetworkUntilRecovery(e,r)}__PRIVATE_shouldStartWriteStream(e)&&__PRIVATE_startWriteStream(e)}function __PRIVATE_shouldStartWriteStream(e){return __PRIVATE_canUseNetwork(e)&&!__PRIVATE_ensureWriteStream(e).x_()&&e.Ta.length>0}function __PRIVATE_startWriteStream(e){__PRIVATE_ensureWriteStream(e).start()}async function __PRIVATE_onWriteStreamOpen(e){__PRIVATE_ensureWriteStream(e).ra()}async function __PRIVATE_onWriteHandshakeComplete(e){let r=__PRIVATE_ensureWriteStream(e);for(let h of e.Ta)r.ea(h.mutations)}async function __PRIVATE_onMutationResult(e,r,h){let d=e.Ta.shift(),f=MutationBatchResult.from(d,r,h);await __PRIVATE_executeWithRecovery(e,()=>e.remoteSyncer.applySuccessfulWrite(f)),await __PRIVATE_fillWritePipeline(e)}async function __PRIVATE_onWriteStreamClose(e,r){r&&__PRIVATE_ensureWriteStream(e).Y_&&await async function(e,r){var h;if(function(e){switch(e){case eg.OK:return common_341bda9b_esm_fail(64938);case eg.CANCELLED:case eg.UNKNOWN:case eg.DEADLINE_EXCEEDED:case eg.RESOURCE_EXHAUSTED:case eg.INTERNAL:case eg.UNAVAILABLE:case eg.UNAUTHENTICATED:return!1;case eg.INVALID_ARGUMENT:case eg.NOT_FOUND:case eg.ALREADY_EXISTS:case eg.PERMISSION_DENIED:case eg.FAILED_PRECONDITION:case eg.ABORTED:case eg.OUT_OF_RANGE:case eg.UNIMPLEMENTED:case eg.DATA_LOSS:return!0;default:return common_341bda9b_esm_fail(15467,{code:e})}}(h=r.code)&&h!==eg.ABORTED){let h=e.Ta.shift();__PRIVATE_ensureWriteStream(e).B_(),await __PRIVATE_executeWithRecovery(e,()=>e.remoteSyncer.rejectFailedWrite(h.batchId,r)),await __PRIVATE_fillWritePipeline(e)}}(e,r),__PRIVATE_shouldStartWriteStream(e)&&__PRIVATE_startWriteStream(e)}async function __PRIVATE_remoteStoreHandleCredentialChange(e,r){e.asyncQueue.verifyOperationInProgress(),common_341bda9b_esm_PRIVATE_logDebug(eJ,"RemoteStore received new credentials");let h=__PRIVATE_canUseNetwork(e);e.Ea.add(3),await __PRIVATE_disableNetworkInternal(e),h&&e.Va.set("Unknown"),await e.remoteSyncer.handleCredentialChange(r),e.Ea.delete(3),await __PRIVATE_enableNetworkInternal(e)}async function __PRIVATE_remoteStoreApplyPrimaryState(e,r){r?(e.Ea.delete(2),await __PRIVATE_enableNetworkInternal(e)):r||(e.Ea.add(2),await __PRIVATE_disableNetworkInternal(e),e.Va.set("Unknown"))}function __PRIVATE_ensureWatchStream(e){var r,h,d;return e.ma||(e.ma=(r=e.datastore,h=e.asyncQueue,d={Zo:__PRIVATE_onWatchStreamConnected.bind(null,e),Yo:__PRIVATE_onWatchStreamOpen.bind(null,e),t_:__PRIVATE_onWatchStreamClose.bind(null,e),J_:__PRIVATE_onWatchStreamChange.bind(null,e)},r.sa(),new __PRIVATE_PersistentListenStream(h,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,d)),e.Ra.push(async r=>{r?(e.ma.B_(),__PRIVATE_shouldStartWatchStream(e)?__PRIVATE_startWatchStream(e):e.Va.set("Unknown")):(await e.ma.stop(),e.da=void 0)})),e.ma}function __PRIVATE_ensureWriteStream(e){var r,h,d;return e.fa||(e.fa=(r=e.datastore,h=e.asyncQueue,d={Zo:()=>Promise.resolve(),Yo:__PRIVATE_onWriteStreamOpen.bind(null,e),t_:__PRIVATE_onWriteStreamClose.bind(null,e),ta:__PRIVATE_onWriteHandshakeComplete.bind(null,e),na:__PRIVATE_onMutationResult.bind(null,e)},r.sa(),new __PRIVATE_PersistentWriteStream(h,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,d)),e.Ra.push(async r=>{r?(e.fa.B_(),await __PRIVATE_fillWritePipeline(e)):(await e.fa.stop(),e.Ta.length>0&&(common_341bda9b_esm_PRIVATE_logDebug(eJ,`Stopping write stream with ${e.Ta.length} pending writes`),e.Ta=[]))})),e.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let DelayedOperation=class DelayedOperation{constructor(e,r,h,d,f){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=h,this.op=d,this.removalCallback=f,this.deferred=new __PRIVATE_Deferred,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,h,d,f){let g=Date.now()+h,b=new DelayedOperation(e,r,g,d,f);return b.start(h),b}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new common_341bda9b_esm_FirestoreError(eg.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function __PRIVATE_wrapInUserErrorIfRecoverable(e,r){if(__PRIVATE_logError("AsyncQueue",`${r}: ${e}`),__PRIVATE_isIndexedDbTransactionError(e))return new common_341bda9b_esm_FirestoreError(eg.UNAVAILABLE,`${r}: ${e}`);throw e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let common_341bda9b_esm_DocumentSet=class common_341bda9b_esm_DocumentSet{static emptySet(e){return new common_341bda9b_esm_DocumentSet(e.comparator)}constructor(e){this.comparator=e?(r,h)=>e(r,h)||common_341bda9b_esm_DocumentKey.comparator(r.key,h.key):(e,r)=>common_341bda9b_esm_DocumentKey.comparator(e.key,r.key),this.keyedMap=documentMap(),this.sortedSet=new SortedMap(this.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,h)=>(e(r),!1))}add(e){let r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){let r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof common_341bda9b_esm_DocumentSet)||this.size!==e.size)return!1;let r=this.sortedSet.getIterator(),h=e.sortedSet.getIterator();for(;r.hasNext();){let e=r.getNext().key,d=h.getNext().key;if(!e.isEqual(d))return!1}return!0}toString(){let e=[];return this.forEach(r=>{e.push(r.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,r){let h=new common_341bda9b_esm_DocumentSet;return h.comparator=this.comparator,h.keyedMap=e,h.sortedSet=r,h}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_DocumentChangeSet=class __PRIVATE_DocumentChangeSet{constructor(){this.ga=new SortedMap(common_341bda9b_esm_DocumentKey.comparator)}track(e){let r=e.doc.key,h=this.ga.get(r);h?0!==e.type&&3===h.type?this.ga=this.ga.insert(r,e):3===e.type&&1!==h.type?this.ga=this.ga.insert(r,{type:h.type,doc:e.doc}):2===e.type&&2===h.type?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):2===e.type&&0===h.type?this.ga=this.ga.insert(r,{type:0,doc:e.doc}):1===e.type&&0===h.type?this.ga=this.ga.remove(r):1===e.type&&2===h.type?this.ga=this.ga.insert(r,{type:1,doc:h.doc}):0===e.type&&1===h.type?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):common_341bda9b_esm_fail(63341,{Vt:e,pa:h}):this.ga=this.ga.insert(r,e)}ya(){let e=[];return this.ga.inorderTraversal((r,h)=>{e.push(h)}),e}};let common_341bda9b_esm_ViewSnapshot=class common_341bda9b_esm_ViewSnapshot{constructor(e,r,h,d,f,g,b,A,k){this.query=e,this.docs=r,this.oldDocs=h,this.docChanges=d,this.mutatedKeys=f,this.fromCache=g,this.syncStateChanged=b,this.excludesMetadataChanges=A,this.hasCachedResults=k}static fromInitialDocuments(e,r,h,d,f){let g=[];return r.forEach(e=>{g.push({type:0,doc:e})}),new common_341bda9b_esm_ViewSnapshot(e,r,common_341bda9b_esm_DocumentSet.emptySet(r),g,h,d,!0,!1,f)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&__PRIVATE_queryEquals(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let r=this.docChanges,h=e.docChanges;if(r.length!==h.length)return!1;for(let e=0;e<r.length;e++)if(r[e].type!==h[e].type||!r[e].doc.isEqual(h[e].doc))return!1;return!0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_QueryListenersInfo=class __PRIVATE_QueryListenersInfo{constructor(){this.wa=void 0,this.ba=[]}Sa(){return this.ba.some(e=>e.Da())}};let __PRIVATE_EventManagerImpl=class __PRIVATE_EventManagerImpl{constructor(){this.queries=__PRIVATE_newQueriesObjectMap(),this.onlineState="Unknown",this.Ca=new Set}terminate(){!function(e,r){let h=e.queries;e.queries=__PRIVATE_newQueriesObjectMap(),h.forEach((e,h)=>{for(let e of h.ba)e.onError(r)})}(this,new common_341bda9b_esm_FirestoreError(eg.ABORTED,"Firestore shutting down"))}};function __PRIVATE_newQueriesObjectMap(){return new ObjectMap(e=>__PRIVATE_canonifyQuery(e),__PRIVATE_queryEquals)}async function __PRIVATE_eventManagerListen(e,r){let h=3,d=r.query,f=e.queries.get(d);f?!f.Sa()&&r.Da()&&(h=2):(f=new __PRIVATE_QueryListenersInfo,h=r.Da()?0:1);try{switch(h){case 0:f.wa=await e.onListen(d,!0);break;case 1:f.wa=await e.onListen(d,!1);break;case 2:await e.onFirstRemoteStoreListen(d)}}catch(h){let e=__PRIVATE_wrapInUserErrorIfRecoverable(h,`Initialization of query '${__PRIVATE_stringifyQuery(r.query)}' failed`);return void r.onError(e)}e.queries.set(d,f),f.ba.push(r),r.va(e.onlineState),f.wa&&r.Fa(f.wa)&&__PRIVATE_raiseSnapshotsInSyncEvent(e)}async function __PRIVATE_eventManagerUnlisten(e,r){let h=r.query,d=3,f=e.queries.get(h);if(f){let e=f.ba.indexOf(r);e>=0&&(f.ba.splice(e,1),0===f.ba.length?d=r.Da()?0:1:!f.Sa()&&r.Da()&&(d=2))}switch(d){case 0:return e.queries.delete(h),e.onUnlisten(h,!0);case 1:return e.queries.delete(h),e.onUnlisten(h,!1);case 2:return e.onLastRemoteStoreUnlisten(h);default:return}}function __PRIVATE_eventManagerOnWatchChange(e,r){let h=!1;for(let d of r){let r=d.query,f=e.queries.get(r);if(f){for(let e of f.ba)e.Fa(d)&&(h=!0);f.wa=d}}h&&__PRIVATE_raiseSnapshotsInSyncEvent(e)}function __PRIVATE_eventManagerOnWatchError(e,r,h){let d=e.queries.get(r);if(d)for(let e of d.ba)e.onError(h);e.queries.delete(r)}function __PRIVATE_raiseSnapshotsInSyncEvent(e){e.Ca.forEach(e=>{e.next()})}(ei=en||(en={})).Ma="default",ei.Cache="cache";let __PRIVATE_QueryListener=class __PRIVATE_QueryListener{constructor(e,r,h){this.query=e,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=h||{}}Fa(e){if(!this.options.includeMetadataChanges){let r=[];for(let h of e.docChanges)3!==h.type&&r.push(h);e=new common_341bda9b_esm_ViewSnapshot(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),r=!0):this.La(e,this.onlineState)&&(this.ka(e),r=!0),this.Na=e,r}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),r=!0),r}La(e,r){return!(e.fromCache&&this.Da())||(!this.options.Ka||!("Offline"!==r))&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===r)}Ba(e){if(e.docChanges.length>0)return!0;let r=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&!0===this.options.includeMetadataChanges}ka(e){e=common_341bda9b_esm_ViewSnapshot.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==en.Cache}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_AddedLimboDocument=class __PRIVATE_AddedLimboDocument{constructor(e){this.key=e}};let __PRIVATE_RemovedLimboDocument=class __PRIVATE_RemovedLimboDocument{constructor(e){this.key=e}};let __PRIVATE_View=class __PRIVATE_View{constructor(e,r){this.query=e,this.Za=r,this.Xa=null,this.hasCachedResults=!1,this.current=!1,this.Ya=common_341bda9b_esm_PRIVATE_documentKeySet(),this.mutatedKeys=common_341bda9b_esm_PRIVATE_documentKeySet(),this.eu=__PRIVATE_newQueryComparator(e),this.tu=new common_341bda9b_esm_DocumentSet(this.eu)}get nu(){return this.Za}ru(e,r){let h=r?r.iu:new __PRIVATE_DocumentChangeSet,d=r?r.tu:this.tu,f=r?r.mutatedKeys:this.mutatedKeys,g=d,b=!1,A="F"===this.query.limitType&&d.size===this.query.limit?d.last():null,k="L"===this.query.limitType&&d.size===this.query.limit?d.first():null;if(e.inorderTraversal((e,r)=>{let M=d.get(e),j=__PRIVATE_queryMatches(this.query,r)?r:null,q=!!M&&this.mutatedKeys.has(M.key),ee=!!j&&(j.hasLocalMutations||this.mutatedKeys.has(j.key)&&j.hasCommittedMutations),et=!1;M&&j?M.data.isEqual(j.data)?q!==ee&&(h.track({type:3,doc:j}),et=!0):this.su(M,j)||(h.track({type:2,doc:j}),et=!0,(A&&this.eu(j,A)>0||k&&0>this.eu(j,k))&&(b=!0)):!M&&j?(h.track({type:0,doc:j}),et=!0):M&&!j&&(h.track({type:1,doc:M}),et=!0,(A||k)&&(b=!0)),et&&(j?(g=g.add(j),f=ee?f.add(e):f.delete(e)):(g=g.delete(e),f=f.delete(e)))}),null!==this.query.limit)for(;g.size>this.query.limit;){let e="F"===this.query.limitType?g.last():g.first();g=g.delete(e.key),f=f.delete(e.key),h.track({type:1,doc:e})}return{tu:g,iu:h,Ss:b,mutatedKeys:f}}su(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,h,d){let f=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;let g=e.iu.ya();g.sort((e,r)=>(function(e,r){let order=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return common_341bda9b_esm_fail(20277,{Vt:e})}};return order(e)-order(r)})(e.type,r.type)||this.eu(e.doc,r.doc)),this.ou(h),d=d??!1;let b=r&&!d?this._u():[],A=0===this.Ya.size&&this.current&&!d?1:0,k=A!==this.Xa;return(this.Xa=A,0!==g.length||k)?{snapshot:new common_341bda9b_esm_ViewSnapshot(this.query,e.tu,f,g,e.mutatedKeys,0===A,k,!1,!!h&&h.resumeToken.approximateByteSize()>0),au:b}:{au:b}}va(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({tu:this.tu,iu:new __PRIVATE_DocumentChangeSet,mutatedKeys:this.mutatedKeys,Ss:!1},!1)):{au:[]}}uu(e){return!this.Za.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(e=>this.Za=this.Za.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.Za=this.Za.delete(e)),this.current=e.current)}_u(){if(!this.current)return[];let e=this.Ya;this.Ya=common_341bda9b_esm_PRIVATE_documentKeySet(),this.tu.forEach(e=>{this.uu(e.key)&&(this.Ya=this.Ya.add(e.key))});let r=[];return e.forEach(e=>{this.Ya.has(e)||r.push(new __PRIVATE_RemovedLimboDocument(e))}),this.Ya.forEach(h=>{e.has(h)||r.push(new __PRIVATE_AddedLimboDocument(h))}),r}cu(e){this.Za=e.ks,this.Ya=common_341bda9b_esm_PRIVATE_documentKeySet();let r=this.ru(e.documents);return this.applyChanges(r,!0)}lu(){return common_341bda9b_esm_ViewSnapshot.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,0===this.Xa,this.hasCachedResults)}};let eX="SyncEngine";let __PRIVATE_QueryView=class __PRIVATE_QueryView{constructor(e,r,h){this.query=e,this.targetId=r,this.view=h}};let LimboResolution=class LimboResolution{constructor(e){this.key=e,this.hu=!1}};let __PRIVATE_SyncEngineImpl=class __PRIVATE_SyncEngineImpl{constructor(e,r,h,d,f,g){this.localStore=e,this.remoteStore=r,this.eventManager=h,this.sharedClientState=d,this.currentUser=f,this.maxConcurrentLimboResolutions=g,this.Pu={},this.Tu=new ObjectMap(e=>__PRIVATE_canonifyQuery(e),__PRIVATE_queryEquals),this.Iu=new Map,this.Eu=new Set,this.Ru=new SortedMap(common_341bda9b_esm_DocumentKey.comparator),this.Au=new Map,this.Vu=new __PRIVATE_ReferenceSet,this.du={},this.mu=new Map,this.fu=__PRIVATE_TargetIdGenerator.ar(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return!0===this.gu}};async function __PRIVATE_syncEngineListen(e,r,h=!0){let d;let f=__PRIVATE_ensureWatchCallbacks(e),g=f.Tu.get(r);return g?(f.sharedClientState.addLocalQueryTarget(g.targetId),d=g.view.lu()):d=await __PRIVATE_allocateTargetAndMaybeListen(f,r,h,!0),d}async function __PRIVATE_triggerRemoteStoreListen(e,r){let h=__PRIVATE_ensureWatchCallbacks(e);await __PRIVATE_allocateTargetAndMaybeListen(h,r,!0,!1)}async function __PRIVATE_allocateTargetAndMaybeListen(e,r,h,d){var f,g;let b;let A=await (f=e.localStore,g=__PRIVATE_queryToTarget(r),f.persistence.runTransaction("Allocate target","readwrite",e=>{let r;return f.li.getTargetData(e,g).next(h=>h?(r=h,PersistencePromise.resolve(r)):f.li.allocateTargetId(e).next(h=>(r=new TargetData(g,h,"TargetPurposeListen",e.currentSequenceNumber),f.li.addTargetData(e,r).next(()=>r))))}).then(e=>{let r=f.vs.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(f.vs=f.vs.insert(e.targetId,e),f.Fs.set(g,e.targetId)),e})),k=A.targetId,M=e.sharedClientState.addLocalQueryTarget(k,h);return d&&(b=await __PRIVATE_initializeViewAndComputeSnapshot(e,r,k,"current"===M,A.resumeToken)),e.isPrimaryClient&&h&&__PRIVATE_remoteStoreListen(e.remoteStore,A),b}async function __PRIVATE_initializeViewAndComputeSnapshot(e,r,h,d,f){e.pu=(r,h,d)=>(async function(e,r,h,d){let f=r.view.ru(h);f.Ss&&(f=await __PRIVATE_localStoreExecuteQuery(e.localStore,r.query,!1).then(({documents:e})=>r.view.ru(e,f)));let g=d&&d.targetChanges.get(r.targetId),b=d&&null!=d.targetMismatches.get(r.targetId),A=r.view.applyChanges(f,e.isPrimaryClient,g,b);return __PRIVATE_updateTrackedLimbos(e,r.targetId,A.au),A.snapshot})(e,r,h,d);let g=await __PRIVATE_localStoreExecuteQuery(e.localStore,r,!0),b=new __PRIVATE_View(r,g.ks),A=b.ru(g.documents),k=TargetChange.createSynthesizedTargetChangeForCurrentChange(h,d&&"Offline"!==e.onlineState,f),M=b.applyChanges(A,e.isPrimaryClient,k);__PRIVATE_updateTrackedLimbos(e,h,M.au);let j=new __PRIVATE_QueryView(r,h,b);return e.Tu.set(r,j),e.Iu.has(h)?e.Iu.get(h).push(r):e.Iu.set(h,[r]),M.snapshot}async function __PRIVATE_syncEngineUnlisten(e,r,h){let d=e.Tu.get(r),f=e.Iu.get(d.targetId);if(f.length>1)return e.Iu.set(d.targetId,f.filter(e=>!__PRIVATE_queryEquals(e,r))),void e.Tu.delete(r);e.isPrimaryClient?(e.sharedClientState.removeLocalQueryTarget(d.targetId),e.sharedClientState.isActiveQueryTarget(d.targetId)||await __PRIVATE_localStoreReleaseTarget(e.localStore,d.targetId,!1).then(()=>{e.sharedClientState.clearQueryState(d.targetId),h&&__PRIVATE_remoteStoreUnlisten(e.remoteStore,d.targetId),__PRIVATE_removeAndCleanupTarget(e,d.targetId)}).catch(__PRIVATE_ignoreIfPrimaryLeaseLoss)):(__PRIVATE_removeAndCleanupTarget(e,d.targetId),await __PRIVATE_localStoreReleaseTarget(e.localStore,d.targetId,!0))}async function __PRIVATE_triggerRemoteStoreUnlisten(e,r){let h=e.Tu.get(r),d=e.Iu.get(h.targetId);e.isPrimaryClient&&1===d.length&&(e.sharedClientState.removeLocalQueryTarget(h.targetId),__PRIVATE_remoteStoreUnlisten(e.remoteStore,h.targetId))}async function __PRIVATE_syncEngineWrite(e,r,h){var d;let f=(e.remoteStore.remoteSyncer.applySuccessfulWrite=__PRIVATE_syncEngineApplySuccessfulWrite.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=__PRIVATE_syncEngineRejectFailedWrite.bind(null,e),e);try{let e;let g=await function(e,r){let h,d;let f=Timestamp.now(),g=r.reduce((e,r)=>e.add(r.key),common_341bda9b_esm_PRIVATE_documentKeySet());return e.persistence.runTransaction("Locally write mutations","readwrite",b=>{let A=ek,k=common_341bda9b_esm_PRIVATE_documentKeySet();return e.xs.getEntries(b,g).next(e=>{(A=e).forEach((e,r)=>{r.isValidDocument()||(k=k.add(e))})}).next(()=>e.localDocuments.getOverlayedDocuments(b,A)).next(d=>{h=d;let g=[];for(let e of r){let r=function(e,r){let h=null;for(let d of e.fieldTransforms){let e=r.data.field(d.field),f=__PRIVATE_computeTransformOperationBaseValue(d.transform,e||null);null!=f&&(null===h&&(h=common_341bda9b_esm_ObjectValue.empty()),h.set(d.field,f))}return h||null}(e,h.get(e.key).overlayedDocument);null!=r&&g.push(new __PRIVATE_PatchMutation(e.key,r,function __PRIVATE_extractFieldMask(e){let r=[];return forEach(e.fields,(e,h)=>{let d=new FieldPath$1([e]);if(__PRIVATE_isMapValue(h)){let e=__PRIVATE_extractFieldMask(h.mapValue).fields;if(0===e.length)r.push(d);else for(let h of e)r.push(d.child(h))}else r.push(d)}),new FieldMask(r)}(r.value.mapValue),common_341bda9b_esm_Precondition.exists(!0)))}return e.mutationQueue.addMutationBatch(b,f,g,r)}).next(r=>{d=r;let f=r.applyToLocalDocumentSet(h,k);return e.documentOverlayCache.saveOverlays(b,r.batchId,f)})}).then(()=>({batchId:d.batchId,changes:__PRIVATE_convertOverlayedDocumentMapToDocumentMap(h)}))}(f.localStore,r);f.sharedClientState.addPendingMutation(g.batchId),d=g.batchId,(e=f.du[f.currentUser.toKey()])||(e=new SortedMap(__PRIVATE_primitiveComparator)),e=e.insert(d,h),f.du[f.currentUser.toKey()]=e,await __PRIVATE_syncEngineEmitNewSnapsAndNotifyLocalStore(f,g.changes),await __PRIVATE_fillWritePipeline(f.remoteStore)}catch(r){let e=__PRIVATE_wrapInUserErrorIfRecoverable(r,"Failed to persist write");h.reject(e)}}async function __PRIVATE_syncEngineApplyRemoteEvent(e,r){try{let h=await function(e,r){let h=r.snapshotVersion,d=e.vs;return e.persistence.runTransaction("Apply remote event","readwrite-primary",f=>{var g;let b,A;let k=e.xs.newChangeBuffer({trackRemovals:!0});d=e.vs;let M=[];r.targetChanges.forEach((g,b)=>{let A=d.get(b);if(!A)return;M.push(e.li.removeMatchingKeys(f,g.removedDocuments,b).next(()=>e.li.addMatchingKeys(f,g.addedDocuments,b)));let k=A.withSequenceNumber(f.currentSequenceNumber);null!==r.targetMismatches.get(b)?k=k.withResumeToken(ByteString.EMPTY_BYTE_STRING,SnapshotVersion.min()).withLastLimboFreeSnapshotVersion(SnapshotVersion.min()):g.resumeToken.approximateByteSize()>0&&(k=k.withResumeToken(g.resumeToken,h)),d=d.insert(b,k),function(e,r,h){if(0===e.resumeToken.approximateByteSize())return!0;let d=r.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds();if(d>=3e8)return!0;let f=h.addedDocuments.size+h.modifiedDocuments.size+h.removedDocuments.size;return f>0}(A,k,g)&&M.push(e.li.updateTargetData(f,k))});let j=ek,q=common_341bda9b_esm_PRIVATE_documentKeySet();if(r.documentUpdates.forEach(h=>{r.resolvedLimboDocuments.has(h)&&M.push(e.persistence.referenceDelegate.updateLimboDocument(f,h))}),M.push((g=r.documentUpdates,b=common_341bda9b_esm_PRIVATE_documentKeySet(),A=common_341bda9b_esm_PRIVATE_documentKeySet(),g.forEach(e=>b=b.add(e)),k.getEntries(f,b).next(e=>{let r=ek;return g.forEach((h,d)=>{let f=e.get(h);d.isFoundDocument()!==f.isFoundDocument()&&(A=A.add(h)),d.isNoDocument()&&d.version.isEqual(SnapshotVersion.min())?(k.removeEntry(h,d.readTime),r=r.insert(h,d)):!f.isValidDocument()||d.version.compareTo(f.version)>0||0===d.version.compareTo(f.version)&&f.hasPendingWrites?(k.addEntry(d),r=r.insert(h,d)):common_341bda9b_esm_PRIVATE_logDebug(ez,"Ignoring outdated watch update for ",h,". Current version:",f.version," Watch version:",d.version)}),{Bs:r,Ls:A}})).next(e=>{j=e.Bs,q=e.Ls})),!h.isEqual(SnapshotVersion.min())){let r=e.li.getLastRemoteSnapshotVersion(f).next(r=>e.li.setTargetsMetadata(f,f.currentSequenceNumber,h));M.push(r)}return PersistencePromise.waitFor(M).next(()=>k.apply(f)).next(()=>e.localDocuments.getLocalViewOfDocuments(f,j,q)).next(()=>j)}).then(r=>(e.vs=d,r))}(e.localStore,r);r.targetChanges.forEach((r,h)=>{let d=e.Au.get(h);d&&(__PRIVATE_hardAssert(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1,22616),r.addedDocuments.size>0?d.hu=!0:r.modifiedDocuments.size>0?__PRIVATE_hardAssert(d.hu,14607):r.removedDocuments.size>0&&(__PRIVATE_hardAssert(d.hu,42227),d.hu=!1))}),await __PRIVATE_syncEngineEmitNewSnapsAndNotifyLocalStore(e,h,r)}catch(e){await __PRIVATE_ignoreIfPrimaryLeaseLoss(e)}}function __PRIVATE_syncEngineApplyOnlineStateChange(e,r,h){var d;if(e.isPrimaryClient&&0===h||!e.isPrimaryClient&&1===h){let h;let f=[];e.Tu.forEach((e,h)=>{let d=h.view.va(r);d.snapshot&&f.push(d.snapshot)}),(d=e.eventManager).onlineState=r,h=!1,d.queries.forEach((e,d)=>{for(let e of d.ba)e.va(r)&&(h=!0)}),h&&__PRIVATE_raiseSnapshotsInSyncEvent(d),f.length&&e.Pu.J_(f),e.onlineState=r,e.isPrimaryClient&&e.sharedClientState.setOnlineState(r)}}async function __PRIVATE_syncEngineRejectListen(e,r,h){e.sharedClientState.updateQueryState(r,"rejected",h);let d=e.Au.get(r),f=d&&d.key;if(f){let h=new SortedMap(common_341bda9b_esm_DocumentKey.comparator);h=h.insert(f,MutableDocument.newNoDocument(f,SnapshotVersion.min()));let d=common_341bda9b_esm_PRIVATE_documentKeySet().add(f),g=new RemoteEvent(SnapshotVersion.min(),new Map,new SortedMap(__PRIVATE_primitiveComparator),h,d);await __PRIVATE_syncEngineApplyRemoteEvent(e,g),e.Ru=e.Ru.remove(f),e.Au.delete(r),__PRIVATE_pumpEnqueuedLimboResolutions(e)}else await __PRIVATE_localStoreReleaseTarget(e.localStore,r,!1).then(()=>__PRIVATE_removeAndCleanupTarget(e,r,h)).catch(__PRIVATE_ignoreIfPrimaryLeaseLoss)}async function __PRIVATE_syncEngineApplySuccessfulWrite(e,r){var h;let d=r.batch.batchId;try{let f=await (h=e.localStore).persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{let d=r.batch.keys(),f=h.xs.newChangeBuffer({trackRemovals:!0});return(function(e,r,h,d){let f=h.batch,g=f.keys(),b=PersistencePromise.resolve();return g.forEach(e=>{b=b.next(()=>d.getEntry(r,e)).next(r=>{let g=h.docVersions.get(e);__PRIVATE_hardAssert(null!==g,48541),0>r.version.compareTo(g)&&(f.applyToRemoteDocument(r,h),r.isValidDocument()&&(r.setReadTime(h.commitVersion),d.addEntry(r)))})}),b.next(()=>e.mutationQueue.removeMutationBatch(r,f))})(h,e,r,f).next(()=>f.apply(e)).next(()=>h.mutationQueue.performConsistencyCheck(e)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(e,d,r.batch.batchId)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let r=common_341bda9b_esm_PRIVATE_documentKeySet();for(let h=0;h<e.mutationResults.length;++h)e.mutationResults[h].transformResults.length>0&&(r=r.add(e.batch.mutations[h].key));return r}(r))).next(()=>h.localDocuments.getDocuments(e,d))});__PRIVATE_processUserCallback(e,d,null),__PRIVATE_triggerPendingWritesCallbacks(e,d),e.sharedClientState.updateMutationState(d,"acknowledged"),await __PRIVATE_syncEngineEmitNewSnapsAndNotifyLocalStore(e,f)}catch(e){await __PRIVATE_ignoreIfPrimaryLeaseLoss(e)}}async function __PRIVATE_syncEngineRejectFailedWrite(e,r,h){var d;try{let f=await (d=e.localStore).persistence.runTransaction("Reject batch","readwrite-primary",e=>{let h;return d.mutationQueue.lookupMutationBatch(e,r).next(r=>(__PRIVATE_hardAssert(null!==r,37113),h=r.keys(),d.mutationQueue.removeMutationBatch(e,r))).next(()=>d.mutationQueue.performConsistencyCheck(e)).next(()=>d.documentOverlayCache.removeOverlaysForBatchId(e,h,r)).next(()=>d.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,h)).next(()=>d.localDocuments.getDocuments(e,h))});__PRIVATE_processUserCallback(e,r,h),__PRIVATE_triggerPendingWritesCallbacks(e,r),e.sharedClientState.updateMutationState(r,"rejected",h),await __PRIVATE_syncEngineEmitNewSnapsAndNotifyLocalStore(e,f)}catch(e){await __PRIVATE_ignoreIfPrimaryLeaseLoss(e)}}function __PRIVATE_triggerPendingWritesCallbacks(e,r){(e.mu.get(r)||[]).forEach(e=>{e.resolve()}),e.mu.delete(r)}function __PRIVATE_processUserCallback(e,r,h){let d=e.du[e.currentUser.toKey()];if(d){let f=d.get(r);f&&(h?f.reject(h):f.resolve(),d=d.remove(r)),e.du[e.currentUser.toKey()]=d}}function __PRIVATE_removeAndCleanupTarget(e,r,h=null){for(let d of(e.sharedClientState.removeLocalQueryTarget(r),e.Iu.get(r)))e.Tu.delete(d),h&&e.Pu.yu(d,h);e.Iu.delete(r),e.isPrimaryClient&&e.Vu.Gr(r).forEach(r=>{e.Vu.containsKey(r)||__PRIVATE_removeLimboTarget(e,r)})}function __PRIVATE_removeLimboTarget(e,r){e.Eu.delete(r.path.canonicalString());let h=e.Ru.get(r);null!==h&&(__PRIVATE_remoteStoreUnlisten(e.remoteStore,h),e.Ru=e.Ru.remove(r),e.Au.delete(h),__PRIVATE_pumpEnqueuedLimboResolutions(e))}function __PRIVATE_updateTrackedLimbos(e,r,h){for(let d of h)d instanceof __PRIVATE_AddedLimboDocument?(e.Vu.addReference(d.key,r),function(e,r){let h=r.key,d=h.path.canonicalString();e.Ru.get(h)||e.Eu.has(d)||(common_341bda9b_esm_PRIVATE_logDebug(eX,"New document in limbo: "+h),e.Eu.add(d),__PRIVATE_pumpEnqueuedLimboResolutions(e))}(e,d)):d instanceof __PRIVATE_RemovedLimboDocument?(common_341bda9b_esm_PRIVATE_logDebug(eX,"Document no longer in limbo: "+d.key),e.Vu.removeReference(d.key,r),e.Vu.containsKey(d.key)||__PRIVATE_removeLimboTarget(e,d.key)):common_341bda9b_esm_fail(19791,{wu:d})}function __PRIVATE_pumpEnqueuedLimboResolutions(e){for(;e.Eu.size>0&&e.Ru.size<e.maxConcurrentLimboResolutions;){var r;let h=e.Eu.values().next().value;e.Eu.delete(h);let d=new common_341bda9b_esm_DocumentKey(common_341bda9b_esm_ResourcePath.fromString(h)),f=e.fu.next();e.Au.set(f,new LimboResolution(d)),e.Ru=e.Ru.insert(d,f),__PRIVATE_remoteStoreListen(e.remoteStore,new TargetData(__PRIVATE_queryToTarget((r=d.path,new __PRIVATE_QueryImpl(r))),f,"TargetPurposeLimboResolution",__PRIVATE_ListenSequence.ce))}}async function __PRIVATE_syncEngineEmitNewSnapsAndNotifyLocalStore(e,r,h){let d=[],f=[],g=[];e.Tu.isEmpty()||(e.Tu.forEach((b,A)=>{g.push(e.pu(A,r,h).then(r=>{if((r||h)&&e.isPrimaryClient){let d=r?!r.fromCache:h?.targetChanges.get(A.targetId)?.current;e.sharedClientState.updateQueryState(A.targetId,d?"current":"not-current")}if(r){d.push(r);let e=__PRIVATE_LocalViewChanges.Es(A.targetId,r);f.push(e)}}))}),await Promise.all(g),e.Pu.J_(d),await async function(e,r){try{await e.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>PersistencePromise.forEach(r,r=>PersistencePromise.forEach(r.Ts,d=>e.persistence.referenceDelegate.addReference(h,r.targetId,d)).next(()=>PersistencePromise.forEach(r.Is,d=>e.persistence.referenceDelegate.removeReference(h,r.targetId,d)))))}catch(e){if(!__PRIVATE_isIndexedDbTransactionError(e))throw e;common_341bda9b_esm_PRIVATE_logDebug(ez,"Failed to update sequence numbers: "+e)}for(let h of r){let r=h.targetId;if(!h.fromCache){let h=e.vs.get(r),d=h.snapshotVersion,f=h.withLastLimboFreeSnapshotVersion(d);e.vs=e.vs.insert(r,f)}}}(e.localStore,f))}async function __PRIVATE_syncEngineHandleCredentialChange(e,r){if(!e.currentUser.isEqual(r)){common_341bda9b_esm_PRIVATE_logDebug(eX,"User change. New user:",r.toKey());let h=await __PRIVATE_localStoreHandleUserChange(e.localStore,r);e.currentUser=r,e.mu.forEach(e=>{e.forEach(e=>{e.reject(new common_341bda9b_esm_FirestoreError(eg.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.mu.clear(),e.sharedClientState.handleUserChange(r,h.removedBatchIds,h.addedBatchIds),await __PRIVATE_syncEngineEmitNewSnapsAndNotifyLocalStore(e,h.Ns)}}function __PRIVATE_syncEngineGetRemoteKeysForTarget(e,r){let h=e.Au.get(r);if(h&&h.hu)return common_341bda9b_esm_PRIVATE_documentKeySet().add(h.key);{let h=common_341bda9b_esm_PRIVATE_documentKeySet(),d=e.Iu.get(r);if(!d)return h;for(let r of d){let d=e.Tu.get(r);h=h.unionWith(d.view.nu)}return h}}function __PRIVATE_ensureWatchCallbacks(e){return e.remoteStore.remoteSyncer.applyRemoteEvent=__PRIVATE_syncEngineApplyRemoteEvent.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=__PRIVATE_syncEngineGetRemoteKeysForTarget.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=__PRIVATE_syncEngineRejectListen.bind(null,e),e.Pu.J_=__PRIVATE_eventManagerOnWatchChange.bind(null,e.eventManager),e.Pu.yu=__PRIVATE_eventManagerOnWatchError.bind(null,e.eventManager),e}let common_341bda9b_esm_PRIVATE_MemoryOfflineComponentProvider=class common_341bda9b_esm_PRIVATE_MemoryOfflineComponentProvider{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=common_341bda9b_esm_PRIVATE_newSerializer(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,r){return null}Mu(e,r){return null}vu(e){var r,h,d,f;return r=this.persistence,h=new __PRIVATE_QueryEngine,d=e.initialUser,f=this.serializer,new __PRIVATE_LocalStoreImpl(r,h,d,f)}Cu(e){return new __PRIVATE_MemoryPersistence(__PRIVATE_MemoryEagerDelegate.Vi,this.serializer)}Du(e){return new __PRIVATE_MemorySharedClientState}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}};common_341bda9b_esm_PRIVATE_MemoryOfflineComponentProvider.provider={build:()=>new common_341bda9b_esm_PRIVATE_MemoryOfflineComponentProvider};let common_341bda9b_esm_PRIVATE_LruGcMemoryOfflineComponentProvider=class common_341bda9b_esm_PRIVATE_LruGcMemoryOfflineComponentProvider extends common_341bda9b_esm_PRIVATE_MemoryOfflineComponentProvider{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,r){__PRIVATE_hardAssert(this.persistence.referenceDelegate instanceof __PRIVATE_MemoryLruDelegate,46915);let h=this.persistence.referenceDelegate.garbageCollector;return new __PRIVATE_LruScheduler(h,e.asyncQueue,r)}Cu(e){let r=void 0!==this.cacheSizeBytes?LruParams.withCacheSize(this.cacheSizeBytes):LruParams.DEFAULT;return new __PRIVATE_MemoryPersistence(e=>__PRIVATE_MemoryLruDelegate.Vi(e,r),this.serializer)}};let common_341bda9b_esm_OnlineComponentProvider=class common_341bda9b_esm_OnlineComponentProvider{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>__PRIVATE_syncEngineApplyOnlineStateChange(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=__PRIVATE_syncEngineHandleCredentialChange.bind(null,this.syncEngine),await __PRIVATE_remoteStoreApplyPrimaryState(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new __PRIVATE_EventManagerImpl}createDatastore(e){var r,h,d;let f=common_341bda9b_esm_PRIVATE_newSerializer(e.databaseInfo.databaseId),g=(r=e.databaseInfo,new __PRIVATE_WebChannelConnection(r));return h=e.authCredentials,d=e.appCheckCredentials,new __PRIVATE_DatastoreImpl(h,d,g,f)}createRemoteStore(e){var r,h,d,f;return r=this.localStore,h=this.datastore,d=e.asyncQueue,f=__PRIVATE_BrowserConnectivityMonitor.v()?new __PRIVATE_BrowserConnectivityMonitor:new __PRIVATE_NoopConnectivityMonitor,new __PRIVATE_RemoteStoreImpl(r,h,d,e=>__PRIVATE_syncEngineApplyOnlineStateChange(this.syncEngine,e,0),f)}createSyncEngine(e,r){return function(e,r,h,d,f,g,b){let A=new __PRIVATE_SyncEngineImpl(e,r,h,d,f,g);return b&&(A.gu=!0),A}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){await async function(e){common_341bda9b_esm_PRIVATE_logDebug(eJ,"RemoteStore shutting down."),e.Ea.add(5),await __PRIVATE_disableNetworkInternal(e),e.Aa.shutdown(),e.Va.set("Unknown")}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}};common_341bda9b_esm_OnlineComponentProvider.provider={build:()=>new common_341bda9b_esm_OnlineComponentProvider};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let __PRIVATE_AsyncObserver=class __PRIVATE_AsyncObserver{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):__PRIVATE_logError("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,r){setTimeout(()=>{this.muted||e(r)},0)}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eY="FirestoreClient";let FirestoreClient=class FirestoreClient{constructor(e,r,h,d,f){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=h,this._databaseInfo=d,this.user=User.UNAUTHENTICATED,this.clientId=__PRIVATE_AutoId.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=f,this.authCredentials.start(h,async e=>{common_341bda9b_esm_PRIVATE_logDebug(eY,"Received user=",e.uid),await this.authCredentialListener(e),this.user=e}),this.appCheckCredentials.start(h,e=>(common_341bda9b_esm_PRIVATE_logDebug(eY,"Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this._databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new __PRIVATE_Deferred;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(h){let r=__PRIVATE_wrapInUserErrorIfRecoverable(h,"Failed to shutdown persistence");e.reject(r)}}),e.promise}};async function __PRIVATE_setOfflineComponentProvider(e,r){e.asyncQueue.verifyOperationInProgress(),common_341bda9b_esm_PRIVATE_logDebug(eY,"Initializing OfflineComponentProvider");let h=e.configuration;await r.initialize(h);let d=h.initialUser;e.setCredentialChangeListener(async e=>{d.isEqual(e)||(await __PRIVATE_localStoreHandleUserChange(r.localStore,e),d=e)}),r.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=r}async function __PRIVATE_setOnlineComponentProvider(e,r){e.asyncQueue.verifyOperationInProgress();let h=await __PRIVATE_ensureOfflineComponents(e);common_341bda9b_esm_PRIVATE_logDebug(eY,"Initializing OnlineComponentProvider"),await r.initialize(h,e.configuration),e.setCredentialChangeListener(e=>__PRIVATE_remoteStoreHandleCredentialChange(r.remoteStore,e)),e.setAppCheckTokenChangeListener((e,h)=>__PRIVATE_remoteStoreHandleCredentialChange(r.remoteStore,h)),e._onlineComponents=r}async function __PRIVATE_ensureOfflineComponents(e){if(!e._offlineComponents){if(e._uninitializedComponentsProvider){common_341bda9b_esm_PRIVATE_logDebug(eY,"Using user provided OfflineComponentProvider");try{await __PRIVATE_setOfflineComponentProvider(e,e._uninitializedComponentsProvider._offline)}catch(r){if(!("FirebaseError"===r.name?r.code===eg.FAILED_PRECONDITION||r.code===eg.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&r instanceof DOMException)||22===r.code||20===r.code||11===r.code))throw r;common_341bda9b_esm_PRIVATE_logWarn("Error using user provided cache. Falling back to memory cache: "+r),await __PRIVATE_setOfflineComponentProvider(e,new common_341bda9b_esm_PRIVATE_MemoryOfflineComponentProvider)}}else common_341bda9b_esm_PRIVATE_logDebug(eY,"Using default OfflineComponentProvider"),await __PRIVATE_setOfflineComponentProvider(e,new common_341bda9b_esm_PRIVATE_LruGcMemoryOfflineComponentProvider(void 0))}return e._offlineComponents}async function __PRIVATE_ensureOnlineComponents(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(common_341bda9b_esm_PRIVATE_logDebug(eY,"Using user provided OnlineComponentProvider"),await __PRIVATE_setOnlineComponentProvider(e,e._uninitializedComponentsProvider._online)):(common_341bda9b_esm_PRIVATE_logDebug(eY,"Using default OnlineComponentProvider"),await __PRIVATE_setOnlineComponentProvider(e,new common_341bda9b_esm_OnlineComponentProvider))),e._onlineComponents}async function __PRIVATE_getEventManager(e){let r=await __PRIVATE_ensureOnlineComponents(e),h=r.eventManager;return h.onListen=__PRIVATE_syncEngineListen.bind(null,r.syncEngine),h.onUnlisten=__PRIVATE_syncEngineUnlisten.bind(null,r.syncEngine),h.onFirstRemoteStoreListen=__PRIVATE_triggerRemoteStoreListen.bind(null,r.syncEngine),h.onLastRemoteStoreUnlisten=__PRIVATE_triggerRemoteStoreUnlisten.bind(null,r.syncEngine),h}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function __PRIVATE_cloneLongPollingOptions(e){let r={};return void 0!==e.timeoutSeconds&&(r.timeoutSeconds=e.timeoutSeconds),r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eZ=new Map,e0="firestore.googleapis.com";let FirestoreSettingsImpl=class FirestoreSettingsImpl{constructor(e){if(void 0===e.host){if(void 0!==e.ssl)throw new common_341bda9b_esm_FirestoreError(eg.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=e0,this.ssl=!0}else this.host=e.host,this.ssl=e.ssl??!0;if(this.isUsingEmulator=void 0!==e.emulatorOptions,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new common_341bda9b_esm_FirestoreError(eg.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,r,h,d){if(!0===r&&!0===d)throw new common_341bda9b_esm_FirestoreError(eg.INVALID_ARGUMENT,`${e} and ${h} cannot be used together.`)})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=__PRIVATE_cloneLongPollingOptions(e.experimentalLongPollingOptions??{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new common_341bda9b_esm_FirestoreError(eg.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new common_341bda9b_esm_FirestoreError(eg.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new common_341bda9b_esm_FirestoreError(eg.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){var r,h;return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(r=this.experimentalLongPollingOptions,h=e.experimentalLongPollingOptions,r.timeoutSeconds===h.timeoutSeconds)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}};let Firestore$1=class Firestore$1{constructor(e,r,h,d){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=h,this._app=d,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new FirestoreSettingsImpl({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new common_341bda9b_esm_FirestoreError(eg.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new common_341bda9b_esm_FirestoreError(eg.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new FirestoreSettingsImpl(e),this._emulatorOptions=e.emulatorOptions||{},void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new __PRIVATE_EmptyAuthCredentialsProvider;switch(e.type){case"firstParty":return new __PRIVATE_FirstPartyAuthCredentialsProvider(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new common_341bda9b_esm_FirestoreError(eg.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){let r=eZ.get(e);r&&(common_341bda9b_esm_PRIVATE_logDebug("ComponentProvider","Removing Datastore"),eZ.delete(e),r.terminate())}(this),Promise.resolve()}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let common_341bda9b_esm_Query=class common_341bda9b_esm_Query{constructor(e,r,h){this.converter=r,this._query=h,this.type="query",this.firestore=e}withConverter(e){return new common_341bda9b_esm_Query(this.firestore,e,this._query)}};let common_341bda9b_esm_DocumentReference=class common_341bda9b_esm_DocumentReference{constructor(e,r,h){this.converter=r,this._key=h,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new CollectionReference(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new common_341bda9b_esm_DocumentReference(this.firestore,e,this._key)}toJSON(){return{type:common_341bda9b_esm_DocumentReference._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,h){if(common_341bda9b_esm_PRIVATE_validateJSON(r,common_341bda9b_esm_DocumentReference._jsonSchema))return new common_341bda9b_esm_DocumentReference(e,h||null,new common_341bda9b_esm_DocumentKey(common_341bda9b_esm_ResourcePath.fromString(r.referencePath)))}};common_341bda9b_esm_DocumentReference._jsonSchemaVersion="firestore/documentReference/1.0",common_341bda9b_esm_DocumentReference._jsonSchema={type:property("string",common_341bda9b_esm_DocumentReference._jsonSchemaVersion),referencePath:property("string")};let CollectionReference=class CollectionReference extends common_341bda9b_esm_Query{constructor(e,r,h){super(e,r,new __PRIVATE_QueryImpl(h)),this._path=h,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new common_341bda9b_esm_DocumentReference(this.firestore,null,new common_341bda9b_esm_DocumentKey(e))}withConverter(e){return new CollectionReference(this.firestore,e,this._path)}};function collection(e,r,...h){if(e=(0,ea.m9)(e),__PRIVATE_validateNonEmptyArgument("collection","path",r),e instanceof Firestore$1){let d=common_341bda9b_esm_ResourcePath.fromString(r,...h);return __PRIVATE_validateCollectionPath(d),new CollectionReference(e,null,d)}{if(!(e instanceof common_341bda9b_esm_DocumentReference||e instanceof CollectionReference))throw new common_341bda9b_esm_FirestoreError(eg.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let d=e._path.child(common_341bda9b_esm_ResourcePath.fromString(r,...h));return __PRIVATE_validateCollectionPath(d),new CollectionReference(e.firestore,null,d)}}function common_341bda9b_esm_doc(e,r,...h){if(e=(0,ea.m9)(e),1==arguments.length&&(r=__PRIVATE_AutoId.newId()),__PRIVATE_validateNonEmptyArgument("doc","path",r),e instanceof Firestore$1){let d=common_341bda9b_esm_ResourcePath.fromString(r,...h);return __PRIVATE_validateDocumentPath(d),new common_341bda9b_esm_DocumentReference(e,null,new common_341bda9b_esm_DocumentKey(d))}{if(!(e instanceof common_341bda9b_esm_DocumentReference||e instanceof CollectionReference))throw new common_341bda9b_esm_FirestoreError(eg.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let d=e._path.child(common_341bda9b_esm_ResourcePath.fromString(r,...h));return __PRIVATE_validateDocumentPath(d),new common_341bda9b_esm_DocumentReference(e.firestore,e instanceof CollectionReference?e.converter:null,new common_341bda9b_esm_DocumentKey(d))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let e1="AsyncQueue";let __PRIVATE_AsyncQueueImpl=class __PRIVATE_AsyncQueueImpl{constructor(e=Promise.resolve()){this.Yu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new __PRIVATE_ExponentialBackoff(this,"async_queue_retry"),this._c=()=>{let e=getDocument();e&&common_341bda9b_esm_PRIVATE_logDebug(e1,"Visibility state changed to "+e.visibilityState),this.M_.w_()},this.ac=e;let r=getDocument();r&&"function"==typeof r.addEventListener&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;let r=getDocument();r&&"function"==typeof r.removeEventListener&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});let r=new __PRIVATE_Deferred;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Yu.push(e),this.lc()))}async lc(){if(0!==this.Yu.length){try{await this.Yu[0](),this.Yu.shift(),this.M_.reset()}catch(e){if(!__PRIVATE_isIndexedDbTransactionError(e))throw e;common_341bda9b_esm_PRIVATE_logDebug(e1,"Operation failed with retryable error: "+e)}this.Yu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){let r=this.ac.then(()=>(this.rc=!0,e().catch(e=>{throw this.nc=e,this.rc=!1,__PRIVATE_logError("INTERNAL UNHANDLED ERROR: ",__PRIVATE_getMessageOrStack(e)),e}).then(e=>(this.rc=!1,e))));return this.ac=r,r}enqueueAfterDelay(e,r,h){this.uc(),this.oc.indexOf(e)>-1&&(r=0);let d=DelayedOperation.createAndSchedule(this,e,r,h,e=>this.hc(e));return this.tc.push(d),d}uc(){this.nc&&common_341bda9b_esm_fail(47125,{Pc:__PRIVATE_getMessageOrStack(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(let r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{for(let r of(this.tc.sort((e,r)=>e.targetTimeMs-r.targetTimeMs),this.tc))if(r.skipDelay(),"all"!==e&&r.timerId===e)break;return this.Tc()})}Rc(e){this.oc.push(e)}hc(e){let r=this.tc.indexOf(e);this.tc.splice(r,1)}};function __PRIVATE_getMessageOrStack(e){let r=e.message||"";return e.stack&&(r=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),r}let common_341bda9b_esm_Firestore=class common_341bda9b_esm_Firestore extends Firestore$1{constructor(e,r,h,d){super(e,r,h,d),this.type="firestore",this._queue=new __PRIVATE_AsyncQueueImpl,this._persistenceKey=d?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new __PRIVATE_AsyncQueueImpl(e),this._firestoreClient=void 0,await e}}};function getFirestore(e,r){let h="object"==typeof e?e:(0,es.Mq)(),d=(0,es.qX)(h,"firestore").getImmediate({identifier:"string"==typeof e?e:r||eR});if(!d._initialized){let e=(0,ea.P0)("firestore");e&&function(e,r,h,d={}){e=common_341bda9b_esm_PRIVATE_cast(e,Firestore$1);let f=(0,ea.Xx)(r),g=e._getSettings(),b={...g,emulatorOptions:e._getEmulatorOptions()},A=`${r}:${h}`;f&&((0,ea.Uo)(`https://${A}`),(0,ea.dp)("Firestore",!0)),g.host!==e0&&g.host!==A&&common_341bda9b_esm_PRIVATE_logWarn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let k={...g,host:A,ssl:f,emulatorOptions:d};if(!(0,ea.vZ)(k,b)&&(e._setSettings(k),d.mockUserToken)){let r,h;if("string"==typeof d.mockUserToken)r=d.mockUserToken,h=User.MOCK_USER;else{r=(0,ea.Sg)(d.mockUserToken,e._app?.options.projectId);let f=d.mockUserToken.sub||d.mockUserToken.user_id;if(!f)throw new common_341bda9b_esm_FirestoreError(eg.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new User(f)}e._authCredentials=new __PRIVATE_EmulatorAuthCredentialsProvider(new __PRIVATE_OAuthToken(r,h))}}(d,...e)}return d}function common_341bda9b_esm_ensureFirestoreConfigured(e){if(e._terminated)throw new common_341bda9b_esm_FirestoreError(eg.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||function(e){var r,h,d,f;let g=e._freezeSettings(),b=(r=e._databaseId,h=e._app?.options.appId||"",d=e._persistenceKey,f=e._app?.options.apiKey,new DatabaseInfo(r,h,d,g.host,g.ssl,g.experimentalForceLongPolling,g.experimentalAutoDetectLongPolling,__PRIVATE_cloneLongPollingOptions(g.experimentalLongPollingOptions),g.useFetchStreams,g.isUsingEmulator,f));e._componentsProvider||g.localCache?._offlineComponentProvider&&g.localCache?._onlineComponentProvider&&(e._componentsProvider={_offline:g.localCache._offlineComponentProvider,_online:g.localCache._onlineComponentProvider}),e._firestoreClient=new FirestoreClient(e._authCredentials,e._appCheckCredentials,e._queue,b,e._componentsProvider&&function(e){let r=e?._online.build();return{_offline:e?._offline.build(r),_online:r}}(e._componentsProvider))}(e),e._firestoreClient}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let common_341bda9b_esm_Bytes=class common_341bda9b_esm_Bytes{constructor(e){this._byteString=e}static fromBase64String(e){try{return new common_341bda9b_esm_Bytes(ByteString.fromBase64String(e))}catch(e){throw new common_341bda9b_esm_FirestoreError(eg.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new common_341bda9b_esm_Bytes(ByteString.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:common_341bda9b_esm_Bytes._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(common_341bda9b_esm_PRIVATE_validateJSON(e,common_341bda9b_esm_Bytes._jsonSchema))return common_341bda9b_esm_Bytes.fromBase64String(e.bytes)}};common_341bda9b_esm_Bytes._jsonSchemaVersion="firestore/bytes/1.0",common_341bda9b_esm_Bytes._jsonSchema={type:property("string",common_341bda9b_esm_Bytes._jsonSchemaVersion),bytes:property("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let common_341bda9b_esm_FieldPath=class common_341bda9b_esm_FieldPath{constructor(...e){for(let r=0;r<e.length;++r)if(0===e[r].length)throw new common_341bda9b_esm_FirestoreError(eg.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new FieldPath$1(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let FieldValue=class FieldValue{constructor(e){this._methodName=e}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let GeoPoint=class GeoPoint{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new common_341bda9b_esm_FirestoreError(eg.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new common_341bda9b_esm_FirestoreError(eg.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return __PRIVATE_primitiveComparator(this._lat,e._lat)||__PRIVATE_primitiveComparator(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:GeoPoint._jsonSchemaVersion}}static fromJSON(e){if(common_341bda9b_esm_PRIVATE_validateJSON(e,GeoPoint._jsonSchema))return new GeoPoint(e.latitude,e.longitude)}};GeoPoint._jsonSchemaVersion="firestore/geoPoint/1.0",GeoPoint._jsonSchema={type:property("string",GeoPoint._jsonSchemaVersion),latitude:property("number"),longitude:property("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let VectorValue=class VectorValue{constructor(e){this._values=(e||[]).map(e=>e)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(e,r){if(e.length!==r.length)return!1;for(let h=0;h<e.length;++h)if(e[h]!==r[h])return!1;return!0}(this._values,e._values)}toJSON(){return{type:VectorValue._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(common_341bda9b_esm_PRIVATE_validateJSON(e,VectorValue._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(e=>"number"==typeof e))return new VectorValue(e.vectorValues);throw new common_341bda9b_esm_FirestoreError(eg.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}};VectorValue._jsonSchemaVersion="firestore/vectorValue/1.0",VectorValue._jsonSchema={type:property("string",VectorValue._jsonSchemaVersion),vectorValues:property("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let e4=/^__.*__$/;let ParsedSetData=class ParsedSetData{constructor(e,r,h){this.data=e,this.fieldMask=r,this.fieldTransforms=h}toMutation(e,r){return null!==this.fieldMask?new __PRIVATE_PatchMutation(e,this.data,this.fieldMask,r,this.fieldTransforms):new __PRIVATE_SetMutation(e,this.data,r,this.fieldTransforms)}};let ParsedUpdateData=class ParsedUpdateData{constructor(e,r,h){this.data=e,this.fieldMask=r,this.fieldTransforms=h}toMutation(e,r){return new __PRIVATE_PatchMutation(e,this.data,this.fieldMask,r,this.fieldTransforms)}};function __PRIVATE_isWrite(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw common_341bda9b_esm_fail(40011,{dataSource:e})}}let ParseContextImpl=class ParseContextImpl{constructor(e,r,h,d,f,g){this.settings=e,this.databaseId=r,this.serializer=h,this.ignoreUndefinedProperties=d,void 0===f&&this.validatePath(),this.fieldTransforms=f||[],this.fieldMask=g||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new ParseContextImpl({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){let r=this.path?.child(e),h=this.contextWith({path:r,arrayElement:!1});return h.validatePathSegment(e),h}childContextForFieldPath(e){let r=this.path?.child(e),h=this.contextWith({path:r,arrayElement:!1});return h.validatePath(),h}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return createError(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return void 0!==this.fieldMask.find(r=>e.isPrefixOf(r))||void 0!==this.fieldTransforms.find(r=>e.isPrefixOf(r.field))}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(0===e.length)throw this.createError("Document fields must not be empty");if(__PRIVATE_isWrite(this.dataSource)&&e4.test(e))throw this.createError('Document fields cannot begin and end with "__"')}};let UserDataReader=class UserDataReader{constructor(e,r,h){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=h||common_341bda9b_esm_PRIVATE_newSerializer(e)}createContext(e,r,h,d=!1){return new ParseContextImpl({dataSource:e,methodName:r,targetDoc:h,path:FieldPath$1.emptyPath(),arrayElement:!1,hasConverter:d},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function common_341bda9b_esm_PRIVATE_newUserDataReader(e){let r=e._freezeSettings(),h=common_341bda9b_esm_PRIVATE_newSerializer(e._databaseId);return new UserDataReader(e._databaseId,!!r.ignoreUndefinedProperties,h)}let __PRIVATE_DeleteFieldValueImpl=class __PRIVATE_DeleteFieldValueImpl extends FieldValue{_toFieldTransform(e){if(2!==e.dataSource)throw 1===e.dataSource?e.createError(`${this._methodName}() can only appear at the top level of your update data`):e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof __PRIVATE_DeleteFieldValueImpl}};let __PRIVATE_ServerTimestampFieldValueImpl=class __PRIVATE_ServerTimestampFieldValueImpl extends FieldValue{_toFieldTransform(e){return new FieldTransform(e.path,new __PRIVATE_ServerTimestampTransform)}isEqual(e){return e instanceof __PRIVATE_ServerTimestampFieldValueImpl}};let __PRIVATE_ArrayUnionFieldValueImpl=class __PRIVATE_ArrayUnionFieldValueImpl extends FieldValue{constructor(e,r){super(e),this.Ac=r}_toFieldTransform(e){let r=new ParseContextImpl({dataSource:3,targetDoc:e.settings.targetDoc,methodName:this._methodName,arrayElement:!0},e.databaseId,e.serializer,e.ignoreUndefinedProperties),h=this.Ac.map(e=>__PRIVATE_parseData(e,r)),d=new __PRIVATE_ArrayUnionTransformOperation(h);return new FieldTransform(e.path,d)}isEqual(e){return e instanceof __PRIVATE_ArrayUnionFieldValueImpl&&(0,ea.vZ)(this.Ac,e.Ac)}};function __PRIVATE_parseData(e,r){if(__PRIVATE_looksLikeJsonObject(e=(0,ea.m9)(e)))return __PRIVATE_validatePlainObject("Unsupported field value:",r,e),__PRIVATE_parseObject(e,r);if(e instanceof FieldValue)return function(e,r){if(!__PRIVATE_isWrite(r.dataSource))throw r.createError(`${e._methodName}() can only be used with update() and set()`);if(!r.path)throw r.createError(`${e._methodName}() is not currently supported inside arrays`);let h=e._toFieldTransform(r);h&&r.fieldTransforms.push(h)}(e,r),null;if(void 0===e&&r.ignoreUndefinedProperties)return null;if(r.path&&r.fieldMask.push(r.path),e instanceof Array){if(r.settings.arrayElement&&4!==r.dataSource)throw r.createError("Nested arrays are not supported");return function(e,r){let h=[],d=0;for(let f of e){let e=__PRIVATE_parseData(f,r.childContextForArray(d));null==e&&(e={nullValue:"NULL_VALUE"}),h.push(e),d++}return{arrayValue:{values:h}}}(e,r)}return function(e,r){if(null===(e=(0,ea.m9)(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e){var h,d,f;return h=r.serializer,"number"==typeof(f=d=e)&&Number.isInteger(f)&&!__PRIVATE_isNegativeZero(f)&&f<=Number.MAX_SAFE_INTEGER&&f>=Number.MIN_SAFE_INTEGER?__PRIVATE_toInteger(d):__PRIVATE_toDouble(h,d)}if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){let h=Timestamp.fromDate(e);return{timestampValue:toTimestamp(r.serializer,h)}}if(e instanceof Timestamp){let h=new Timestamp(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:toTimestamp(r.serializer,h)}}if(e instanceof GeoPoint)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof common_341bda9b_esm_Bytes)return{bytesValue:__PRIVATE_toBytes(r.serializer,e._byteString)};if(e instanceof common_341bda9b_esm_DocumentReference){let h=r.databaseId,d=e.firestore._databaseId;if(!d.isEqual(h))throw r.createError(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${h.projectId}/${h.database}`);return{referenceValue:__PRIVATE_toResourceName(e.firestore._databaseId||r.databaseId,e._key.path)}}if(e instanceof VectorValue)return function(e,r){let h=e instanceof VectorValue?e.toArray():e,d={fields:{[ew]:{stringValue:eC},[ex]:{arrayValue:{values:h.map(e=>{if("number"!=typeof e)throw r.createError("VectorValues must only contain numeric values.");return __PRIVATE_toDouble(r.serializer,e)})}}}};return{mapValue:d}}(e,r);if(__PRIVATE_isProtoValueSerializable(e))return e._toProto(r.serializer);throw r.createError(`Unsupported field value: ${__PRIVATE_valueDescription(e)}`)}(e,r)}function __PRIVATE_parseObject(e,r){let h={};return isEmpty(e)?r.path&&r.path.length>0&&r.fieldMask.push(r.path):forEach(e,(e,d)=>{let f=__PRIVATE_parseData(d,r.childContextForField(e));null!=f&&(h[e]=f)}),{mapValue:{fields:h}}}function __PRIVATE_looksLikeJsonObject(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof Timestamp||e instanceof GeoPoint||e instanceof common_341bda9b_esm_Bytes||e instanceof common_341bda9b_esm_DocumentReference||e instanceof FieldValue||e instanceof VectorValue||__PRIVATE_isProtoValueSerializable(e))}function __PRIVATE_validatePlainObject(e,r,h){if(!__PRIVATE_looksLikeJsonObject(h)||!__PRIVATE_isPlainObject(h)){let d=__PRIVATE_valueDescription(h);throw"an object"===d?r.createError(e+" a custom object"):r.createError(e+" "+d)}}function common_341bda9b_esm_PRIVATE_fieldPathFromArgument(e,r,h){if((r=(0,ea.m9)(r))instanceof common_341bda9b_esm_FieldPath)return r._internalPath;if("string"==typeof r)return common_341bda9b_esm_PRIVATE_fieldPathFromDotSeparatedString(e,r);throw createError("Field path arguments must be of type string or ",e,!1,void 0,h)}let e2=RegExp("[~\\*/\\[\\]]");function common_341bda9b_esm_PRIVATE_fieldPathFromDotSeparatedString(e,r,h){if(r.search(e2)>=0)throw createError(`Invalid field path (${r}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,h);try{return new common_341bda9b_esm_FieldPath(...r.split("."))._internalPath}catch(d){throw createError(`Invalid field path (${r}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,h)}}function createError(e,r,h,d,f){let g=d&&!d.isEmpty(),b=void 0!==f,A=`Function ${r}() called with invalid data`;h&&(A+=" (via `toFirestore()`)"),A+=". ";let k="";return(g||b)&&(k+=" (found",g&&(k+=` in field ${d}`),b&&(k+=` in document ${f}`),k+=")"),new common_341bda9b_esm_FirestoreError(eg.INVALID_ARGUMENT,A+e+k)}function __PRIVATE_fieldMaskContains(e,r){return e.some(e=>e.isEqual(r))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let common_341bda9b_esm_AbstractUserDataWriter=class common_341bda9b_esm_AbstractUserDataWriter{convertValue(e,r="none"){switch(__PRIVATE_typeOrder(e)){case 0:return null;case 1:return e.booleanValue;case 2:return __PRIVATE_normalizeNumber(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(__PRIVATE_normalizeByteString(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw common_341bda9b_esm_fail(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){let h={};return forEach(e,(e,d)=>{h[e]=this.convertValue(d,r)}),h}convertVectorValue(e){let r=e.fields?.[ex].arrayValue?.values?.map(e=>__PRIVATE_normalizeNumber(e.doubleValue));return new VectorValue(r)}convertGeoPoint(e){return new GeoPoint(__PRIVATE_normalizeNumber(e.latitude),__PRIVATE_normalizeNumber(e.longitude))}convertArray(e,r){return(e.values||[]).map(e=>this.convertValue(e,r))}convertServerTimestamp(e,r){switch(r){case"previous":let h=__PRIVATE_getPreviousValue(e);return null==h?null:this.convertValue(h,r);case"estimate":return this.convertTimestamp(__PRIVATE_getLocalWriteTime(e));default:return null}}convertTimestamp(e){let r=__PRIVATE_normalizeTimestamp(e);return new Timestamp(r.seconds,r.nanos)}convertDocumentKey(e,r){let h=common_341bda9b_esm_ResourcePath.fromString(e);__PRIVATE_hardAssert(__PRIVATE_isValidResourceName(h),9688,{name:e});let d=new DatabaseId(h.get(1),h.get(3)),f=new common_341bda9b_esm_DocumentKey(h.popFirst(5));return d.isEqual(r)||__PRIVATE_logError(`Document ${f} contains a document reference within a different database (${d.projectId}/${d.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),f}};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let common_341bda9b_esm_PRIVATE_ExpUserDataWriter=class common_341bda9b_esm_PRIVATE_ExpUserDataWriter extends common_341bda9b_esm_AbstractUserDataWriter{constructor(e){super(),this.firestore=e}convertBytes(e){return new common_341bda9b_esm_Bytes(e)}convertReference(e){let r=this.convertDocumentKey(e,this.firestore._databaseId);return new common_341bda9b_esm_DocumentReference(this.firestore,null,r)}};function serverTimestamp(){return new __PRIVATE_ServerTimestampFieldValueImpl("serverTimestamp")}function arrayUnion(...e){return new __PRIVATE_ArrayUnionFieldValueImpl("arrayUnion",e)}let e3="@firebase/firestore",e9="4.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let DocumentSnapshot$1=class DocumentSnapshot$1{constructor(e,r,h,d,f){this._firestore=e,this._userDataWriter=r,this._key=h,this._document=d,this._converter=f}get id(){return this._key.path.lastSegment()}get ref(){return new common_341bda9b_esm_DocumentReference(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){let e=new QueryDocumentSnapshot$1(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){let r=this._document.data.field(common_341bda9b_esm_PRIVATE_fieldPathFromArgument("DocumentSnapshot.get",e));if(null!==r)return this._userDataWriter.convertValue(r)}}};let QueryDocumentSnapshot$1=class QueryDocumentSnapshot$1 extends DocumentSnapshot$1{data(){return super.data()}};let AppliableConstraint=class AppliableConstraint{};let QueryConstraint=class QueryConstraint extends AppliableConstraint{};function query(e,r,...h){let d=[];for(let f of(r instanceof AppliableConstraint&&d.push(r),function(e){let r=e.filter(e=>e instanceof QueryCompositeFilterConstraint).length,h=e.filter(e=>e instanceof QueryFieldFilterConstraint).length;if(r>1||r>0&&h>0)throw new common_341bda9b_esm_FirestoreError(eg.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(d=d.concat(h)),d))e=f._apply(e);return e}let QueryFieldFilterConstraint=class QueryFieldFilterConstraint extends QueryConstraint{constructor(e,r,h){super(),this._field=e,this._op=r,this._value=h,this.type="where"}static _create(e,r,h){return new QueryFieldFilterConstraint(e,r,h)}_apply(e){let r=this._parse(e);return __PRIVATE_validateNewFieldFilter(e._query,r),new common_341bda9b_esm_Query(e.firestore,e.converter,__PRIVATE_queryWithAddedFilter(e._query,r))}_parse(e){let r=common_341bda9b_esm_PRIVATE_newUserDataReader(e.firestore),h=function(e,r,h,d,f,g,b){let A;if(f.isKeyField()){if("array-contains"===g||"array-contains-any"===g)throw new common_341bda9b_esm_FirestoreError(eg.INVALID_ARGUMENT,`Invalid Query. You can't perform '${g}' queries on documentId().`);if("in"===g||"not-in"===g){__PRIVATE_validateDisjunctiveFilterElements(b,g);let r=[];for(let h of b)r.push(__PRIVATE_parseDocumentIdValue(d,e,h));A={arrayValue:{values:r}}}else A=__PRIVATE_parseDocumentIdValue(d,e,b)}else"in"!==g&&"not-in"!==g&&"array-contains-any"!==g||__PRIVATE_validateDisjunctiveFilterElements(b,g),A=function(e,r,h,d=!1){return __PRIVATE_parseData(h,e.createContext(d?4:3,r))}(h,r,b,"in"===g||"not-in"===g);let k=FieldFilter.create(f,g,A);return k}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value);return h}};function where(e,r,h){let d=common_341bda9b_esm_PRIVATE_fieldPathFromArgument("where",e);return QueryFieldFilterConstraint._create(d,r,h)}let QueryCompositeFilterConstraint=class QueryCompositeFilterConstraint extends AppliableConstraint{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new QueryCompositeFilterConstraint(e,r)}_parse(e){let r=this._queryConstraints.map(r=>r._parse(e)).filter(e=>e.getFilters().length>0);return 1===r.length?r[0]:CompositeFilter.create(r,this._getOperator())}_apply(e){let r=this._parse(e);return 0===r.getFilters().length?e:(function(e,r){let h=e,d=r.getFlattenedFilters();for(let e of d)__PRIVATE_validateNewFieldFilter(h,e),h=__PRIVATE_queryWithAddedFilter(h,e)}(e._query,r),new common_341bda9b_esm_Query(e.firestore,e.converter,__PRIVATE_queryWithAddedFilter(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}};let QueryOrderByConstraint=class QueryOrderByConstraint extends QueryConstraint{constructor(e,r){super(),this._field=e,this._direction=r,this.type="orderBy"}static _create(e,r){return new QueryOrderByConstraint(e,r)}_apply(e){let r=function(e,r,h){if(null!==e.startAt)throw new common_341bda9b_esm_FirestoreError(eg.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new common_341bda9b_esm_FirestoreError(eg.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");let d=new OrderBy(r,h);return d}(e._query,this._field,this._direction);return new common_341bda9b_esm_Query(e.firestore,e.converter,function(e,r){let h=e.explicitOrderBy.concat([r]);return new __PRIVATE_QueryImpl(e.path,e.collectionGroup,h,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,r))}};function orderBy(e,r="asc"){let h=common_341bda9b_esm_PRIVATE_fieldPathFromArgument("orderBy",e);return QueryOrderByConstraint._create(h,r)}function __PRIVATE_parseDocumentIdValue(e,r,h){if("string"==typeof(h=(0,ea.m9)(h))){if(""===h)throw new common_341bda9b_esm_FirestoreError(eg.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!common_341bda9b_esm_PRIVATE_isCollectionGroupQuery(r)&&-1!==h.indexOf("/"))throw new common_341bda9b_esm_FirestoreError(eg.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${h}' contains a '/' character.`);let d=r.path.child(common_341bda9b_esm_ResourcePath.fromString(h));if(!common_341bda9b_esm_DocumentKey.isDocumentKey(d))throw new common_341bda9b_esm_FirestoreError(eg.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${d}' is not because it has an odd number of segments (${d.length}).`);return common_341bda9b_esm_PRIVATE_refValue(e,new common_341bda9b_esm_DocumentKey(d))}if(h instanceof common_341bda9b_esm_DocumentReference)return common_341bda9b_esm_PRIVATE_refValue(e,h._key);throw new common_341bda9b_esm_FirestoreError(eg.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${__PRIVATE_valueDescription(h)}.`)}function __PRIVATE_validateDisjunctiveFilterElements(e,r){if(!Array.isArray(e)||0===e.length)throw new common_341bda9b_esm_FirestoreError(eg.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${r.toString()}' filters.`)}function __PRIVATE_validateNewFieldFilter(e,r){let h=function(e,r){for(let h of e)for(let e of h.getFlattenedFilters())if(r.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(r.op));if(null!==h)throw h===r.op?new common_341bda9b_esm_FirestoreError(eg.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${r.op.toString()}' filter.`):new common_341bda9b_esm_FirestoreError(eg.INVALID_ARGUMENT,`Invalid query. You cannot use '${r.op.toString()}' filters with '${h.toString()}' filters.`)}let SnapshotMetadata=class SnapshotMetadata{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}};let DocumentSnapshot=class DocumentSnapshot extends DocumentSnapshot$1{constructor(e,r,h,d,f,g){super(e,r,h,d,g),this._firestore=e,this._firestoreImpl=e,this.metadata=f}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let r=new QueryDocumentSnapshot(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){let h=this._document.data.field(common_341bda9b_esm_PRIVATE_fieldPathFromArgument("DocumentSnapshot.get",e));if(null!==h)return this._userDataWriter.convertValue(h,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new common_341bda9b_esm_FirestoreError(eg.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e=this._document,r={};return r.type=DocumentSnapshot._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),e&&e.isValidDocument()&&e.isFoundDocument()&&(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED")),r}};DocumentSnapshot._jsonSchemaVersion="firestore/documentSnapshot/1.0",DocumentSnapshot._jsonSchema={type:property("string",DocumentSnapshot._jsonSchemaVersion),bundleSource:property("string","DocumentSnapshot"),bundleName:property("string"),bundle:property("string")};let QueryDocumentSnapshot=class QueryDocumentSnapshot extends DocumentSnapshot{data(e={}){return super.data(e)}};let QuerySnapshot=class QuerySnapshot{constructor(e,r,h,d){this._firestore=e,this._userDataWriter=r,this._snapshot=d,this.metadata=new SnapshotMetadata(d.hasPendingWrites,d.fromCache),this.query=h}get docs(){let e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,r){this._snapshot.docs.forEach(h=>{e.call(r,new QueryDocumentSnapshot(this._firestore,this._userDataWriter,h.key,h,new SnapshotMetadata(this._snapshot.mutatedKeys.has(h.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new common_341bda9b_esm_FirestoreError(eg.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(e,r){if(e._snapshot.oldDocs.isEmpty()){let r=0;return e._snapshot.docChanges.map(h=>{let d=new QueryDocumentSnapshot(e._firestore,e._userDataWriter,h.doc.key,h.doc,new SnapshotMetadata(e._snapshot.mutatedKeys.has(h.doc.key),e._snapshot.fromCache),e.query.converter);return h.doc,{type:"added",doc:d,oldIndex:-1,newIndex:r++}})}{let h=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>r||3!==e.type).map(r=>{let d=new QueryDocumentSnapshot(e._firestore,e._userDataWriter,r.doc.key,r.doc,new SnapshotMetadata(e._snapshot.mutatedKeys.has(r.doc.key),e._snapshot.fromCache),e.query.converter),f=-1,g=-1;return 0!==r.type&&(f=h.indexOf(r.doc.key),h=h.delete(r.doc.key)),1!==r.type&&(g=(h=h.add(r.doc)).indexOf(r.doc.key)),{type:function(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return common_341bda9b_esm_fail(61501,{type:e})}}(r.type),doc:d,oldIndex:f,newIndex:g}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new common_341bda9b_esm_FirestoreError(eg.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e={};e.type=QuerySnapshot._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=__PRIVATE_AutoId.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;let r=[],h=[],d=[];return this.docs.forEach(e=>{null!==e._document&&(r.push(e._document),h.push(this._userDataWriter.convertObjectMap(e._document.data.value.mapValue.fields,"previous")),d.push(e.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function getDoc(e){e=common_341bda9b_esm_PRIVATE_cast(e,common_341bda9b_esm_DocumentReference);let r=common_341bda9b_esm_PRIVATE_cast(e.firestore,common_341bda9b_esm_Firestore),h=common_341bda9b_esm_ensureFirestoreConfigured(r);return(function(e,r,h={}){let d=new __PRIVATE_Deferred;return e.asyncQueue.enqueueAndForget(async()=>(function(e,r,h,d,f){var g;let b=new __PRIVATE_AsyncObserver({next:g=>{b.Nu(),r.enqueueAndForget(()=>__PRIVATE_eventManagerUnlisten(e,A));let k=g.docs.has(h);!k&&g.fromCache?f.reject(new common_341bda9b_esm_FirestoreError(eg.UNAVAILABLE,"Failed to get document because the client is offline.")):k&&g.fromCache&&d&&"server"===d.source?f.reject(new common_341bda9b_esm_FirestoreError(eg.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):f.resolve(g)},error:e=>f.reject(e)}),A=new __PRIVATE_QueryListener((g=h.path,new __PRIVATE_QueryImpl(g)),b,{includeMetadataChanges:!0,Ka:!0});return __PRIVATE_eventManagerListen(e,A)})(await __PRIVATE_getEventManager(e),e.asyncQueue,r,h,d)),d.promise})(h,e._key).then(h=>(function(e,r,h){let d=h.docs.get(r._key),f=new common_341bda9b_esm_PRIVATE_ExpUserDataWriter(e);return new DocumentSnapshot(e,f,r._key,d,new SnapshotMetadata(h.hasPendingWrites,h.fromCache),r.converter)})(r,e,h))}function getDocs(e){e=common_341bda9b_esm_PRIVATE_cast(e,common_341bda9b_esm_Query);let r=common_341bda9b_esm_PRIVATE_cast(e.firestore,common_341bda9b_esm_Firestore),h=common_341bda9b_esm_ensureFirestoreConfigured(r),d=new common_341bda9b_esm_PRIVATE_ExpUserDataWriter(r);return(/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new common_341bda9b_esm_FirestoreError(eg.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}(e._query),(function(e,r,h={}){let d=new __PRIVATE_Deferred;return e.asyncQueue.enqueueAndForget(async()=>(function(e,r,h,d,f){let g=new __PRIVATE_AsyncObserver({next:h=>{g.Nu(),r.enqueueAndForget(()=>__PRIVATE_eventManagerUnlisten(e,b)),h.fromCache&&"server"===d.source?f.reject(new common_341bda9b_esm_FirestoreError(eg.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):f.resolve(h)},error:e=>f.reject(e)}),b=new __PRIVATE_QueryListener(h,g,{includeMetadataChanges:!0,Ka:!0});return __PRIVATE_eventManagerListen(e,b)})(await __PRIVATE_getEventManager(e),e.asyncQueue,r,h,d)),d.promise})(h,e._query).then(h=>new QuerySnapshot(r,d,e,h)))}function setDoc(e,r,h){var d;e=common_341bda9b_esm_PRIVATE_cast(e,common_341bda9b_esm_DocumentReference);let f=common_341bda9b_esm_PRIVATE_cast(e.firestore,common_341bda9b_esm_Firestore),g=(d=e.converter)?h&&(h.merge||h.mergeFields)?d.toFirestore(r,h):d.toFirestore(r):r,b=common_341bda9b_esm_PRIVATE_newUserDataReader(f);return executeWrite(f,[(function(e,r,h,d,f,g={}){let b,A;let k=e.createContext(g.merge||g.mergeFields?2:0,r,h,f);__PRIVATE_validatePlainObject("Data must be an object, but it was:",k,d);let M=__PRIVATE_parseObject(d,k);if(g.merge)b=new FieldMask(k.fieldMask),A=k.fieldTransforms;else if(g.mergeFields){let e=[];for(let d of g.mergeFields){let f=common_341bda9b_esm_PRIVATE_fieldPathFromArgument(r,d,h);if(!k.contains(f))throw new common_341bda9b_esm_FirestoreError(eg.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);__PRIVATE_fieldMaskContains(e,f)||e.push(f)}b=new FieldMask(e),A=k.fieldTransforms.filter(e=>b.covers(e.field))}else b=null,A=k.fieldTransforms;return new ParsedSetData(new common_341bda9b_esm_ObjectValue(M),b,A)})(b,"setDoc",e._key,g,null!==e.converter,h).toMutation(e._key,common_341bda9b_esm_Precondition.none())])}function updateDoc(e,r,h,...d){e=common_341bda9b_esm_PRIVATE_cast(e,common_341bda9b_esm_DocumentReference);let f=common_341bda9b_esm_PRIVATE_cast(e.firestore,common_341bda9b_esm_Firestore),g=common_341bda9b_esm_PRIVATE_newUserDataReader(f);return executeWrite(f,[("string"==typeof(r=(0,ea.m9)(r))||r instanceof common_341bda9b_esm_FieldPath?function(e,r,h,d,f,g){let b=e.createContext(1,r,h),A=[common_341bda9b_esm_PRIVATE_fieldPathFromArgument(r,d,h)],k=[f];if(g.length%2!=0)throw new common_341bda9b_esm_FirestoreError(eg.INVALID_ARGUMENT,`Function ${r}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let e=0;e<g.length;e+=2)A.push(common_341bda9b_esm_PRIVATE_fieldPathFromArgument(r,g[e])),k.push(g[e+1]);let M=[],j=common_341bda9b_esm_ObjectValue.empty();for(let e=A.length-1;e>=0;--e)if(!__PRIVATE_fieldMaskContains(M,A[e])){let r=A[e],h=k[e];h=(0,ea.m9)(h);let d=b.childContextForFieldPath(r);if(h instanceof __PRIVATE_DeleteFieldValueImpl)M.push(r);else{let e=__PRIVATE_parseData(h,d);null!=e&&(M.push(r),j.set(r,e))}}let q=new FieldMask(M);return new ParsedUpdateData(j,q,b.fieldTransforms)}(g,"updateDoc",e._key,r,h,d):function(e,r,h,d){let f=e.createContext(1,r,h);__PRIVATE_validatePlainObject("Data must be an object, but it was:",f,d);let g=[],b=common_341bda9b_esm_ObjectValue.empty();forEach(d,(e,d)=>{let A=common_341bda9b_esm_PRIVATE_fieldPathFromDotSeparatedString(r,e,h);d=(0,ea.m9)(d);let k=f.childContextForFieldPath(A);if(d instanceof __PRIVATE_DeleteFieldValueImpl)g.push(A);else{let e=__PRIVATE_parseData(d,k);null!=e&&(g.push(A),b.set(A,e))}});let A=new FieldMask(g);return new ParsedUpdateData(b,A,f.fieldTransforms)}(g,"updateDoc",e._key,r)).toMutation(e._key,common_341bda9b_esm_Precondition.exists(!0))])}function executeWrite(e,r){let h=common_341bda9b_esm_ensureFirestoreConfigured(e);return function(e,r){let h=new __PRIVATE_Deferred;return e.asyncQueue.enqueueAndForget(async()=>__PRIVATE_syncEngineWrite(await __PRIVATE_ensureOnlineComponents(e).then(e=>e.syncEngine),r,h)),h.promise}(h,r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */QuerySnapshot._jsonSchemaVersion="firestore/querySnapshot/1.0",QuerySnapshot._jsonSchema={type:property("string",QuerySnapshot._jsonSchemaVersion),bundleSource:property("string","QuerySnapshot"),bundleName:property("string"),bundle:property("string")},new WeakMap,function(e=!0){ep=es.Jn,(0,es.Xd)(new eo.wA("firestore",(r,{instanceIdentifier:h,options:d})=>{let f=r.getProvider("app").getImmediate(),g=new common_341bda9b_esm_Firestore(new __PRIVATE_FirebaseAuthCredentialsProvider(r.getProvider("auth-internal")),new __PRIVATE_FirebaseAppCheckTokenProvider(f,r.getProvider("app-check-internal")),function(e,r){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new common_341bda9b_esm_FirestoreError(eg.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new DatabaseId(e.options.projectId,r)}(f,h),f);return d={useFetchStreams:e,...d},g._setSettings(d),g},"PUBLIC").setMultipleInstances(!0)),(0,es.KN)(e3,e9,void 0),(0,es.KN)(e3,e9,"esm2020")}()},1526:function(e,r,h){"use strict";h.d(r,{M:function(){return AnimatePresence}});var d=h(7294),f=h(8868);function useIsMounted(){let e=(0,d.useRef)(!1);return(0,f.L)(()=>(e.current=!0,()=>{e.current=!1}),[]),e}var g=h(2074),b=h(240),A=h(6681);let PopChildMeasure=class PopChildMeasure extends d.Component{getSnapshotBeforeUpdate(e){let r=this.props.childRef.current;if(r&&e.isPresent&&!this.props.isPresent){let e=this.props.sizeRef.current;e.height=r.offsetHeight||0,e.width=r.offsetWidth||0,e.top=r.offsetTop,e.left=r.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}};function PopChild({children:e,isPresent:r}){let h=(0,d.useId)(),f=(0,d.useRef)(null),g=(0,d.useRef)({width:0,height:0,top:0,left:0});return(0,d.useInsertionEffect)(()=>{let{width:e,height:d,top:b,left:A}=g.current;if(r||!f.current||!e||!d)return;f.current.dataset.motionPopId=h;let k=document.createElement("style");return document.head.appendChild(k),k.sheet&&k.sheet.insertRule(`
          [data-motion-pop-id="${h}"] {
            position: absolute !important;
            width: ${e}px !important;
            height: ${d}px !important;
            top: ${b}px !important;
            left: ${A}px !important;
          }
        `),()=>{document.head.removeChild(k)}},[r]),d.createElement(PopChildMeasure,{isPresent:r,childRef:f,sizeRef:g},d.cloneElement(e,{ref:f}))}let PresenceChild=({children:e,initial:r,isPresent:h,onExitComplete:f,custom:g,presenceAffectsLayout:k,mode:M})=>{let j=(0,A.h)(newChildrenMap),q=(0,d.useId)(),ee=(0,d.useMemo)(()=>({id:q,initial:r,isPresent:h,custom:g,onExitComplete:e=>{for(let r of(j.set(e,!0),j.values()))if(!r)return;f&&f()},register:e=>(j.set(e,!1),()=>j.delete(e))}),k?void 0:[h]);return(0,d.useMemo)(()=>{j.forEach((e,r)=>j.set(r,!1))},[h]),d.useEffect(()=>{h||j.size||!f||f()},[h]),"popLayout"===M&&(e=d.createElement(PopChild,{isPresent:h},e)),d.createElement(b.O.Provider,{value:ee},e)};function newChildrenMap(){return new Map}var k=h(5364),M=h(5487);let getChildKey=e=>e.key||"",AnimatePresence=({children:e,custom:r,initial:h=!0,onExitComplete:b,exitBeforeEnter:A,presenceAffectsLayout:j=!0,mode:q="sync"})=>{var ee;(0,M.k)(!A,"Replace exitBeforeEnter with mode='wait'");let et=(0,d.useContext)(k.p).forceRender||function(){let e=useIsMounted(),[r,h]=(0,d.useState)(0),f=(0,d.useCallback)(()=>{e.current&&h(r+1)},[r]),b=(0,d.useCallback)(()=>g.Wi.postRender(f),[f]);return[b,r]}()[0],er=useIsMounted(),en=function(e){let r=[];return d.Children.forEach(e,e=>{(0,d.isValidElement)(e)&&r.push(e)}),r}(e),ei=en,es=(0,d.useRef)(new Map).current,eo=(0,d.useRef)(ei),ea=(0,d.useRef)(new Map).current,el=(0,d.useRef)(!0);if((0,f.L)(()=>{el.current=!1,function(e,r){e.forEach(e=>{let h=getChildKey(e);r.set(h,e)})}(en,ea),eo.current=ei}),ee=()=>{el.current=!0,ea.clear(),es.clear()},(0,d.useEffect)(()=>()=>ee(),[]),el.current)return d.createElement(d.Fragment,null,ei.map(e=>d.createElement(PresenceChild,{key:getChildKey(e),isPresent:!0,initial:!!h&&void 0,presenceAffectsLayout:j,mode:q},e)));ei=[...ei];let eu=eo.current.map(getChildKey),eh=en.map(getChildKey),ed=eu.length;for(let e=0;e<ed;e++){let r=eu[e];-1!==eh.indexOf(r)||es.has(r)||es.set(r,void 0)}return"wait"===q&&es.size&&(ei=[]),es.forEach((e,h)=>{if(-1!==eh.indexOf(h))return;let f=ea.get(h);if(!f)return;let g=eu.indexOf(h),A=e;A||(A=d.createElement(PresenceChild,{key:getChildKey(f),isPresent:!1,onExitComplete:()=>{es.delete(h);let e=Array.from(ea.keys()).filter(e=>!eh.includes(e));if(e.forEach(e=>ea.delete(e)),eo.current=en.filter(r=>{let d=getChildKey(r);return d===h||e.includes(d)}),!es.size){if(!1===er.current)return;et(),b&&b()}},custom:r,presenceAffectsLayout:j,mode:q},f),es.set(h,A)),ei.splice(g,0,A)}),ei=ei.map(e=>{let r=e.key;return es.has(r)?e:d.createElement(PresenceChild,{key:getChildKey(e),isPresent:!0,presenceAffectsLayout:j,mode:q},e)}),d.createElement(d.Fragment,null,es.size?ei:ei.map(e=>(0,d.cloneElement)(e)))}},5364:function(e,r,h){"use strict";h.d(r,{p:function(){return f}});var d=h(7294);let f=(0,d.createContext)({})},240:function(e,r,h){"use strict";h.d(r,{O:function(){return f}});var d=h(7294);let f=(0,d.createContext)(null)},2074:function(e,r,h){"use strict";h.d(r,{Pn:function(){return b},Wi:function(){return g},frameData:function(){return A},S6:function(){return k}});var d=h(1662);let Queue=class Queue{constructor(){this.order=[],this.scheduled=new Set}add(e){if(!this.scheduled.has(e))return this.scheduled.add(e),this.order.push(e),!0}remove(e){let r=this.order.indexOf(e);-1!==r&&(this.order.splice(r,1),this.scheduled.delete(e))}clear(){this.order.length=0,this.scheduled.clear()}};let f=["prepare","read","update","preRender","render","postRender"],{schedule:g,cancel:b,state:A,steps:k}=function(e,r){let h=!1,d=!0,g={delta:0,timestamp:0,isProcessing:!1},b=f.reduce((e,r)=>(e[r]=function(e){let r=new Queue,h=new Queue,d=0,f=!1,g=!1,b=new WeakSet,A={schedule:(e,g=!1,A=!1)=>{let k=A&&f,M=k?r:h;return g&&b.add(e),M.add(e)&&k&&f&&(d=r.order.length),e},cancel:e=>{h.remove(e),b.delete(e)},process:k=>{if(f){g=!0;return}if(f=!0,[r,h]=[h,r],h.clear(),d=r.order.length)for(let h=0;h<d;h++){let d=r.order[h];d(k),b.has(d)&&(A.schedule(d),e())}f=!1,g&&(g=!1,A.process(k))}};return A}(()=>h=!0),e),{}),processStep=e=>b[e].process(g),processBatch=()=>{let b=performance.now();h=!1,g.delta=d?1e3/60:Math.max(Math.min(b-g.timestamp,40),1),g.timestamp=b,g.isProcessing=!0,f.forEach(processStep),g.isProcessing=!1,h&&r&&(d=!1,e(processBatch))},wake=()=>{h=!0,d=!0,g.isProcessing||e(processBatch)},A=f.reduce((e,r)=>{let d=b[r];return e[r]=(e,r=!1,f=!1)=>(h||wake(),d.schedule(e,r,f)),e},{});return{schedule:A,cancel:e=>f.forEach(r=>b[r].cancel(e)),state:g,steps:b}}("undefined"!=typeof requestAnimationFrame?requestAnimationFrame:d.Z,!0)},3495:function(e,r,h){"use strict";let d;h.d(r,{E:function(){return t9}});var f,g,b=h(7294);let A=(0,b.createContext)({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"}),k=(0,b.createContext)({});var M=h(240),j=h(8868);let q=(0,b.createContext)({strict:!1}),camelToDash=e=>e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),ee="data-"+camelToDash("framerAppearId");function isRefObject(e){return e&&"object"==typeof e&&Object.prototype.hasOwnProperty.call(e,"current")}function isVariantLabel(e){return"string"==typeof e||Array.isArray(e)}function isAnimationControls(e){return null!==e&&"object"==typeof e&&"function"==typeof e.start}let et=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],er=["initial",...et];function isControllingVariants(e){return isAnimationControls(e.animate)||er.some(r=>isVariantLabel(e[r]))}function isVariantNode(e){return!!(isControllingVariants(e)||e.variants)}function variantLabelsAsDependency(e){return Array.isArray(e)?e.join(" "):e}let en={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},ei={};for(let e in en)ei[e]={isEnabled:r=>en[e].some(e=>!!r[e])};var es=h(1741),eo=h(5364);let ea=(0,b.createContext)({}),el=Symbol.for("motionComponentSymbol"),eu=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function isSVGComponent(e){if("string"!=typeof e||e.includes("-"));else if(eu.indexOf(e)>-1||/[A-Z]/.test(e))return!0;return!1}let eh={},ed=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],em=new Set(ed);function isForcedMotionValue(e,{layout:r,layoutId:h}){return em.has(e)||e.startsWith("origin")||(r||void 0!==h)&&(!!eh[e]||"opacity"===e)}let isMotionValue=e=>!!(e&&e.getVelocity),ef={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},ep=ed.length,checkStringStartsWith=e=>r=>"string"==typeof r&&r.startsWith(e),e_=checkStringStartsWith("--"),eg=checkStringStartsWith("var(--"),getValueAsType=(e,r)=>r&&"number"==typeof e?r.transform(e):e,clamp=(e,r,h)=>Math.min(Math.max(h,e),r),ey={test:e=>"number"==typeof e,parse:parseFloat,transform:e=>e},ev={...ey,transform:e=>clamp(0,1,e)},eE={...ey,default:1},sanitize=e=>Math.round(1e5*e)/1e5,eT=/(-)?([\d]*\.?[\d])+/g,eI=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,eP=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function isString(e){return"string"==typeof e}let createUnitType=e=>({test:r=>isString(r)&&r.endsWith(e)&&1===r.split(" ").length,parse:parseFloat,transform:r=>`${r}${e}`}),eA=createUnitType("deg"),eR=createUnitType("%"),ew=createUnitType("px"),eV=createUnitType("vh"),eS=createUnitType("vw"),eC={...eR,parse:e=>eR.parse(e)/100,transform:e=>eR.transform(100*e)},ex={...ey,transform:Math.round},ek={borderWidth:ew,borderTopWidth:ew,borderRightWidth:ew,borderBottomWidth:ew,borderLeftWidth:ew,borderRadius:ew,radius:ew,borderTopLeftRadius:ew,borderTopRightRadius:ew,borderBottomRightRadius:ew,borderBottomLeftRadius:ew,width:ew,maxWidth:ew,height:ew,maxHeight:ew,size:ew,top:ew,right:ew,bottom:ew,left:ew,padding:ew,paddingTop:ew,paddingRight:ew,paddingBottom:ew,paddingLeft:ew,margin:ew,marginTop:ew,marginRight:ew,marginBottom:ew,marginLeft:ew,rotate:eA,rotateX:eA,rotateY:eA,rotateZ:eA,scale:eE,scaleX:eE,scaleY:eE,scaleZ:eE,skew:eA,skewX:eA,skewY:eA,distance:ew,translateX:ew,translateY:ew,translateZ:ew,x:ew,y:ew,z:ew,perspective:ew,transformPerspective:ew,opacity:ev,originX:eC,originY:eC,originZ:ew,zIndex:ex,fillOpacity:ev,strokeOpacity:ev,numOctaves:ex};function buildHTMLStyles(e,r,h,d){let{style:f,vars:g,transform:b,transformOrigin:A}=e,k=!1,M=!1,j=!0;for(let e in r){let h=r[e];if(e_(e)){g[e]=h;continue}let d=ek[e],q=getValueAsType(h,d);if(em.has(e)){if(k=!0,b[e]=q,!j)continue;h!==(d.default||0)&&(j=!1)}else e.startsWith("origin")?(M=!0,A[e]=q):f[e]=q}if(!r.transform&&(k||d?f.transform=function(e,{enableHardwareAcceleration:r=!0,allowTransformNone:h=!0},d,f){let g="";for(let r=0;r<ep;r++){let h=ed[r];if(void 0!==e[h]){let r=ef[h]||h;g+=`${r}(${e[h]}) `}}return r&&!e.z&&(g+="translateZ(0)"),g=g.trim(),f?g=f(e,d?"":g):h&&d&&(g="none"),g}(e.transform,h,j,d):f.transform&&(f.transform="none")),M){let{originX:e="50%",originY:r="50%",originZ:h=0}=A;f.transformOrigin=`${e} ${r} ${h}`}}let createHtmlRenderState=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function copyRawValuesOnly(e,r,h){for(let d in r)isMotionValue(r[d])||isForcedMotionValue(d,h)||(e[d]=r[d])}function useHTMLProps(e,r,h){let d={},f=function(e,r,h){let d=e.style||{},f={};return copyRawValuesOnly(f,d,e),Object.assign(f,function({transformTemplate:e},r,h){return(0,b.useMemo)(()=>{let d=createHtmlRenderState();return buildHTMLStyles(d,r,{enableHardwareAcceleration:!h},e),Object.assign({},d.vars,d.style)},[r])}(e,r,h)),e.transformValues?e.transformValues(f):f}(e,r,h);return e.drag&&!1!==e.dragListener&&(d.draggable=!1,f.userSelect=f.WebkitUserSelect=f.WebkitTouchCallout="none",f.touchAction=!0===e.drag?"none":`pan-${"x"===e.drag?"y":"x"}`),void 0===e.tabIndex&&(e.onTap||e.onTapStart||e.whileTap)&&(d.tabIndex=0),d.style=f,d}let eD=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function isValidMotionProp(e){return e.startsWith("while")||e.startsWith("drag")&&"draggable"!==e||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||eD.has(e)}let shouldForward=e=>!isValidMotionProp(e);try{(f=require("@emotion/is-prop-valid").default)&&(shouldForward=e=>e.startsWith("on")?!isValidMotionProp(e):f(e))}catch(e){}function calcOrigin(e,r,h){return"string"==typeof e?e:ew.transform(r+h*e)}let eN={offset:"stroke-dashoffset",array:"stroke-dasharray"},eO={offset:"strokeDashoffset",array:"strokeDasharray"};function buildSVGAttrs(e,{attrX:r,attrY:h,attrScale:d,originX:f,originY:g,pathLength:b,pathSpacing:A=1,pathOffset:k=0,...M},j,q,ee){if(buildHTMLStyles(e,M,j,ee),q){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};let{attrs:et,style:er,dimensions:en}=e;et.transform&&(en&&(er.transform=et.transform),delete et.transform),en&&(void 0!==f||void 0!==g||er.transform)&&(er.transformOrigin=function(e,r,h){let d=calcOrigin(r,e.x,e.width),f=calcOrigin(h,e.y,e.height);return`${d} ${f}`}(en,void 0!==f?f:.5,void 0!==g?g:.5)),void 0!==r&&(et.x=r),void 0!==h&&(et.y=h),void 0!==d&&(et.scale=d),void 0!==b&&function(e,r,h=1,d=0,f=!0){e.pathLength=1;let g=f?eN:eO;e[g.offset]=ew.transform(-d);let b=ew.transform(r),A=ew.transform(h);e[g.array]=`${b} ${A}`}(et,b,A,k,!1)}let createSvgRenderState=()=>({...createHtmlRenderState(),attrs:{}}),isSVGTag=e=>"string"==typeof e&&"svg"===e.toLowerCase();function useSVGProps(e,r,h,d){let f=(0,b.useMemo)(()=>{let h=createSvgRenderState();return buildSVGAttrs(h,r,{enableHardwareAcceleration:!1},isSVGTag(d),e.transformTemplate),{...h.attrs,style:{...h.style}}},[r]);if(e.style){let r={};copyRawValuesOnly(r,e.style,e),f.style={...r,...f.style}}return f}function renderHTML(e,{style:r,vars:h},d,f){for(let g in Object.assign(e.style,r,f&&f.getProjectionStyles(d)),h)e.style.setProperty(g,h[g])}let eM=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function renderSVG(e,r,h,d){for(let h in renderHTML(e,r,void 0,d),r.attrs)e.setAttribute(eM.has(h)?h:camelToDash(h),r.attrs[h])}function scrapeMotionValuesFromProps(e,r){let{style:h}=e,d={};for(let f in h)(isMotionValue(h[f])||r.style&&isMotionValue(r.style[f])||isForcedMotionValue(f,e))&&(d[f]=h[f]);return d}function scrape_motion_values_scrapeMotionValuesFromProps(e,r){let h=scrapeMotionValuesFromProps(e,r);for(let d in e)if(isMotionValue(e[d])||isMotionValue(r[d])){let r=-1!==ed.indexOf(d)?"attr"+d.charAt(0).toUpperCase()+d.substring(1):d;h[r]=e[d]}return h}function resolveVariantFromProps(e,r,h,d={},f={}){return"function"==typeof r&&(r=r(void 0!==h?h:e.custom,d,f)),"string"==typeof r&&(r=e.variants&&e.variants[r]),"function"==typeof r&&(r=r(void 0!==h?h:e.custom,d,f)),r}var eL=h(6681);let isKeyframesTarget=e=>Array.isArray(e),isCustomValue=e=>!!(e&&"object"==typeof e&&e.mix&&e.toValue),resolveFinalValueInKeyframes=e=>isKeyframesTarget(e)?e[e.length-1]||0:e;function resolveMotionValue(e){let r=isMotionValue(e)?e.get():e;return isCustomValue(r)?r.toValue():r}let makeUseVisualState=e=>(r,h)=>{let d=(0,b.useContext)(k),f=(0,b.useContext)(M.O),make=()=>(function({scrapeMotionValuesFromProps:e,createRenderState:r,onMount:h},d,f,g){let b={latestValues:function(e,r,h,d){let f={},g=d(e,{});for(let e in g)f[e]=resolveMotionValue(g[e]);let{initial:b,animate:A}=e,k=isControllingVariants(e),M=isVariantNode(e);r&&M&&!k&&!1!==e.inherit&&(void 0===b&&(b=r.initial),void 0===A&&(A=r.animate));let j=!!h&&!1===h.initial;j=j||!1===b;let q=j?A:b;if(q&&"boolean"!=typeof q&&!isAnimationControls(q)){let r=Array.isArray(q)?q:[q];r.forEach(r=>{let h=resolveVariantFromProps(e,r);if(!h)return;let{transitionEnd:d,transition:g,...b}=h;for(let e in b){let r=b[e];if(Array.isArray(r)){let e=j?r.length-1:0;r=r[e]}null!==r&&(f[e]=r)}for(let e in d)f[e]=d[e]})}return f}(d,f,g,e),renderState:r()};return h&&(b.mount=e=>h(d,e,b)),b})(e,r,d,f);return h?make():(0,eL.h)(make)};var eF=h(2074);let eB={useVisualState:makeUseVisualState({scrapeMotionValuesFromProps:scrape_motion_values_scrapeMotionValuesFromProps,createRenderState:createSvgRenderState,onMount:(e,r,{renderState:h,latestValues:d})=>{eF.Wi.read(()=>{try{h.dimensions="function"==typeof r.getBBox?r.getBBox():r.getBoundingClientRect()}catch(e){h.dimensions={x:0,y:0,width:0,height:0}}}),eF.Wi.render(()=>{buildSVGAttrs(h,d,{enableHardwareAcceleration:!1},isSVGTag(r.tagName),e.transformTemplate),renderSVG(r,h)})}})},eU={useVisualState:makeUseVisualState({scrapeMotionValuesFromProps:scrapeMotionValuesFromProps,createRenderState:createHtmlRenderState})};function addDomEvent(e,r,h,d={passive:!0}){return e.addEventListener(r,h,d),()=>e.removeEventListener(r,h)}let isPrimaryPointer=e=>"mouse"===e.pointerType?"number"!=typeof e.button||e.button<=0:!1!==e.isPrimary;function extractEventInfo(e,r="page"){return{point:{x:e[r+"X"],y:e[r+"Y"]}}}let addPointerInfo=e=>r=>isPrimaryPointer(r)&&e(r,extractEventInfo(r));function addPointerEvent(e,r,h,d){return addDomEvent(e,r,addPointerInfo(h),d)}let combineFunctions=(e,r)=>h=>r(e(h)),pipe=(...e)=>e.reduce(combineFunctions);function createLock(e){let r=null;return()=>null===r&&(r=e,()=>{r=null})}let ej=createLock("dragHorizontal"),eq=createLock("dragVertical");function getGlobalLock(e){let r=!1;if("y"===e)r=eq();else if("x"===e)r=ej();else{let e=ej(),h=eq();e&&h?r=()=>{e(),h()}:(e&&e(),h&&h())}return r}function isDragActive(){let e=getGlobalLock(!0);return!e||(e(),!1)}let Feature=class Feature{constructor(e){this.isMounted=!1,this.node=e}update(){}};function addHoverEvent(e,r){let h="pointer"+(r?"enter":"leave"),d="onHover"+(r?"Start":"End");return addPointerEvent(e.current,h,(h,f)=>{if("touch"===h.pointerType||isDragActive())return;let g=e.getProps();e.animationState&&g.whileHover&&e.animationState.setActive("whileHover",r),g[d]&&eF.Wi.update(()=>g[d](h,f))},{passive:!e.getProps()[d]})}let isNodeOrChild=(e,r)=>!!r&&(e===r||isNodeOrChild(e,r.parentElement));var ez=h(1662);function fireSyntheticPointerEvent(e,r){if(!r)return;let h=new PointerEvent("pointer"+e);r(h,extractEventInfo(h))}let eW=new WeakMap,e$=new WeakMap,fireObserverCallback=e=>{let r=eW.get(e.target);r&&r(e)},fireAllObserverCallbacks=e=>{e.forEach(fireObserverCallback)},eK={some:0,all:1};function shallowCompare(e,r){if(!Array.isArray(r))return!1;let h=r.length;if(h!==e.length)return!1;for(let d=0;d<h;d++)if(r[d]!==e[d])return!1;return!0}function resolveVariant(e,r,h){let d=e.getProps();return resolveVariantFromProps(d,r,void 0!==h?h:d.custom,function(e){let r={};return e.values.forEach((e,h)=>r[h]=e.get()),r}(e),function(e){let r={};return e.values.forEach((e,h)=>r[h]=e.getVelocity()),r}(e))}var eH=h(5487);let secondsToMilliseconds=e=>1e3*e,millisecondsToSeconds=e=>e/1e3,eG={current:!1},isBezierDefinition=e=>Array.isArray(e)&&"number"==typeof e[0],cubicBezierAsString=([e,r,h,d])=>`cubic-bezier(${e}, ${r}, ${h}, ${d})`,eQ={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:cubicBezierAsString([0,.65,.55,1]),circOut:cubicBezierAsString([.55,0,1,.45]),backIn:cubicBezierAsString([.31,.01,.66,-.59]),backOut:cubicBezierAsString([.33,1.53,.69,.99])},calcBezier=(e,r,h)=>(((1-3*h+3*r)*e+(3*h-6*r))*e+3*r)*e;function cubicBezier(e,r,h,d){if(e===r&&h===d)return ez.Z;let getTForX=r=>(function(e,r,h,d,f){let g,b;let A=0;do(g=calcBezier(b=r+(h-r)/2,d,f)-e)>0?h=b:r=b;while(Math.abs(g)>1e-7&&++A<12);return b})(r,0,1,e,h);return e=>0===e||1===e?e:calcBezier(getTForX(e),r,d)}let eJ=cubicBezier(.42,0,1,1),eX=cubicBezier(0,0,.58,1),eY=cubicBezier(.42,0,.58,1),isEasingArray=e=>Array.isArray(e)&&"number"!=typeof e[0],mirrorEasing=e=>r=>r<=.5?e(2*r)/2:(2-e(2*(1-r)))/2,reverseEasing=e=>r=>1-e(1-r),circIn=e=>1-Math.sin(Math.acos(e)),eZ=reverseEasing(circIn),e0=mirrorEasing(circIn),e1=cubicBezier(.33,1.53,.69,.99),e4=reverseEasing(e1),e2=mirrorEasing(e4),e3={linear:ez.Z,easeIn:eJ,easeInOut:eY,easeOut:eX,circIn:circIn,circInOut:e0,circOut:eZ,backIn:e4,backInOut:e2,backOut:e1,anticipate:e=>(e*=2)<1?.5*e4(e):.5*(2-Math.pow(2,-10*(e-1)))},easingDefinitionToFunction=e=>{if(Array.isArray(e)){(0,eH.k)(4===e.length,"Cubic bezier arrays must contain four numerical values.");let[r,h,d,f]=e;return cubicBezier(r,h,d,f)}return"string"==typeof e?((0,eH.k)(void 0!==e3[e],`Invalid easing type '${e}'`),e3[e]):e},isColorString=(e,r)=>h=>!!(isString(h)&&eP.test(h)&&h.startsWith(e)||r&&Object.prototype.hasOwnProperty.call(h,r)),splitColor=(e,r,h)=>d=>{if(!isString(d))return d;let[f,g,b,A]=d.match(eT);return{[e]:parseFloat(f),[r]:parseFloat(g),[h]:parseFloat(b),alpha:void 0!==A?parseFloat(A):1}},clampRgbUnit=e=>clamp(0,255,e),e9={...ey,transform:e=>Math.round(clampRgbUnit(e))},e6={test:isColorString("rgb","red"),parse:splitColor("red","green","blue"),transform:({red:e,green:r,blue:h,alpha:d=1})=>"rgba("+e9.transform(e)+", "+e9.transform(r)+", "+e9.transform(h)+", "+sanitize(ev.transform(d))+")"},e5={test:isColorString("#"),parse:function(e){let r="",h="",d="",f="";return e.length>5?(r=e.substring(1,3),h=e.substring(3,5),d=e.substring(5,7),f=e.substring(7,9)):(r=e.substring(1,2),h=e.substring(2,3),d=e.substring(3,4),f=e.substring(4,5),r+=r,h+=h,d+=d,f+=f),{red:parseInt(r,16),green:parseInt(h,16),blue:parseInt(d,16),alpha:f?parseInt(f,16)/255:1}},transform:e6.transform},e7={test:isColorString("hsl","hue"),parse:splitColor("hue","saturation","lightness"),transform:({hue:e,saturation:r,lightness:h,alpha:d=1})=>"hsla("+Math.round(e)+", "+eR.transform(sanitize(r))+", "+eR.transform(sanitize(h))+", "+sanitize(ev.transform(d))+")"},e8={test:e=>e6.test(e)||e5.test(e)||e7.test(e),parse:e=>e6.test(e)?e6.parse(e):e7.test(e)?e7.parse(e):e5.parse(e),transform:e=>isString(e)?e:e.hasOwnProperty("red")?e6.transform(e):e7.transform(e)},mix=(e,r,h)=>-h*e+h*r+e;function hueToRgb(e,r,h){return(h<0&&(h+=1),h>1&&(h-=1),h<1/6)?e+(r-e)*6*h:h<.5?r:h<2/3?e+(r-e)*(2/3-h)*6:e}let mixLinearColor=(e,r,h)=>{let d=e*e;return Math.sqrt(Math.max(0,h*(r*r-d)+d))},te=[e5,e6,e7],getColorType=e=>te.find(r=>r.test(e));function asRGBA(e){let r=getColorType(e);(0,eH.k)(!!r,`'${e}' is not an animatable color. Use the equivalent color code instead.`);let h=r.parse(e);return r===e7&&(h=function({hue:e,saturation:r,lightness:h,alpha:d}){e/=360,h/=100;let f=0,g=0,b=0;if(r/=100){let d=h<.5?h*(1+r):h+r-h*r,A=2*h-d;f=hueToRgb(A,d,e+1/3),g=hueToRgb(A,d,e),b=hueToRgb(A,d,e-1/3)}else f=g=b=h;return{red:Math.round(255*f),green:Math.round(255*g),blue:Math.round(255*b),alpha:d}}(h)),h}let mixColor=(e,r)=>{let h=asRGBA(e),d=asRGBA(r),f={...h};return e=>(f.red=mixLinearColor(h.red,d.red,e),f.green=mixLinearColor(h.green,d.green,e),f.blue=mixLinearColor(h.blue,d.blue,e),f.alpha=mix(h.alpha,d.alpha,e),e6.transform(f))},tt={regex:/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,countKey:"Vars",token:"${v}",parse:ez.Z},tr={regex:eI,countKey:"Colors",token:"${c}",parse:e8.parse},tn={regex:eT,countKey:"Numbers",token:"${n}",parse:ey.parse};function tokenise(e,{regex:r,countKey:h,token:d,parse:f}){let g=e.tokenised.match(r);g&&(e["num"+h]=g.length,e.tokenised=e.tokenised.replace(r,d),e.values.push(...g.map(f)))}function analyseComplexValue(e){let r=e.toString(),h={value:r,tokenised:r,values:[],numVars:0,numColors:0,numNumbers:0};return h.value.includes("var(--")&&tokenise(h,tt),tokenise(h,tr),tokenise(h,tn),h}function parseComplexValue(e){return analyseComplexValue(e).values}function createTransformer(e){let{values:r,numColors:h,numVars:d,tokenised:f}=analyseComplexValue(e),g=r.length;return e=>{let r=f;for(let f=0;f<g;f++)r=f<d?r.replace(tt.token,e[f]):f<d+h?r.replace(tr.token,e8.transform(e[f])):r.replace(tn.token,sanitize(e[f]));return r}}let convertNumbersToZero=e=>"number"==typeof e?0:e,ti={test:function(e){var r,h;return isNaN(e)&&isString(e)&&((null===(r=e.match(eT))||void 0===r?void 0:r.length)||0)+((null===(h=e.match(eI))||void 0===h?void 0:h.length)||0)>0},parse:parseComplexValue,createTransformer,getAnimatableNone:function(e){let r=parseComplexValue(e),h=createTransformer(e);return h(r.map(convertNumbersToZero))}},mixImmediate=(e,r)=>h=>`${h>0?r:e}`;function getMixer(e,r){return"number"==typeof e?h=>mix(e,r,h):e8.test(e)?mixColor(e,r):e.startsWith("var(")?mixImmediate(e,r):mixComplex(e,r)}let mixArray=(e,r)=>{let h=[...e],d=h.length,f=e.map((e,h)=>getMixer(e,r[h]));return e=>{for(let r=0;r<d;r++)h[r]=f[r](e);return h}},mixObject=(e,r)=>{let h={...e,...r},d={};for(let f in h)void 0!==e[f]&&void 0!==r[f]&&(d[f]=getMixer(e[f],r[f]));return e=>{for(let r in d)h[r]=d[r](e);return h}},mixComplex=(e,r)=>{let h=ti.createTransformer(r),d=analyseComplexValue(e),f=analyseComplexValue(r),g=d.numVars===f.numVars&&d.numColors===f.numColors&&d.numNumbers>=f.numNumbers;return g?pipe(mixArray(d.values,f.values),h):((0,eH.K)(!0,`Complex values '${e}' and '${r}' too different to mix. Ensure all colors are of the same type, and that each contains the same quantity of number and color values. Falling back to instant transition.`),mixImmediate(e,r))},progress=(e,r,h)=>{let d=r-e;return 0===d?1:(h-e)/d},mixNumber=(e,r)=>h=>mix(e,r,h);function interpolate(e,r,{clamp:h=!0,ease:d,mixer:f}={}){let g=e.length;if((0,eH.k)(g===r.length,"Both input and output ranges must be the same length"),1===g)return()=>r[0];e[0]>e[g-1]&&(e=[...e].reverse(),r=[...r].reverse());let b=function(e,r,h){let d=[],f=h||function(e){if("number"==typeof e);else if("string"==typeof e)return e8.test(e)?mixColor:mixComplex;else if(Array.isArray(e))return mixArray;else if("object"==typeof e)return mixObject;return mixNumber}(e[0]),g=e.length-1;for(let h=0;h<g;h++){let g=f(e[h],e[h+1]);if(r){let e=Array.isArray(r)?r[h]||ez.Z:r;g=pipe(e,g)}d.push(g)}return d}(r,d,f),A=b.length,interpolator=r=>{let h=0;if(A>1)for(;h<e.length-2&&!(r<e[h+1]);h++);let d=progress(e[h],e[h+1],r);return b[h](d)};return h?r=>interpolator(clamp(e[0],e[g-1],r)):interpolator}function keyframes({duration:e=300,keyframes:r,times:h,ease:d="easeInOut"}){let f=isEasingArray(d)?d.map(easingDefinitionToFunction):easingDefinitionToFunction(d),g={done:!1,value:r[0]},b=(h&&h.length===r.length?h:function(e){let r=[0];return function(e,r){let h=e[e.length-1];for(let d=1;d<=r;d++){let f=progress(0,r,d);e.push(mix(h,1,f))}}(r,e.length-1),r}(r)).map(r=>r*e),A=interpolate(b,r,{ease:Array.isArray(f)?f:r.map(()=>f||eY).splice(0,r.length-1)});return{calculatedDuration:e,next:r=>(g.value=A(r),g.done=r>=e,g)}}function calcGeneratorVelocity(e,r,h){var d,f;let g=Math.max(r-5,0);return d=h-e(g),(f=r-g)?d*(1e3/f):0}function calcAngularFreq(e,r){return e*Math.sqrt(1-r*r)}let ts=["duration","bounce"],to=["stiffness","damping","mass"];function isSpringType(e,r){return r.some(r=>void 0!==e[r])}function spring({keyframes:e,restDelta:r,restSpeed:h,...d}){let f;let g=e[0],b=e[e.length-1],A={done:!1,value:g},{stiffness:k,damping:M,mass:j,duration:q,velocity:ee,isResolvedFromDuration:et}=function(e){let r={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...e};if(!isSpringType(e,to)&&isSpringType(e,ts)){let h=function({duration:e=800,bounce:r=.25,velocity:h=0,mass:d=1}){let f,g;(0,eH.K)(e<=secondsToMilliseconds(10),"Spring duration must be 10 seconds or less");let b=1-r;b=clamp(.05,1,b),e=clamp(.01,10,millisecondsToSeconds(e)),b<1?(f=r=>{let d=r*b,f=d*e,g=calcAngularFreq(r,b);return .001-(d-h)/g*Math.exp(-f)},g=r=>{let d=r*b,g=d*e,A=Math.pow(b,2)*Math.pow(r,2)*e,k=calcAngularFreq(Math.pow(r,2),b),M=-f(r)+.001>0?-1:1;return M*((g*h+h-A)*Math.exp(-g))/k}):(f=r=>{let d=Math.exp(-r*e),f=(r-h)*e+1;return -.001+d*f},g=r=>{let d=Math.exp(-r*e),f=(h-r)*(e*e);return d*f});let A=5/e,k=function(e,r,h){let d=h;for(let h=1;h<12;h++)d-=e(d)/r(d);return d}(f,g,A);if(e=secondsToMilliseconds(e),isNaN(k))return{stiffness:100,damping:10,duration:e};{let r=Math.pow(k,2)*d;return{stiffness:r,damping:2*b*Math.sqrt(d*r),duration:e}}}(e);(r={...r,...h,mass:1}).isResolvedFromDuration=!0}return r}({...d,velocity:-millisecondsToSeconds(d.velocity||0)}),er=ee||0,en=M/(2*Math.sqrt(k*j)),ei=b-g,es=millisecondsToSeconds(Math.sqrt(k/j)),eo=5>Math.abs(ei);if(h||(h=eo?.01:2),r||(r=eo?.005:.5),en<1){let e=calcAngularFreq(es,en);f=r=>{let h=Math.exp(-en*es*r);return b-h*((er+en*es*ei)/e*Math.sin(e*r)+ei*Math.cos(e*r))}}else if(1===en)f=e=>b-Math.exp(-es*e)*(ei+(er+es*ei)*e);else{let e=es*Math.sqrt(en*en-1);f=r=>{let h=Math.exp(-en*es*r),d=Math.min(e*r,300);return b-h*((er+en*es*ei)*Math.sinh(d)+e*ei*Math.cosh(d))/e}}return{calculatedDuration:et&&q||null,next:e=>{let d=f(e);if(et)A.done=e>=q;else{let g=er;0!==e&&(g=en<1?calcGeneratorVelocity(f,e,d):0);let k=Math.abs(g)<=h,M=Math.abs(b-d)<=r;A.done=k&&M}return A.value=A.done?b:d,A}}}function inertia({keyframes:e,velocity:r=0,power:h=.8,timeConstant:d=325,bounceDamping:f=10,bounceStiffness:g=500,modifyTarget:b,min:A,max:k,restDelta:M=.5,restSpeed:j}){let q,ee;let et=e[0],er={done:!1,value:et},isOutOfBounds=e=>void 0!==A&&e<A||void 0!==k&&e>k,nearestBoundary=e=>void 0===A?k:void 0===k?A:Math.abs(A-e)<Math.abs(k-e)?A:k,en=h*r,ei=et+en,es=void 0===b?ei:b(ei);es!==ei&&(en=es-et);let calcDelta=e=>-en*Math.exp(-e/d),calcLatest=e=>es+calcDelta(e),applyFriction=e=>{let r=calcDelta(e),h=calcLatest(e);er.done=Math.abs(r)<=M,er.value=er.done?es:h},checkCatchBoundary=e=>{isOutOfBounds(er.value)&&(q=e,ee=spring({keyframes:[er.value,nearestBoundary(er.value)],velocity:calcGeneratorVelocity(calcLatest,e,er.value),damping:f,stiffness:g,restDelta:M,restSpeed:j}))};return checkCatchBoundary(0),{calculatedDuration:null,next:e=>{let r=!1;return(ee||void 0!==q||(r=!0,applyFriction(e),checkCatchBoundary(e)),void 0!==q&&e>q)?ee.next(e-q):(r||applyFriction(e),er)}}}let frameloopDriver=e=>{let passTimestamp=({timestamp:r})=>e(r);return{start:()=>eF.Wi.update(passTimestamp,!0),stop:()=>(0,eF.Pn)(passTimestamp),now:()=>eF.frameData.isProcessing?eF.frameData.timestamp:performance.now()}};function calcGeneratorDuration(e){let r=0,h=e.next(r);for(;!h.done&&r<2e4;)r+=50,h=e.next(r);return r>=2e4?1/0:r}let tl={decay:inertia,inertia:inertia,tween:keyframes,keyframes:keyframes,spring:spring};function animateValue({autoplay:e=!0,delay:r=0,driver:h=frameloopDriver,keyframes:d,type:f="keyframes",repeat:g=0,repeatDelay:b=0,repeatType:A="loop",onPlay:k,onStop:M,onComplete:j,onUpdate:q,...ee}){let et,er,en,ei,es,eo=1,ea=!1,updateFinishedPromise=()=>{er=new Promise(e=>{et=e})};updateFinishedPromise();let el=tl[f]||keyframes;el!==keyframes&&"number"!=typeof d[0]&&(ei=interpolate([0,100],d,{clamp:!1}),d=[0,100]);let eu=el({...ee,keyframes:d});"mirror"===A&&(es=el({...ee,keyframes:[...d].reverse(),velocity:-(ee.velocity||0)}));let eh="idle",ed=null,em=null,ef=null;null===eu.calculatedDuration&&g&&(eu.calculatedDuration=calcGeneratorDuration(eu));let{calculatedDuration:ep}=eu,e_=1/0,eg=1/0;null!==ep&&(eg=(e_=ep+b)*(g+1)-b);let ey=0,tick=e=>{if(null===em)return;eo>0&&(em=Math.min(em,e)),eo<0&&(em=Math.min(e-eg/eo,em)),ey=null!==ed?ed:Math.round(e-em)*eo;let h=ey-r*(eo>=0?1:-1),f=eo>=0?h<0:h>eg;ey=Math.max(h,0),"finished"===eh&&null===ed&&(ey=eg);let k=ey,M=eu;if(g){let e=Math.min(ey,eg)/e_,r=Math.floor(e),h=e%1;!h&&e>=1&&(h=1),1===h&&r--,r=Math.min(r,g+1);let d=!!(r%2);d&&("reverse"===A?(h=1-h,b&&(h-=b/e_)):"mirror"===A&&(M=es)),k=clamp(0,1,h)*e_}let j=f?{done:!1,value:d[0]}:M.next(k);ei&&(j.value=ei(j.value));let{done:ee}=j;f||null===ep||(ee=eo>=0?ey>=eg:ey<=0);let et=null===ed&&("finished"===eh||"running"===eh&&ee);return q&&q(j.value),et&&finish(),j},stopAnimationDriver=()=>{en&&en.stop(),en=void 0},cancel=()=>{eh="idle",stopAnimationDriver(),et(),updateFinishedPromise(),em=ef=null},finish=()=>{eh="finished",j&&j(),stopAnimationDriver(),et()},play=()=>{if(ea)return;en||(en=h(tick));let e=en.now();k&&k(),null!==ed?em=e-ed:em&&"finished"!==eh||(em=e),"finished"===eh&&updateFinishedPromise(),ef=em,ed=null,eh="running",en.start()};e&&play();let ev={then:(e,r)=>er.then(e,r),get time(){return millisecondsToSeconds(ey)},set time(newTime){ey=newTime=secondsToMilliseconds(newTime),null===ed&&en&&0!==eo?em=en.now()-newTime/eo:ed=newTime},get duration(){let e=null===eu.calculatedDuration?calcGeneratorDuration(eu):eu.calculatedDuration;return millisecondsToSeconds(e)},get speed(){return eo},set speed(newSpeed){if(newSpeed===eo||!en)return;eo=newSpeed,ev.time=millisecondsToSeconds(ey)},get state(){return eh},play,pause:()=>{eh="paused",ed=ey},stop:()=>{ea=!0,"idle"!==eh&&(eh="idle",M&&M(),cancel())},cancel:()=>{null!==ef&&tick(ef),cancel()},complete:()=>{eh="finished"},sample:e=>(em=0,tick(e))};return ev}let tu=(g=()=>Object.hasOwnProperty.call(Element.prototype,"animate"),()=>(void 0===d&&(d=g()),d)),tc=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),requiresPregeneratedKeyframes=(e,r)=>"spring"===r.type||"backgroundColor"===e||!function isWaapiSupportedEasing(e){return!!(!e||"string"==typeof e&&eQ[e]||isBezierDefinition(e)||Array.isArray(e)&&e.every(isWaapiSupportedEasing))}(r.ease),th={type:"spring",stiffness:500,damping:25,restSpeed:10},criticallyDampedSpring=e=>({type:"spring",stiffness:550,damping:0===e?2*Math.sqrt(550):30,restSpeed:10}),td={type:"keyframes",duration:.8},tm={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},getDefaultTransition=(e,{keyframes:r})=>r.length>2?td:em.has(e)?e.startsWith("scale")?criticallyDampedSpring(r[1]):th:tm,isAnimatable=(e,r)=>"zIndex"!==e&&!!("number"==typeof r||Array.isArray(r)||"string"==typeof r&&(ti.test(r)||"0"===r)&&!r.startsWith("url(")),tf=new Set(["brightness","contrast","saturate","opacity"]);function applyDefaultFilter(e){let[r,h]=e.slice(0,-1).split("(");if("drop-shadow"===r)return e;let[d]=h.match(eT)||[];if(!d)return e;let f=h.replace(d,""),g=tf.has(r)?1:0;return d!==h&&(g*=100),r+"("+g+f+")"}let tp=/([a-z-]*)\(.*?\)/g,t_={...ti,getAnimatableNone:e=>{let r=e.match(tp);return r?r.map(applyDefaultFilter).join(" "):e}},tg={...ek,color:e8,backgroundColor:e8,outlineColor:e8,fill:e8,stroke:e8,borderColor:e8,borderTopColor:e8,borderRightColor:e8,borderBottomColor:e8,borderLeftColor:e8,filter:t_,WebkitFilter:t_},getDefaultValueType=e=>tg[e];function animatable_none_getAnimatableNone(e,r){let h=getDefaultValueType(e);return h!==t_&&(h=ti),h.getAnimatableNone?h.getAnimatableNone(r):void 0}let isZeroValueString=e=>/^0[^.\s]+$/.test(e);function getValueTransition(e,r){return e[r]||e.default||e}let ty={skipAnimations:!1},animateMotionValue=(e,r,h,d={})=>f=>{let g=getValueTransition(d,e)||{},b=g.delay||d.delay||0,{elapsed:A=0}=d;A-=secondsToMilliseconds(b);let k=function(e,r,h,d){let f,g;let b=isAnimatable(r,h);f=Array.isArray(h)?[...h]:[null,h];let A=void 0!==d.from?d.from:e.get(),k=[];for(let e=0;e<f.length;e++){var M;null===f[e]&&(f[e]=0===e?A:f[e-1]),("number"==typeof(M=f[e])?0===M:null!==M?"none"===M||"0"===M||isZeroValueString(M):void 0)&&k.push(e),"string"==typeof f[e]&&"none"!==f[e]&&"0"!==f[e]&&(g=f[e])}if(b&&k.length&&g)for(let e=0;e<k.length;e++){let h=k[e];f[h]=animatable_none_getAnimatableNone(r,g)}return f}(r,e,h,g),M=k[0],j=k[k.length-1],q=isAnimatable(e,M),ee=isAnimatable(e,j);(0,eH.K)(q===ee,`You are trying to animate ${e} from "${M}" to "${j}". ${M} is not an animatable value - to enable this animation set ${M} to a value animatable to ${j} via the \`style\` property.`);let et={keyframes:k,velocity:r.getVelocity(),ease:"easeOut",...g,delay:-A,onUpdate:e=>{r.set(e),g.onUpdate&&g.onUpdate(e)},onComplete:()=>{f(),g.onComplete&&g.onComplete()}};if(!function({when:e,delay:r,delayChildren:h,staggerChildren:d,staggerDirection:f,repeat:g,repeatType:b,repeatDelay:A,from:k,elapsed:M,...j}){return!!Object.keys(j).length}(g)&&(et={...et,...getDefaultTransition(e,et)}),et.duration&&(et.duration=secondsToMilliseconds(et.duration)),et.repeatDelay&&(et.repeatDelay=secondsToMilliseconds(et.repeatDelay)),!q||!ee||eG.current||!1===g.type||ty.skipAnimations)return function({keyframes:e,delay:r,onUpdate:h,onComplete:d}){let setValue=()=>(h&&h(e[e.length-1]),d&&d(),{time:0,speed:1,duration:0,play:ez.Z,pause:ez.Z,stop:ez.Z,then:e=>(e(),Promise.resolve()),cancel:ez.Z,complete:ez.Z});return r?animateValue({keyframes:[0,1],duration:0,delay:r,onComplete:setValue}):setValue()}(eG.current?{...et,delay:0}:et);if(!d.isHandoff&&r.owner&&r.owner.current instanceof HTMLElement&&!r.owner.getProps().onUpdate){let h=function(e,r,{onUpdate:h,onComplete:d,...f}){let g,b;let A=tu()&&tc.has(r)&&!f.repeatDelay&&"mirror"!==f.repeatType&&0!==f.damping&&"inertia"!==f.type;if(!A)return!1;let k=!1,M=!1,updateFinishedPromise=()=>{b=new Promise(e=>{g=e})};updateFinishedPromise();let{keyframes:j,duration:q=300,ease:ee,times:et}=f;if(requiresPregeneratedKeyframes(r,f)){let e=animateValue({...f,repeat:0,delay:0}),r={done:!1,value:j[0]},h=[],d=0;for(;!r.done&&d<2e4;)r=e.sample(d),h.push(r.value),d+=10;et=void 0,j=h,q=d-10,ee="linear"}let er=function(e,r,h,{delay:d=0,duration:f,repeat:g=0,repeatType:b="loop",ease:A,times:k}={}){let M={[r]:h};k&&(M.offset=k);let j=function mapEasingToNativeEasing(e){if(e)return isBezierDefinition(e)?cubicBezierAsString(e):Array.isArray(e)?e.map(mapEasingToNativeEasing):eQ[e]}(A);return Array.isArray(j)&&(M.easing=j),e.animate(M,{delay:d,duration:f,easing:Array.isArray(j)?"linear":j,fill:"both",iterations:g+1,direction:"reverse"===b?"alternate":"normal"})}(e.owner.current,r,j,{...f,duration:q,ease:ee,times:et}),cancelAnimation=()=>{M=!1,er.cancel()},safeCancel=()=>{M=!0,eF.Wi.update(cancelAnimation),g(),updateFinishedPromise()};return er.onfinish=()=>{M||(e.set(function(e,{repeat:r,repeatType:h="loop"}){let d=r&&"loop"!==h&&r%2==1?0:e.length-1;return e[d]}(j,f)),d&&d(),safeCancel())},{then:(e,r)=>b.then(e,r),attachTimeline:e=>(er.timeline=e,er.onfinish=null,ez.Z),get time(){return millisecondsToSeconds(er.currentTime||0)},set time(newTime){er.currentTime=secondsToMilliseconds(newTime)},get speed(){return er.playbackRate},set speed(newSpeed){er.playbackRate=newSpeed},get duration(){return millisecondsToSeconds(q)},play:()=>{k||(er.play(),(0,eF.Pn)(cancelAnimation))},pause:()=>er.pause(),stop:()=>{if(k=!0,"idle"===er.playState)return;let{currentTime:r}=er;if(r){let h=animateValue({...f,autoplay:!1});e.setWithVelocity(h.sample(r-10).value,h.sample(r).value,10)}safeCancel()},complete:()=>{M||er.finish()},cancel:safeCancel}}(r,e,et);if(h)return h}return animateValue(et)};function isWillChangeMotionValue(e){return!!(isMotionValue(e)&&e.add)}let isNumericalString=e=>/^\-?\d*\.?\d+$/.test(e);function addUniqueItem(e,r){-1===e.indexOf(r)&&e.push(r)}function removeItem(e,r){let h=e.indexOf(r);h>-1&&e.splice(h,1)}let SubscriptionManager=class SubscriptionManager{constructor(){this.subscriptions=[]}add(e){return addUniqueItem(this.subscriptions,e),()=>removeItem(this.subscriptions,e)}notify(e,r,h){let d=this.subscriptions.length;if(d){if(1===d)this.subscriptions[0](e,r,h);else for(let f=0;f<d;f++){let d=this.subscriptions[f];d&&d(e,r,h)}}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}};let isFloat=e=>!isNaN(parseFloat(e)),tv={current:void 0};let MotionValue=class MotionValue{constructor(e,r={}){this.version="10.18.0",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(e,r=!0)=>{this.prev=this.current,this.current=e;let{delta:h,timestamp:d}=eF.frameData;this.lastUpdated!==d&&(this.timeDelta=h,this.lastUpdated=d,eF.Wi.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),r&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>eF.Wi.postRender(this.velocityCheck),this.velocityCheck=({timestamp:e})=>{e!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=e,this.canTrackVelocity=isFloat(this.current),this.owner=r.owner}onChange(e){return this.on("change",e)}on(e,r){this.events[e]||(this.events[e]=new SubscriptionManager);let h=this.events[e].add(r);return"change"===e?()=>{h(),eF.Wi.read(()=>{this.events.change.getSize()||this.stop()})}:h}clearListeners(){for(let e in this.events)this.events[e].clear()}attach(e,r){this.passiveEffect=e,this.stopPassiveEffect=r}set(e,r=!0){r&&this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e,r)}setWithVelocity(e,r,h){this.set(r),this.prev=e,this.timeDelta=h}jump(e){this.updateAndNotify(e),this.prev=e,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return tv.current&&tv.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){var e,r;return this.canTrackVelocity?(e=parseFloat(this.current)-parseFloat(this.prev),(r=this.timeDelta)?e*(1e3/r):0):0}start(e){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=e(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}};function motionValue(e,r){return new MotionValue(e,r)}let testValueType=e=>r=>r.test(e),tb=[ey,ew,eR,eA,eS,eV,{test:e=>"auto"===e,parse:e=>e}],findDimensionValueType=e=>tb.find(testValueType(e)),tE=[...tb,e8,ti],findValueType=e=>tE.find(testValueType(e));function animateTarget(e,r,{delay:h=0,transitionOverride:d,type:f}={}){let{transition:g=e.getDefaultTransition(),transitionEnd:b,...A}=e.makeTargetAnimatable(r),k=e.getValue("willChange");d&&(g=d);let M=[],j=f&&e.animationState&&e.animationState.getState()[f];for(let r in A){let d=e.getValue(r),f=A[r];if(!d||void 0===f||j&&function({protectedKeys:e,needsAnimating:r},h){let d=e.hasOwnProperty(h)&&!0!==r[h];return r[h]=!1,d}(j,r))continue;let b={delay:h,elapsed:0,...getValueTransition(g||{},r)};if(window.HandoffAppearAnimations){let h=e.getProps()[ee];if(h){let e=window.HandoffAppearAnimations(h,r,d,eF.Wi);null!==e&&(b.elapsed=e,b.isHandoff=!0)}}let q=!b.isHandoff&&!function(e,r){let h=e.get();if(!Array.isArray(r))return h!==r;for(let e=0;e<r.length;e++)if(r[e]!==h)return!0}(d,f);if("spring"===b.type&&(d.getVelocity()||b.velocity)&&(q=!1),d.animation&&(q=!1),q)continue;d.start(animateMotionValue(r,d,f,e.shouldReduceMotion&&em.has(r)?{type:!1}:b));let et=d.animation;isWillChangeMotionValue(k)&&(k.add(r),et.then(()=>k.remove(r))),M.push(et)}return b&&Promise.all(M).then(()=>{b&&function(e,r){let h=resolveVariant(e,r),{transitionEnd:d={},transition:f={},...g}=h?e.makeTargetAnimatable(h,!1):{};for(let r in g={...g,...d}){let h=resolveFinalValueInKeyframes(g[r]);e.hasValue(r)?e.getValue(r).set(h):e.addValue(r,motionValue(h))}}(e,b)}),M}function animateVariant(e,r,h={}){let d=resolveVariant(e,r,h.custom),{transition:f=e.getDefaultTransition()||{}}=d||{};h.transitionOverride&&(f=h.transitionOverride);let g=d?()=>Promise.all(animateTarget(e,d,h)):()=>Promise.resolve(),b=e.variantChildren&&e.variantChildren.size?(d=0)=>{let{delayChildren:g=0,staggerChildren:b,staggerDirection:A}=f;return function(e,r,h=0,d=0,f=1,g){let b=[],A=(e.variantChildren.size-1)*d,k=1===f?(e=0)=>e*d:(e=0)=>A-e*d;return Array.from(e.variantChildren).sort(sortByTreeOrder).forEach((e,d)=>{e.notify("AnimationStart",r),b.push(animateVariant(e,r,{...g,delay:h+k(d)}).then(()=>e.notify("AnimationComplete",r)))}),Promise.all(b)}(e,r,g+d,b,A,h)}:()=>Promise.resolve(),{when:A}=f;if(!A)return Promise.all([g(),b(h.delay)]);{let[e,r]="beforeChildren"===A?[g,b]:[b,g];return e().then(()=>r())}}function sortByTreeOrder(e,r){return e.sortNodePosition(r)}let tT=[...et].reverse(),tI=et.length;function createTypeState(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}let tP=0,distance=(e,r)=>Math.abs(e-r);let PanSession=class PanSession{constructor(e,r,{transformPagePoint:h,contextWindow:d,dragSnapToOrigin:f=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;let e=getPanInfo(this.lastMoveEventInfo,this.history),r=null!==this.startEvent,h=function(e,r){let h=distance(e.x,r.x),d=distance(e.y,r.y);return Math.sqrt(h**2+d**2)}(e.offset,{x:0,y:0})>=3;if(!r&&!h)return;let{point:d}=e,{timestamp:f}=eF.frameData;this.history.push({...d,timestamp:f});let{onStart:g,onMove:b}=this.handlers;r||(g&&g(this.lastMoveEvent,e),this.startEvent=this.lastMoveEvent),b&&b(this.lastMoveEvent,e)},this.handlePointerMove=(e,r)=>{this.lastMoveEvent=e,this.lastMoveEventInfo=transformPoint(r,this.transformPagePoint),eF.Wi.update(this.updatePoint,!0)},this.handlePointerUp=(e,r)=>{this.end();let{onEnd:h,onSessionEnd:d,resumeAnimation:f}=this.handlers;if(this.dragSnapToOrigin&&f&&f(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;let g=getPanInfo("pointercancel"===e.type?this.lastMoveEventInfo:transformPoint(r,this.transformPagePoint),this.history);this.startEvent&&h&&h(e,g),d&&d(e,g)},!isPrimaryPointer(e))return;this.dragSnapToOrigin=f,this.handlers=r,this.transformPagePoint=h,this.contextWindow=d||window;let g=extractEventInfo(e),b=transformPoint(g,this.transformPagePoint),{point:A}=b,{timestamp:k}=eF.frameData;this.history=[{...A,timestamp:k}];let{onSessionStart:M}=r;M&&M(e,getPanInfo(b,this.history)),this.removeListeners=pipe(addPointerEvent(this.contextWindow,"pointermove",this.handlePointerMove),addPointerEvent(this.contextWindow,"pointerup",this.handlePointerUp),addPointerEvent(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),(0,eF.Pn)(this.updatePoint)}};function transformPoint(e,r){return r?{point:r(e.point)}:e}function subtractPoint(e,r){return{x:e.x-r.x,y:e.y-r.y}}function getPanInfo({point:e},r){return{point:e,delta:subtractPoint(e,lastDevicePoint(r)),offset:subtractPoint(e,r[0]),velocity:function(e,r){if(e.length<2)return{x:0,y:0};let h=e.length-1,d=null,f=lastDevicePoint(e);for(;h>=0&&(d=e[h],!(f.timestamp-d.timestamp>secondsToMilliseconds(.1)));)h--;if(!d)return{x:0,y:0};let g=millisecondsToSeconds(f.timestamp-d.timestamp);if(0===g)return{x:0,y:0};let b={x:(f.x-d.x)/g,y:(f.y-d.y)/g};return b.x===1/0&&(b.x=0),b.y===1/0&&(b.y=0),b}(r,0)}}function lastDevicePoint(e){return e[e.length-1]}function calcLength(e){return e.max-e.min}function isNear(e,r=0,h=.01){return Math.abs(e-r)<=h}function calcAxisDelta(e,r,h,d=.5){e.origin=d,e.originPoint=mix(r.min,r.max,e.origin),e.scale=calcLength(h)/calcLength(r),(isNear(e.scale,1,1e-4)||isNaN(e.scale))&&(e.scale=1),e.translate=mix(h.min,h.max,e.origin)-e.originPoint,(isNear(e.translate)||isNaN(e.translate))&&(e.translate=0)}function calcBoxDelta(e,r,h,d){calcAxisDelta(e.x,r.x,h.x,d?d.originX:void 0),calcAxisDelta(e.y,r.y,h.y,d?d.originY:void 0)}function calcRelativeAxis(e,r,h){e.min=h.min+r.min,e.max=e.min+calcLength(r)}function calcRelativeAxisPosition(e,r,h){e.min=r.min-h.min,e.max=e.min+calcLength(r)}function calcRelativePosition(e,r,h){calcRelativeAxisPosition(e.x,r.x,h.x),calcRelativeAxisPosition(e.y,r.y,h.y)}function calcRelativeAxisConstraints(e,r,h){return{min:void 0!==r?e.min+r:void 0,max:void 0!==h?e.max+h-(e.max-e.min):void 0}}function calcViewportAxisConstraints(e,r){let h=r.min-e.min,d=r.max-e.max;return r.max-r.min<e.max-e.min&&([h,d]=[d,h]),{min:h,max:d}}function resolveAxisElastic(e,r,h){return{min:resolvePointElastic(e,r),max:resolvePointElastic(e,h)}}function resolvePointElastic(e,r){return"number"==typeof e?e:e[r]||0}let createAxisDelta=()=>({translate:0,scale:1,origin:0,originPoint:0}),createDelta=()=>({x:createAxisDelta(),y:createAxisDelta()}),createAxis=()=>({min:0,max:0}),createBox=()=>({x:createAxis(),y:createAxis()});function eachAxis(e){return[e("x"),e("y")]}function convertBoundingBoxToBox({top:e,left:r,right:h,bottom:d}){return{x:{min:r,max:h},y:{min:e,max:d}}}function isIdentityScale(e){return void 0===e||1===e}function hasScale({scale:e,scaleX:r,scaleY:h}){return!isIdentityScale(e)||!isIdentityScale(r)||!isIdentityScale(h)}function hasTransform(e){return hasScale(e)||has2DTranslate(e)||e.z||e.rotate||e.rotateX||e.rotateY}function has2DTranslate(e){var r,h;return(r=e.x)&&"0%"!==r||(h=e.y)&&"0%"!==h}function applyPointDelta(e,r,h,d,f){return void 0!==f&&(e=d+f*(e-d)),d+h*(e-d)+r}function applyAxisDelta(e,r=0,h=1,d,f){e.min=applyPointDelta(e.min,r,h,d,f),e.max=applyPointDelta(e.max,r,h,d,f)}function applyBoxDelta(e,{x:r,y:h}){applyAxisDelta(e.x,r.translate,r.scale,r.originPoint),applyAxisDelta(e.y,h.translate,h.scale,h.originPoint)}function snapToDefault(e){return Number.isInteger(e)?e:e>1.0000000000001||e<.999999999999?e:1}function translateAxis(e,r){e.min=e.min+r,e.max=e.max+r}function transformAxis(e,r,[h,d,f]){let g=void 0!==r[f]?r[f]:.5,b=mix(e.min,e.max,g);applyAxisDelta(e,r[h],r[d],b,r.scale)}let tA=["x","scaleX","originX"],tR=["y","scaleY","originY"];function transformBox(e,r){transformAxis(e.x,r,tA),transformAxis(e.y,r,tR)}function measureViewportBox(e,r){return convertBoundingBoxToBox(function(e,r){if(!r)return e;let h=r({x:e.left,y:e.top}),d=r({x:e.right,y:e.bottom});return{top:h.y,left:h.x,bottom:d.y,right:d.x}}(e.getBoundingClientRect(),r))}let getContextWindow=({current:e})=>e?e.ownerDocument.defaultView:null,tw=new WeakMap;let VisualElementDragControls=class VisualElementDragControls{constructor(e){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=createBox(),this.visualElement=e}start(e,{snapToCursor:r=!1}={}){let{presenceContext:h}=this.visualElement;if(h&&!1===h.isPresent)return;let{dragSnapToOrigin:d}=this.getProps();this.panSession=new PanSession(e,{onSessionStart:e=>{let{dragSnapToOrigin:h}=this.getProps();h?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(extractEventInfo(e,"page").point)},onStart:(e,r)=>{let{drag:h,dragPropagation:d,onDragStart:f}=this.getProps();if(h&&!d&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=getGlobalLock(h),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),eachAxis(e=>{let r=this.getAxisMotionValue(e).get()||0;if(eR.test(r)){let{projection:h}=this.visualElement;if(h&&h.layout){let d=h.layout.layoutBox[e];if(d){let e=calcLength(d);r=e*(parseFloat(r)/100)}}}this.originPoint[e]=r}),f&&eF.Wi.update(()=>f(e,r),!1,!0);let{animationState:g}=this.visualElement;g&&g.setActive("whileDrag",!0)},onMove:(e,r)=>{let{dragPropagation:h,dragDirectionLock:d,onDirectionLock:f,onDrag:g}=this.getProps();if(!h&&!this.openGlobalLock)return;let{offset:b}=r;if(d&&null===this.currentDirection){this.currentDirection=function(e,r=10){let h=null;return Math.abs(e.y)>r?h="y":Math.abs(e.x)>r&&(h="x"),h}(b),null!==this.currentDirection&&f&&f(this.currentDirection);return}this.updateAxis("x",r.point,b),this.updateAxis("y",r.point,b),this.visualElement.render(),g&&g(e,r)},onSessionEnd:(e,r)=>this.stop(e,r),resumeAnimation:()=>eachAxis(e=>{var r;return"paused"===this.getAnimationState(e)&&(null===(r=this.getAxisMotionValue(e).animation)||void 0===r?void 0:r.play())})},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:d,contextWindow:getContextWindow(this.visualElement)})}stop(e,r){let h=this.isDragging;if(this.cancel(),!h)return;let{velocity:d}=r;this.startAnimation(d);let{onDragEnd:f}=this.getProps();f&&eF.Wi.update(()=>f(e,r))}cancel(){this.isDragging=!1;let{projection:e,animationState:r}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;let{dragPropagation:h}=this.getProps();!h&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(e,r,h){let{drag:d}=this.getProps();if(!h||!shouldDrag(e,d,this.currentDirection))return;let f=this.getAxisMotionValue(e),g=this.originPoint[e]+h[e];this.constraints&&this.constraints[e]&&(g=function(e,{min:r,max:h},d){return void 0!==r&&e<r?e=d?mix(r,e,d.min):Math.max(e,r):void 0!==h&&e>h&&(e=d?mix(h,e,d.max):Math.min(e,h)),e}(g,this.constraints[e],this.elastic[e])),f.set(g)}resolveConstraints(){var e;let{dragConstraints:r,dragElastic:h}=this.getProps(),d=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):null===(e=this.visualElement.projection)||void 0===e?void 0:e.layout,f=this.constraints;r&&isRefObject(r)?this.constraints||(this.constraints=this.resolveRefConstraints()):r&&d?this.constraints=function(e,{top:r,left:h,bottom:d,right:f}){return{x:calcRelativeAxisConstraints(e.x,h,f),y:calcRelativeAxisConstraints(e.y,r,d)}}(d.layoutBox,r):this.constraints=!1,this.elastic=function(e=.35){return!1===e?e=0:!0===e&&(e=.35),{x:resolveAxisElastic(e,"left","right"),y:resolveAxisElastic(e,"top","bottom")}}(h),f!==this.constraints&&d&&this.constraints&&!this.hasMutatedConstraints&&eachAxis(e=>{this.getAxisMotionValue(e)&&(this.constraints[e]=function(e,r){let h={};return void 0!==r.min&&(h.min=r.min-e.min),void 0!==r.max&&(h.max=r.max-e.min),h}(d.layoutBox[e],this.constraints[e]))})}resolveRefConstraints(){var e;let{dragConstraints:r,onMeasureDragConstraints:h}=this.getProps();if(!r||!isRefObject(r))return!1;let d=r.current;(0,eH.k)(null!==d,"If `dragConstraints` is set as a React ref, that ref must be passed to another component's `ref` prop.");let{projection:f}=this.visualElement;if(!f||!f.layout)return!1;let g=function(e,r,h){let d=measureViewportBox(e,h),{scroll:f}=r;return f&&(translateAxis(d.x,f.offset.x),translateAxis(d.y,f.offset.y)),d}(d,f.root,this.visualElement.getTransformPagePoint()),b={x:calcViewportAxisConstraints((e=f.layout.layoutBox).x,g.x),y:calcViewportAxisConstraints(e.y,g.y)};if(h){let e=h(function({x:e,y:r}){return{top:r.min,right:e.max,bottom:r.max,left:e.min}}(b));this.hasMutatedConstraints=!!e,e&&(b=convertBoundingBoxToBox(e))}return b}startAnimation(e){let{drag:r,dragMomentum:h,dragElastic:d,dragTransition:f,dragSnapToOrigin:g,onDragTransitionEnd:b}=this.getProps(),A=this.constraints||{},k=eachAxis(b=>{if(!shouldDrag(b,r,this.currentDirection))return;let k=A&&A[b]||{};g&&(k={min:0,max:0});let M={type:"inertia",velocity:h?e[b]:0,bounceStiffness:d?200:1e6,bounceDamping:d?40:1e7,timeConstant:750,restDelta:1,restSpeed:10,...f,...k};return this.startAxisValueAnimation(b,M)});return Promise.all(k).then(b)}startAxisValueAnimation(e,r){let h=this.getAxisMotionValue(e);return h.start(animateMotionValue(e,h,0,r))}stopAnimation(){eachAxis(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){eachAxis(e=>{var r;return null===(r=this.getAxisMotionValue(e).animation)||void 0===r?void 0:r.pause()})}getAnimationState(e){var r;return null===(r=this.getAxisMotionValue(e).animation)||void 0===r?void 0:r.state}getAxisMotionValue(e){let r="_drag"+e.toUpperCase(),h=this.visualElement.getProps(),d=h[r];return d||this.visualElement.getValue(e,(h.initial?h.initial[e]:void 0)||0)}snapToCursor(e){eachAxis(r=>{let{drag:h}=this.getProps();if(!shouldDrag(r,h,this.currentDirection))return;let{projection:d}=this.visualElement,f=this.getAxisMotionValue(r);if(d&&d.layout){let{min:h,max:g}=d.layout.layoutBox[r];f.set(e[r]-mix(h,g,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;let{drag:e,dragConstraints:r}=this.getProps(),{projection:h}=this.visualElement;if(!isRefObject(r)||!h||!this.constraints)return;this.stopAnimation();let d={x:0,y:0};eachAxis(e=>{let r=this.getAxisMotionValue(e);if(r){let h=r.get();d[e]=function(e,r){let h=.5,d=calcLength(e),f=calcLength(r);return f>d?h=progress(r.min,r.max-d,e.min):d>f&&(h=progress(e.min,e.max-f,r.min)),clamp(0,1,h)}({min:h,max:h},this.constraints[e])}});let{transformTemplate:f}=this.visualElement.getProps();this.visualElement.current.style.transform=f?f({},""):"none",h.root&&h.root.updateScroll(),h.updateLayout(),this.resolveConstraints(),eachAxis(r=>{if(!shouldDrag(r,e,null))return;let h=this.getAxisMotionValue(r),{min:f,max:g}=this.constraints[r];h.set(mix(f,g,d[r]))})}addListeners(){if(!this.visualElement.current)return;tw.set(this.visualElement,this);let e=this.visualElement.current,r=addPointerEvent(e,"pointerdown",e=>{let{drag:r,dragListener:h=!0}=this.getProps();r&&h&&this.start(e)}),measureDragConstraints=()=>{let{dragConstraints:e}=this.getProps();isRefObject(e)&&(this.constraints=this.resolveRefConstraints())},{projection:h}=this.visualElement,d=h.addEventListener("measure",measureDragConstraints);h&&!h.layout&&(h.root&&h.root.updateScroll(),h.updateLayout()),measureDragConstraints();let f=addDomEvent(window,"resize",()=>this.scalePositionWithinConstraints()),g=h.addEventListener("didUpdate",({delta:e,hasLayoutChanged:r})=>{this.isDragging&&r&&(eachAxis(r=>{let h=this.getAxisMotionValue(r);h&&(this.originPoint[r]+=e[r].translate,h.set(h.get()+e[r].translate))}),this.visualElement.render())});return()=>{f(),r(),d(),g&&g()}}getProps(){let e=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:h=!1,dragPropagation:d=!1,dragConstraints:f=!1,dragElastic:g=.35,dragMomentum:b=!0}=e;return{...e,drag:r,dragDirectionLock:h,dragPropagation:d,dragConstraints:f,dragElastic:g,dragMomentum:b}}};function shouldDrag(e,r,h){return(!0===r||r===e)&&(null===h||h===e)}let asyncHandler=e=>(r,h)=>{e&&eF.Wi.update(()=>e(r,h))},tV={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function pixelsToPercent(e,r){return r.max===r.min?0:e/(r.max-r.min)*100}let tS={correct:(e,r)=>{if(!r.target)return e;if("string"==typeof e){if(!ew.test(e))return e;e=parseFloat(e)}let h=pixelsToPercent(e,r.target.x),d=pixelsToPercent(e,r.target.y);return`${h}% ${d}%`}};let MeasureLayoutWithContext=class MeasureLayoutWithContext extends b.Component{componentDidMount(){let{visualElement:e,layoutGroup:r,switchLayoutGroup:h,layoutId:d}=this.props,{projection:f}=e;Object.assign(eh,tC),f&&(r.group&&r.group.add(f),h&&h.register&&d&&h.register(f),f.root.didUpdate(),f.addEventListener("animationComplete",()=>{this.safeToRemove()}),f.setOptions({...f.options,onExitComplete:()=>this.safeToRemove()})),tV.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){let{layoutDependency:r,visualElement:h,drag:d,isPresent:f}=this.props,g=h.projection;return g&&(g.isPresent=f,d||e.layoutDependency!==r||void 0===r?g.willUpdate():this.safeToRemove(),e.isPresent===f||(f?g.promote():g.relegate()||eF.Wi.postRender(()=>{let e=g.getStack();e&&e.members.length||this.safeToRemove()}))),null}componentDidUpdate(){let{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),queueMicrotask(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){let{visualElement:e,layoutGroup:r,switchLayoutGroup:h}=this.props,{projection:d}=e;d&&(d.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(d),h&&h.deregister&&h.deregister(d))}safeToRemove(){let{safeToRemove:e}=this.props;e&&e()}render(){return null}};function MeasureLayout(e){let[r,h]=function(){let e=(0,b.useContext)(M.O);if(null===e)return[!0,null];let{isPresent:r,onExitComplete:h,register:d}=e,f=(0,b.useId)();return(0,b.useEffect)(()=>d(f),[]),!r&&h?[!1,()=>h&&h(f)]:[!0]}(),d=(0,b.useContext)(eo.p);return b.createElement(MeasureLayoutWithContext,{...e,layoutGroup:d,switchLayoutGroup:(0,b.useContext)(ea),isPresent:r,safeToRemove:h})}let tC={borderRadius:{...tS,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:tS,borderTopRightRadius:tS,borderBottomLeftRadius:tS,borderBottomRightRadius:tS,boxShadow:{correct:(e,{treeScale:r,projectionDelta:h})=>{let d=ti.parse(e);if(d.length>5)return e;let f=ti.createTransformer(e),g="number"!=typeof d[0]?1:0,b=h.x.scale*r.x,A=h.y.scale*r.y;d[0+g]/=b,d[1+g]/=A;let k=mix(b,A,.5);return"number"==typeof d[2+g]&&(d[2+g]/=k),"number"==typeof d[3+g]&&(d[3+g]/=k),f(d)}}},tx=["TopLeft","TopRight","BottomLeft","BottomRight"],tk=tx.length,asNumber=e=>"string"==typeof e?parseFloat(e):e,isPx=e=>"number"==typeof e||ew.test(e);function getRadius(e,r){return void 0!==e[r]?e[r]:e.borderRadius}let tD=compress(0,.5,eZ),tN=compress(.5,.95,ez.Z);function compress(e,r,h){return d=>d<e?0:d>r?1:h(progress(e,r,d))}function copyAxisInto(e,r){e.min=r.min,e.max=r.max}function copyBoxInto(e,r){copyAxisInto(e.x,r.x),copyAxisInto(e.y,r.y)}function removePointDelta(e,r,h,d,f){return e-=r,e=d+1/h*(e-d),void 0!==f&&(e=d+1/f*(e-d)),e}function removeAxisTransforms(e,r,[h,d,f],g,b){!function(e,r=0,h=1,d=.5,f,g=e,b=e){if(eR.test(r)){r=parseFloat(r);let e=mix(b.min,b.max,r/100);r=e-b.min}if("number"!=typeof r)return;let A=mix(g.min,g.max,d);e===g&&(A-=r),e.min=removePointDelta(e.min,r,h,A,f),e.max=removePointDelta(e.max,r,h,A,f)}(e,r[h],r[d],r[f],r.scale,g,b)}let tO=["x","scaleX","originX"],tM=["y","scaleY","originY"];function removeBoxTransforms(e,r,h,d){removeAxisTransforms(e.x,r,tO,h?h.x:void 0,d?d.x:void 0),removeAxisTransforms(e.y,r,tM,h?h.y:void 0,d?d.y:void 0)}function isAxisDeltaZero(e){return 0===e.translate&&1===e.scale}function isDeltaZero(e){return isAxisDeltaZero(e.x)&&isAxisDeltaZero(e.y)}function boxEqualsRounded(e,r){return Math.round(e.x.min)===Math.round(r.x.min)&&Math.round(e.x.max)===Math.round(r.x.max)&&Math.round(e.y.min)===Math.round(r.y.min)&&Math.round(e.y.max)===Math.round(r.y.max)}function aspectRatio(e){return calcLength(e.x)/calcLength(e.y)}let NodeStack=class NodeStack{constructor(){this.members=[]}add(e){addUniqueItem(this.members,e),e.scheduleRender()}remove(e){if(removeItem(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){let e=this.members[this.members.length-1];e&&this.promote(e)}}relegate(e){let r;let h=this.members.findIndex(r=>e===r);if(0===h)return!1;for(let e=h;e>=0;e--){let h=this.members[e];if(!1!==h.isPresent){r=h;break}}return!!r&&(this.promote(r),!0)}promote(e,r){let h=this.lead;if(e!==h&&(this.prevLead=h,this.lead=e,e.show(),h)){h.instance&&h.scheduleRender(),e.scheduleRender(),e.resumeFrom=h,r&&(e.resumeFrom.preserveOpacity=!0),h.snapshot&&(e.snapshot=h.snapshot,e.snapshot.latestValues=h.animationValues||h.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);let{crossfade:d}=e.options;!1===d&&h.hide()}}exitAnimationComplete(){this.members.forEach(e=>{let{options:r,resumingFrom:h}=e;r.onExitComplete&&r.onExitComplete(),h&&h.options.onExitComplete&&h.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}};function buildProjectionTransform(e,r,h){let d="",f=e.x.translate/r.x,g=e.y.translate/r.y;if((f||g)&&(d=`translate3d(${f}px, ${g}px, 0) `),(1!==r.x||1!==r.y)&&(d+=`scale(${1/r.x}, ${1/r.y}) `),h){let{rotate:e,rotateX:r,rotateY:f}=h;e&&(d+=`rotate(${e}deg) `),r&&(d+=`rotateX(${r}deg) `),f&&(d+=`rotateY(${f}deg) `)}let b=e.x.scale*r.x,A=e.y.scale*r.y;return(1!==b||1!==A)&&(d+=`scale(${b}, ${A})`),d||"none"}let compareByDepth=(e,r)=>e.depth-r.depth;let FlatTree=class FlatTree{constructor(){this.children=[],this.isDirty=!1}add(e){addUniqueItem(this.children,e),this.isDirty=!0}remove(e){removeItem(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(compareByDepth),this.isDirty=!1,this.children.forEach(e)}};let tL=["","X","Y","Z"],tF={visibility:"hidden"},tB=0,tU={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function createProjectionNode({attachResizeListener:e,defaultParent:r,measureScroll:h,checkIsScrollRoot:d,resetTransform:f}){return class{constructor(e={},h=null==r?void 0:r()){this.id=tB++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,tU.totalNodes=tU.resolvedTargetDeltas=tU.recalculatedProjection=0,this.nodes.forEach(propagateDirtyNodes),this.nodes.forEach(resolveTargetDelta),this.nodes.forEach(calcProjection),this.nodes.forEach(cleanDirtyNodes),window.MotionDebug&&window.MotionDebug.record(tU)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=e,this.root=h?h.root||h:this,this.path=h?[...h.path,h]:[],this.parent=h,this.depth=h?h.depth+1:0;for(let e=0;e<this.path.length;e++)this.path[e].shouldResetTransform=!0;this.root===this&&(this.nodes=new FlatTree)}addEventListener(e,r){return this.eventHandlers.has(e)||this.eventHandlers.set(e,new SubscriptionManager),this.eventHandlers.get(e).add(r)}notifyListeners(e,...r){let h=this.eventHandlers.get(e);h&&h.notify(...r)}hasListeners(e){return this.eventHandlers.has(e)}mount(r,h=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=r instanceof SVGElement&&"svg"!==r.tagName,this.instance=r;let{layoutId:d,layout:f,visualElement:g}=this.options;if(g&&!g.current&&g.mount(r),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),h&&(f||d)&&(this.isLayoutDirty=!0),e){let h;let resizeUnblockUpdate=()=>this.root.updateBlockedByResize=!1;e(r,()=>{this.root.updateBlockedByResize=!0,h&&h(),h=function(e,r){let h=performance.now(),checkElapsed=({timestamp:d})=>{let f=d-h;f>=r&&((0,eF.Pn)(checkElapsed),e(f-r))};return eF.Wi.read(checkElapsed,!0),()=>(0,eF.Pn)(checkElapsed)}(resizeUnblockUpdate,250),tV.hasAnimatedSinceResize&&(tV.hasAnimatedSinceResize=!1,this.nodes.forEach(finishAnimation))})}d&&this.root.registerSharedNode(d,this),!1!==this.options.animate&&g&&(d||f)&&this.addEventListener("didUpdate",({delta:e,hasLayoutChanged:r,hasRelativeTargetChanged:h,layout:d})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}let f=this.options.transition||g.getDefaultTransition()||tj,{onLayoutAnimationStart:b,onLayoutAnimationComplete:A}=g.getProps(),k=!this.targetLayout||!boxEqualsRounded(this.targetLayout,d)||h,M=!r&&h;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||M||r&&(k||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(e,M);let r={...getValueTransition(f,"layout"),onPlay:b,onComplete:A};(g.shouldReduceMotion||this.options.layoutRoot)&&(r.delay=0,r.type=!1),this.startAnimation(r)}else r||finishAnimation(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=d})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);let e=this.getStack();e&&e.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,(0,eF.Pn)(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){!this.isUpdateBlocked()&&(this.isUpdating=!0,this.nodes&&this.nodes.forEach(resetRotation),this.animationId++)}getTransformTemplate(){let{visualElement:e}=this.options;return e&&e.getProps().transformTemplate}willUpdate(e=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(this.root.isUpdating||this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let e=0;e<this.path.length;e++){let r=this.path[e];r.shouldResetTransform=!0,r.updateScroll("snapshot"),r.options.layoutRoot&&r.willUpdate(!1)}let{layoutId:r,layout:h}=this.options;if(void 0===r&&!h)return;let d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),e&&this.notifyListeners("willUpdate")}update(){this.updateScheduled=!1;let e=this.isUpdateBlocked();if(e){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(clearMeasurements);return}this.isUpdating||this.nodes.forEach(clearIsLayoutDirty),this.isUpdating=!1,this.nodes.forEach(resetTransformStyle),this.nodes.forEach(updateLayout),this.nodes.forEach(notifyLayoutUpdate),this.clearAllSnapshots();let r=performance.now();eF.frameData.delta=clamp(0,1e3/60,r-eF.frameData.timestamp),eF.frameData.timestamp=r,eF.frameData.isProcessing=!0,eF.S6.update.process(eF.frameData),eF.S6.preRender.process(eF.frameData),eF.S6.render.process(eF.frameData),eF.frameData.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(clearSnapshot),this.sharedNodes.forEach(removeLeadSnapshots)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,eF.Wi.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){eF.Wi.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){!this.snapshot&&this.instance&&(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let e=0;e<this.path.length;e++){let r=this.path[e];r.updateScroll()}let e=this.layout;this.layout=this.measure(!1),this.layoutCorrected=createBox(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);let{visualElement:r}=this.options;r&&r.notify("LayoutMeasure",this.layout.layoutBox,e?e.layoutBox:void 0)}updateScroll(e="measure"){let r=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===e&&(r=!1),r&&(this.scroll={animationId:this.root.animationId,phase:e,isRoot:d(this.instance),offset:h(this.instance)})}resetTransform(){if(!f)return;let e=this.isLayoutDirty||this.shouldResetTransform,r=this.projectionDelta&&!isDeltaZero(this.projectionDelta),h=this.getTransformTemplate(),d=h?h(this.latestValues,""):void 0,g=d!==this.prevTransformTemplateValue;e&&(r||hasTransform(this.latestValues)||g)&&(f(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(e=!0){var r;let h=this.measurePageBox(),d=this.removeElementScroll(h);return e&&(d=this.removeTransform(d)),roundAxis((r=d).x),roundAxis(r.y),{animationId:this.root.animationId,measuredBox:h,layoutBox:d,latestValues:{},source:this.id}}measurePageBox(){let{visualElement:e}=this.options;if(!e)return createBox();let r=e.measureViewportBox(),{scroll:h}=this.root;return h&&(translateAxis(r.x,h.offset.x),translateAxis(r.y,h.offset.y)),r}removeElementScroll(e){let r=createBox();copyBoxInto(r,e);for(let h=0;h<this.path.length;h++){let d=this.path[h],{scroll:f,options:g}=d;if(d!==this.root&&f&&g.layoutScroll){if(f.isRoot){copyBoxInto(r,e);let{scroll:h}=this.root;h&&(translateAxis(r.x,-h.offset.x),translateAxis(r.y,-h.offset.y))}translateAxis(r.x,f.offset.x),translateAxis(r.y,f.offset.y)}}return r}applyTransform(e,r=!1){let h=createBox();copyBoxInto(h,e);for(let e=0;e<this.path.length;e++){let d=this.path[e];!r&&d.options.layoutScroll&&d.scroll&&d!==d.root&&transformBox(h,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),hasTransform(d.latestValues)&&transformBox(h,d.latestValues)}return hasTransform(this.latestValues)&&transformBox(h,this.latestValues),h}removeTransform(e){let r=createBox();copyBoxInto(r,e);for(let e=0;e<this.path.length;e++){let h=this.path[e];if(!h.instance||!hasTransform(h.latestValues))continue;hasScale(h.latestValues)&&h.updateSnapshot();let d=createBox(),f=h.measurePageBox();copyBoxInto(d,f),removeBoxTransforms(r,h.latestValues,h.snapshot?h.snapshot.layoutBox:void 0,d)}return hasTransform(this.latestValues)&&removeBoxTransforms(r,this.latestValues),r}setTargetDelta(e){this.targetDelta=e,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(e){this.options={...this.options,...e,crossfade:void 0===e.crossfade||e.crossfade}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==eF.frameData.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(e=!1){var r,h,d,f;let g=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=g.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=g.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=g.isSharedProjectionDirty);let b=!!this.resumingFrom||this!==g,A=!(e||b&&this.isSharedProjectionDirty||this.isProjectionDirty||(null===(r=this.parent)||void 0===r?void 0:r.isProjectionDirty)||this.attemptToResolveRelativeTarget);if(A)return;let{layout:k,layoutId:M}=this.options;if(this.layout&&(k||M)){if(this.resolvedRelativeTargetAt=eF.frameData.timestamp,!this.targetDelta&&!this.relativeTarget){let e=this.getClosestProjectingParent();e&&e.layout&&1!==this.animationProgress?(this.relativeParent=e,this.forceRelativeParentToResolveTarget(),this.relativeTarget=createBox(),this.relativeTargetOrigin=createBox(),calcRelativePosition(this.relativeTargetOrigin,this.layout.layoutBox,e.layout.layoutBox),copyBoxInto(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(this.relativeTarget||this.targetDelta){if((this.target||(this.target=createBox(),this.targetWithTransforms=createBox()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target)?(this.forceRelativeParentToResolveTarget(),h=this.target,d=this.relativeTarget,f=this.relativeParent.target,calcRelativeAxis(h.x,d.x,f.x),calcRelativeAxis(h.y,d.y,f.y)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):copyBoxInto(this.target,this.layout.layoutBox),applyBoxDelta(this.target,this.targetDelta)):copyBoxInto(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;let e=this.getClosestProjectingParent();e&&!!e.resumingFrom==!!this.resumingFrom&&!e.options.layoutScroll&&e.target&&1!==this.animationProgress?(this.relativeParent=e,this.forceRelativeParentToResolveTarget(),this.relativeTarget=createBox(),this.relativeTargetOrigin=createBox(),calcRelativePosition(this.relativeTargetOrigin,this.target,e.target),copyBoxInto(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}tU.resolvedTargetDeltas++}}}getClosestProjectingParent(){return!this.parent||hasScale(this.parent.latestValues)||has2DTranslate(this.parent.latestValues)?void 0:this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var e;let r=this.getLead(),h=!!this.resumingFrom||this!==r,d=!0;if((this.isProjectionDirty||(null===(e=this.parent)||void 0===e?void 0:e.isProjectionDirty))&&(d=!1),h&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(d=!1),this.resolvedRelativeTargetAt===eF.frameData.timestamp&&(d=!1),d)return;let{layout:f,layoutId:g}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(f||g))return;copyBoxInto(this.layoutCorrected,this.layout.layoutBox);let b=this.treeScale.x,A=this.treeScale.y;!function(e,r,h,d=!1){let f,g;let b=h.length;if(b){r.x=r.y=1;for(let A=0;A<b;A++){g=(f=h[A]).projectionDelta;let b=f.instance;(!b||!b.style||"contents"!==b.style.display)&&(d&&f.options.layoutScroll&&f.scroll&&f!==f.root&&transformBox(e,{x:-f.scroll.offset.x,y:-f.scroll.offset.y}),g&&(r.x*=g.x.scale,r.y*=g.y.scale,applyBoxDelta(e,g)),d&&hasTransform(f.latestValues)&&transformBox(e,f.latestValues))}r.x=snapToDefault(r.x),r.y=snapToDefault(r.y)}}(this.layoutCorrected,this.treeScale,this.path,h),r.layout&&!r.target&&(1!==this.treeScale.x||1!==this.treeScale.y)&&(r.target=r.layout.layoutBox);let{target:k}=r;if(!k){this.projectionTransform&&(this.projectionDelta=createDelta(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=createDelta(),this.projectionDeltaWithTransform=createDelta());let M=this.projectionTransform;calcBoxDelta(this.projectionDelta,this.layoutCorrected,k,this.latestValues),this.projectionTransform=buildProjectionTransform(this.projectionDelta,this.treeScale),(this.projectionTransform!==M||this.treeScale.x!==b||this.treeScale.y!==A)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",k)),tU.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(e=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),e){let e=this.getStack();e&&e.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(e,r=!1){let h;let d=this.snapshot,f=d?d.latestValues:{},g={...this.latestValues},b=createDelta();this.relativeParent&&this.relativeParent.options.layoutRoot||(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!r;let A=createBox(),k=d?d.source:void 0,M=this.layout?this.layout.source:void 0,j=k!==M,q=this.getStack(),ee=!q||q.members.length<=1,et=!!(j&&!ee&&!0===this.options.crossfade&&!this.path.some(hasOpacityCrossfade));this.animationProgress=0,this.mixTargetDelta=r=>{let d=r/1e3;if(mixAxisDelta(b.x,e.x,d),mixAxisDelta(b.y,e.y,d),this.setTargetDelta(b),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout){var k,M,q,er;calcRelativePosition(A,this.layout.layoutBox,this.relativeParent.layout.layoutBox),q=this.relativeTarget,er=this.relativeTargetOrigin,mixAxis(q.x,er.x,A.x,d),mixAxis(q.y,er.y,A.y,d),h&&(k=this.relativeTarget,M=h,k.x.min===M.x.min&&k.x.max===M.x.max&&k.y.min===M.y.min&&k.y.max===M.y.max)&&(this.isProjectionDirty=!1),h||(h=createBox()),copyBoxInto(h,this.relativeTarget)}j&&(this.animationValues=g,function(e,r,h,d,f,g){f?(e.opacity=mix(0,void 0!==h.opacity?h.opacity:1,tD(d)),e.opacityExit=mix(void 0!==r.opacity?r.opacity:1,0,tN(d))):g&&(e.opacity=mix(void 0!==r.opacity?r.opacity:1,void 0!==h.opacity?h.opacity:1,d));for(let f=0;f<tk;f++){let g=`border${tx[f]}Radius`,b=getRadius(r,g),A=getRadius(h,g);if(void 0===b&&void 0===A)continue;b||(b=0),A||(A=0);let k=0===b||0===A||isPx(b)===isPx(A);k?(e[g]=Math.max(mix(asNumber(b),asNumber(A),d),0),(eR.test(A)||eR.test(b))&&(e[g]+="%")):e[g]=A}(r.rotate||h.rotate)&&(e.rotate=mix(r.rotate||0,h.rotate||0,d))}(g,f,this.latestValues,d,et,ee)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=d},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(e){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&((0,eF.Pn)(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=eF.Wi.update(()=>{tV.hasAnimatedSinceResize=!0,this.currentAnimation=function(e,r,h){let d=isMotionValue(e)?e:motionValue(e);return d.start(animateMotionValue("",d,1e3,h)),d.animation}(0,0,{...e,onUpdate:r=>{this.mixTargetDelta(r),e.onUpdate&&e.onUpdate(r)},onComplete:()=>{e.onComplete&&e.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);let e=this.getStack();e&&e.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(1e3),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){let e=this.getLead(),{targetWithTransforms:r,target:h,layout:d,latestValues:f}=e;if(r&&h&&d){if(this!==e&&this.layout&&d&&shouldAnimatePositionOnly(this.options.animationType,this.layout.layoutBox,d.layoutBox)){h=this.target||createBox();let r=calcLength(this.layout.layoutBox.x);h.x.min=e.target.x.min,h.x.max=h.x.min+r;let d=calcLength(this.layout.layoutBox.y);h.y.min=e.target.y.min,h.y.max=h.y.min+d}copyBoxInto(r,h),transformBox(r,f),calcBoxDelta(this.projectionDeltaWithTransform,this.layoutCorrected,r,f)}}registerSharedNode(e,r){this.sharedNodes.has(e)||this.sharedNodes.set(e,new NodeStack);let h=this.sharedNodes.get(e);h.add(r);let d=r.options.initialPromotionConfig;r.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(r):void 0})}isLead(){let e=this.getStack();return!e||e.lead===this}getLead(){var e;let{layoutId:r}=this.options;return r&&(null===(e=this.getStack())||void 0===e?void 0:e.lead)||this}getPrevLead(){var e;let{layoutId:r}=this.options;return r?null===(e=this.getStack())||void 0===e?void 0:e.prevLead:void 0}getStack(){let{layoutId:e}=this.options;if(e)return this.root.sharedNodes.get(e)}promote({needsReset:e,transition:r,preserveFollowOpacity:h}={}){let d=this.getStack();d&&d.promote(this,h),e&&(this.projectionDelta=void 0,this.needsReset=!0),r&&this.setOptions({transition:r})}relegate(){let e=this.getStack();return!!e&&e.relegate(this)}resetRotation(){let{visualElement:e}=this.options;if(!e)return;let r=!1,{latestValues:h}=e;if((h.rotate||h.rotateX||h.rotateY||h.rotateZ)&&(r=!0),!r)return;let d={};for(let r=0;r<tL.length;r++){let f="rotate"+tL[r];h[f]&&(d[f]=h[f],e.setStaticValue(f,0))}for(let r in e.render(),d)e.setStaticValue(r,d[r]);e.scheduleRender()}getProjectionStyles(e){var r,h;if(!this.instance||this.isSVG)return;if(!this.isVisible)return tF;let d={visibility:""},f=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,d.opacity="",d.pointerEvents=resolveMotionValue(null==e?void 0:e.pointerEvents)||"",d.transform=f?f(this.latestValues,""):"none",d;let g=this.getLead();if(!this.projectionDelta||!this.layout||!g.target){let r={};return this.options.layoutId&&(r.opacity=void 0!==this.latestValues.opacity?this.latestValues.opacity:1,r.pointerEvents=resolveMotionValue(null==e?void 0:e.pointerEvents)||""),this.hasProjected&&!hasTransform(this.latestValues)&&(r.transform=f?f({},""):"none",this.hasProjected=!1),r}let b=g.animationValues||g.latestValues;this.applyTransformsToTarget(),d.transform=buildProjectionTransform(this.projectionDeltaWithTransform,this.treeScale,b),f&&(d.transform=f(b,d.transform));let{x:A,y:k}=this.projectionDelta;for(let e in d.transformOrigin=`${100*A.origin}% ${100*k.origin}% 0`,g.animationValues?d.opacity=g===this?null!==(h=null!==(r=b.opacity)&&void 0!==r?r:this.latestValues.opacity)&&void 0!==h?h:1:this.preserveOpacity?this.latestValues.opacity:b.opacityExit:d.opacity=g===this?void 0!==b.opacity?b.opacity:"":void 0!==b.opacityExit?b.opacityExit:0,eh){if(void 0===b[e])continue;let{correct:r,applyTo:h}=eh[e],f="none"===d.transform?b[e]:r(b[e],g);if(h){let e=h.length;for(let r=0;r<e;r++)d[h[r]]=f}else d[e]=f}return this.options.layoutId&&(d.pointerEvents=g===this?resolveMotionValue(null==e?void 0:e.pointerEvents)||"":"none"),d}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(e=>{var r;return null===(r=e.currentAnimation)||void 0===r?void 0:r.stop()}),this.root.nodes.forEach(clearMeasurements),this.root.sharedNodes.clear()}}}function updateLayout(e){e.updateLayout()}function notifyLayoutUpdate(e){var r;let h=(null===(r=e.resumeFrom)||void 0===r?void 0:r.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&h&&e.hasListeners("didUpdate")){let{layoutBox:r,measuredBox:d}=e.layout,{animationType:f}=e.options,g=h.source!==e.layout.source;"size"===f?eachAxis(e=>{let d=g?h.measuredBox[e]:h.layoutBox[e],f=calcLength(d);d.min=r[e].min,d.max=d.min+f}):shouldAnimatePositionOnly(f,h.layoutBox,r)&&eachAxis(d=>{let f=g?h.measuredBox[d]:h.layoutBox[d],b=calcLength(r[d]);f.max=f.min+b,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[d].max=e.relativeTarget[d].min+b)});let b=createDelta();calcBoxDelta(b,r,h.layoutBox);let A=createDelta();g?calcBoxDelta(A,e.applyTransform(d,!0),h.measuredBox):calcBoxDelta(A,r,h.layoutBox);let k=!isDeltaZero(b),M=!1;if(!e.resumeFrom){let d=e.getClosestProjectingParent();if(d&&!d.resumeFrom){let{snapshot:f,layout:g}=d;if(f&&g){let b=createBox();calcRelativePosition(b,h.layoutBox,f.layoutBox);let A=createBox();calcRelativePosition(A,r,g.layoutBox),boxEqualsRounded(b,A)||(M=!0),d.options.layoutRoot&&(e.relativeTarget=A,e.relativeTargetOrigin=b,e.relativeParent=d)}}}e.notifyListeners("didUpdate",{layout:r,snapshot:h,delta:A,layoutDelta:b,hasLayoutChanged:k,hasRelativeTargetChanged:M})}else if(e.isLead()){let{onExitComplete:r}=e.options;r&&r()}e.options.transition=void 0}function propagateDirtyNodes(e){tU.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function cleanDirtyNodes(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function clearSnapshot(e){e.clearSnapshot()}function clearMeasurements(e){e.clearMeasurements()}function clearIsLayoutDirty(e){e.isLayoutDirty=!1}function resetTransformStyle(e){let{visualElement:r}=e.options;r&&r.getProps().onBeforeLayoutMeasure&&r.notify("BeforeLayoutMeasure"),e.resetTransform()}function finishAnimation(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function resolveTargetDelta(e){e.resolveTargetDelta()}function calcProjection(e){e.calcProjection()}function resetRotation(e){e.resetRotation()}function removeLeadSnapshots(e){e.removeLeadSnapshot()}function mixAxisDelta(e,r,h){e.translate=mix(r.translate,0,h),e.scale=mix(r.scale,1,h),e.origin=r.origin,e.originPoint=r.originPoint}function mixAxis(e,r,h,d){e.min=mix(r.min,h.min,d),e.max=mix(r.max,h.max,d)}function hasOpacityCrossfade(e){return e.animationValues&&void 0!==e.animationValues.opacityExit}let tj={duration:.45,ease:[.4,0,.1,1]},userAgentContains=e=>"undefined"!=typeof navigator&&navigator.userAgent.toLowerCase().includes(e),tq=userAgentContains("applewebkit/")&&!userAgentContains("chrome/")?Math.round:ez.Z;function roundAxis(e){e.min=tq(e.min),e.max=tq(e.max)}function shouldAnimatePositionOnly(e,r,h){return"position"===e||"preserve-aspect"===e&&!isNear(aspectRatio(r),aspectRatio(h),.2)}let tz=createProjectionNode({attachResizeListener:(e,r)=>addDomEvent(e,"resize",r),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),tW={current:void 0},t$=createProjectionNode({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!tW.current){let e=new tz({});e.mount(window),e.setOptions({layoutScroll:!0}),tW.current=e}return tW.current},resetTransform:(e,r)=>{e.style.transform=void 0!==r?r:"none"},checkIsScrollRoot:e=>"fixed"===window.getComputedStyle(e).position}),tK=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function getVariableValue(e,r,h=1){(0,eH.k)(h<=4,`Max CSS variable fallback depth detected in property "${e}". This may indicate a circular fallback dependency.`);let[d,f]=function(e){let r=tK.exec(e);if(!r)return[,];let[,h,d]=r;return[h,d]}(e);if(!d)return;let g=window.getComputedStyle(r).getPropertyValue(d);if(g){let e=g.trim();return isNumericalString(e)?parseFloat(e):e}return eg(f)?getVariableValue(f,r,h+1):f}let tH=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),isPositionalKey=e=>tH.has(e),hasPositionalKey=e=>Object.keys(e).some(isPositionalKey),isNumOrPxType=e=>e===ey||e===ew,getPosFromMatrix=(e,r)=>parseFloat(e.split(", ")[r]),getTranslateFromMatrix=(e,r)=>(h,{transform:d})=>{if("none"===d||!d)return 0;let f=d.match(/^matrix3d\((.+)\)$/);if(f)return getPosFromMatrix(f[1],r);{let r=d.match(/^matrix\((.+)\)$/);return r?getPosFromMatrix(r[1],e):0}},tG=new Set(["x","y","z"]),tQ=ed.filter(e=>!tG.has(e)),tJ={width:({x:e},{paddingLeft:r="0",paddingRight:h="0"})=>e.max-e.min-parseFloat(r)-parseFloat(h),height:({y:e},{paddingTop:r="0",paddingBottom:h="0"})=>e.max-e.min-parseFloat(r)-parseFloat(h),top:(e,{top:r})=>parseFloat(r),left:(e,{left:r})=>parseFloat(r),bottom:({y:e},{top:r})=>parseFloat(r)+(e.max-e.min),right:({x:e},{left:r})=>parseFloat(r)+(e.max-e.min),x:getTranslateFromMatrix(4,13),y:getTranslateFromMatrix(5,14)};tJ.translateX=tJ.x,tJ.translateY=tJ.y;let convertChangedValueTypes=(e,r,h)=>{let d=r.measureViewportBox(),f=r.current,g=getComputedStyle(f),{display:b}=g,A={};"none"===b&&r.setStaticValue("display",e.display||"block"),h.forEach(e=>{A[e]=tJ[e](d,g)}),r.render();let k=r.measureViewportBox();return h.forEach(h=>{let d=r.getValue(h);d&&d.jump(A[h]),e[h]=tJ[h](k,g)}),e},checkAndConvertChangedValueTypes=(e,r,h={},d={})=>{r={...r},d={...d};let f=Object.keys(r).filter(isPositionalKey),g=[],b=!1,A=[];if(f.forEach(f=>{let k;let M=e.getValue(f);if(!e.hasValue(f))return;let j=h[f],q=findDimensionValueType(j),ee=r[f];if(isKeyframesTarget(ee)){let e=ee.length,r=null===ee[0]?1:0;q=findDimensionValueType(j=ee[r]);for(let h=r;h<e&&null!==ee[h];h++)k?(0,eH.k)(findDimensionValueType(ee[h])===k,"All keyframes must be of the same type"):(k=findDimensionValueType(ee[h]),(0,eH.k)(k===q||isNumOrPxType(q)&&isNumOrPxType(k),"Keyframes must be of the same dimension as the current value"))}else k=findDimensionValueType(ee);if(q!==k){if(isNumOrPxType(q)&&isNumOrPxType(k)){let e=M.get();"string"==typeof e&&M.set(parseFloat(e)),"string"==typeof ee?r[f]=parseFloat(ee):Array.isArray(ee)&&k===ew&&(r[f]=ee.map(parseFloat))}else(null==q?void 0:q.transform)&&(null==k?void 0:k.transform)&&(0===j||0===ee)?0===j?M.set(k.transform(j)):r[f]=q.transform(ee):(b||(g=function(e){let r=[];return tQ.forEach(h=>{let d=e.getValue(h);void 0!==d&&(r.push([h,d.get()]),d.set(h.startsWith("scale")?1:0))}),r.length&&e.render(),r}(e),b=!0),A.push(f),d[f]=void 0!==d[f]?d[f]:r[f],M.jump(ee))}}),!A.length)return{target:r,transitionEnd:d};{let h=A.indexOf("height")>=0?window.pageYOffset:null,f=convertChangedValueTypes(r,e,A);return g.length&&g.forEach(([r,h])=>{e.getValue(r).set(h)}),e.render(),es.j&&null!==h&&window.scrollTo({top:h}),{target:f,transitionEnd:d}}},parseDomVariant=(e,r,h,d)=>{var f,g;let b=function(e,{...r},h){let d=e.current;if(!(d instanceof Element))return{target:r,transitionEnd:h};for(let f in h&&(h={...h}),e.values.forEach(e=>{let r=e.get();if(!eg(r))return;let h=getVariableValue(r,d);h&&e.set(h)}),r){let e=r[f];if(!eg(e))continue;let g=getVariableValue(e,d);g&&(r[f]=g,h||(h={}),void 0===h[f]&&(h[f]=e))}return{target:r,transitionEnd:h}}(e,r,d);return r=b.target,d=b.transitionEnd,f=r,g=d,hasPositionalKey(f)?checkAndConvertChangedValueTypes(e,f,h,g):{target:f,transitionEnd:g}},tX={current:null},tY={current:!1},tZ=new WeakMap,t0=Object.keys(ei),t1=t0.length,t4=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],t2=er.length;let VisualElement=class VisualElement{constructor({parent:e,props:r,presenceContext:h,reducedMotionConfig:d,visualState:f},g={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>eF.Wi.render(this.render,!1,!0);let{latestValues:b,renderState:A}=f;this.latestValues=b,this.baseTarget={...b},this.initialValues=r.initial?{...b}:{},this.renderState=A,this.parent=e,this.props=r,this.presenceContext=h,this.depth=e?e.depth+1:0,this.reducedMotionConfig=d,this.options=g,this.isControllingVariants=isControllingVariants(r),this.isVariantNode=isVariantNode(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);let{willChange:k,...M}=this.scrapeMotionValuesFromProps(r,{});for(let e in M){let r=M[e];void 0!==b[e]&&isMotionValue(r)&&(r.set(b[e],!1),isWillChangeMotionValue(k)&&k.add(e))}}scrapeMotionValuesFromProps(e,r){return{}}mount(e){this.current=e,tZ.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((e,r)=>this.bindToMotionValue(r,e)),tY.current||function(){if(tY.current=!0,es.j){if(window.matchMedia){let e=window.matchMedia("(prefers-reduced-motion)"),setReducedMotionPreferences=()=>tX.current=e.matches;e.addListener(setReducedMotionPreferences),setReducedMotionPreferences()}else tX.current=!1}}(),this.shouldReduceMotion="never"!==this.reducedMotionConfig&&("always"===this.reducedMotionConfig||tX.current),this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){for(let e in tZ.delete(this.current),this.projection&&this.projection.unmount(),(0,eF.Pn)(this.notifyUpdate),(0,eF.Pn)(this.render),this.valueSubscriptions.forEach(e=>e()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this),this.events)this.events[e].clear();for(let e in this.features)this.features[e].unmount();this.current=null}bindToMotionValue(e,r){let h=em.has(e),d=r.on("change",r=>{this.latestValues[e]=r,this.props.onUpdate&&eF.Wi.update(this.notifyUpdate,!1,!0),h&&this.projection&&(this.projection.isTransformDirty=!0)}),f=r.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(e,()=>{d(),f()})}sortNodePosition(e){return this.current&&this.sortInstanceNodePosition&&this.type===e.type?this.sortInstanceNodePosition(this.current,e.current):0}loadFeatures({children:e,...r},h,d,f){let g,b;for(let e=0;e<t1;e++){let h=t0[e],{isEnabled:d,Feature:f,ProjectionNode:A,MeasureLayout:k}=ei[h];A&&(g=A),d(r)&&(!this.features[h]&&f&&(this.features[h]=new f(this)),k&&(b=k))}if(("html"===this.type||"svg"===this.type)&&!this.projection&&g){this.projection=new g(this.latestValues,this.parent&&this.parent.projection);let{layoutId:e,layout:h,drag:d,dragConstraints:b,layoutScroll:A,layoutRoot:k}=r;this.projection.setOptions({layoutId:e,layout:h,alwaysMeasureLayout:!!d||b&&isRefObject(b),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:"string"==typeof h?h:"both",initialPromotionConfig:f,layoutScroll:A,layoutRoot:k})}return b}updateFeatures(){for(let e in this.features){let r=this.features[e];r.isMounted?r.update():(r.mount(),r.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):createBox()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,r){this.latestValues[e]=r}makeTargetAnimatable(e,r=!0){return this.makeTargetAnimatableFromInstance(e,this.props,r)}update(e,r){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let r=0;r<t4.length;r++){let h=t4[r];this.propEventSubscriptions[h]&&(this.propEventSubscriptions[h](),delete this.propEventSubscriptions[h]);let d=e["on"+h];d&&(this.propEventSubscriptions[h]=this.on(h,d))}this.prevMotionValues=function(e,r,h){let{willChange:d}=r;for(let f in r){let g=r[f],b=h[f];if(isMotionValue(g))e.addValue(f,g),isWillChangeMotionValue(d)&&d.add(f);else if(isMotionValue(b))e.addValue(f,motionValue(g,{owner:e})),isWillChangeMotionValue(d)&&d.remove(f);else if(b!==g){if(e.hasValue(f)){let r=e.getValue(f);r.hasAnimated||r.set(g)}else{let r=e.getStaticValue(f);e.addValue(f,motionValue(void 0!==r?r:g,{owner:e}))}}}for(let d in h)void 0===r[d]&&e.removeValue(d);return r}(this,this.scrapeMotionValuesFromProps(e,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(e=!1){if(e)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){let e=this.parent&&this.parent.getVariantContext()||{};return void 0!==this.props.initial&&(e.initial=this.props.initial),e}let r={};for(let e=0;e<t2;e++){let h=er[e],d=this.props[h];(isVariantLabel(d)||!1===d)&&(r[h]=d)}return r}addVariantChild(e){let r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(e),()=>r.variantChildren.delete(e)}addValue(e,r){r!==this.values.get(e)&&(this.removeValue(e),this.bindToMotionValue(e,r)),this.values.set(e,r),this.latestValues[e]=r.get()}removeValue(e){this.values.delete(e);let r=this.valueSubscriptions.get(e);r&&(r(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,r){if(this.props.values&&this.props.values[e])return this.props.values[e];let h=this.values.get(e);return void 0===h&&void 0!==r&&(h=motionValue(r,{owner:this}),this.addValue(e,h)),h}readValue(e){var r;return void 0===this.latestValues[e]&&this.current?null!==(r=this.getBaseTargetFromProps(this.props,e))&&void 0!==r?r:this.readValueFromInstance(this.current,e,this.options):this.latestValues[e]}setBaseTarget(e,r){this.baseTarget[e]=r}getBaseTarget(e){var r;let{initial:h}=this.props,d="string"==typeof h||"object"==typeof h?null===(r=resolveVariantFromProps(this.props,h))||void 0===r?void 0:r[e]:void 0;if(h&&void 0!==d)return d;let f=this.getBaseTargetFromProps(this.props,e);return void 0===f||isMotionValue(f)?void 0!==this.initialValues[e]&&void 0===d?void 0:this.baseTarget[e]:f}on(e,r){return this.events[e]||(this.events[e]=new SubscriptionManager),this.events[e].add(r)}notify(e,...r){this.events[e]&&this.events[e].notify(...r)}};let DOMVisualElement=class DOMVisualElement extends VisualElement{sortInstanceNodePosition(e,r){return 2&e.compareDocumentPosition(r)?1:-1}getBaseTargetFromProps(e,r){return e.style?e.style[r]:void 0}removeValueFromRenderState(e,{vars:r,style:h}){delete r[e],delete h[e]}makeTargetAnimatableFromInstance({transition:e,transitionEnd:r,...h},{transformValues:d},f){let g=function(e,r,h){let d={};for(let f in e){let e=function(e,r){if(!r)return;let h=r[e]||r.default||r;return h.from}(f,r);if(void 0!==e)d[f]=e;else{let e=h.getValue(f);e&&(d[f]=e.get())}}return d}(h,e||{},this);if(d&&(r&&(r=d(r)),h&&(h=d(h)),g&&(g=d(g))),f){!function(e,r,h){var d,f;let g=Object.keys(r).filter(r=>!e.hasValue(r)),b=g.length;if(b)for(let A=0;A<b;A++){let b=g[A],k=r[b],M=null;Array.isArray(k)&&(M=k[0]),null===M&&(M=null!==(f=null!==(d=h[b])&&void 0!==d?d:e.readValue(b))&&void 0!==f?f:r[b]),null!=M&&("string"==typeof M&&(isNumericalString(M)||isZeroValueString(M))?M=parseFloat(M):!findValueType(M)&&ti.test(k)&&(M=animatable_none_getAnimatableNone(b,k)),e.addValue(b,motionValue(M,{owner:e})),void 0===h[b]&&(h[b]=M),null!==M&&e.setBaseTarget(b,M))}}(this,h,g);let e=parseDomVariant(this,h,g,r);r=e.transitionEnd,h=e.target}return{transition:e,transitionEnd:r,...h}}};let HTMLVisualElement=class HTMLVisualElement extends DOMVisualElement{constructor(){super(...arguments),this.type="html"}readValueFromInstance(e,r){if(em.has(r)){let e=getDefaultValueType(r);return e&&e.default||0}{let h=window.getComputedStyle(e),d=(e_(r)?h.getPropertyValue(r):h[r])||0;return"string"==typeof d?d.trim():d}}measureInstanceViewportBox(e,{transformPagePoint:r}){return measureViewportBox(e,r)}build(e,r,h,d){buildHTMLStyles(e,r,h,d.transformTemplate)}scrapeMotionValuesFromProps(e,r){return scrapeMotionValuesFromProps(e,r)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);let{children:e}=this.props;isMotionValue(e)&&(this.childSubscription=e.on("change",e=>{this.current&&(this.current.textContent=`${e}`)}))}renderInstance(e,r,h,d){renderHTML(e,r,h,d)}};let SVGVisualElement=class SVGVisualElement extends DOMVisualElement{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(e,r){return e[r]}readValueFromInstance(e,r){if(em.has(r)){let e=getDefaultValueType(r);return e&&e.default||0}return r=eM.has(r)?r:camelToDash(r),e.getAttribute(r)}measureInstanceViewportBox(){return createBox()}scrapeMotionValuesFromProps(e,r){return scrape_motion_values_scrapeMotionValuesFromProps(e,r)}build(e,r,h,d){buildSVGAttrs(e,r,h,this.isSVGTag,d.transformTemplate)}renderInstance(e,r,h,d){renderSVG(e,r,h,d)}mount(e){this.isSVGTag=isSVGTag(e.tagName),super.mount(e)}};let create_visual_element_createDomVisualElement=(e,r)=>isSVGComponent(e)?new SVGVisualElement(r,{enableHardwareAcceleration:!1}):new HTMLVisualElement(r,{enableHardwareAcceleration:!0}),t3={animation:{Feature:class extends Feature{constructor(e){super(e),e.animationState||(e.animationState=function(e){let animate=r=>Promise.all(r.map(({animation:r,options:h})=>(function(e,r,h={}){let d;if(e.notify("AnimationStart",r),Array.isArray(r)){let f=r.map(r=>animateVariant(e,r,h));d=Promise.all(f)}else if("string"==typeof r)d=animateVariant(e,r,h);else{let f="function"==typeof r?resolveVariant(e,r,h.custom):r;d=Promise.all(animateTarget(e,f,h))}return d.then(()=>e.notify("AnimationComplete",r))})(e,r,h))),r={animate:createTypeState(!0),whileInView:createTypeState(),whileHover:createTypeState(),whileTap:createTypeState(),whileDrag:createTypeState(),whileFocus:createTypeState(),exit:createTypeState()},h=!0,buildResolvedTypeValues=(r,h)=>{let d=resolveVariant(e,h);if(d){let{transition:e,transitionEnd:h,...f}=d;r={...r,...f,...h}}return r};function animateChanges(d,f){let g=e.getProps(),b=e.getVariantContext(!0)||{},A=[],k=new Set,M={},j=1/0;for(let ee=0;ee<tI;ee++){var q;let et=tT[ee],er=r[et],en=void 0!==g[et]?g[et]:b[et],ei=isVariantLabel(en),es=et===f?er.isActive:null;!1===es&&(j=ee);let eo=en===b[et]&&en!==g[et]&&ei;if(eo&&h&&e.manuallyAnimateOnMount&&(eo=!1),er.protectedKeys={...M},!er.isActive&&null===es||!en&&!er.prevProp||isAnimationControls(en)||"boolean"==typeof en)continue;let ea=(q=er.prevProp,"string"==typeof en?en!==q:!!Array.isArray(en)&&!shallowCompare(en,q)),el=ea||et===f&&er.isActive&&!eo&&ei||ee>j&&ei,eu=!1,eh=Array.isArray(en)?en:[en],ed=eh.reduce(buildResolvedTypeValues,{});!1===es&&(ed={});let{prevResolvedValues:em={}}=er,ef={...em,...ed},markToAnimate=e=>{el=!0,k.has(e)&&(eu=!0,k.delete(e)),er.needsAnimating[e]=!0};for(let e in ef){let r=ed[e],h=em[e];if(!M.hasOwnProperty(e))(isKeyframesTarget(r)&&isKeyframesTarget(h)?shallowCompare(r,h):r===h)?void 0!==r&&k.has(e)?markToAnimate(e):er.protectedKeys[e]=!0:void 0!==r?markToAnimate(e):k.add(e)}er.prevProp=en,er.prevResolvedValues=ed,er.isActive&&(M={...M,...ed}),h&&e.blockInitialAnimation&&(el=!1),el&&(!eo||eu)&&A.push(...eh.map(e=>({animation:e,options:{type:et,...d}})))}if(k.size){let r={};k.forEach(h=>{let d=e.getBaseTarget(h);void 0!==d&&(r[h]=d)}),A.push({animation:r})}let ee=!!A.length;return h&&(!1===g.initial||g.initial===g.animate)&&!e.manuallyAnimateOnMount&&(ee=!1),h=!1,ee?animate(A):Promise.resolve()}return{animateChanges,setActive:function(h,d,f){var g;if(r[h].isActive===d)return Promise.resolve();null===(g=e.variantChildren)||void 0===g||g.forEach(e=>{var r;return null===(r=e.animationState)||void 0===r?void 0:r.setActive(h,d)}),r[h].isActive=d;let b=animateChanges(f,h);for(let e in r)r[e].protectedKeys={};return b},setAnimateFunction:function(r){animate=r(e)},getState:()=>r}}(e))}updateAnimationControlsSubscription(){let{animate:e}=this.node.getProps();this.unmount(),isAnimationControls(e)&&(this.unmount=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){let{animate:e}=this.node.getProps(),{animate:r}=this.node.prevProps||{};e!==r&&this.updateAnimationControlsSubscription()}unmount(){}}},exit:{Feature:class extends Feature{constructor(){super(...arguments),this.id=tP++}update(){if(!this.node.presenceContext)return;let{isPresent:e,onExitComplete:r,custom:h}=this.node.presenceContext,{isPresent:d}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===d)return;let f=this.node.animationState.setActive("exit",!e,{custom:null!=h?h:this.node.getProps().custom});r&&!e&&f.then(()=>r(this.id))}mount(){let{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}},inView:{Feature:class extends Feature{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();let{viewport:e={}}=this.node.getProps(),{root:r,margin:h,amount:d="some",once:f}=e,g={root:r?r.current:void 0,rootMargin:h,threshold:"number"==typeof d?d:eK[d]};return function(e,r,h){let d=function({root:e,...r}){let h=e||document;e$.has(h)||e$.set(h,{});let d=e$.get(h),f=JSON.stringify(r);return d[f]||(d[f]=new IntersectionObserver(fireAllObserverCallbacks,{root:e,...r})),d[f]}(r);return eW.set(e,h),d.observe(e),()=>{eW.delete(e),d.unobserve(e)}}(this.node.current,g,e=>{let{isIntersecting:r}=e;if(this.isInView===r||(this.isInView=r,f&&!r&&this.hasEnteredView))return;r&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",r);let{onViewportEnter:h,onViewportLeave:d}=this.node.getProps(),g=r?h:d;g&&g(e)})}mount(){this.startObserver()}update(){if("undefined"==typeof IntersectionObserver)return;let{props:e,prevProps:r}=this.node,h=["amount","margin","root"].some(function({viewport:e={}},{viewport:r={}}={}){return h=>e[h]!==r[h]}(e,r));h&&this.startObserver()}unmount(){}}},tap:{Feature:class extends Feature{constructor(){super(...arguments),this.removeStartListeners=ez.Z,this.removeEndListeners=ez.Z,this.removeAccessibleListeners=ez.Z,this.startPointerPress=(e,r)=>{if(this.isPressing)return;this.removeEndListeners();let h=this.node.getProps(),d=addPointerEvent(window,"pointerup",(e,r)=>{if(!this.checkPressEnd())return;let{onTap:h,onTapCancel:d,globalTapTarget:f}=this.node.getProps();eF.Wi.update(()=>{f||isNodeOrChild(this.node.current,e.target)?h&&h(e,r):d&&d(e,r)})},{passive:!(h.onTap||h.onPointerUp)}),f=addPointerEvent(window,"pointercancel",(e,r)=>this.cancelPress(e,r),{passive:!(h.onTapCancel||h.onPointerCancel)});this.removeEndListeners=pipe(d,f),this.startPress(e,r)},this.startAccessiblePress=()=>{let e=addDomEvent(this.node.current,"keydown",e=>{"Enter"!==e.key||this.isPressing||(this.removeEndListeners(),this.removeEndListeners=addDomEvent(this.node.current,"keyup",e=>{"Enter"===e.key&&this.checkPressEnd()&&fireSyntheticPointerEvent("up",(e,r)=>{let{onTap:h}=this.node.getProps();h&&eF.Wi.update(()=>h(e,r))})}),fireSyntheticPointerEvent("down",(e,r)=>{this.startPress(e,r)}))}),r=addDomEvent(this.node.current,"blur",()=>{this.isPressing&&fireSyntheticPointerEvent("cancel",(e,r)=>this.cancelPress(e,r))});this.removeAccessibleListeners=pipe(e,r)}}startPress(e,r){this.isPressing=!0;let{onTapStart:h,whileTap:d}=this.node.getProps();d&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),h&&eF.Wi.update(()=>h(e,r))}checkPressEnd(){this.removeEndListeners(),this.isPressing=!1;let e=this.node.getProps();return e.whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!isDragActive()}cancelPress(e,r){if(!this.checkPressEnd())return;let{onTapCancel:h}=this.node.getProps();h&&eF.Wi.update(()=>h(e,r))}mount(){let e=this.node.getProps(),r=addPointerEvent(e.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(e.onTapStart||e.onPointerStart)}),h=addDomEvent(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=pipe(r,h)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}},focus:{Feature:class extends Feature{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch(r){e=!0}e&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){this.isActive&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=pipe(addDomEvent(this.node.current,"focus",()=>this.onFocus()),addDomEvent(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}},hover:{Feature:class extends Feature{mount(){this.unmount=pipe(addHoverEvent(this.node,!0),addHoverEvent(this.node,!1))}unmount(){}}},pan:{Feature:class extends Feature{constructor(){super(...arguments),this.removePointerDownListener=ez.Z}onPointerDown(e){this.session=new PanSession(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:getContextWindow(this.node)})}createPanHandlers(){let{onPanSessionStart:e,onPanStart:r,onPan:h,onPanEnd:d}=this.node.getProps();return{onSessionStart:asyncHandler(e),onStart:asyncHandler(r),onMove:h,onEnd:(e,r)=>{delete this.session,d&&eF.Wi.update(()=>d(e,r))}}}mount(){this.removePointerDownListener=addPointerEvent(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}},drag:{Feature:class extends Feature{constructor(e){super(e),this.removeGroupControls=ez.Z,this.removeListeners=ez.Z,this.controls=new VisualElementDragControls(e)}mount(){let{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||ez.Z}unmount(){this.removeGroupControls(),this.removeListeners()}},ProjectionNode:t$,MeasureLayout:MeasureLayout},layout:{ProjectionNode:t$,MeasureLayout:MeasureLayout}},t9=function(e){function custom(r,h={}){return function({preloadedFeatures:e,createVisualElement:r,useRender:h,useVisualState:d,Component:f}){e&&function(e){for(let r in e)ei[r]={...ei[r],...e[r]}}(e);let g=(0,b.forwardRef)(function(g,et){var er;let en;let ei={...(0,b.useContext)(A),...g,layoutId:function({layoutId:e}){let r=(0,b.useContext)(eo.p).id;return r&&void 0!==e?r+"-"+e:e}(g)},{isStatic:el}=ei,eu=function(e){let{initial:r,animate:h}=function(e,r){if(isControllingVariants(e)){let{initial:r,animate:h}=e;return{initial:!1===r||isVariantLabel(r)?r:void 0,animate:isVariantLabel(h)?h:void 0}}return!1!==e.inherit?r:{}}(e,(0,b.useContext)(k));return(0,b.useMemo)(()=>({initial:r,animate:h}),[variantLabelsAsDependency(r),variantLabelsAsDependency(h)])}(g),eh=d(g,el);if(!el&&es.j){eu.visualElement=function(e,r,h,d){let{visualElement:f}=(0,b.useContext)(k),g=(0,b.useContext)(q),et=(0,b.useContext)(M.O),er=(0,b.useContext)(A).reducedMotion,en=(0,b.useRef)();d=d||g.renderer,!en.current&&d&&(en.current=d(e,{visualState:r,parent:f,props:h,presenceContext:et,blockInitialAnimation:!!et&&!1===et.initial,reducedMotionConfig:er}));let ei=en.current;(0,b.useInsertionEffect)(()=>{ei&&ei.update(h,et)});let es=(0,b.useRef)(!!(h[ee]&&!window.HandoffComplete));return(0,j.L)(()=>{ei&&(ei.render(),es.current&&ei.animationState&&ei.animationState.animateChanges())}),(0,b.useEffect)(()=>{ei&&(ei.updateFeatures(),!es.current&&ei.animationState&&ei.animationState.animateChanges(),es.current&&(es.current=!1,window.HandoffComplete=!0))}),ei}(f,eh,ei,r);let h=(0,b.useContext)(ea),d=(0,b.useContext)(q).strict;eu.visualElement&&(en=eu.visualElement.loadFeatures(ei,d,e,h))}return b.createElement(k.Provider,{value:eu},en&&eu.visualElement?b.createElement(en,{visualElement:eu.visualElement,...ei}):null,h(f,g,(er=eu.visualElement,(0,b.useCallback)(e=>{e&&eh.mount&&eh.mount(e),er&&(e?er.mount(e):er.unmount()),et&&("function"==typeof et?et(e):isRefObject(et)&&(et.current=e))},[er])),eh,el,eu.visualElement))});return g[el]=f,g}(e(r,h))}if("undefined"==typeof Proxy)return custom;let r=new Map;return new Proxy(custom,{get:(e,h)=>(r.has(h)||r.set(h,custom(h)),r.get(h))})}((e,r)=>(function(e,{forwardMotionProps:r=!1},h,d){let f=isSVGComponent(e)?eB:eU;return{...f,preloadedFeatures:h,useRender:function(e=!1){return(r,h,d,{latestValues:f},g)=>{let A=isSVGComponent(r)?useSVGProps:useHTMLProps,k=A(h,f,g,r),M=function(e,r,h){let d={};for(let f in e)("values"!==f||"object"!=typeof e.values)&&(shouldForward(f)||!0===h&&isValidMotionProp(f)||!r&&!isValidMotionProp(f)||e.draggable&&f.startsWith("onDrag"))&&(d[f]=e[f]);return d}(h,"string"==typeof r,e),j={...M,...k,ref:d},{children:q}=h,ee=(0,b.useMemo)(()=>isMotionValue(q)?q.get():q,[q]);return(0,b.createElement)(r,{...j,children:ee})}}(r),createVisualElement:d,Component:e}})(e,r,t3,create_visual_element_createDomVisualElement))},5487:function(e,r,h){"use strict";h.d(r,{K:function(){return f},k:function(){return g}});var d=h(1662);let f=d.Z,g=d.Z},1741:function(e,r,h){"use strict";h.d(r,{j:function(){return d}});let d="undefined"!=typeof document},1662:function(e,r,h){"use strict";h.d(r,{Z:function(){return noop}});let noop=e=>e},6681:function(e,r,h){"use strict";h.d(r,{h:function(){return useConstant}});var d=h(7294);function useConstant(e){let r=(0,d.useRef)(null);return null===r.current&&(r.current=e()),r.current}},8868:function(e,r,h){"use strict";h.d(r,{L:function(){return g}});var d=h(7294),f=h(1741);let g=f.j?d.useLayoutEffect:d.useEffect}},function(e){var __webpack_exec__=function(r){return e(e.s=r)};e.O(0,[774,179],function(){return __webpack_exec__(1118),__webpack_exec__(9974)}),_N_E=e.O()}]);