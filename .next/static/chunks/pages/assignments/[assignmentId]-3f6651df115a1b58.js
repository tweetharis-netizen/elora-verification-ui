(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[833],{3708:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/assignments/[assignmentId]",function(){return s(7764)}])},7142:function(e,t,s){"use strict";s.d(t,{tz:function(){return generateRubric},vK:function(){return createAssignment},vS:function(){return getUserAssignments}});var r=s(1034),a=s(5266);async function createAssignment(e){var t,s,n;let{classId:i,teacherId:l,title:d,description:o,dueDate:c,points:m,rubric:x=null,attachments:u=[],settings:h={}}=e;if(!a.db)throw Error("Firestore not initialized");let p={classId:i,teacherId:l,title:d,description:o,dueDate:c,points:m,rubric:x,attachments:u,settings:{allowLateSubmissions:null===(t=h.allowLateSubmissions)||void 0===t||t,allowPeerReview:null!==(s=h.allowPeerReview)&&void 0!==s&&s,plagiarismCheck:null===(n=h.plagiarismCheck)||void 0===n||n,...h},status:"draft",createdAt:(0,r.Bt)(),updatedAt:(0,r.Bt)(),publishedAt:null,versions:[]},b=(0,r.JU)((0,r.hJ)(a.db,"assignments"));return await (0,r.pl)(b,p),{id:b.id,...p}}async function getClassAssignments(e){if(!a.db)return[];let t=(0,r.IO)((0,r.hJ)(a.db,"assignments"),(0,r.ar)("classId","==",e),(0,r.Xo)("dueDate","desc")),s=await (0,r.PL)(t);return s.docs.map(e=>({id:e.id,...e.data()}))}async function generateRubric(e,t,s){return{criteria:[{name:"Content & Understanding",description:"Demonstrates understanding of the topic",levels:[{name:"Excellent",points:.4*s,description:"Exceptional understanding"},{name:"Good",points:.3*s,description:"Good understanding"},{name:"Satisfactory",points:.2*s,description:"Basic understanding"},{name:"Needs Improvement",points:.1*s,description:"Limited understanding"}]},{name:"Quality & Effort",description:"Overall quality and effort demonstrated",levels:[{name:"Excellent",points:.3*s,description:"Outstanding effort"},{name:"Good",points:.2*s,description:"Good effort"},{name:"Satisfactory",points:.15*s,description:"Adequate effort"},{name:"Needs Improvement",points:.05*s,description:"Minimal effort"}]}]}}async function getTeacherAssignments(e){if(!a.db)return[];let t=(0,r.IO)((0,r.hJ)(a.db,"assignments"),(0,r.ar)("teacherId","==",e),(0,r.Xo)("createdAt","desc")),s=await (0,r.PL)(t);return s.docs.map(e=>({id:e.id,...e.data()}))}async function getUserAssignments(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(!a.db)return[];try{if("educator"===t)return await getTeacherAssignments(e);if("student"===t||"parent"===t){if(!s||0===s.length)return[];let e=s.map(e=>getClassAssignments(e)),t=await Promise.all(e),r=new Map;return t.flat().forEach(e=>{r.has(e.id)||r.set(e.id,e)}),Array.from(r.values()).sort((e,t)=>new Date(t.dueDate)-new Date(e.dueDate))}return[]}catch(e){return console.error("Error in getUserAssignments:",e),[]}}},7764:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return AssignmentDetailPage}});var r=s(5893),a=s(7294),n=s(1163),i=s(8260),l=s(6600);function GradingInterface(e){let{submission:t,assignment:s,onGrade:n,onNext:l,onPrevious:d,currentIndex:o,totalSubmissions:c}=e,[m,x]=(0,a.useState)(t.grade||null),[u,h]=(0,a.useState)(t.feedback||""),[p,b]=(0,a.useState)(t.rubricScores||{}),[g,j]=(0,a.useState)(["Excellent work!","Good effort, but needs improvement in...","Please see me about this assignment","Great attention to detail","Remember to show your work","Check your calculations"]),calculateRubricGrade=()=>{var e;if(!(null===(e=s.rubric)||void 0===e?void 0:e.criteria))return null;let t=0,r=0;return(s.rubric.criteria.forEach(e=>{let s=p[e.id];void 0!==s&&(t+=s*(e.weight/100),r+=e.weight)}),r>0)?Math.round(t/r*s.points):null},handleRubricScore=(e,t,s)=>{b({...p,[e]:s});let r=calculateRubricGrade();null!==r&&x(r)},addQuickComment=e=>{h(u?"".concat(u,"\n\n").concat(e):e)};return(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 h-full",children:[(0,r.jsxs)("div",{className:"space-y-4 overflow-y-auto max-h-[calc(100vh-200px)]",children:[(0,r.jsx)("div",{className:"card p-4 bg-gradient-to-r from-primary-50 to-secondary-50 dark:from-primary-900/20 dark:to-secondary-900/20",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-bold text-text-primary text-lg",children:t.studentName}),(0,r.jsxs)("p",{className:"text-sm text-text-secondary",children:["Submitted ",(0,i.Z)(new Date(t.submittedAt),"MMM dd, yyyy h:mm a")]})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("div",{className:"text-sm text-text-tertiary",children:"Submission"}),(0,r.jsxs)("div",{className:"text-xl font-bold text-text-primary",children:[o+1," / ",c]})]})]})}),(0,r.jsxs)("div",{className:"card p-4",children:[(0,r.jsx)("h4",{className:"font-semibold text-text-primary mb-2",children:s.title}),(0,r.jsx)("p",{className:"text-sm text-text-secondary",children:s.description}),(0,r.jsxs)("div",{className:"mt-3 flex items-center gap-4 text-xs text-text-tertiary",children:[(0,r.jsxs)("span",{children:["Due: ",(0,i.Z)(new Date(s.dueDate),"MMM dd, yyyy")]}),(0,r.jsx)("span",{children:"•"}),(0,r.jsxs)("span",{children:[s.points," points"]})]})]}),(0,r.jsxs)("div",{className:"card p-6",children:[(0,r.jsx)("h4",{className:"font-semibold text-text-primary mb-4",children:"Student Response"}),(0,r.jsx)("div",{className:"prose dark:prose-invert max-w-none",children:(0,r.jsx)("div",{className:"bg-neutral-50 dark:bg-neutral-900/50 rounded-lg p-4 whitespace-pre-wrap",children:t.content||(0,r.jsx)("span",{className:"text-text-tertiary italic",children:"No text submitted"})})}),t.attachments&&t.attachments.length>0&&(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsx)("h5",{className:"font-medium text-text-secondary text-sm mb-2",children:"Attachments"}),(0,r.jsx)("div",{className:"space-y-2",children:t.attachments.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center gap-2 p-2 bg-neutral-50 dark:bg-neutral-800/50 rounded",children:[(0,r.jsx)("svg",{className:"w-5 h-5 text-primary-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})}),(0,r.jsx)("span",{className:"text-sm text-text-primary",children:e.name})]},t))})]}),t.plagiarismScore&&(0,r.jsx)("div",{className:"mt-4 p-3 rounded-lg ".concat(t.plagiarismScore.flagged?"bg-red-50 dark:bg-red-900/20 border border-red-300 dark:border-red-700":"bg-secondary-50 dark:bg-secondary-900/20 border border-secondary-300 dark:border-secondary-700"),children:(0,r.jsx)("div",{className:"flex items-center gap-2 font-medium text-sm",children:t.plagiarismScore.flagged?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("svg",{className:"w-5 h-5 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,r.jsxs)("span",{className:"text-red-900 dark:text-red-100",children:["Plagiarism Alert: ",t.plagiarismScore.score,"% similarity"]})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("svg",{className:"w-5 h-5 text-secondary-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,r.jsxs)("span",{className:"text-secondary-900 dark:text-secondary-100",children:["Original work: ",t.plagiarismScore.score,"% similarity"]})]})})})]})]}),(0,r.jsxs)("div",{className:"space-y-4 overflow-y-auto max-h-[calc(100vh-200px)]",children:[s.rubric&&(0,r.jsxs)("div",{className:"card p-6",children:[(0,r.jsx)("h4",{className:"font-semibold text-text-primary mb-4",children:"Rubric"}),(0,r.jsx)("div",{className:"space-y-4",children:s.rubric.criteria.map(e=>(0,r.jsxs)("div",{className:"border border-border-primary rounded-lg p-4",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between mb-3",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h5",{className:"font-medium text-text-primary",children:e.name}),(0,r.jsx)("p",{className:"text-xs text-text-secondary mt-1",children:e.description})]}),(0,r.jsxs)("span",{className:"text-xs font-medium text-text-tertiary",children:[e.weight,"%"]})]}),(0,r.jsx)("div",{className:"grid grid-cols-2 gap-2",children:e.levels.map((t,s)=>{let a=p[e.id]===t.points;return(0,r.jsxs)("button",{onClick:()=>handleRubricScore(e.id,s,t.points),className:"p-3 rounded-lg border-2 text-left transition-all ".concat(a?"border-primary-500 bg-primary-50 dark:bg-primary-900/20":"border-border-primary hover:border-primary-300"),children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,r.jsx)("span",{className:"font-medium text-sm text-text-primary",children:t.name}),(0,r.jsxs)("span",{className:"text-sm font-bold text-primary-600",children:[t.points,"pts"]})]}),(0,r.jsx)("p",{className:"text-xs text-text-secondary line-clamp-2",children:t.description})]},s)})})]},e.id))})]}),(0,r.jsxs)("div",{className:"card p-6",children:[(0,r.jsxs)("label",{className:"label",children:["Grade (out of ",s.points,")"]}),(0,r.jsx)("input",{type:"number",value:null!=m?m:"",onChange:e=>x(e.target.value),min:"0",max:s.points,className:"input text-2xl font-bold text-center",placeholder:"0"}),s.rubric&&(0,r.jsx)("button",{onClick:()=>x(calculateRubricGrade()),className:"btn btn-sm btn-outline mt-2 w-full",children:"Calculate from Rubric"})]}),(0,r.jsxs)("div",{className:"card p-6",children:[(0,r.jsx)("label",{className:"label",children:"Feedback"}),(0,r.jsx)("textarea",{value:u,onChange:e=>h(e.target.value),className:"input min-h-[120px]",placeholder:"Provide constructive feedback...",rows:5}),(0,r.jsxs)("div",{className:"mt-3",children:[(0,r.jsx)("p",{className:"text-xs text-text-tertiary mb-2",children:"Quick comments:"}),(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:g.map((e,t)=>(0,r.jsx)("button",{onClick:()=>addQuickComment(e),className:"text-xs px-2 py-1 bg-neutral-100 dark:bg-neutral-800 rounded hover:bg-primary-100 dark:hover:bg-primary-900/20 text-text-secondary hover:text-primary-600 transition-colors",children:e},t))})]})]}),(0,r.jsxs)("div",{className:"sticky bottom-0 bg-white dark:bg-neutral-900 border-t border-border-primary p-4 -m-4 mt-6",children:[(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsxs)("button",{onClick:d,disabled:0===o,className:"btn btn-outline",children:[(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Previous"]}),(0,r.jsxs)("button",{onClick:()=>{n({grade:Number(m),feedback:u,rubricScores:p})},disabled:null===m||""===m,className:"btn btn-primary flex-1",children:[(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Save & Next"]}),(0,r.jsxs)("button",{onClick:l,disabled:o>=c-1,className:"btn btn-outline",children:["Next",(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]}),(0,r.jsx)("div",{className:"mt-3 text-center",children:(0,r.jsx)("button",{className:"text-sm text-text-tertiary hover:text-text-secondary transition-colors",children:"Skip this submission"})})]})]})]})}var d=s(1034),o=s(5266);async function saveSubmissionDraft(e){let{assignmentId:t,studentId:s,content:r,attachments:a=[]}=e;if(!o.db)throw Error("Firestore not initialized");let n="".concat(t,"_").concat(s),i=(0,d.JU)(o.db,"submissions",n),l=await (0,d.QT)(i);if(l.exists()){let e=l.data();await (0,d.r7)(i,{content:r,attachments:a,versions:[...e.versions||[],{timestamp:new Date().toISOString(),content:e.content,attachments:e.attachments}],updatedAt:(0,d.Bt)()})}else await (0,d.pl)(i,{assignmentId:t,studentId:s,content:r,attachments:a,status:"draft",createdAt:(0,d.Bt)(),updatedAt:(0,d.Bt)(),submittedAt:null,gradedAt:null,grade:null,feedback:"",plagiarismScore:null,peerReviews:[],versions:[]});return{id:n}}async function submitAssignment(e,t){if(!o.db)throw Error("Firestore not initialized");let s="".concat(e,"_").concat(t),r=(0,d.JU)(o.db,"submissions",s);await (0,d.r7)(r,{status:"submitted",submittedAt:(0,d.Bt)(),updatedAt:(0,d.Bt)()})}var c=s(7483);function SubmissionForm(e){var t;let{assignment:s,existingSubmission:n,studentId:l,onSubmit:d}=e,[o,m]=(0,a.useState)((null==n?void 0:n.content)||""),[x,u]=(0,a.useState)((null==n?void 0:n.attachments)||[]),[h,p]=(0,a.useState)(!1),[b,g]=(0,a.useState)(!1),[j,v]=(0,a.useState)((null==n?void 0:n.lastSaved)||null),f=(0,c.z)();(0,a.useEffect)(()=>{if(!o&&0===x.length)return;let e=setTimeout(async()=>{await handleSaveDraft(!0)},3e4);return()=>clearTimeout(e)},[o,x]);let handleSaveDraft=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(o||0!==x.length){p(!0);try{await saveSubmissionDraft({assignmentId:s.id,studentId:l,content:o,attachments:x}),v(new Date),e||f.success("Draft saved")}catch(t){console.error("Failed to save draft:",t),e||f.error("Failed to save draft")}p(!1)}},handleSubmit=async()=>{if(!o&&0===x.length){f.error("Please add content or attachments before submitting");return}g(!0);try{await submitAssignment({assignmentId:s.id,studentId:l,content:o,attachments:x}),f.success("Assignment submitted successfully! \uD83C\uDF89"),d&&d()}catch(e){console.error("Failed to submit:",e),f.error("Failed to submit assignment")}g(!1)},y=new Date>new Date(s.dueDate),k=!(null==n?void 0:n.submittedAt);return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"card p-6 bg-gradient-to-r from-primary-50 to-secondary-50 dark:from-primary-900/20 dark:to-secondary-900/20",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-text-primary mb-2",children:s.title}),(0,r.jsx)("p",{className:"text-text-secondary mb-4",children:s.description}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-4 text-sm",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("svg",{className:"w-5 h-5 text-primary-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),(0,r.jsxs)("span",{className:y?"text-error font-semibold":"text-text-secondary",children:["Due: ",(0,i.Z)(new Date(s.dueDate),"MMM dd, yyyy h:mm a"),y&&" (Past Due)"]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("svg",{className:"w-5 h-5 text-primary-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"})}),(0,r.jsxs)("span",{className:"text-text-secondary",children:[s.points," points"]})]})]})]}),(null==n?void 0:n.submittedAt)?(0,r.jsxs)("div",{className:"card p-6 bg-secondary-50 dark:bg-secondary-900/20 border-2 border-secondary-300 dark:border-secondary-700",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"w-12 h-12 rounded-full bg-secondary-500 flex items-center justify-center",children:(0,r.jsx)("svg",{className:"w-6 h-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h3",{className:"font-bold text-secondary-900 dark:text-secondary-100",children:"Submitted!"}),(0,r.jsx)("p",{className:"text-sm text-secondary-700 dark:text-secondary-300",children:(0,i.Z)(new Date(n.submittedAt),"MMM dd, yyyy h:mm a")})]}),null!==n.grade&&(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("div",{className:"text-3xl font-bold text-secondary-900 dark:text-secondary-100",children:n.grade}),(0,r.jsxs)("div",{className:"text-sm text-secondary-700 dark:text-secondary-300",children:["/ ",s.points]})]})]}),n.feedback&&(0,r.jsxs)("div",{className:"mt-4 p-4 bg-white dark:bg-neutral-800 rounded-lg",children:[(0,r.jsx)("h4",{className:"font-semibold text-text-primary text-sm mb-2",children:"Teacher Feedback"}),(0,r.jsx)("p",{className:"text-text-secondary whitespace-pre-wrap",children:n.feedback})]})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"card p-6",children:[(0,r.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,r.jsx)("label",{className:"label",children:"Your Response"}),j&&(0,r.jsx)("span",{className:"text-xs text-text-tertiary",children:h?"Saving...":"Last saved ".concat((0,i.Z)(j,"h:mm a"))})]}),(0,r.jsx)("textarea",{value:o,onChange:e=>m(e.target.value),className:"input min-h-[300px] font-mono text-sm",placeholder:"Type your response here...",rows:12,disabled:!k}),(0,r.jsx)("p",{className:"text-xs text-text-tertiary mt-2",children:"Your work is automatically saved every 30 seconds"})]}),(0,r.jsxs)("div",{className:"card p-6",children:[(0,r.jsx)("label",{className:"label mb-3",children:"Attachments (Optional)"}),(0,r.jsxs)("div",{className:"border-2 border-dashed border-border-primary rounded-xl p-8 text-center hover:bg-neutral-50 dark:hover:bg-neutral-800/50 transition-colors cursor-pointer",children:[(0,r.jsx)("svg",{className:"w-12 h-12 text-neutral-400 mx-auto mb-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),(0,r.jsx)("p",{className:"text-text-secondary mb-1",children:"Click to upload or drag and drop"}),(0,r.jsx)("p",{className:"text-xs text-text-tertiary",children:"PDF, DOC, Images (Max 10MB)"})]}),x.length>0&&(0,r.jsx)("div",{className:"mt-4 space-y-2",children:x.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-neutral-50 dark:bg-neutral-800/50 rounded-lg",children:[(0,r.jsx)("svg",{className:"w-5 h-5 text-primary-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,r.jsx)("span",{className:"flex-1 text-sm text-text-primary",children:e.name}),(0,r.jsx)("button",{className:"text-error hover:bg-red-50 dark:hover:bg-red-900/20 p-1.5 rounded transition-colors",children:(0,r.jsx)("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},t))})]}),(0,r.jsxs)("div",{className:"flex gap-3 sticky bottom-0 bg-white dark:bg-neutral-900 border-t border-border-primary p-4 -mx-6 -mb-6",children:[(0,r.jsx)("button",{onClick:()=>handleSaveDraft(),disabled:h||!k,className:"btn btn-outline flex-1",children:h?"Saving...":"Save Draft"}),(0,r.jsx)("button",{onClick:handleSubmit,disabled:b||!k||!o&&0===x.length,className:"btn btn-primary flex-1",children:b?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"w-5 h-5 border-2 border-current border-t-transparent rounded-full animate-spin"}),"Submitting..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Submit Assignment"]})})]}),y&&(null===(t=s.settings)||void 0===t?void 0:t.allowLateSubmissions)&&(0,r.jsxs)("div",{className:"text-center text-sm text-warning",children:["⚠️ This assignment is past due. A ",s.settings.latePenalty,"% penalty may apply."]})]})]})}var m=s(7142),x=s(7290);function AssignmentDetailPage(){let e=(0,n.useRouter)(),{assignmentId:t}=e.query,{user:s,session:d}=(0,x.q)(),o=(0,c.z)(),[u,h]=(0,a.useState)(null),[p,b]=(0,a.useState)([]),[g,j]=(0,a.useState)(0),[v,f]=(0,a.useState)(!0),[y,k]=(0,a.useState)("overview"),N=(null==d?void 0:d.role)==="teacher"||(null==d?void 0:d.role)==="educator";(0,a.useEffect)(()=>{t&&loadAssignmentData()},[t]);let loadAssignmentData=async()=>{f(!0);try{let e=await (0,m.getAssignmentById)(t);if(h(e),N){let e=await (0,m.getSubmissions)(t);b(e)}}catch(e){console.error("Failed to load assignment:",e),o.error("Failed to load assignment")}f(!1)},handleGrade=async e=>{try{let s=p[g];await (0,m.gradeSubmission)(t,s.id,e),o.success("Grade saved successfully!"),g<p.length-1&&j(g+1),loadAssignmentData()}catch(e){console.error("Failed to grade submission:",e),o.error("Failed to save grade")}},handleSubmitAssignment=async()=>{o.success("Assignment submitted successfully!"),loadAssignmentData()};if(v)return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.Z,{}),(0,r.jsx)("div",{className:"min-h-screen bg-neutral-50 dark:bg-neutral-900",children:(0,r.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,r.jsx)("div",{className:"skeleton h-96 rounded-2xl"})})})]});if(!u)return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.Z,{}),(0,r.jsx)("div",{className:"min-h-screen bg-neutral-50 dark:bg-neutral-900 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-neutral-900 dark:text-white mb-2",children:"Assignment Not Found"}),(0,r.jsx)("button",{onClick:()=>e.push("/assignments"),className:"btn btn-primary mt-4",children:"Back to Assignments"})]})})]});let w=p[g],S=p.find(e=>e.studentId===(null==s?void 0:s.uid));return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.Z,{}),(0,r.jsx)("div",{className:"min-h-screen bg-neutral-50 dark:bg-neutral-900",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,r.jsxs)("div",{className:"bg-white dark:bg-neutral-800 rounded-2xl border border-neutral-200 dark:border-neutral-700 p-6 mb-6",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-neutral-900 dark:text-white mb-2",children:u.title}),(0,r.jsx)("p",{className:"text-neutral-600 dark:text-neutral-400",children:u.description})]}),(0,r.jsx)("span",{className:"px-4 py-2 rounded-full text-sm font-semibold ".concat("published"===u.status?"bg-secondary-100 dark:bg-secondary-900/30 text-secondary-700 dark:text-secondary-300":"bg-neutral-200 dark:bg-neutral-700 text-neutral-700 dark:text-neutral-300"),children:u.status})]}),(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-6 text-sm text-neutral-600 dark:text-neutral-400",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),(0,r.jsxs)("span",{children:["Due: ",(0,i.Z)(new Date(u.dueDate),"MMM dd, yyyy h:mm a")]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"})}),(0,r.jsxs)("span",{children:[u.points," points"]})]}),N&&(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,r.jsxs)("span",{children:[p.length," submissions"]})]})]})]}),N&&(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-6",children:[(0,r.jsx)("button",{onClick:()=>k("overview"),className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors ".concat("overview"===y?"bg-primary-100 dark:bg-primary-900/30 text-primary-700 dark:text-primary-300":"bg-white dark:bg-neutral-800 text-neutral-600 dark:text-neutral-400"),children:"Overview"}),(0,r.jsx)("button",{onClick:()=>k("grade"),disabled:0===p.length,className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors ".concat("grade"===y?"bg-primary-100 dark:bg-primary-900/30 text-primary-700 dark:text-primary-300":"bg-white dark:bg-neutral-800 text-neutral-600 dark:text-neutral-400"," disabled:opacity-50 disabled:cursor-not-allowed"),children:"Grade Submissions"})]}),N?(0,r.jsxs)(r.Fragment,{children:["overview"===y&&(0,r.jsx)("div",{className:"space-y-4",children:0===p.length?(0,r.jsxs)("div",{className:"bg-white dark:bg-neutral-800 rounded-2xl border border-neutral-200 dark:border-neutral-700 p-12 text-center",children:[(0,r.jsx)("svg",{className:"w-16 h-16 text-neutral-300 dark:text-neutral-700 mx-auto mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-neutral-900 dark:text-white mb-2",children:"No Submissions Yet"}),(0,r.jsx)("p",{className:"text-neutral-600 dark:text-neutral-400",children:"Students haven't submitted their work yet"})]}):p.map(e=>(0,r.jsx)("div",{className:"bg-white dark:bg-neutral-800 rounded-2xl border border-neutral-200 dark:border-neutral-700 p-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-semibold text-neutral-900 dark:text-white",children:e.studentName}),(0,r.jsxs)("p",{className:"text-sm text-neutral-600 dark:text-neutral-400",children:["Submitted ",(0,i.Z)(new Date(e.submittedAt),"MMM dd, h:mm a")]})]}),null!==e.grade?(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("div",{className:"text-2xl font-bold text-secondary-600 dark:text-secondary-400",children:e.grade}),(0,r.jsxs)("div",{className:"text-sm text-neutral-600 dark:text-neutral-400",children:["/ ",u.points]})]}):(0,r.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-semibold bg-warning-100 dark:bg-warning-900/30 text-warning-700 dark:text-warning-300",children:"Not Graded"})]})},e.id))}),"grade"===y&&w&&(0,r.jsx)(GradingInterface,{submission:w,assignment:u,onGrade:handleGrade,onNext:()=>j(Math.min(g+1,p.length-1)),onPrevious:()=>j(Math.max(g-1,0)),currentIndex:g,totalSubmissions:p.length})]}):(0,r.jsx)("div",{className:"bg-white dark:bg-neutral-800 rounded-2xl border border-neutral-200 dark:border-neutral-700 p-6",children:(0,r.jsx)(SubmissionForm,{assignment:u,existingSubmission:S,studentId:null==s?void 0:s.uid,onSubmit:handleSubmitAssignment})})]})})]})}}},function(e){e.O(0,[260,774,888,179],function(){return e(e.s=3708)}),_N_E=e.O()}]);