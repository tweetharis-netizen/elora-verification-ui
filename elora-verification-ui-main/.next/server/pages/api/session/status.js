"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/session/status";
exports.ids = ["pages/api/session/status"];
exports.modules = {

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fsession%2Fstatus&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Csession%5Cstatus.js&middlewareConfigBase64=e30%3D!":
/*!**************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fsession%2Fstatus&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Csession%5Cstatus.js&middlewareConfigBase64=e30%3D! ***!
  \**************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_session_status_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages\\api\\session\\status.js */ \"(api)/./pages/api/session/status.js\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_session_status_js__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_session_status_js__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/session/status\",\n        pathname: \"/api/session/status\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_session_status_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRnNlc3Npb24lMkZzdGF0dXMmcHJlZmVycmVkUmVnaW9uPSZhYnNvbHV0ZVBhZ2VQYXRoPS4lMkZwYWdlcyU1Q2FwaSU1Q3Nlc3Npb24lNUNzdGF0dXMuanMmbWlkZGxld2FyZUNvbmZpZ0Jhc2U2ND1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ0w7QUFDMUQ7QUFDNkQ7QUFDN0Q7QUFDQSxpRUFBZSx3RUFBSyxDQUFDLHlEQUFRLFlBQVksRUFBQztBQUMxQztBQUNPLGVBQWUsd0VBQUssQ0FBQyx5REFBUTtBQUNwQztBQUNPLHdCQUF3QixnSEFBbUI7QUFDbEQ7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsWUFBWTtBQUNaLENBQUM7O0FBRUQiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9lbG9yYS12ZXJpZmljYXRpb24tdWkvPzUyMzMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUGFnZXNBUElSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL3BhZ2VzLWFwaS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBob2lzdCB9IGZyb20gXCJuZXh0L2Rpc3QvYnVpbGQvdGVtcGxhdGVzL2hlbHBlcnNcIjtcbi8vIEltcG9ydCB0aGUgdXNlcmxhbmQgY29kZS5cbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIuL3BhZ2VzXFxcXGFwaVxcXFxzZXNzaW9uXFxcXHN0YXR1cy5qc1wiO1xuLy8gUmUtZXhwb3J0IHRoZSBoYW5kbGVyIChzaG91bGQgYmUgdGhlIGRlZmF1bHQgZXhwb3J0KS5cbmV4cG9ydCBkZWZhdWx0IGhvaXN0KHVzZXJsYW5kLCBcImRlZmF1bHRcIik7XG4vLyBSZS1leHBvcnQgY29uZmlnLlxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IGhvaXN0KHVzZXJsYW5kLCBcImNvbmZpZ1wiKTtcbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSByb3V0ZSBtb2R1bGUgdGhhdCB3aWxsIGJlIGNvbnN1bWVkLlxuZXhwb3J0IGNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IFBhZ2VzQVBJUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLlBBR0VTX0FQSSxcbiAgICAgICAgcGFnZTogXCIvYXBpL3Nlc3Npb24vc3RhdHVzXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvc2Vzc2lvbi9zdGF0dXNcIixcbiAgICAgICAgLy8gVGhlIGZvbGxvd2luZyBhcmVuJ3QgdXNlZCBpbiBwcm9kdWN0aW9uLlxuICAgICAgICBidW5kbGVQYXRoOiBcIlwiLFxuICAgICAgICBmaWxlbmFtZTogXCJcIlxuICAgIH0sXG4gICAgdXNlcmxhbmRcbn0pO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1wYWdlcy1hcGkuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fsession%2Fstatus&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Csession%5Cstatus.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./lib/server/verification.js":
/*!************************************!*\
  !*** ./lib/server/verification.js ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   clearSessionCookie: () => (/* binding */ clearSessionCookie),\n/* harmony export */   fetchBackendStatus: () => (/* binding */ fetchBackendStatus),\n/* harmony export */   getBackendBaseUrl: () => (/* binding */ getBackendBaseUrl),\n/* harmony export */   getSessionTokenFromReq: () => (/* binding */ getSessionTokenFromReq),\n/* harmony export */   makeSessionCookie: () => (/* binding */ makeSessionCookie),\n/* harmony export */   requireVerified: () => (/* binding */ requireVerified)\n/* harmony export */ });\n// lib/server/verification.js\n// Server-only helpers used by Next.js API routes.\n//\n// IMPORTANT:\n// - The backend (Repo B) is the source of truth for verification + role.\n// - The UI domain stores the session token in an httpOnly cookie (elora_session).\n// - Frontend pages should call /api/session/status to read server-backed state.\nconst SESSION_COOKIE = \"elora_session\";\nconst DEFAULT_MAX_AGE_SECONDS = 60 * 60 * 24 * 30; // 30 days\nfunction parseCookies(req) {\n    const header = req?.headers?.cookie || \"\";\n    const out = {};\n    header.split(\";\").forEach((part)=>{\n        const [k, ...rest] = part.trim().split(\"=\");\n        if (!k) return;\n        out[k] = decodeURIComponent(rest.join(\"=\") || \"\");\n    });\n    return out;\n}\nfunction makeCookie(name, value, { maxAgeSeconds = DEFAULT_MAX_AGE_SECONDS } = {}) {\n    const secure = \"development\" === \"production\";\n    const parts = [\n        `${name}=${encodeURIComponent(value)}`,\n        `Path=/`,\n        `HttpOnly`,\n        `SameSite=Lax`,\n        `Max-Age=${maxAgeSeconds}`\n    ];\n    if (secure) parts.push(\"Secure\");\n    return parts.join(\"; \");\n}\nfunction getSessionTokenFromReq(req) {\n    const cookies = parseCookies(req);\n    return cookies[SESSION_COOKIE] || \"\";\n}\nfunction makeSessionCookie(token, { maxAgeSeconds = DEFAULT_MAX_AGE_SECONDS } = {}) {\n    return makeCookie(SESSION_COOKIE, token, {\n        maxAgeSeconds\n    });\n}\nfunction clearSessionCookie() {\n    return makeCookie(SESSION_COOKIE, \"\", {\n        maxAgeSeconds: 0\n    });\n}\nfunction getBackendBaseUrl() {\n    return (process.env.NEXT_PUBLIC_ELORA_BACKEND_URL || process.env.ELORA_BACKEND_URL || \"https://elora-website.vercel.app\").replace(/\\/$/, \"\");\n}\nasync function fetchBackendStatus(sessionToken) {\n    const backend = getBackendBaseUrl();\n    if (!sessionToken) return {\n        ok: true,\n        verified: false,\n        role: \"guest\",\n        email: \"\"\n    };\n    try {\n        const r = await fetch(`${backend}/api/verification/status`, {\n            method: \"GET\",\n            headers: {\n                Authorization: `Bearer ${sessionToken}`\n            },\n            cache: \"no-store\"\n        });\n        const data = await r.json().catch(()=>null);\n        // Backend returns { ok:true, verified:boolean, email?, role? }\n        if (!r.ok || !data?.ok) return {\n            ok: true,\n            verified: false,\n            role: \"guest\",\n            email: \"\"\n        };\n        return {\n            ok: true,\n            verified: Boolean(data?.verified),\n            email: String(data?.email || \"\"),\n            role: String(data?.role || (data?.verified ? \"regular\" : \"guest\"))\n        };\n    } catch  {\n        // Keep UI stable even if backend is down\n        return {\n            ok: true,\n            verified: false,\n            role: \"guest\",\n            email: \"\"\n        };\n    }\n}\nasync function requireVerified(req, res) {\n    const token = getSessionTokenFromReq(req);\n    const status = await fetchBackendStatus(token);\n    if (!status.verified) {\n        res.status(403).json({\n            ok: false,\n            error: \"not_verified\"\n        });\n        return null;\n    }\n    return status;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LFFBQVNPLENBQUFBLE1BQU1SLFdBQVcsWUFBWSxPQUFNO1FBQ2pFO0lBQ0YsRUFBRSxPQUFNO1FBQ04seUNBQXlDO1FBQ3pDLE9BQU87WUFBRUQsSUFBSTtZQUFNQyxVQUFVO1lBQU9DLE1BQU07WUFBU0MsT0FBTztRQUFHO0lBQy9EO0FBQ0Y7QUFFTyxlQUFlVyxnQkFBZ0JqRCxHQUFHLEVBQUVrRCxHQUFHO0lBQzVDLE1BQU16QixRQUFRSCx1QkFBdUJ0QjtJQUNyQyxNQUFNbUQsU0FBUyxNQUFNbkIsbUJBQW1CUDtJQUN4QyxJQUFJLENBQUMwQixPQUFPZixRQUFRLEVBQUU7UUFDcEJjLElBQUlDLE1BQU0sQ0FBQyxLQUFLTixJQUFJLENBQUM7WUFBRVYsSUFBSTtZQUFPaUIsT0FBTztRQUFlO1FBQ3hELE9BQU87SUFDVDtJQUNBLE9BQU9EO0FBQ1QiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9lbG9yYS12ZXJpZmljYXRpb24tdWkvLi9saWIvc2VydmVyL3ZlcmlmaWNhdGlvbi5qcz81YTAxIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIGxpYi9zZXJ2ZXIvdmVyaWZpY2F0aW9uLmpzXG4vLyBTZXJ2ZXItb25seSBoZWxwZXJzIHVzZWQgYnkgTmV4dC5qcyBBUEkgcm91dGVzLlxuLy9cbi8vIElNUE9SVEFOVDpcbi8vIC0gVGhlIGJhY2tlbmQgKFJlcG8gQikgaXMgdGhlIHNvdXJjZSBvZiB0cnV0aCBmb3IgdmVyaWZpY2F0aW9uICsgcm9sZS5cbi8vIC0gVGhlIFVJIGRvbWFpbiBzdG9yZXMgdGhlIHNlc3Npb24gdG9rZW4gaW4gYW4gaHR0cE9ubHkgY29va2llIChlbG9yYV9zZXNzaW9uKS5cbi8vIC0gRnJvbnRlbmQgcGFnZXMgc2hvdWxkIGNhbGwgL2FwaS9zZXNzaW9uL3N0YXR1cyB0byByZWFkIHNlcnZlci1iYWNrZWQgc3RhdGUuXG5cbmNvbnN0IFNFU1NJT05fQ09PS0lFID0gXCJlbG9yYV9zZXNzaW9uXCI7XG5cbmNvbnN0IERFRkFVTFRfTUFYX0FHRV9TRUNPTkRTID0gNjAgKiA2MCAqIDI0ICogMzA7IC8vIDMwIGRheXNcblxuZnVuY3Rpb24gcGFyc2VDb29raWVzKHJlcSkge1xuICBjb25zdCBoZWFkZXIgPSByZXE/LmhlYWRlcnM/LmNvb2tpZSB8fCBcIlwiO1xuICBjb25zdCBvdXQgPSB7fTtcbiAgaGVhZGVyLnNwbGl0KFwiO1wiKS5mb3JFYWNoKChwYXJ0KSA9PiB7XG4gICAgY29uc3QgW2ssIC4uLnJlc3RdID0gcGFydC50cmltKCkuc3BsaXQoXCI9XCIpO1xuICAgIGlmICghaykgcmV0dXJuO1xuICAgIG91dFtrXSA9IGRlY29kZVVSSUNvbXBvbmVudChyZXN0LmpvaW4oXCI9XCIpIHx8IFwiXCIpO1xuICB9KTtcbiAgcmV0dXJuIG91dDtcbn1cblxuZnVuY3Rpb24gbWFrZUNvb2tpZShuYW1lLCB2YWx1ZSwgeyBtYXhBZ2VTZWNvbmRzID0gREVGQVVMVF9NQVhfQUdFX1NFQ09ORFMgfSA9IHt9KSB7XG4gIGNvbnN0IHNlY3VyZSA9IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSBcInByb2R1Y3Rpb25cIjtcbiAgY29uc3QgcGFydHMgPSBbXG4gICAgYCR7bmFtZX09JHtlbmNvZGVVUklDb21wb25lbnQodmFsdWUpfWAsXG4gICAgYFBhdGg9L2AsXG4gICAgYEh0dHBPbmx5YCxcbiAgICBgU2FtZVNpdGU9TGF4YCxcbiAgICBgTWF4LUFnZT0ke21heEFnZVNlY29uZHN9YCxcbiAgXTtcbiAgaWYgKHNlY3VyZSkgcGFydHMucHVzaChcIlNlY3VyZVwiKTtcbiAgcmV0dXJuIHBhcnRzLmpvaW4oXCI7IFwiKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFNlc3Npb25Ub2tlbkZyb21SZXEocmVxKSB7XG4gIGNvbnN0IGNvb2tpZXMgPSBwYXJzZUNvb2tpZXMocmVxKTtcbiAgcmV0dXJuIGNvb2tpZXNbU0VTU0lPTl9DT09LSUVdIHx8IFwiXCI7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBtYWtlU2Vzc2lvbkNvb2tpZSh0b2tlbiwgeyBtYXhBZ2VTZWNvbmRzID0gREVGQVVMVF9NQVhfQUdFX1NFQ09ORFMgfSA9IHt9KSB7XG4gIHJldHVybiBtYWtlQ29va2llKFNFU1NJT05fQ09PS0lFLCB0b2tlbiwgeyBtYXhBZ2VTZWNvbmRzIH0pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY2xlYXJTZXNzaW9uQ29va2llKCkge1xuICByZXR1cm4gbWFrZUNvb2tpZShTRVNTSU9OX0NPT0tJRSwgXCJcIiwgeyBtYXhBZ2VTZWNvbmRzOiAwIH0pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0QmFja2VuZEJhc2VVcmwoKSB7XG4gIHJldHVybiAoXG4gICAgcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfRUxPUkFfQkFDS0VORF9VUkwgfHxcbiAgICBwcm9jZXNzLmVudi5FTE9SQV9CQUNLRU5EX1VSTCB8fFxuICAgIFwiaHR0cHM6Ly9lbG9yYS13ZWJzaXRlLnZlcmNlbC5hcHBcIlxuICApLnJlcGxhY2UoL1xcLyQvLCBcIlwiKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGZldGNoQmFja2VuZFN0YXR1cyhzZXNzaW9uVG9rZW4pIHtcbiAgY29uc3QgYmFja2VuZCA9IGdldEJhY2tlbmRCYXNlVXJsKCk7XG4gIGlmICghc2Vzc2lvblRva2VuKSByZXR1cm4geyBvazogdHJ1ZSwgdmVyaWZpZWQ6IGZhbHNlLCByb2xlOiBcImd1ZXN0XCIsIGVtYWlsOiBcIlwiIH07XG5cbiAgdHJ5IHtcbiAgICBjb25zdCByID0gYXdhaXQgZmV0Y2goYCR7YmFja2VuZH0vYXBpL3ZlcmlmaWNhdGlvbi9zdGF0dXNgLCB7XG4gICAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgICBoZWFkZXJzOiB7IEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHtzZXNzaW9uVG9rZW59YCB9LFxuICAgICAgY2FjaGU6IFwibm8tc3RvcmVcIixcbiAgICB9KTtcbiAgICBjb25zdCBkYXRhID0gYXdhaXQgci5qc29uKCkuY2F0Y2goKCkgPT4gbnVsbCk7XG5cbiAgICAvLyBCYWNrZW5kIHJldHVybnMgeyBvazp0cnVlLCB2ZXJpZmllZDpib29sZWFuLCBlbWFpbD8sIHJvbGU/IH1cbiAgICBpZiAoIXIub2sgfHwgIWRhdGE/Lm9rKSByZXR1cm4geyBvazogdHJ1ZSwgdmVyaWZpZWQ6IGZhbHNlLCByb2xlOiBcImd1ZXN0XCIsIGVtYWlsOiBcIlwiIH07XG5cbiAgICByZXR1cm4ge1xuICAgICAgb2s6IHRydWUsXG4gICAgICB2ZXJpZmllZDogQm9vbGVhbihkYXRhPy52ZXJpZmllZCksXG4gICAgICBlbWFpbDogU3RyaW5nKGRhdGE/LmVtYWlsIHx8IFwiXCIpLFxuICAgICAgcm9sZTogU3RyaW5nKGRhdGE/LnJvbGUgfHwgKGRhdGE/LnZlcmlmaWVkID8gXCJyZWd1bGFyXCIgOiBcImd1ZXN0XCIpKSxcbiAgICB9O1xuICB9IGNhdGNoIHtcbiAgICAvLyBLZWVwIFVJIHN0YWJsZSBldmVuIGlmIGJhY2tlbmQgaXMgZG93blxuICAgIHJldHVybiB7IG9rOiB0cnVlLCB2ZXJpZmllZDogZmFsc2UsIHJvbGU6IFwiZ3Vlc3RcIiwgZW1haWw6IFwiXCIgfTtcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcmVxdWlyZVZlcmlmaWVkKHJlcSwgcmVzKSB7XG4gIGNvbnN0IHRva2VuID0gZ2V0U2Vzc2lvblRva2VuRnJvbVJlcShyZXEpO1xuICBjb25zdCBzdGF0dXMgPSBhd2FpdCBmZXRjaEJhY2tlbmRTdGF0dXModG9rZW4pO1xuICBpZiAoIXN0YXR1cy52ZXJpZmllZCkge1xuICAgIHJlcy5zdGF0dXMoNDAzKS5qc29uKHsgb2s6IGZhbHNlLCBlcnJvcjogXCJub3RfdmVyaWZpZWRcIiB9KTtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICByZXR1cm4gc3RhdHVzO1xufVxuIl0sIm5hbWVzIjpbIlNFU1NJT05fQ09PS0lFIiwiREVGQVVMVF9NQVhfQUdFX1NFQ09ORFMiLCJwYXJzZUNvb2tpZXMiLCJyZXEiLCJoZWFkZXIiLCJoZWFkZXJzIiwiY29va2llIiwib3V0Iiwic3BsaXQiLCJmb3JFYWNoIiwicGFydCIsImsiLCJyZXN0IiwidHJpbSIsImRlY29kZVVSSUNvbXBvbmVudCIsImpvaW4iLCJtYWtlQ29va2llIiwibmFtZSIsInZhbHVlIiwibWF4QWdlU2Vjb25kcyIsInNlY3VyZSIsInByb2Nlc3MiLCJwYXJ0cyIsImVuY29kZVVSSUNvbXBvbmVudCIsInB1c2giLCJnZXRTZXNzaW9uVG9rZW5Gcm9tUmVxIiwiY29va2llcyIsIm1ha2VTZXNzaW9uQ29va2llIiwidG9rZW4iLCJjbGVhclNlc3Npb25Db29raWUiLCJnZXRCYWNrZW5kQmFzZVVybCIsImVudiIsIk5FWFRfUFVCTElDX0VMT1JBX0JBQ0tFTkRfVVJMIiwiRUxPUkFfQkFDS0VORF9VUkwiLCJyZXBsYWNlIiwiZmV0Y2hCYWNrZW5kU3RhdHVzIiwic2Vzc2lvblRva2VuIiwiYmFja2VuZCIsIm9rIiwidmVyaWZpZWQiLCJyb2xlIiwiZW1haWwiLCJyIiwiZmV0Y2giLCJtZXRob2QiLCJBdXRob3JpemF0aW9uIiwiY2FjaGUiLCJkYXRhIiwianNvbiIsImNhdGNoIiwiQm9vbGVhbiIsIlN0cmluZyIsInJlcXVpcmVWZXJpZmllZCIsInJlcyIsInN0YXR1cyIsImVycm9yIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./lib/server/verification.js\n");

/***/ }),

/***/ "(api)/./pages/api/session/status.js":
/*!*************************************!*\
  !*** ./pages/api/session/status.js ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _lib_server_verification__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/server/verification */ \"(api)/./lib/server/verification.js\");\n\nasync function handler(req, res) {\n    const token = (0,_lib_server_verification__WEBPACK_IMPORTED_MODULE_0__.getSessionTokenFromReq)(req);\n    const status = await (0,_lib_server_verification__WEBPACK_IMPORTED_MODULE_0__.fetchBackendStatus)(token);\n    const accountRole = String(status.role || (status.verified ? \"regular\" : \"guest\")).toLowerCase();\n    const teacher = accountRole === \"teacher\";\n    res.status(200).json({\n        ok: true,\n        verified: Boolean(status.verified),\n        email: status.email || \"\",\n        // Backwards-compatible field name (server-side role, NOT UI persona role)\n        role: accountRole,\n        // Preferred explicit name (avoids collision with UI persona role)\n        accountRole,\n        teacher,\n        hasSession: Boolean(token)\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9wYWdlcy9hcGkvc2Vzc2lvbi9zdGF0dXMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBdUY7QUFFeEUsZUFBZUUsUUFBUUMsR0FBRyxFQUFFQyxHQUFHO0lBQzVDLE1BQU1DLFFBQVFMLGdGQUFzQkEsQ0FBQ0c7SUFDckMsTUFBTUcsU0FBUyxNQUFNTCw0RUFBa0JBLENBQUNJO0lBRXhDLE1BQU1FLGNBQWNDLE9BQU9GLE9BQU9HLElBQUksSUFBS0gsQ0FBQUEsT0FBT0ksUUFBUSxHQUFHLFlBQVksT0FBTSxHQUFJQyxXQUFXO0lBQzlGLE1BQU1DLFVBQVVMLGdCQUFnQjtJQUVoQ0gsSUFBSUUsTUFBTSxDQUFDLEtBQUtPLElBQUksQ0FBQztRQUNuQkMsSUFBSTtRQUNKSixVQUFVSyxRQUFRVCxPQUFPSSxRQUFRO1FBQ2pDTSxPQUFPVixPQUFPVSxLQUFLLElBQUk7UUFDdkIsMEVBQTBFO1FBQzFFUCxNQUFNRjtRQUNOLGtFQUFrRTtRQUNsRUE7UUFDQUs7UUFDQUssWUFBWUYsUUFBUVY7SUFDdEI7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL2Vsb3JhLXZlcmlmaWNhdGlvbi11aS8uL3BhZ2VzL2FwaS9zZXNzaW9uL3N0YXR1cy5qcz81YmQ5Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGdldFNlc3Npb25Ub2tlbkZyb21SZXEsIGZldGNoQmFja2VuZFN0YXR1cyB9IGZyb20gXCJAL2xpYi9zZXJ2ZXIvdmVyaWZpY2F0aW9uXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxLCByZXMpIHtcbiAgY29uc3QgdG9rZW4gPSBnZXRTZXNzaW9uVG9rZW5Gcm9tUmVxKHJlcSk7XG4gIGNvbnN0IHN0YXR1cyA9IGF3YWl0IGZldGNoQmFja2VuZFN0YXR1cyh0b2tlbik7XG5cbiAgY29uc3QgYWNjb3VudFJvbGUgPSBTdHJpbmcoc3RhdHVzLnJvbGUgfHwgKHN0YXR1cy52ZXJpZmllZCA/IFwicmVndWxhclwiIDogXCJndWVzdFwiKSkudG9Mb3dlckNhc2UoKTtcbiAgY29uc3QgdGVhY2hlciA9IGFjY291bnRSb2xlID09PSBcInRlYWNoZXJcIjtcblxuICByZXMuc3RhdHVzKDIwMCkuanNvbih7XG4gICAgb2s6IHRydWUsXG4gICAgdmVyaWZpZWQ6IEJvb2xlYW4oc3RhdHVzLnZlcmlmaWVkKSxcbiAgICBlbWFpbDogc3RhdHVzLmVtYWlsIHx8IFwiXCIsXG4gICAgLy8gQmFja3dhcmRzLWNvbXBhdGlibGUgZmllbGQgbmFtZSAoc2VydmVyLXNpZGUgcm9sZSwgTk9UIFVJIHBlcnNvbmEgcm9sZSlcbiAgICByb2xlOiBhY2NvdW50Um9sZSxcbiAgICAvLyBQcmVmZXJyZWQgZXhwbGljaXQgbmFtZSAoYXZvaWRzIGNvbGxpc2lvbiB3aXRoIFVJIHBlcnNvbmEgcm9sZSlcbiAgICBhY2NvdW50Um9sZSxcbiAgICB0ZWFjaGVyLFxuICAgIGhhc1Nlc3Npb246IEJvb2xlYW4odG9rZW4pLFxuICB9KTtcbn1cbiJdLCJuYW1lcyI6WyJnZXRTZXNzaW9uVG9rZW5Gcm9tUmVxIiwiZmV0Y2hCYWNrZW5kU3RhdHVzIiwiaGFuZGxlciIsInJlcSIsInJlcyIsInRva2VuIiwic3RhdHVzIiwiYWNjb3VudFJvbGUiLCJTdHJpbmciLCJyb2xlIiwidmVyaWZpZWQiLCJ0b0xvd2VyQ2FzZSIsInRlYWNoZXIiLCJqc29uIiwib2siLCJCb29sZWFuIiwiZW1haWwiLCJoYXNTZXNzaW9uIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./pages/api/session/status.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fsession%2Fstatus&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Csession%5Cstatus.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();